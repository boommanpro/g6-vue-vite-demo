var FI=Object.defineProperty;var Ix=n=>{throw TypeError(n)};var BI=(n,t,e)=>t in n?FI(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var Ce=(n,t,e)=>BI(n,typeof t!="symbol"?t+"":t,e),Td=(n,t,e)=>t.has(n)||Ix("Cannot "+e);var ri=(n,t,e)=>(Td(n,t,"read from private field"),e?e.call(n):t.get(n)),kd=(n,t,e)=>t.has(n)?Ix("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e),Dc=(n,t,e,r)=>(Td(n,t,"write to private field"),r?r.call(n,e):t.set(n,e),e),Ad=(n,t,e)=>(Td(n,t,"access private method"),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function e(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=e(i);fetch(i.href,a)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Hb(n){const t=Object.create(null);for(const e of n.split(","))t[e]=1;return e=>e in t}const Be={},vo=[],Ri=()=>{},zI=()=>!1,$h=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),Ub=n=>n.startsWith("onUpdate:"),hr=Object.assign,Yb=(n,t)=>{const e=n.indexOf(t);e>-1&&n.splice(e,1)},jI=Object.prototype.hasOwnProperty,be=(n,t)=>jI.call(n,t),he=Array.isArray,xl=n=>Gh(n)==="[object Map]",qI=n=>Gh(n)==="[object Set]",de=n=>typeof n=="function",Nn=n=>typeof n=="string",Do=n=>typeof n=="symbol",mn=n=>n!==null&&typeof n=="object",mC=n=>(mn(n)||de(n))&&de(n.then)&&de(n.catch),$I=Object.prototype.toString,Gh=n=>$I.call(n),GI=n=>Gh(n).slice(8,-1),WI=n=>Gh(n)==="[object Object]",Xb=n=>Nn(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,El=Hb(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Wh=n=>{const t=Object.create(null);return e=>t[e]||(t[e]=n(e))},VI=/-(\w)/g,$a=Wh(n=>n.replace(VI,(t,e)=>e?e.toUpperCase():"")),HI=/\B([A-Z])/g,js=Wh(n=>n.replace(HI,"-$1").toLowerCase()),bC=Wh(n=>n.charAt(0).toUpperCase()+n.slice(1)),Cd=Wh(n=>n?`on${bC(n)}`:""),Ss=(n,t)=>!Object.is(n,t),Pd=(n,...t)=>{for(let e=0;e<n.length;e++)n[e](...t)},wC=(n,t,e,r=!1)=>{Object.defineProperty(n,t,{configurable:!0,enumerable:!1,writable:r,value:e})},UI=n=>{const t=parseFloat(n);return isNaN(t)?n:t};let Dx;const Vh=()=>Dx||(Dx=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Kb(n){if(he(n)){const t={};for(let e=0;e<n.length;e++){const r=n[e],i=Nn(r)?ZI(r):Kb(r);if(i)for(const a in i)t[a]=i[a]}return t}else if(Nn(n)||mn(n))return n}const YI=/;(?![^(]*\))/g,XI=/:([^]+)/,KI=/\/\*[^]*?\*\//g;function ZI(n){const t={};return n.replace(KI,"").split(YI).forEach(e=>{if(e){const r=e.split(XI);r.length>1&&(t[r[0].trim()]=r[1].trim())}}),t}function Zb(n){let t="";if(Nn(n))t=n;else if(he(n))for(let e=0;e<n.length;e++){const r=Zb(n[e]);r&&(t+=r+" ")}else if(mn(n))for(const e in n)n[e]&&(t+=e+" ");return t.trim()}const JI="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",QI=Hb(JI);function xC(n){return!!n||n===""}/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Pr;class tD{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Pr,!t&&Pr&&(this.index=(Pr.scopes||(Pr.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].pause();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].resume();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].resume()}}run(t){if(this._active){const e=Pr;try{return Pr=this,t()}finally{Pr=e}}}on(){Pr=this}off(){Pr=this.parent}stop(t){if(this._active){this._active=!1;let e,r;for(e=0,r=this.effects.length;e<r;e++)this.effects[e].stop();for(this.effects.length=0,e=0,r=this.cleanups.length;e<r;e++)this.cleanups[e]();if(this.cleanups.length=0,this.scopes){for(e=0,r=this.scopes.length;e<r;e++)this.scopes[e].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function eD(){return Pr}let De;const Nd=new WeakSet;class EC{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Pr&&Pr.active&&Pr.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Nd.has(this)&&(Nd.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||_C(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Fx(this),MC(this);const t=De,e=hi;De=this,hi=!0;try{return this.fn()}finally{OC(this),De=t,hi=e,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)tw(t);this.deps=this.depsTail=void 0,Fx(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Nd.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){_1(this)&&this.run()}get dirty(){return _1(this)}}let SC=0,Sl,_l;function _C(n,t=!1){if(n.flags|=8,t){n.next=_l,_l=n;return}n.next=Sl,Sl=n}function Jb(){SC++}function Qb(){if(--SC>0)return;if(_l){let t=_l;for(_l=void 0;t;){const e=t.next;t.next=void 0,t.flags&=-9,t=e}}let n;for(;Sl;){let t=Sl;for(Sl=void 0;t;){const e=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(r){n||(n=r)}t=e}}if(n)throw n}function MC(n){for(let t=n.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function OC(n){let t,e=n.depsTail,r=e;for(;r;){const i=r.prevDep;r.version===-1?(r===e&&(e=i),tw(r),nD(r)):t=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=i}n.deps=t,n.depsTail=e}function _1(n){for(let t=n.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(TC(t.dep.computed)||t.dep.version!==t.version))return!0;return!!n._dirty}function TC(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===Fl))return;n.globalVersion=Fl;const t=n.dep;if(n.flags|=2,t.version>0&&!n.isSSR&&n.deps&&!_1(n)){n.flags&=-3;return}const e=De,r=hi;De=n,hi=!0;try{MC(n);const i=n.fn(n._value);(t.version===0||Ss(i,n._value))&&(n._value=i,t.version++)}catch(i){throw t.version++,i}finally{De=e,hi=r,OC(n),n.flags&=-3}}function tw(n,t=!1){const{dep:e,prevSub:r,nextSub:i}=n;if(r&&(r.nextSub=i,n.prevSub=void 0),i&&(i.prevSub=r,n.nextSub=void 0),e.subs===n&&(e.subs=r,!r&&e.computed)){e.computed.flags&=-5;for(let a=e.computed.deps;a;a=a.nextDep)tw(a,!0)}!t&&!--e.sc&&e.map&&e.map.delete(e.key)}function nD(n){const{prevDep:t,nextDep:e}=n;t&&(t.nextDep=e,n.prevDep=void 0),e&&(e.prevDep=t,n.nextDep=void 0)}let hi=!0;const kC=[];function Ka(){kC.push(hi),hi=!1}function Za(){const n=kC.pop();hi=n===void 0?!0:n}function Fx(n){const{cleanup:t}=n;if(n.cleanup=void 0,t){const e=De;De=void 0;try{t()}finally{De=e}}}let Fl=0;class rD{constructor(t,e){this.sub=t,this.dep=e,this.version=e.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class AC{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!De||!hi||De===this.computed)return;let e=this.activeLink;if(e===void 0||e.sub!==De)e=this.activeLink=new rD(De,this),De.deps?(e.prevDep=De.depsTail,De.depsTail.nextDep=e,De.depsTail=e):De.deps=De.depsTail=e,CC(e);else if(e.version===-1&&(e.version=this.version,e.nextDep)){const r=e.nextDep;r.prevDep=e.prevDep,e.prevDep&&(e.prevDep.nextDep=r),e.prevDep=De.depsTail,e.nextDep=void 0,De.depsTail.nextDep=e,De.depsTail=e,De.deps===e&&(De.deps=r)}return e}trigger(t){this.version++,Fl++,this.notify(t)}notify(t){Jb();try{for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{Qb()}}}function CC(n){if(n.dep.sc++,n.sub.flags&4){const t=n.dep.computed;if(t&&!n.dep.subs){t.flags|=20;for(let r=t.deps;r;r=r.nextDep)CC(r)}const e=n.dep.subs;e!==n&&(n.prevSub=e,e&&(e.nextSub=n)),n.dep.subs=n}}const M1=new WeakMap,_s=Symbol(""),O1=Symbol(""),Bl=Symbol("");function Xn(n,t,e){if(hi&&De){let r=M1.get(n);r||M1.set(n,r=new Map);let i=r.get(e);i||(r.set(e,i=new AC),i.map=r,i.key=e),i.track()}}function Zi(n,t,e,r,i,a){const s=M1.get(n);if(!s){Fl++;return}const o=l=>{l&&l.trigger()};if(Jb(),t==="clear")s.forEach(o);else{const l=he(n),c=l&&Xb(e);if(l&&e==="length"){const u=Number(r);s.forEach((h,f)=>{(f==="length"||f===Bl||!Do(f)&&f>=u)&&o(h)})}else switch((e!==void 0||s.has(void 0))&&o(s.get(e)),c&&o(s.get(Bl)),t){case"add":l?c&&o(s.get("length")):(o(s.get(_s)),xl(n)&&o(s.get(O1)));break;case"delete":l||(o(s.get(_s)),xl(n)&&o(s.get(O1)));break;case"set":xl(n)&&o(s.get(_s));break}}Qb()}function Ks(n){const t=Te(n);return t===n?t:(Xn(t,"iterate",Bl),Li(n)?t:t.map(Rr))}function ew(n){return Xn(n=Te(n),"iterate",Bl),n}const iD={__proto__:null,[Symbol.iterator](){return Rd(this,Symbol.iterator,Rr)},concat(...n){return Ks(this).concat(...n.map(t=>he(t)?Ks(t):t))},entries(){return Rd(this,"entries",n=>(n[1]=Rr(n[1]),n))},every(n,t){return Hi(this,"every",n,t,void 0,arguments)},filter(n,t){return Hi(this,"filter",n,t,e=>e.map(Rr),arguments)},find(n,t){return Hi(this,"find",n,t,Rr,arguments)},findIndex(n,t){return Hi(this,"findIndex",n,t,void 0,arguments)},findLast(n,t){return Hi(this,"findLast",n,t,Rr,arguments)},findLastIndex(n,t){return Hi(this,"findLastIndex",n,t,void 0,arguments)},forEach(n,t){return Hi(this,"forEach",n,t,void 0,arguments)},includes(...n){return Ld(this,"includes",n)},indexOf(...n){return Ld(this,"indexOf",n)},join(n){return Ks(this).join(n)},lastIndexOf(...n){return Ld(this,"lastIndexOf",n)},map(n,t){return Hi(this,"map",n,t,void 0,arguments)},pop(){return Xo(this,"pop")},push(...n){return Xo(this,"push",n)},reduce(n,...t){return Bx(this,"reduce",n,t)},reduceRight(n,...t){return Bx(this,"reduceRight",n,t)},shift(){return Xo(this,"shift")},some(n,t){return Hi(this,"some",n,t,void 0,arguments)},splice(...n){return Xo(this,"splice",n)},toReversed(){return Ks(this).toReversed()},toSorted(n){return Ks(this).toSorted(n)},toSpliced(...n){return Ks(this).toSpliced(...n)},unshift(...n){return Xo(this,"unshift",n)},values(){return Rd(this,"values",Rr)}};function Rd(n,t,e){const r=ew(n),i=r[t]();return r!==n&&!Li(n)&&(i._next=i.next,i.next=()=>{const a=i._next();return a.value&&(a.value=e(a.value)),a}),i}const aD=Array.prototype;function Hi(n,t,e,r,i,a){const s=ew(n),o=s!==n&&!Li(n),l=s[t];if(l!==aD[t]){const h=l.apply(n,a);return o?Rr(h):h}let c=e;s!==n&&(o?c=function(h,f){return e.call(this,Rr(h),f,n)}:e.length>2&&(c=function(h,f){return e.call(this,h,f,n)}));const u=l.call(s,c,r);return o&&i?i(u):u}function Bx(n,t,e,r){const i=ew(n);let a=e;return i!==n&&(Li(n)?e.length>3&&(a=function(s,o,l){return e.call(this,s,o,l,n)}):a=function(s,o,l){return e.call(this,s,Rr(o),l,n)}),i[t](a,...r)}function Ld(n,t,e){const r=Te(n);Xn(r,"iterate",Bl);const i=r[t](...e);return(i===-1||i===!1)&&aw(e[0])?(e[0]=Te(e[0]),r[t](...e)):i}function Xo(n,t,e=[]){Ka(),Jb();const r=Te(n)[t].apply(n,e);return Qb(),Za(),r}const sD=Hb("__proto__,__v_isRef,__isVue"),PC=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Do));function oD(n){Do(n)||(n=String(n));const t=Te(this);return Xn(t,"has",n),t.hasOwnProperty(n)}class NC{constructor(t=!1,e=!1){this._isReadonly=t,this._isShallow=e}get(t,e,r){if(e==="__v_skip")return t.__v_skip;const i=this._isReadonly,a=this._isShallow;if(e==="__v_isReactive")return!i;if(e==="__v_isReadonly")return i;if(e==="__v_isShallow")return a;if(e==="__v_raw")return r===(i?a?yD:DC:a?IC:LC).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(r)?t:void 0;const s=he(t);if(!i){let l;if(s&&(l=iD[e]))return l;if(e==="hasOwnProperty")return oD}const o=Reflect.get(t,e,ur(t)?t:r);return(Do(e)?PC.has(e):sD(e))||(i||Xn(t,"get",e),a)?o:ur(o)?s&&Xb(e)?o:o.value:mn(o)?i?FC(o):rw(o):o}}class RC extends NC{constructor(t=!1){super(!1,t)}set(t,e,r,i){let a=t[e];if(!this._isShallow){const l=_o(a);if(!Li(r)&&!_o(r)&&(a=Te(a),r=Te(r)),!he(t)&&ur(a)&&!ur(r))return l?!1:(a.value=r,!0)}const s=he(t)&&Xb(e)?Number(e)<t.length:be(t,e),o=Reflect.set(t,e,r,ur(t)?t:i);return t===Te(i)&&(s?Ss(r,a)&&Zi(t,"set",e,r):Zi(t,"add",e,r)),o}deleteProperty(t,e){const r=be(t,e);t[e];const i=Reflect.deleteProperty(t,e);return i&&r&&Zi(t,"delete",e,void 0),i}has(t,e){const r=Reflect.has(t,e);return(!Do(e)||!PC.has(e))&&Xn(t,"has",e),r}ownKeys(t){return Xn(t,"iterate",he(t)?"length":_s),Reflect.ownKeys(t)}}class lD extends NC{constructor(t=!1){super(!0,t)}set(t,e){return!0}deleteProperty(t,e){return!0}}const cD=new RC,uD=new lD,hD=new RC(!0);const T1=n=>n,Fc=n=>Reflect.getPrototypeOf(n);function fD(n,t,e){return function(...r){const i=this.__v_raw,a=Te(i),s=xl(a),o=n==="entries"||n===Symbol.iterator&&s,l=n==="keys"&&s,c=i[n](...r),u=e?T1:t?k1:Rr;return!t&&Xn(a,"iterate",l?O1:_s),{next(){const{value:h,done:f}=c.next();return f?{value:h,done:f}:{value:o?[u(h[0]),u(h[1])]:u(h),done:f}},[Symbol.iterator](){return this}}}}function Bc(n){return function(...t){return n==="delete"?!1:n==="clear"?void 0:this}}function dD(n,t){const e={get(i){const a=this.__v_raw,s=Te(a),o=Te(i);n||(Ss(i,o)&&Xn(s,"get",i),Xn(s,"get",o));const{has:l}=Fc(s),c=t?T1:n?k1:Rr;if(l.call(s,i))return c(a.get(i));if(l.call(s,o))return c(a.get(o));a!==s&&a.get(i)},get size(){const i=this.__v_raw;return!n&&Xn(Te(i),"iterate",_s),Reflect.get(i,"size",i)},has(i){const a=this.__v_raw,s=Te(a),o=Te(i);return n||(Ss(i,o)&&Xn(s,"has",i),Xn(s,"has",o)),i===o?a.has(i):a.has(i)||a.has(o)},forEach(i,a){const s=this,o=s.__v_raw,l=Te(o),c=t?T1:n?k1:Rr;return!n&&Xn(l,"iterate",_s),o.forEach((u,h)=>i.call(a,c(u),c(h),s))}};return hr(e,n?{add:Bc("add"),set:Bc("set"),delete:Bc("delete"),clear:Bc("clear")}:{add(i){!t&&!Li(i)&&!_o(i)&&(i=Te(i));const a=Te(this);return Fc(a).has.call(a,i)||(a.add(i),Zi(a,"add",i,i)),this},set(i,a){!t&&!Li(a)&&!_o(a)&&(a=Te(a));const s=Te(this),{has:o,get:l}=Fc(s);let c=o.call(s,i);c||(i=Te(i),c=o.call(s,i));const u=l.call(s,i);return s.set(i,a),c?Ss(a,u)&&Zi(s,"set",i,a):Zi(s,"add",i,a),this},delete(i){const a=Te(this),{has:s,get:o}=Fc(a);let l=s.call(a,i);l||(i=Te(i),l=s.call(a,i)),o&&o.call(a,i);const c=a.delete(i);return l&&Zi(a,"delete",i,void 0),c},clear(){const i=Te(this),a=i.size!==0,s=i.clear();return a&&Zi(i,"clear",void 0,void 0),s}}),["keys","values","entries",Symbol.iterator].forEach(i=>{e[i]=fD(i,n,t)}),e}function nw(n,t){const e=dD(n,t);return(r,i,a)=>i==="__v_isReactive"?!n:i==="__v_isReadonly"?n:i==="__v_raw"?r:Reflect.get(be(e,i)&&i in r?e:r,i,a)}const gD={get:nw(!1,!1)},pD={get:nw(!1,!0)},vD={get:nw(!0,!1)};const LC=new WeakMap,IC=new WeakMap,DC=new WeakMap,yD=new WeakMap;function mD(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function bD(n){return n.__v_skip||!Object.isExtensible(n)?0:mD(GI(n))}function rw(n){return _o(n)?n:iw(n,!1,cD,gD,LC)}function wD(n){return iw(n,!1,hD,pD,IC)}function FC(n){return iw(n,!0,uD,vD,DC)}function iw(n,t,e,r,i){if(!mn(n)||n.__v_raw&&!(t&&n.__v_isReactive))return n;const a=i.get(n);if(a)return a;const s=bD(n);if(s===0)return n;const o=new Proxy(n,s===2?r:e);return i.set(n,o),o}function Ml(n){return _o(n)?Ml(n.__v_raw):!!(n&&n.__v_isReactive)}function _o(n){return!!(n&&n.__v_isReadonly)}function Li(n){return!!(n&&n.__v_isShallow)}function aw(n){return n?!!n.__v_raw:!1}function Te(n){const t=n&&n.__v_raw;return t?Te(t):n}function xD(n){return!be(n,"__v_skip")&&Object.isExtensible(n)&&wC(n,"__v_skip",!0),n}const Rr=n=>mn(n)?rw(n):n,k1=n=>mn(n)?FC(n):n;function ur(n){return n?n.__v_isRef===!0:!1}function ED(n){return ur(n)?n.value:n}const SD={get:(n,t,e)=>t==="__v_raw"?n:ED(Reflect.get(n,t,e)),set:(n,t,e,r)=>{const i=n[t];return ur(i)&&!ur(e)?(i.value=e,!0):Reflect.set(n,t,e,r)}};function BC(n){return Ml(n)?n:new Proxy(n,SD)}class _D{constructor(t,e,r){this.fn=t,this.setter=e,this._value=void 0,this.dep=new AC(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Fl-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!e,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&De!==this)return _C(this,!0),!0}get value(){const t=this.dep.track();return TC(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function MD(n,t,e=!1){let r,i;return de(n)?r=n:(r=n.get,i=n.set),new _D(r,i,e)}const zc={},Qu=new WeakMap;let ps;function OD(n,t=!1,e=ps){if(e){let r=Qu.get(e);r||Qu.set(e,r=[]),r.push(n)}}function TD(n,t,e=Be){const{immediate:r,deep:i,once:a,scheduler:s,augmentJob:o,call:l}=e,c=E=>i?E:Li(E)||i===!1||i===0?Oa(E,1):Oa(E);let u,h,f,d,g=!1,v=!1;if(ur(n)?(h=()=>n.value,g=Li(n)):Ml(n)?(h=()=>c(n),g=!0):he(n)?(v=!0,g=n.some(E=>Ml(E)||Li(E)),h=()=>n.map(E=>{if(ur(E))return E.value;if(Ml(E))return c(E);if(de(E))return l?l(E,2):E()})):de(n)?t?h=l?()=>l(n,2):n:h=()=>{if(f){Ka();try{f()}finally{Za()}}const E=ps;ps=u;try{return l?l(n,3,[d]):n(d)}finally{ps=E}}:h=Ri,t&&i){const E=h,S=i===!0?1/0:i;h=()=>Oa(E(),S)}const p=eD(),y=()=>{u.stop(),p&&p.active&&Yb(p.effects,u)};if(a&&t){const E=t;t=(...S)=>{E(...S),y()}}let m=v?new Array(n.length).fill(zc):zc;const w=E=>{if(!(!(u.flags&1)||!u.dirty&&!E))if(t){const S=u.run();if(i||g||(v?S.some((O,k)=>Ss(O,m[k])):Ss(S,m))){f&&f();const O=ps;ps=u;try{const k=[S,m===zc?void 0:v&&m[0]===zc?[]:m,d];l?l(t,3,k):t(...k),m=S}finally{ps=O}}}else u.run()};return o&&o(w),u=new EC(h),u.scheduler=s?()=>s(w,!1):w,d=E=>OD(E,!1,u),f=u.onStop=()=>{const E=Qu.get(u);if(E){if(l)l(E,4);else for(const S of E)S();Qu.delete(u)}},t?r?w(!0):m=u.run():s?s(w.bind(null,!0),!0):u.run(),y.pause=u.pause.bind(u),y.resume=u.resume.bind(u),y.stop=y,y}function Oa(n,t=1/0,e){if(t<=0||!mn(n)||n.__v_skip||(e=e||new Set,e.has(n)))return n;if(e.add(n),t--,ur(n))Oa(n.value,t,e);else if(he(n))for(let r=0;r<n.length;r++)Oa(n[r],t,e);else if(qI(n)||xl(n))n.forEach(r=>{Oa(r,t,e)});else if(WI(n)){for(const r in n)Oa(n[r],t,e);for(const r of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,r)&&Oa(n[r],t,e)}return n}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function sc(n,t,e,r){try{return r?n(...r):n()}catch(i){Hh(i,t,e)}}function Fi(n,t,e,r){if(de(n)){const i=sc(n,t,e,r);return i&&mC(i)&&i.catch(a=>{Hh(a,t,e)}),i}if(he(n)){const i=[];for(let a=0;a<n.length;a++)i.push(Fi(n[a],t,e,r));return i}}function Hh(n,t,e,r=!0){const i=t?t.vnode:null,{errorHandler:a,throwUnhandledErrorInProduction:s}=t&&t.appContext.config||Be;if(t){let o=t.parent;const l=t.proxy,c=`https://vuejs.org/error-reference/#runtime-${e}`;for(;o;){const u=o.ec;if(u){for(let h=0;h<u.length;h++)if(u[h](n,l,c)===!1)return}o=o.parent}if(a){Ka(),sc(a,null,10,[n,l,c]),Za();return}}kD(n,e,i,r,s)}function kD(n,t,e,r=!0,i=!1){if(i)throw n;console.error(n)}const ir=[];let Mi=-1;const yo=[];let Ea=null,lo=0;const zC=Promise.resolve();let th=null;function AD(n){const t=th||zC;return n?t.then(this?n.bind(this):n):t}function CD(n){let t=Mi+1,e=ir.length;for(;t<e;){const r=t+e>>>1,i=ir[r],a=zl(i);a<n||a===n&&i.flags&2?t=r+1:e=r}return t}function sw(n){if(!(n.flags&1)){const t=zl(n),e=ir[ir.length-1];!e||!(n.flags&2)&&t>=zl(e)?ir.push(n):ir.splice(CD(t),0,n),n.flags|=1,jC()}}function jC(){th||(th=zC.then($C))}function PD(n){he(n)?yo.push(...n):Ea&&n.id===-1?Ea.splice(lo+1,0,n):n.flags&1||(yo.push(n),n.flags|=1),jC()}function zx(n,t,e=Mi+1){for(;e<ir.length;e++){const r=ir[e];if(r&&r.flags&2){if(n&&r.id!==n.uid)continue;ir.splice(e,1),e--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function qC(n){if(yo.length){const t=[...new Set(yo)].sort((e,r)=>zl(e)-zl(r));if(yo.length=0,Ea){Ea.push(...t);return}for(Ea=t,lo=0;lo<Ea.length;lo++){const e=Ea[lo];e.flags&4&&(e.flags&=-2),e.flags&8||e(),e.flags&=-2}Ea=null,lo=0}}const zl=n=>n.id==null?n.flags&2?-1:1/0:n.id;function $C(n){try{for(Mi=0;Mi<ir.length;Mi++){const t=ir[Mi];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),sc(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Mi<ir.length;Mi++){const t=ir[Mi];t&&(t.flags&=-2)}Mi=-1,ir.length=0,qC(),th=null,(ir.length||yo.length)&&$C()}}let ki=null,GC=null;function eh(n){const t=ki;return ki=n,GC=n&&n.type.__scopeId||null,t}function ND(n,t=ki,e){if(!t||n._n)return n;const r=(...i)=>{r._d&&Yx(-1);const a=eh(t);let s;try{s=n(...i)}finally{eh(a),r._d&&Yx(1)}return s};return r._n=!0,r._c=!0,r._d=!0,r}function os(n,t,e,r){const i=n.dirs,a=t&&t.dirs;for(let s=0;s<i.length;s++){const o=i[s];a&&(o.oldValue=a[s].value);let l=o.dir[r];l&&(Ka(),Fi(l,e,8,[n.el,o,n,t]),Za())}}const RD=Symbol("_vte"),LD=n=>n.__isTeleport;function ow(n,t){n.shapeFlag&6&&n.component?(n.transition=t,ow(n.component.subTree,t)):n.shapeFlag&128?(n.ssContent.transition=t.clone(n.ssContent),n.ssFallback.transition=t.clone(n.ssFallback)):n.transition=t}function WC(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function nh(n,t,e,r,i=!1){if(he(n)){n.forEach((g,v)=>nh(g,t&&(he(t)?t[v]:t),e,r,i));return}if(Ol(r)&&!i){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&nh(n,t,e,r.component.subTree);return}const a=r.shapeFlag&4?uw(r.component):r.el,s=i?null:a,{i:o,r:l}=n,c=t&&t.r,u=o.refs===Be?o.refs={}:o.refs,h=o.setupState,f=Te(h),d=h===Be?()=>!1:g=>be(f,g);if(c!=null&&c!==l&&(Nn(c)?(u[c]=null,d(c)&&(h[c]=null)):ur(c)&&(c.value=null)),de(l))sc(l,o,12,[s,u]);else{const g=Nn(l),v=ur(l);if(g||v){const p=()=>{if(n.f){const y=g?d(l)?h[l]:u[l]:l.value;i?he(y)&&Yb(y,a):he(y)?y.includes(a)||y.push(a):g?(u[l]=[a],d(l)&&(h[l]=u[l])):(l.value=[a],n.k&&(u[n.k]=l.value))}else g?(u[l]=s,d(l)&&(h[l]=s)):v&&(l.value=s,n.k&&(u[n.k]=s))};s?(p.id=-1,Cr(p,e)):p()}}}Vh().requestIdleCallback;Vh().cancelIdleCallback;const Ol=n=>!!n.type.__asyncLoader,VC=n=>n.type.__isKeepAlive;function ID(n,t){HC(n,"a",t)}function DD(n,t){HC(n,"da",t)}function HC(n,t,e=ar){const r=n.__wdc||(n.__wdc=()=>{let i=e;for(;i;){if(i.isDeactivated)return;i=i.parent}return n()});if(Uh(t,r,e),e){let i=e.parent;for(;i&&i.parent;)VC(i.parent.vnode)&&FD(r,t,e,i),i=i.parent}}function FD(n,t,e,r){const i=Uh(t,n,r,!0);YC(()=>{Yb(r[t],i)},e)}function Uh(n,t,e=ar,r=!1){if(e){const i=e[n]||(e[n]=[]),a=t.__weh||(t.__weh=(...s)=>{Ka();const o=oc(e),l=Fi(t,e,n,s);return o(),Za(),l});return r?i.unshift(a):i.push(a),a}}const fa=n=>(t,e=ar)=>{(!$l||n==="sp")&&Uh(n,(...r)=>t(...r),e)},BD=fa("bm"),UC=fa("m"),zD=fa("bu"),jD=fa("u"),qD=fa("bum"),YC=fa("um"),$D=fa("sp"),GD=fa("rtg"),WD=fa("rtc");function VD(n,t=ar){Uh("ec",n,t)}const HD=Symbol.for("v-ndc"),A1=n=>n?vP(n)?uw(n):A1(n.parent):null,Tl=hr(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>A1(n.parent),$root:n=>A1(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>KC(n),$forceUpdate:n=>n.f||(n.f=()=>{sw(n.update)}),$nextTick:n=>n.n||(n.n=AD.bind(n.proxy)),$watch:n=>g6.bind(n)}),Id=(n,t)=>n!==Be&&!n.__isScriptSetup&&be(n,t),UD={get({_:n},t){if(t==="__v_skip")return!0;const{ctx:e,setupState:r,data:i,props:a,accessCache:s,type:o,appContext:l}=n;let c;if(t[0]!=="$"){const d=s[t];if(d!==void 0)switch(d){case 1:return r[t];case 2:return i[t];case 4:return e[t];case 3:return a[t]}else{if(Id(r,t))return s[t]=1,r[t];if(i!==Be&&be(i,t))return s[t]=2,i[t];if((c=n.propsOptions[0])&&be(c,t))return s[t]=3,a[t];if(e!==Be&&be(e,t))return s[t]=4,e[t];C1&&(s[t]=0)}}const u=Tl[t];let h,f;if(u)return t==="$attrs"&&Xn(n.attrs,"get",""),u(n);if((h=o.__cssModules)&&(h=h[t]))return h;if(e!==Be&&be(e,t))return s[t]=4,e[t];if(f=l.config.globalProperties,be(f,t))return f[t]},set({_:n},t,e){const{data:r,setupState:i,ctx:a}=n;return Id(i,t)?(i[t]=e,!0):r!==Be&&be(r,t)?(r[t]=e,!0):be(n.props,t)||t[0]==="$"&&t.slice(1)in n?!1:(a[t]=e,!0)},has({_:{data:n,setupState:t,accessCache:e,ctx:r,appContext:i,propsOptions:a}},s){let o;return!!e[s]||n!==Be&&be(n,s)||Id(t,s)||(o=a[0])&&be(o,s)||be(r,s)||be(Tl,s)||be(i.config.globalProperties,s)},defineProperty(n,t,e){return e.get!=null?n._.accessCache[t]=0:be(e,"value")&&this.set(n,t,e.value,null),Reflect.defineProperty(n,t,e)}};function jx(n){return he(n)?n.reduce((t,e)=>(t[e]=null,t),{}):n}let C1=!0;function YD(n){const t=KC(n),e=n.proxy,r=n.ctx;C1=!1,t.beforeCreate&&qx(t.beforeCreate,n,"bc");const{data:i,computed:a,methods:s,watch:o,provide:l,inject:c,created:u,beforeMount:h,mounted:f,beforeUpdate:d,updated:g,activated:v,deactivated:p,beforeDestroy:y,beforeUnmount:m,destroyed:w,unmounted:E,render:S,renderTracked:O,renderTriggered:k,errorCaptured:T,serverPrefetch:C,expose:P,inheritAttrs:N,components:L,directives:D,filters:G}=t;if(c&&XD(c,r,null),s)for(const q in s){const z=s[q];de(z)&&(r[q]=z.bind(e))}if(i){const q=i.call(e,e);mn(q)&&(n.data=rw(q))}if(C1=!0,a)for(const q in a){const z=a[q],Z=de(z)?z.bind(e,e):de(z.get)?z.get.bind(e,e):Ri,at=!de(z)&&de(z.set)?z.set.bind(e):Ri,ft=B6({get:Z,set:at});Object.defineProperty(r,q,{enumerable:!0,configurable:!0,get:()=>ft.value,set:ct=>ft.value=ct})}if(o)for(const q in o)XC(o[q],r,e,q);if(l){const q=de(l)?l.call(e):l;Reflect.ownKeys(q).forEach(z=>{e6(z,q[z])})}u&&qx(u,n,"c");function W(q,z){he(z)?z.forEach(Z=>q(Z.bind(e))):z&&q(z.bind(e))}if(W(BD,h),W(UC,f),W(zD,d),W(jD,g),W(ID,v),W(DD,p),W(VD,T),W(WD,O),W(GD,k),W(qD,m),W(YC,E),W($D,C),he(P))if(P.length){const q=n.exposed||(n.exposed={});P.forEach(z=>{Object.defineProperty(q,z,{get:()=>e[z],set:Z=>e[z]=Z})})}else n.exposed||(n.exposed={});S&&n.render===Ri&&(n.render=S),N!=null&&(n.inheritAttrs=N),L&&(n.components=L),D&&(n.directives=D),C&&WC(n)}function XD(n,t,e=Ri){he(n)&&(n=P1(n));for(const r in n){const i=n[r];let a;mn(i)?"default"in i?a=zu(i.from||r,i.default,!0):a=zu(i.from||r):a=zu(i),ur(a)?Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:()=>a.value,set:s=>a.value=s}):t[r]=a}}function qx(n,t,e){Fi(he(n)?n.map(r=>r.bind(t.proxy)):n.bind(t.proxy),t,e)}function XC(n,t,e,r){let i=r.includes(".")?uP(e,r):()=>e[r];if(Nn(n)){const a=t[n];de(a)&&Fd(i,a)}else if(de(n))Fd(i,n.bind(e));else if(mn(n))if(he(n))n.forEach(a=>XC(a,t,e,r));else{const a=de(n.handler)?n.handler.bind(e):t[n.handler];de(a)&&Fd(i,a,n)}}function KC(n){const t=n.type,{mixins:e,extends:r}=t,{mixins:i,optionsCache:a,config:{optionMergeStrategies:s}}=n.appContext,o=a.get(t);let l;return o?l=o:!i.length&&!e&&!r?l=t:(l={},i.length&&i.forEach(c=>rh(l,c,s,!0)),rh(l,t,s)),mn(t)&&a.set(t,l),l}function rh(n,t,e,r=!1){const{mixins:i,extends:a}=t;a&&rh(n,a,e,!0),i&&i.forEach(s=>rh(n,s,e,!0));for(const s in t)if(!(r&&s==="expose")){const o=KD[s]||e&&e[s];n[s]=o?o(n[s],t[s]):t[s]}return n}const KD={data:$x,props:Gx,emits:Gx,methods:cl,computed:cl,beforeCreate:nr,created:nr,beforeMount:nr,mounted:nr,beforeUpdate:nr,updated:nr,beforeDestroy:nr,beforeUnmount:nr,destroyed:nr,unmounted:nr,activated:nr,deactivated:nr,errorCaptured:nr,serverPrefetch:nr,components:cl,directives:cl,watch:JD,provide:$x,inject:ZD};function $x(n,t){return t?n?function(){return hr(de(n)?n.call(this,this):n,de(t)?t.call(this,this):t)}:t:n}function ZD(n,t){return cl(P1(n),P1(t))}function P1(n){if(he(n)){const t={};for(let e=0;e<n.length;e++)t[n[e]]=n[e];return t}return n}function nr(n,t){return n?[...new Set([].concat(n,t))]:t}function cl(n,t){return n?hr(Object.create(null),n,t):t}function Gx(n,t){return n?he(n)&&he(t)?[...new Set([...n,...t])]:hr(Object.create(null),jx(n),jx(t??{})):t}function JD(n,t){if(!n)return t;if(!t)return n;const e=hr(Object.create(null),n);for(const r in t)e[r]=nr(n[r],t[r]);return e}function ZC(){return{app:null,config:{isNativeTag:zI,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let QD=0;function t6(n,t){return function(r,i=null){de(r)||(r=hr({},r)),i!=null&&!mn(i)&&(i=null);const a=ZC(),s=new WeakSet,o=[];let l=!1;const c=a.app={_uid:QD++,_component:r,_props:i,_container:null,_context:a,_instance:null,version:z6,get config(){return a.config},set config(u){},use(u,...h){return s.has(u)||(u&&de(u.install)?(s.add(u),u.install(c,...h)):de(u)&&(s.add(u),u(c,...h))),c},mixin(u){return a.mixins.includes(u)||a.mixins.push(u),c},component(u,h){return h?(a.components[u]=h,c):a.components[u]},directive(u,h){return h?(a.directives[u]=h,c):a.directives[u]},mount(u,h,f){if(!l){const d=c._ceVNode||Ms(r,i);return d.appContext=a,f===!0?f="svg":f===!1&&(f=void 0),n(d,u,f),l=!0,c._container=u,u.__vue_app__=c,uw(d.component)}},onUnmount(u){o.push(u)},unmount(){l&&(Fi(o,c._instance,16),n(null,c._container),delete c._container.__vue_app__)},provide(u,h){return a.provides[u]=h,c},runWithContext(u){const h=mo;mo=c;try{return u()}finally{mo=h}}};return c}}let mo=null;function e6(n,t){if(ar){let e=ar.provides;const r=ar.parent&&ar.parent.provides;r===e&&(e=ar.provides=Object.create(r)),e[n]=t}}function zu(n,t,e=!1){const r=ar||ki;if(r||mo){const i=mo?mo._context.provides:r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(i&&n in i)return i[n];if(arguments.length>1)return e&&de(t)?t.call(r&&r.proxy):t}}const JC={},QC=()=>Object.create(JC),tP=n=>Object.getPrototypeOf(n)===JC;function n6(n,t,e,r=!1){const i={},a=QC();n.propsDefaults=Object.create(null),eP(n,t,i,a);for(const s in n.propsOptions[0])s in i||(i[s]=void 0);e?n.props=r?i:wD(i):n.type.props?n.props=i:n.props=a,n.attrs=a}function r6(n,t,e,r){const{props:i,attrs:a,vnode:{patchFlag:s}}=n,o=Te(i),[l]=n.propsOptions;let c=!1;if((r||s>0)&&!(s&16)){if(s&8){const u=n.vnode.dynamicProps;for(let h=0;h<u.length;h++){let f=u[h];if(Yh(n.emitsOptions,f))continue;const d=t[f];if(l)if(be(a,f))d!==a[f]&&(a[f]=d,c=!0);else{const g=$a(f);i[g]=N1(l,o,g,d,n,!1)}else d!==a[f]&&(a[f]=d,c=!0)}}}else{eP(n,t,i,a)&&(c=!0);let u;for(const h in o)(!t||!be(t,h)&&((u=js(h))===h||!be(t,u)))&&(l?e&&(e[h]!==void 0||e[u]!==void 0)&&(i[h]=N1(l,o,h,void 0,n,!0)):delete i[h]);if(a!==o)for(const h in a)(!t||!be(t,h))&&(delete a[h],c=!0)}c&&Zi(n.attrs,"set","")}function eP(n,t,e,r){const[i,a]=n.propsOptions;let s=!1,o;if(t)for(let l in t){if(El(l))continue;const c=t[l];let u;i&&be(i,u=$a(l))?!a||!a.includes(u)?e[u]=c:(o||(o={}))[u]=c:Yh(n.emitsOptions,l)||(!(l in r)||c!==r[l])&&(r[l]=c,s=!0)}if(a){const l=Te(e),c=o||Be;for(let u=0;u<a.length;u++){const h=a[u];e[h]=N1(i,l,h,c[h],n,!be(c,h))}}return s}function N1(n,t,e,r,i,a){const s=n[e];if(s!=null){const o=be(s,"default");if(o&&r===void 0){const l=s.default;if(s.type!==Function&&!s.skipFactory&&de(l)){const{propsDefaults:c}=i;if(e in c)r=c[e];else{const u=oc(i);r=c[e]=l.call(null,t),u()}}else r=l;i.ce&&i.ce._setProp(e,r)}s[0]&&(a&&!o?r=!1:s[1]&&(r===""||r===js(e))&&(r=!0))}return r}const i6=new WeakMap;function nP(n,t,e=!1){const r=e?i6:t.propsCache,i=r.get(n);if(i)return i;const a=n.props,s={},o=[];let l=!1;if(!de(n)){const u=h=>{l=!0;const[f,d]=nP(h,t,!0);hr(s,f),d&&o.push(...d)};!e&&t.mixins.length&&t.mixins.forEach(u),n.extends&&u(n.extends),n.mixins&&n.mixins.forEach(u)}if(!a&&!l)return mn(n)&&r.set(n,vo),vo;if(he(a))for(let u=0;u<a.length;u++){const h=$a(a[u]);Wx(h)&&(s[h]=Be)}else if(a)for(const u in a){const h=$a(u);if(Wx(h)){const f=a[u],d=s[h]=he(f)||de(f)?{type:f}:hr({},f),g=d.type;let v=!1,p=!0;if(he(g))for(let y=0;y<g.length;++y){const m=g[y],w=de(m)&&m.name;if(w==="Boolean"){v=!0;break}else w==="String"&&(p=!1)}else v=de(g)&&g.name==="Boolean";d[0]=v,d[1]=p,(v||be(d,"default"))&&o.push(h)}}const c=[s,o];return mn(n)&&r.set(n,c),c}function Wx(n){return n[0]!=="$"&&!El(n)}const rP=n=>n[0]==="_"||n==="$stable",lw=n=>he(n)?n.map(Oi):[Oi(n)],a6=(n,t,e)=>{if(t._n)return t;const r=ND((...i)=>lw(t(...i)),e);return r._c=!1,r},iP=(n,t,e)=>{const r=n._ctx;for(const i in n){if(rP(i))continue;const a=n[i];if(de(a))t[i]=a6(i,a,r);else if(a!=null){const s=lw(a);t[i]=()=>s}}},aP=(n,t)=>{const e=lw(t);n.slots.default=()=>e},sP=(n,t,e)=>{for(const r in t)(e||r!=="_")&&(n[r]=t[r])},s6=(n,t,e)=>{const r=n.slots=QC();if(n.vnode.shapeFlag&32){const i=t._;i?(sP(r,t,e),e&&wC(r,"_",i,!0)):iP(t,r)}else t&&aP(n,t)},o6=(n,t,e)=>{const{vnode:r,slots:i}=n;let a=!0,s=Be;if(r.shapeFlag&32){const o=t._;o?e&&o===1?a=!1:sP(i,t,e):(a=!t.$stable,iP(t,i)),s=t}else t&&(aP(n,t),s={default:1});if(a)for(const o in i)!rP(o)&&s[o]==null&&delete i[o]},Cr=x6;function l6(n){return c6(n)}function c6(n,t){const e=Vh();e.__VUE__=!0;const{insert:r,remove:i,patchProp:a,createElement:s,createText:o,createComment:l,setText:c,setElementText:u,parentNode:h,nextSibling:f,setScopeId:d=Ri,insertStaticContent:g}=n,v=(U,X,rt,lt=null,vt=null,ut=null,Pt=void 0,xt=null,At=!!X.dynamicChildren)=>{if(U===X)return;U&&!Ko(U,X)&&(lt=dt(U),ct(U,vt,ut,!0),U=null),X.patchFlag===-2&&(At=!1,X.dynamicChildren=null);const{type:wt,ref:Bt,shapeFlag:_t}=X;switch(wt){case Xh:p(U,X,rt,lt);break;case jl:y(U,X,rt,lt);break;case Bd:U==null&&m(X,rt,lt,Pt);break;case Xi:L(U,X,rt,lt,vt,ut,Pt,xt,At);break;default:_t&1?S(U,X,rt,lt,vt,ut,Pt,xt,At):_t&6?D(U,X,rt,lt,vt,ut,Pt,xt,At):(_t&64||_t&128)&&wt.process(U,X,rt,lt,vt,ut,Pt,xt,At,Kt)}Bt!=null&&vt&&nh(Bt,U&&U.ref,ut,X||U,!X)},p=(U,X,rt,lt)=>{if(U==null)r(X.el=o(X.children),rt,lt);else{const vt=X.el=U.el;X.children!==U.children&&c(vt,X.children)}},y=(U,X,rt,lt)=>{U==null?r(X.el=l(X.children||""),rt,lt):X.el=U.el},m=(U,X,rt,lt)=>{[U.el,U.anchor]=g(U.children,X,rt,lt,U.el,U.anchor)},w=({el:U,anchor:X},rt,lt)=>{let vt;for(;U&&U!==X;)vt=f(U),r(U,rt,lt),U=vt;r(X,rt,lt)},E=({el:U,anchor:X})=>{let rt;for(;U&&U!==X;)rt=f(U),i(U),U=rt;i(X)},S=(U,X,rt,lt,vt,ut,Pt,xt,At)=>{X.type==="svg"?Pt="svg":X.type==="math"&&(Pt="mathml"),U==null?O(X,rt,lt,vt,ut,Pt,xt,At):C(U,X,vt,ut,Pt,xt,At)},O=(U,X,rt,lt,vt,ut,Pt,xt)=>{let At,wt;const{props:Bt,shapeFlag:_t,transition:$t,dirs:Vt}=U;if(At=U.el=s(U.type,ut,Bt&&Bt.is,Bt),_t&8?u(At,U.children):_t&16&&T(U.children,At,null,lt,vt,Dd(U,ut),Pt,xt),Vt&&os(U,null,lt,"created"),k(At,U,U.scopeId,Pt,lt),Bt){for(const pe in Bt)pe!=="value"&&!El(pe)&&a(At,pe,null,Bt[pe],ut,lt);"value"in Bt&&a(At,"value",null,Bt.value,ut),(wt=Bt.onVnodeBeforeMount)&&wi(wt,lt,U)}Vt&&os(U,null,lt,"beforeMount");const Zt=u6(vt,$t);Zt&&$t.beforeEnter(At),r(At,X,rt),((wt=Bt&&Bt.onVnodeMounted)||Zt||Vt)&&Cr(()=>{wt&&wi(wt,lt,U),Zt&&$t.enter(At),Vt&&os(U,null,lt,"mounted")},vt)},k=(U,X,rt,lt,vt)=>{if(rt&&d(U,rt),lt)for(let ut=0;ut<lt.length;ut++)d(U,lt[ut]);if(vt){let ut=vt.subTree;if(X===ut||fP(ut.type)&&(ut.ssContent===X||ut.ssFallback===X)){const Pt=vt.vnode;k(U,Pt,Pt.scopeId,Pt.slotScopeIds,vt.parent)}}},T=(U,X,rt,lt,vt,ut,Pt,xt,At=0)=>{for(let wt=At;wt<U.length;wt++){const Bt=U[wt]=xt?Sa(U[wt]):Oi(U[wt]);v(null,Bt,X,rt,lt,vt,ut,Pt,xt)}},C=(U,X,rt,lt,vt,ut,Pt)=>{const xt=X.el=U.el;let{patchFlag:At,dynamicChildren:wt,dirs:Bt}=X;At|=U.patchFlag&16;const _t=U.props||Be,$t=X.props||Be;let Vt;if(rt&&ls(rt,!1),(Vt=$t.onVnodeBeforeUpdate)&&wi(Vt,rt,X,U),Bt&&os(X,U,rt,"beforeUpdate"),rt&&ls(rt,!0),(_t.innerHTML&&$t.innerHTML==null||_t.textContent&&$t.textContent==null)&&u(xt,""),wt?P(U.dynamicChildren,wt,xt,rt,lt,Dd(X,vt),ut):Pt||z(U,X,xt,null,rt,lt,Dd(X,vt),ut,!1),At>0){if(At&16)N(xt,_t,$t,rt,vt);else if(At&2&&_t.class!==$t.class&&a(xt,"class",null,$t.class,vt),At&4&&a(xt,"style",_t.style,$t.style,vt),At&8){const Zt=X.dynamicProps;for(let pe=0;pe<Zt.length;pe++){const ue=Zt[pe],dn=_t[ue],on=$t[ue];(on!==dn||ue==="value")&&a(xt,ue,dn,on,vt,rt)}}At&1&&U.children!==X.children&&u(xt,X.children)}else!Pt&&wt==null&&N(xt,_t,$t,rt,vt);((Vt=$t.onVnodeUpdated)||Bt)&&Cr(()=>{Vt&&wi(Vt,rt,X,U),Bt&&os(X,U,rt,"updated")},lt)},P=(U,X,rt,lt,vt,ut,Pt)=>{for(let xt=0;xt<X.length;xt++){const At=U[xt],wt=X[xt],Bt=At.el&&(At.type===Xi||!Ko(At,wt)||At.shapeFlag&70)?h(At.el):rt;v(At,wt,Bt,null,lt,vt,ut,Pt,!0)}},N=(U,X,rt,lt,vt)=>{if(X!==rt){if(X!==Be)for(const ut in X)!El(ut)&&!(ut in rt)&&a(U,ut,X[ut],null,vt,lt);for(const ut in rt){if(El(ut))continue;const Pt=rt[ut],xt=X[ut];Pt!==xt&&ut!=="value"&&a(U,ut,xt,Pt,vt,lt)}"value"in rt&&a(U,"value",X.value,rt.value,vt)}},L=(U,X,rt,lt,vt,ut,Pt,xt,At)=>{const wt=X.el=U?U.el:o(""),Bt=X.anchor=U?U.anchor:o("");let{patchFlag:_t,dynamicChildren:$t,slotScopeIds:Vt}=X;Vt&&(xt=xt?xt.concat(Vt):Vt),U==null?(r(wt,rt,lt),r(Bt,rt,lt),T(X.children||[],rt,Bt,vt,ut,Pt,xt,At)):_t>0&&_t&64&&$t&&U.dynamicChildren?(P(U.dynamicChildren,$t,rt,vt,ut,Pt,xt),(X.key!=null||vt&&X===vt.subTree)&&oP(U,X,!0)):z(U,X,rt,Bt,vt,ut,Pt,xt,At)},D=(U,X,rt,lt,vt,ut,Pt,xt,At)=>{X.slotScopeIds=xt,U==null?X.shapeFlag&512?vt.ctx.activate(X,rt,lt,Pt,At):G(X,rt,lt,vt,ut,Pt,At):H(U,X,At)},G=(U,X,rt,lt,vt,ut,Pt)=>{const xt=U.component=N6(U,lt,vt);if(VC(U)&&(xt.ctx.renderer=Kt),R6(xt,!1,Pt),xt.asyncDep){if(vt&&vt.registerDep(xt,W,Pt),!U.el){const At=xt.subTree=Ms(jl);y(null,At,X,rt)}}else W(xt,U,X,rt,vt,ut,Pt)},H=(U,X,rt)=>{const lt=X.component=U.component;if(b6(U,X,rt))if(lt.asyncDep&&!lt.asyncResolved){q(lt,X,rt);return}else lt.next=X,lt.update();else X.el=U.el,lt.vnode=X},W=(U,X,rt,lt,vt,ut,Pt)=>{const xt=()=>{if(U.isMounted){let{next:_t,bu:$t,u:Vt,parent:Zt,vnode:pe}=U;{const Qn=lP(U);if(Qn){_t&&(_t.el=pe.el,q(U,_t,Pt)),Qn.asyncDep.then(()=>{U.isUnmounted||xt()});return}}let ue=_t,dn;ls(U,!1),_t?(_t.el=pe.el,q(U,_t,Pt)):_t=pe,$t&&Pd($t),(dn=_t.props&&_t.props.onVnodeBeforeUpdate)&&wi(dn,Zt,_t,pe),ls(U,!0);const on=Hx(U),gr=U.subTree;U.subTree=on,v(gr,on,h(gr.el),dt(gr),U,vt,ut),_t.el=on.el,ue===null&&w6(U,on.el),Vt&&Cr(Vt,vt),(dn=_t.props&&_t.props.onVnodeUpdated)&&Cr(()=>wi(dn,Zt,_t,pe),vt)}else{let _t;const{el:$t,props:Vt}=X,{bm:Zt,m:pe,parent:ue,root:dn,type:on}=U,gr=Ol(X);ls(U,!1),Zt&&Pd(Zt),!gr&&(_t=Vt&&Vt.onVnodeBeforeMount)&&wi(_t,ue,X),ls(U,!0);{dn.ce&&dn.ce._injectChildStyle(on);const Qn=U.subTree=Hx(U);v(null,Qn,rt,lt,U,vt,ut),X.el=Qn.el}if(pe&&Cr(pe,vt),!gr&&(_t=Vt&&Vt.onVnodeMounted)){const Qn=X;Cr(()=>wi(_t,ue,Qn),vt)}(X.shapeFlag&256||ue&&Ol(ue.vnode)&&ue.vnode.shapeFlag&256)&&U.a&&Cr(U.a,vt),U.isMounted=!0,X=rt=lt=null}};U.scope.on();const At=U.effect=new EC(xt);U.scope.off();const wt=U.update=At.run.bind(At),Bt=U.job=At.runIfDirty.bind(At);Bt.i=U,Bt.id=U.uid,At.scheduler=()=>sw(Bt),ls(U,!0),wt()},q=(U,X,rt)=>{X.component=U;const lt=U.vnode.props;U.vnode=X,U.next=null,r6(U,X.props,lt,rt),o6(U,X.children,rt),Ka(),zx(U),Za()},z=(U,X,rt,lt,vt,ut,Pt,xt,At=!1)=>{const wt=U&&U.children,Bt=U?U.shapeFlag:0,_t=X.children,{patchFlag:$t,shapeFlag:Vt}=X;if($t>0){if($t&128){at(wt,_t,rt,lt,vt,ut,Pt,xt,At);return}else if($t&256){Z(wt,_t,rt,lt,vt,ut,Pt,xt,At);return}}Vt&8?(Bt&16&&nt(wt,vt,ut),_t!==wt&&u(rt,_t)):Bt&16?Vt&16?at(wt,_t,rt,lt,vt,ut,Pt,xt,At):nt(wt,vt,ut,!0):(Bt&8&&u(rt,""),Vt&16&&T(_t,rt,lt,vt,ut,Pt,xt,At))},Z=(U,X,rt,lt,vt,ut,Pt,xt,At)=>{U=U||vo,X=X||vo;const wt=U.length,Bt=X.length,_t=Math.min(wt,Bt);let $t;for($t=0;$t<_t;$t++){const Vt=X[$t]=At?Sa(X[$t]):Oi(X[$t]);v(U[$t],Vt,rt,null,vt,ut,Pt,xt,At)}wt>Bt?nt(U,vt,ut,!0,!1,_t):T(X,rt,lt,vt,ut,Pt,xt,At,_t)},at=(U,X,rt,lt,vt,ut,Pt,xt,At)=>{let wt=0;const Bt=X.length;let _t=U.length-1,$t=Bt-1;for(;wt<=_t&&wt<=$t;){const Vt=U[wt],Zt=X[wt]=At?Sa(X[wt]):Oi(X[wt]);if(Ko(Vt,Zt))v(Vt,Zt,rt,null,vt,ut,Pt,xt,At);else break;wt++}for(;wt<=_t&&wt<=$t;){const Vt=U[_t],Zt=X[$t]=At?Sa(X[$t]):Oi(X[$t]);if(Ko(Vt,Zt))v(Vt,Zt,rt,null,vt,ut,Pt,xt,At);else break;_t--,$t--}if(wt>_t){if(wt<=$t){const Vt=$t+1,Zt=Vt<Bt?X[Vt].el:lt;for(;wt<=$t;)v(null,X[wt]=At?Sa(X[wt]):Oi(X[wt]),rt,Zt,vt,ut,Pt,xt,At),wt++}}else if(wt>$t)for(;wt<=_t;)ct(U[wt],vt,ut,!0),wt++;else{const Vt=wt,Zt=wt,pe=new Map;for(wt=Zt;wt<=$t;wt++){const tr=X[wt]=At?Sa(X[wt]):Oi(X[wt]);tr.key!=null&&pe.set(tr.key,wt)}let ue,dn=0;const on=$t-Zt+1;let gr=!1,Qn=0;const Vn=new Array(on);for(wt=0;wt<on;wt++)Vn[wt]=0;for(wt=Vt;wt<=_t;wt++){const tr=U[wt];if(dn>=on){ct(tr,vt,ut,!0);continue}let Gr;if(tr.key!=null)Gr=pe.get(tr.key);else for(ue=Zt;ue<=$t;ue++)if(Vn[ue-Zt]===0&&Ko(tr,X[ue])){Gr=ue;break}Gr===void 0?ct(tr,vt,ut,!0):(Vn[Gr-Zt]=wt+1,Gr>=Qn?Qn=Gr:gr=!0,v(tr,X[Gr],rt,null,vt,ut,Pt,xt,At),dn++)}const Mr=gr?h6(Vn):vo;for(ue=Mr.length-1,wt=on-1;wt>=0;wt--){const tr=Zt+wt,Gr=X[tr],Nc=tr+1<Bt?X[tr+1].el:lt;Vn[wt]===0?v(null,Gr,rt,Nc,vt,ut,Pt,xt,At):gr&&(ue<0||wt!==Mr[ue]?ft(Gr,rt,Nc,2):ue--)}}},ft=(U,X,rt,lt,vt=null)=>{const{el:ut,type:Pt,transition:xt,children:At,shapeFlag:wt}=U;if(wt&6){ft(U.component.subTree,X,rt,lt);return}if(wt&128){U.suspense.move(X,rt,lt);return}if(wt&64){Pt.move(U,X,rt,Kt);return}if(Pt===Xi){r(ut,X,rt);for(let _t=0;_t<At.length;_t++)ft(At[_t],X,rt,lt);r(U.anchor,X,rt);return}if(Pt===Bd){w(U,X,rt);return}if(lt!==2&&wt&1&&xt)if(lt===0)xt.beforeEnter(ut),r(ut,X,rt),Cr(()=>xt.enter(ut),vt);else{const{leave:_t,delayLeave:$t,afterLeave:Vt}=xt,Zt=()=>r(ut,X,rt),pe=()=>{_t(ut,()=>{Zt(),Vt&&Vt()})};$t?$t(ut,Zt,pe):pe()}else r(ut,X,rt)},ct=(U,X,rt,lt=!1,vt=!1)=>{const{type:ut,props:Pt,ref:xt,children:At,dynamicChildren:wt,shapeFlag:Bt,patchFlag:_t,dirs:$t,cacheIndex:Vt}=U;if(_t===-2&&(vt=!1),xt!=null&&nh(xt,null,rt,U,!0),Vt!=null&&(X.renderCache[Vt]=void 0),Bt&256){X.ctx.deactivate(U);return}const Zt=Bt&1&&$t,pe=!Ol(U);let ue;if(pe&&(ue=Pt&&Pt.onVnodeBeforeUnmount)&&wi(ue,X,U),Bt&6)V(U.component,rt,lt);else{if(Bt&128){U.suspense.unmount(rt,lt);return}Zt&&os(U,null,X,"beforeUnmount"),Bt&64?U.type.remove(U,X,rt,Kt,lt):wt&&!wt.hasOnce&&(ut!==Xi||_t>0&&_t&64)?nt(wt,X,rt,!1,!0):(ut===Xi&&_t&384||!vt&&Bt&16)&&nt(At,X,rt),lt&&Gt(U)}(pe&&(ue=Pt&&Pt.onVnodeUnmounted)||Zt)&&Cr(()=>{ue&&wi(ue,X,U),Zt&&os(U,null,X,"unmounted")},rt)},Gt=U=>{const{type:X,el:rt,anchor:lt,transition:vt}=U;if(X===Xi){J(rt,lt);return}if(X===Bd){E(U);return}const ut=()=>{i(rt),vt&&!vt.persisted&&vt.afterLeave&&vt.afterLeave()};if(U.shapeFlag&1&&vt&&!vt.persisted){const{leave:Pt,delayLeave:xt}=vt,At=()=>Pt(rt,ut);xt?xt(U.el,ut,At):At()}else ut()},J=(U,X)=>{let rt;for(;U!==X;)rt=f(U),i(U),U=rt;i(X)},V=(U,X,rt)=>{const{bum:lt,scope:vt,job:ut,subTree:Pt,um:xt,m:At,a:wt}=U;Vx(At),Vx(wt),lt&&Pd(lt),vt.stop(),ut&&(ut.flags|=8,ct(Pt,U,X,rt)),xt&&Cr(xt,X),Cr(()=>{U.isUnmounted=!0},X),X&&X.pendingBranch&&!X.isUnmounted&&U.asyncDep&&!U.asyncResolved&&U.suspenseId===X.pendingId&&(X.deps--,X.deps===0&&X.resolve())},nt=(U,X,rt,lt=!1,vt=!1,ut=0)=>{for(let Pt=ut;Pt<U.length;Pt++)ct(U[Pt],X,rt,lt,vt)},dt=U=>{if(U.shapeFlag&6)return dt(U.component.subTree);if(U.shapeFlag&128)return U.suspense.next();const X=f(U.anchor||U.el),rt=X&&X[RD];return rt?f(rt):X};let Nt=!1;const Wt=(U,X,rt)=>{U==null?X._vnode&&ct(X._vnode,null,null,!0):v(X._vnode||null,U,X,null,null,null,rt),X._vnode=U,Nt||(Nt=!0,zx(),qC(),Nt=!1)},Kt={p:v,um:ct,m:ft,r:Gt,mt:G,mc:T,pc:z,pbc:P,n:dt,o:n};return{render:Wt,hydrate:void 0,createApp:t6(Wt)}}function Dd({type:n,props:t},e){return e==="svg"&&n==="foreignObject"||e==="mathml"&&n==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:e}function ls({effect:n,job:t},e){e?(n.flags|=32,t.flags|=4):(n.flags&=-33,t.flags&=-5)}function u6(n,t){return(!n||n&&!n.pendingBranch)&&t&&!t.persisted}function oP(n,t,e=!1){const r=n.children,i=t.children;if(he(r)&&he(i))for(let a=0;a<r.length;a++){const s=r[a];let o=i[a];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=i[a]=Sa(i[a]),o.el=s.el),!e&&o.patchFlag!==-2&&oP(s,o)),o.type===Xh&&(o.el=s.el)}}function h6(n){const t=n.slice(),e=[0];let r,i,a,s,o;const l=n.length;for(r=0;r<l;r++){const c=n[r];if(c!==0){if(i=e[e.length-1],n[i]<c){t[r]=i,e.push(r);continue}for(a=0,s=e.length-1;a<s;)o=a+s>>1,n[e[o]]<c?a=o+1:s=o;c<n[e[a]]&&(a>0&&(t[r]=e[a-1]),e[a]=r)}}for(a=e.length,s=e[a-1];a-- >0;)e[a]=s,s=t[s];return e}function lP(n){const t=n.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:lP(t)}function Vx(n){if(n)for(let t=0;t<n.length;t++)n[t].flags|=8}const f6=Symbol.for("v-scx"),d6=()=>zu(f6);function Fd(n,t,e){return cP(n,t,e)}function cP(n,t,e=Be){const{immediate:r,deep:i,flush:a,once:s}=e,o=hr({},e),l=t&&r||!t&&a!=="post";let c;if($l){if(a==="sync"){const d=d6();c=d.__watcherHandles||(d.__watcherHandles=[])}else if(!l){const d=()=>{};return d.stop=Ri,d.resume=Ri,d.pause=Ri,d}}const u=ar;o.call=(d,g,v)=>Fi(d,u,g,v);let h=!1;a==="post"?o.scheduler=d=>{Cr(d,u&&u.suspense)}:a!=="sync"&&(h=!0,o.scheduler=(d,g)=>{g?d():sw(d)}),o.augmentJob=d=>{t&&(d.flags|=4),h&&(d.flags|=2,u&&(d.id=u.uid,d.i=u))};const f=TD(n,t,o);return $l&&(c?c.push(f):l&&f()),f}function g6(n,t,e){const r=this.proxy,i=Nn(n)?n.includes(".")?uP(r,n):()=>r[n]:n.bind(r,r);let a;de(t)?a=t:(a=t.handler,e=t);const s=oc(this),o=cP(i,a.bind(r),e);return s(),o}function uP(n,t){const e=t.split(".");return()=>{let r=n;for(let i=0;i<e.length&&r;i++)r=r[e[i]];return r}}const p6=(n,t)=>t==="modelValue"||t==="model-value"?n.modelModifiers:n[`${t}Modifiers`]||n[`${$a(t)}Modifiers`]||n[`${js(t)}Modifiers`];function v6(n,t,...e){if(n.isUnmounted)return;const r=n.vnode.props||Be;let i=e;const a=t.startsWith("update:"),s=a&&p6(r,t.slice(7));s&&(s.trim&&(i=e.map(u=>Nn(u)?u.trim():u)),s.number&&(i=e.map(UI)));let o,l=r[o=Cd(t)]||r[o=Cd($a(t))];!l&&a&&(l=r[o=Cd(js(t))]),l&&Fi(l,n,6,i);const c=r[o+"Once"];if(c){if(!n.emitted)n.emitted={};else if(n.emitted[o])return;n.emitted[o]=!0,Fi(c,n,6,i)}}function hP(n,t,e=!1){const r=t.emitsCache,i=r.get(n);if(i!==void 0)return i;const a=n.emits;let s={},o=!1;if(!de(n)){const l=c=>{const u=hP(c,t,!0);u&&(o=!0,hr(s,u))};!e&&t.mixins.length&&t.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!a&&!o?(mn(n)&&r.set(n,null),null):(he(a)?a.forEach(l=>s[l]=null):hr(s,a),mn(n)&&r.set(n,s),s)}function Yh(n,t){return!n||!$h(t)?!1:(t=t.slice(2).replace(/Once$/,""),be(n,t[0].toLowerCase()+t.slice(1))||be(n,js(t))||be(n,t))}function Hx(n){const{type:t,vnode:e,proxy:r,withProxy:i,propsOptions:[a],slots:s,attrs:o,emit:l,render:c,renderCache:u,props:h,data:f,setupState:d,ctx:g,inheritAttrs:v}=n,p=eh(n);let y,m;try{if(e.shapeFlag&4){const E=i||r,S=E;y=Oi(c.call(S,E,u,h,d,f,g)),m=o}else{const E=t;y=Oi(E.length>1?E(h,{attrs:o,slots:s,emit:l}):E(h,null)),m=t.props?o:y6(o)}}catch(E){kl.length=0,Hh(E,n,1),y=Ms(jl)}let w=y;if(m&&v!==!1){const E=Object.keys(m),{shapeFlag:S}=w;E.length&&S&7&&(a&&E.some(Ub)&&(m=m6(m,a)),w=Mo(w,m,!1,!0))}return e.dirs&&(w=Mo(w,null,!1,!0),w.dirs=w.dirs?w.dirs.concat(e.dirs):e.dirs),e.transition&&ow(w,e.transition),y=w,eh(p),y}const y6=n=>{let t;for(const e in n)(e==="class"||e==="style"||$h(e))&&((t||(t={}))[e]=n[e]);return t},m6=(n,t)=>{const e={};for(const r in n)(!Ub(r)||!(r.slice(9)in t))&&(e[r]=n[r]);return e};function b6(n,t,e){const{props:r,children:i,component:a}=n,{props:s,children:o,patchFlag:l}=t,c=a.emitsOptions;if(t.dirs||t.transition)return!0;if(e&&l>=0){if(l&1024)return!0;if(l&16)return r?Ux(r,s,c):!!s;if(l&8){const u=t.dynamicProps;for(let h=0;h<u.length;h++){const f=u[h];if(s[f]!==r[f]&&!Yh(c,f))return!0}}}else return(i||o)&&(!o||!o.$stable)?!0:r===s?!1:r?s?Ux(r,s,c):!0:!!s;return!1}function Ux(n,t,e){const r=Object.keys(t);if(r.length!==Object.keys(n).length)return!0;for(let i=0;i<r.length;i++){const a=r[i];if(t[a]!==n[a]&&!Yh(e,a))return!0}return!1}function w6({vnode:n,parent:t},e){for(;t;){const r=t.subTree;if(r.suspense&&r.suspense.activeBranch===n&&(r.el=n.el),r===n)(n=t.vnode).el=e,t=t.parent;else break}}const fP=n=>n.__isSuspense;function x6(n,t){t&&t.pendingBranch?he(n)?t.effects.push(...n):t.effects.push(n):PD(n)}const Xi=Symbol.for("v-fgt"),Xh=Symbol.for("v-txt"),jl=Symbol.for("v-cmt"),Bd=Symbol.for("v-stc"),kl=[];let Dr=null;function E6(n=!1){kl.push(Dr=n?null:[])}function S6(){kl.pop(),Dr=kl[kl.length-1]||null}let ql=1;function Yx(n,t=!1){ql+=n,n<0&&Dr&&t&&(Dr.hasOnce=!0)}function _6(n){return n.dynamicChildren=ql>0?Dr||vo:null,S6(),ql>0&&Dr&&Dr.push(n),n}function M6(n,t,e,r,i,a){return _6(pP(n,t,e,r,i,a,!0))}function dP(n){return n?n.__v_isVNode===!0:!1}function Ko(n,t){return n.type===t.type&&n.key===t.key}const gP=({key:n})=>n??null,ju=({ref:n,ref_key:t,ref_for:e})=>(typeof n=="number"&&(n=""+n),n!=null?Nn(n)||ur(n)||de(n)?{i:ki,r:n,k:t,f:!!e}:n:null);function pP(n,t=null,e=null,r=0,i=null,a=n===Xi?0:1,s=!1,o=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:t,key:t&&gP(t),ref:t&&ju(t),scopeId:GC,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:ki};return o?(cw(l,e),a&128&&n.normalize(l)):e&&(l.shapeFlag|=Nn(e)?8:16),ql>0&&!s&&Dr&&(l.patchFlag>0||a&6)&&l.patchFlag!==32&&Dr.push(l),l}const Ms=O6;function O6(n,t=null,e=null,r=0,i=null,a=!1){if((!n||n===HD)&&(n=jl),dP(n)){const o=Mo(n,t,!0);return e&&cw(o,e),ql>0&&!a&&Dr&&(o.shapeFlag&6?Dr[Dr.indexOf(n)]=o:Dr.push(o)),o.patchFlag=-2,o}if(F6(n)&&(n=n.__vccOpts),t){t=T6(t);let{class:o,style:l}=t;o&&!Nn(o)&&(t.class=Zb(o)),mn(l)&&(aw(l)&&!he(l)&&(l=hr({},l)),t.style=Kb(l))}const s=Nn(n)?1:fP(n)?128:LD(n)?64:mn(n)?4:de(n)?2:0;return pP(n,t,e,r,i,s,a,!0)}function T6(n){return n?aw(n)||tP(n)?hr({},n):n:null}function Mo(n,t,e=!1,r=!1){const{props:i,ref:a,patchFlag:s,children:o,transition:l}=n,c=t?A6(i||{},t):i,u={__v_isVNode:!0,__v_skip:!0,type:n.type,props:c,key:c&&gP(c),ref:t&&t.ref?e&&a?he(a)?a.concat(ju(t)):[a,ju(t)]:ju(t):a,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:o,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:t&&n.type!==Xi?s===-1?16:s|16:s,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:l,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&Mo(n.ssContent),ssFallback:n.ssFallback&&Mo(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return l&&r&&ow(u,l.clone(u)),u}function k6(n=" ",t=0){return Ms(Xh,null,n,t)}function Oi(n){return n==null||typeof n=="boolean"?Ms(jl):he(n)?Ms(Xi,null,n.slice()):dP(n)?Sa(n):Ms(Xh,null,String(n))}function Sa(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:Mo(n)}function cw(n,t){let e=0;const{shapeFlag:r}=n;if(t==null)t=null;else if(he(t))e=16;else if(typeof t=="object")if(r&65){const i=t.default;i&&(i._c&&(i._d=!1),cw(n,i()),i._c&&(i._d=!0));return}else{e=32;const i=t._;!i&&!tP(t)?t._ctx=ki:i===3&&ki&&(ki.slots._===1?t._=1:(t._=2,n.patchFlag|=1024))}else de(t)?(t={default:t,_ctx:ki},e=32):(t=String(t),r&64?(e=16,t=[k6(t)]):e=8);n.children=t,n.shapeFlag|=e}function A6(...n){const t={};for(let e=0;e<n.length;e++){const r=n[e];for(const i in r)if(i==="class")t.class!==r.class&&(t.class=Zb([t.class,r.class]));else if(i==="style")t.style=Kb([t.style,r.style]);else if($h(i)){const a=t[i],s=r[i];s&&a!==s&&!(he(a)&&a.includes(s))&&(t[i]=a?[].concat(a,s):s)}else i!==""&&(t[i]=r[i])}return t}function wi(n,t,e,r=null){Fi(n,t,7,[e,r])}const C6=ZC();let P6=0;function N6(n,t,e){const r=n.type,i=(t?t.appContext:n.appContext)||C6,a={uid:P6++,vnode:n,type:r,parent:t,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new tD(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(i.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:nP(r,i),emitsOptions:hP(r,i),emit:null,emitted:null,propsDefaults:Be,inheritAttrs:r.inheritAttrs,ctx:Be,data:Be,props:Be,attrs:Be,slots:Be,refs:Be,setupState:Be,setupContext:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=t?t.root:a,a.emit=v6.bind(null,a),n.ce&&n.ce(a),a}let ar=null,ih,R1;{const n=Vh(),t=(e,r)=>{let i;return(i=n[e])||(i=n[e]=[]),i.push(r),a=>{i.length>1?i.forEach(s=>s(a)):i[0](a)}};ih=t("__VUE_INSTANCE_SETTERS__",e=>ar=e),R1=t("__VUE_SSR_SETTERS__",e=>$l=e)}const oc=n=>{const t=ar;return ih(n),n.scope.on(),()=>{n.scope.off(),ih(t)}},Xx=()=>{ar&&ar.scope.off(),ih(null)};function vP(n){return n.vnode.shapeFlag&4}let $l=!1;function R6(n,t=!1,e=!1){t&&R1(t);const{props:r,children:i}=n.vnode,a=vP(n);n6(n,r,a,t),s6(n,i,e);const s=a?L6(n,t):void 0;return t&&R1(!1),s}function L6(n,t){const e=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,UD);const{setup:r}=e;if(r){Ka();const i=n.setupContext=r.length>1?D6(n):null,a=oc(n),s=sc(r,n,0,[n.props,i]),o=mC(s);if(Za(),a(),(o||n.sp)&&!Ol(n)&&WC(n),o){if(s.then(Xx,Xx),t)return s.then(l=>{Kx(n,l)}).catch(l=>{Hh(l,n,0)});n.asyncDep=s}else Kx(n,s)}else yP(n)}function Kx(n,t,e){de(t)?n.type.__ssrInlineRender?n.ssrRender=t:n.render=t:mn(t)&&(n.setupState=BC(t)),yP(n)}function yP(n,t,e){const r=n.type;n.render||(n.render=r.render||Ri);{const i=oc(n);Ka();try{YD(n)}finally{Za(),i()}}}const I6={get(n,t){return Xn(n,"get",""),n[t]}};function D6(n){const t=e=>{n.exposed=e||{}};return{attrs:new Proxy(n.attrs,I6),slots:n.slots,emit:n.emit,expose:t}}function uw(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(BC(xD(n.exposed)),{get(t,e){if(e in t)return t[e];if(e in Tl)return Tl[e](n)},has(t,e){return e in t||e in Tl}})):n.proxy}function F6(n){return de(n)&&"__vccOpts"in n}const B6=(n,t)=>MD(n,t,$l),z6="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let L1;const Zx=typeof window<"u"&&window.trustedTypes;if(Zx)try{L1=Zx.createPolicy("vue",{createHTML:n=>n})}catch{}const mP=L1?n=>L1.createHTML(n):n=>n,j6="http://www.w3.org/2000/svg",q6="http://www.w3.org/1998/Math/MathML",Yi=typeof document<"u"?document:null,Jx=Yi&&Yi.createElement("template"),$6={insert:(n,t,e)=>{t.insertBefore(n,e||null)},remove:n=>{const t=n.parentNode;t&&t.removeChild(n)},createElement:(n,t,e,r)=>{const i=t==="svg"?Yi.createElementNS(j6,n):t==="mathml"?Yi.createElementNS(q6,n):e?Yi.createElement(n,{is:e}):Yi.createElement(n);return n==="select"&&r&&r.multiple!=null&&i.setAttribute("multiple",r.multiple),i},createText:n=>Yi.createTextNode(n),createComment:n=>Yi.createComment(n),setText:(n,t)=>{n.nodeValue=t},setElementText:(n,t)=>{n.textContent=t},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>Yi.querySelector(n),setScopeId(n,t){n.setAttribute(t,"")},insertStaticContent(n,t,e,r,i,a){const s=e?e.previousSibling:t.lastChild;if(i&&(i===a||i.nextSibling))for(;t.insertBefore(i.cloneNode(!0),e),!(i===a||!(i=i.nextSibling)););else{Jx.innerHTML=mP(r==="svg"?`<svg>${n}</svg>`:r==="mathml"?`<math>${n}</math>`:n);const o=Jx.content;if(r==="svg"||r==="mathml"){const l=o.firstChild;for(;l.firstChild;)o.appendChild(l.firstChild);o.removeChild(l)}t.insertBefore(o,e)}return[s?s.nextSibling:t.firstChild,e?e.previousSibling:t.lastChild]}},G6=Symbol("_vtc");function W6(n,t,e){const r=n[G6];r&&(t=(t?[t,...r]:[...r]).join(" ")),t==null?n.removeAttribute("class"):e?n.setAttribute("class",t):n.className=t}const Qx=Symbol("_vod"),V6=Symbol("_vsh"),H6=Symbol(""),U6=/(^|;)\s*display\s*:/;function Y6(n,t,e){const r=n.style,i=Nn(e);let a=!1;if(e&&!i){if(t)if(Nn(t))for(const s of t.split(";")){const o=s.slice(0,s.indexOf(":")).trim();e[o]==null&&qu(r,o,"")}else for(const s in t)e[s]==null&&qu(r,s,"");for(const s in e)s==="display"&&(a=!0),qu(r,s,e[s])}else if(i){if(t!==e){const s=r[H6];s&&(e+=";"+s),r.cssText=e,a=U6.test(e)}}else t&&n.removeAttribute("style");Qx in n&&(n[Qx]=a?r.display:"",n[V6]&&(r.display="none"))}const tE=/\s*!important$/;function qu(n,t,e){if(he(e))e.forEach(r=>qu(n,t,r));else if(e==null&&(e=""),t.startsWith("--"))n.setProperty(t,e);else{const r=X6(n,t);tE.test(e)?n.setProperty(js(r),e.replace(tE,""),"important"):n[r]=e}}const eE=["Webkit","Moz","ms"],zd={};function X6(n,t){const e=zd[t];if(e)return e;let r=$a(t);if(r!=="filter"&&r in n)return zd[t]=r;r=bC(r);for(let i=0;i<eE.length;i++){const a=eE[i]+r;if(a in n)return zd[t]=a}return t}const nE="http://www.w3.org/1999/xlink";function rE(n,t,e,r,i,a=QI(t)){r&&t.startsWith("xlink:")?e==null?n.removeAttributeNS(nE,t.slice(6,t.length)):n.setAttributeNS(nE,t,e):e==null||a&&!xC(e)?n.removeAttribute(t):n.setAttribute(t,a?"":Do(e)?String(e):e)}function iE(n,t,e,r,i){if(t==="innerHTML"||t==="textContent"){e!=null&&(n[t]=t==="innerHTML"?mP(e):e);return}const a=n.tagName;if(t==="value"&&a!=="PROGRESS"&&!a.includes("-")){const o=a==="OPTION"?n.getAttribute("value")||"":n.value,l=e==null?n.type==="checkbox"?"on":"":String(e);(o!==l||!("_value"in n))&&(n.value=l),e==null&&n.removeAttribute(t),n._value=e;return}let s=!1;if(e===""||e==null){const o=typeof n[t];o==="boolean"?e=xC(e):e==null&&o==="string"?(e="",s=!0):o==="number"&&(e=0,s=!0)}try{n[t]=e}catch{}s&&n.removeAttribute(i||t)}function K6(n,t,e,r){n.addEventListener(t,e,r)}function Z6(n,t,e,r){n.removeEventListener(t,e,r)}const aE=Symbol("_vei");function J6(n,t,e,r,i=null){const a=n[aE]||(n[aE]={}),s=a[t];if(r&&s)s.value=r;else{const[o,l]=Q6(t);if(r){const c=a[t]=nF(r,i);K6(n,o,c,l)}else s&&(Z6(n,o,s,l),a[t]=void 0)}}const sE=/(?:Once|Passive|Capture)$/;function Q6(n){let t;if(sE.test(n)){t={};let r;for(;r=n.match(sE);)n=n.slice(0,n.length-r[0].length),t[r[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):js(n.slice(2)),t]}let jd=0;const tF=Promise.resolve(),eF=()=>jd||(tF.then(()=>jd=0),jd=Date.now());function nF(n,t){const e=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=e.attached)return;Fi(rF(r,e.value),t,5,[r])};return e.value=n,e.attached=eF(),e}function rF(n,t){if(he(t)){const e=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{e.call(n),n._stopped=!0},t.map(r=>i=>!i._stopped&&r&&r(i))}else return t}const oE=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,iF=(n,t,e,r,i,a)=>{const s=i==="svg";t==="class"?W6(n,r,s):t==="style"?Y6(n,e,r):$h(t)?Ub(t)||J6(n,t,e,r,a):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):aF(n,t,r,s))?(iE(n,t,r),!n.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&rE(n,t,r,s,a,t!=="value")):n._isVueCE&&(/[A-Z]/.test(t)||!Nn(r))?iE(n,$a(t),r,a,t):(t==="true-value"?n._trueValue=r:t==="false-value"&&(n._falseValue=r),rE(n,t,r,s))};function aF(n,t,e,r){if(r)return!!(t==="innerHTML"||t==="textContent"||t in n&&oE(t)&&de(e));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&n.tagName==="INPUT"||t==="type"&&n.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const i=n.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return oE(t)&&Nn(e)?!1:t in n}const sF=hr({patchProp:iF},$6);let lE;function oF(){return lE||(lE=l6(sF))}const lF=(...n)=>{const t=oF().createApp(...n),{mount:e}=t;return t.mount=r=>{const i=uF(r);if(!i)return;const a=t._component;!de(a)&&!a.render&&!a.template&&(a.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const s=e(i,!1,cF(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),s},t};function cF(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function uF(n){return Nn(n)?document.querySelector(n):n}function Ga(n){"@babel/helpers - typeof";return Ga=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ga(n)}function hF(n,t){if(Ga(n)!="object"||!n)return n;var e=n[Symbol.toPrimitive];if(e!==void 0){var r=e.call(n,t);if(Ga(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(n)}function bP(n){var t=hF(n,"string");return Ga(t)=="symbol"?t:t+""}function It(n,t,e){return(t=bP(t))in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function cE(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),e.push.apply(e,r)}return e}function ie(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?cE(Object(e),!0).forEach(function(r){It(n,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):cE(Object(e)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(e,r))})}return n}function yt(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function uE(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,bP(r.key),r)}}function mt(n,t,e){return t&&uE(n.prototype,t),e&&uE(n,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function I1(n,t){(t==null||t>n.length)&&(t=n.length);for(var e=0,r=Array(t);e<t;e++)r[e]=n[e];return r}function fF(n){if(Array.isArray(n))return I1(n)}function dF(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function hw(n,t){if(n){if(typeof n=="string")return I1(n,t);var e={}.toString.call(n).slice(8,-1);return e==="Object"&&n.constructor&&(e=n.constructor.name),e==="Map"||e==="Set"?Array.from(n):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?I1(n,t):void 0}}function gF(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ie(n){return fF(n)||dF(n)||hw(n)||gF()}function Oo(n){return Oo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Oo(n)}function wP(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wP=function(){return!!n})()}function pF(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function vF(n,t){if(t&&(Ga(t)=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pF(n)}function ae(n,t,e){return t=Oo(t),vF(n,wP()?Reflect.construct(t,e||[],Oo(n).constructor):t.apply(n,e))}function D1(n,t){return D1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,r){return e.__proto__=r,e},D1(n,t)}function se(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),t&&D1(n,t)}function yF(n){if(Array.isArray(n))return n}function mF(n,t){var e=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(e!=null){var r,i,a,s,o=[],l=!0,c=!1;try{if(a=(e=e.call(n)).next,t===0){if(Object(e)!==e)return;l=!1}else for(;!(l=(r=a.call(e)).done)&&(o.push(r.value),o.length!==t);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&e.return!=null&&(s=e.return(),Object(s)!==s))return}finally{if(c)throw i}}return o}}function bF(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ne(n,t){return yF(n)||mF(n,t)||hw(n,t)||bF()}var jc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function lc(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function xP(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var t=n.default;if(typeof t=="function"){var e=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(e,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),e}var qd={exports:{}},hE;function wF(){return hE||(hE=1,function(n){var t=Object.prototype.hasOwnProperty,e="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(e=!1));function i(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function a(l,c,u,h,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var d=new i(u,h||l,f),g=e?e+c:c;return l._events[g]?l._events[g].fn?l._events[g]=[l._events[g],d]:l._events[g].push(d):(l._events[g]=d,l._eventsCount++),l}function s(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],u,h;if(this._eventsCount===0)return c;for(h in u=this._events)t.call(u,h)&&c.push(e?h.slice(1):h);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},o.prototype.listeners=function(c){var u=e?e+c:c,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var f=0,d=h.length,g=new Array(d);f<d;f++)g[f]=h[f].fn;return g},o.prototype.listenerCount=function(c){var u=e?e+c:c,h=this._events[u];return h?h.fn?1:h.length:0},o.prototype.emit=function(c,u,h,f,d,g){var v=e?e+c:c;if(!this._events[v])return!1;var p=this._events[v],y=arguments.length,m,w;if(p.fn){switch(p.once&&this.removeListener(c,p.fn,void 0,!0),y){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,u),!0;case 3:return p.fn.call(p.context,u,h),!0;case 4:return p.fn.call(p.context,u,h,f),!0;case 5:return p.fn.call(p.context,u,h,f,d),!0;case 6:return p.fn.call(p.context,u,h,f,d,g),!0}for(w=1,m=new Array(y-1);w<y;w++)m[w-1]=arguments[w];p.fn.apply(p.context,m)}else{var E=p.length,S;for(w=0;w<E;w++)switch(p[w].once&&this.removeListener(c,p[w].fn,void 0,!0),y){case 1:p[w].fn.call(p[w].context);break;case 2:p[w].fn.call(p[w].context,u);break;case 3:p[w].fn.call(p[w].context,u,h);break;case 4:p[w].fn.call(p[w].context,u,h,f);break;default:if(!m)for(S=1,m=new Array(y-1);S<y;S++)m[S-1]=arguments[S];p[w].fn.apply(p[w].context,m)}}return!0},o.prototype.on=function(c,u,h){return a(this,c,u,h,!1)},o.prototype.once=function(c,u,h){return a(this,c,u,h,!0)},o.prototype.removeListener=function(c,u,h,f){var d=e?e+c:c;if(!this._events[d])return this;if(!u)return s(this,d),this;var g=this._events[d];if(g.fn)g.fn===u&&(!f||g.once)&&(!h||g.context===h)&&s(this,d);else{for(var v=0,p=[],y=g.length;v<y;v++)(g[v].fn!==u||f&&!g[v].once||h&&g[v].context!==h)&&p.push(g[v]);p.length?this._events[d]=p.length===1?p[0]:p:s(this,d)}return this},o.prototype.removeAllListeners=function(c){var u;return c?(u=e?e+c:c,this._events[u]&&s(this,u)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=e,o.EventEmitter=o,n.exports=o}(qd)),qd.exports}var xF=wF();const EP=lc(xF);var Ve=1e-6,bn=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var n=0,t=arguments.length;t--;)n+=arguments[t]*arguments[t];return Math.sqrt(n)});function SP(){var n=new bn(9);return bn!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function EF(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[4],n[4]=t[5],n[5]=t[6],n[6]=t[8],n[7]=t[9],n[8]=t[10],n}function SF(n,t,e,r,i,a,s,o,l){var c=new bn(9);return c[0]=n,c[1]=t,c[2]=e,c[3]=r,c[4]=i,c[5]=a,c[6]=s,c[7]=o,c[8]=l,c}function Ne(){var n=new bn(16);return bn!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n}function _P(n){var t=new bn(16);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}function To(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n}function MP(n,t,e,r,i,a,s,o,l,c,u,h,f,d,g,v){var p=new bn(16);return p[0]=n,p[1]=t,p[2]=e,p[3]=r,p[4]=i,p[5]=a,p[6]=s,p[7]=o,p[8]=l,p[9]=c,p[10]=u,p[11]=h,p[12]=f,p[13]=d,p[14]=g,p[15]=v,p}function F1(n,t,e,r,i,a,s,o,l,c,u,h,f,d,g,v,p){return n[0]=t,n[1]=e,n[2]=r,n[3]=i,n[4]=a,n[5]=s,n[6]=o,n[7]=l,n[8]=c,n[9]=u,n[10]=h,n[11]=f,n[12]=d,n[13]=g,n[14]=v,n[15]=p,n}function Wa(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function OP(n,t){if(n===t){var e=t[1],r=t[2],i=t[3],a=t[6],s=t[7],o=t[11];n[1]=t[4],n[2]=t[8],n[3]=t[12],n[4]=e,n[6]=t[9],n[7]=t[13],n[8]=r,n[9]=a,n[11]=t[14],n[12]=i,n[13]=s,n[14]=o}else n[0]=t[0],n[1]=t[4],n[2]=t[8],n[3]=t[12],n[4]=t[1],n[5]=t[5],n[6]=t[9],n[7]=t[13],n[8]=t[2],n[9]=t[6],n[10]=t[10],n[11]=t[14],n[12]=t[3],n[13]=t[7],n[14]=t[11],n[15]=t[15];return n}function Ai(n,t){var e=t[0],r=t[1],i=t[2],a=t[3],s=t[4],o=t[5],l=t[6],c=t[7],u=t[8],h=t[9],f=t[10],d=t[11],g=t[12],v=t[13],p=t[14],y=t[15],m=e*o-r*s,w=e*l-i*s,E=e*c-a*s,S=r*l-i*o,O=r*c-a*o,k=i*c-a*l,T=u*v-h*g,C=u*p-f*g,P=u*y-d*g,N=h*p-f*v,L=h*y-d*v,D=f*y-d*p,G=m*D-w*L+E*N+S*P-O*C+k*T;return G?(G=1/G,n[0]=(o*D-l*L+c*N)*G,n[1]=(i*L-r*D-a*N)*G,n[2]=(v*k-p*O+y*S)*G,n[3]=(f*O-h*k-d*S)*G,n[4]=(l*P-s*D-c*C)*G,n[5]=(e*D-i*P+a*C)*G,n[6]=(p*E-g*k-y*w)*G,n[7]=(u*k-f*E+d*w)*G,n[8]=(s*L-o*P+c*T)*G,n[9]=(r*P-e*L-a*T)*G,n[10]=(g*O-v*E+y*m)*G,n[11]=(h*E-u*O-d*m)*G,n[12]=(o*C-s*N-l*T)*G,n[13]=(e*N-r*C+i*T)*G,n[14]=(v*w-g*S-p*m)*G,n[15]=(u*S-h*w+f*m)*G,n):null}function _F(n,t){var e=t[0],r=t[1],i=t[2],a=t[3],s=t[4],o=t[5],l=t[6],c=t[7],u=t[8],h=t[9],f=t[10],d=t[11],g=t[12],v=t[13],p=t[14],y=t[15];return n[0]=o*(f*y-d*p)-h*(l*y-c*p)+v*(l*d-c*f),n[1]=-(r*(f*y-d*p)-h*(i*y-a*p)+v*(i*d-a*f)),n[2]=r*(l*y-c*p)-o*(i*y-a*p)+v*(i*c-a*l),n[3]=-(r*(l*d-c*f)-o*(i*d-a*f)+h*(i*c-a*l)),n[4]=-(s*(f*y-d*p)-u*(l*y-c*p)+g*(l*d-c*f)),n[5]=e*(f*y-d*p)-u*(i*y-a*p)+g*(i*d-a*f),n[6]=-(e*(l*y-c*p)-s*(i*y-a*p)+g*(i*c-a*l)),n[7]=e*(l*d-c*f)-s*(i*d-a*f)+u*(i*c-a*l),n[8]=s*(h*y-d*v)-u*(o*y-c*v)+g*(o*d-c*h),n[9]=-(e*(h*y-d*v)-u*(r*y-a*v)+g*(r*d-a*h)),n[10]=e*(o*y-c*v)-s*(r*y-a*v)+g*(r*c-a*o),n[11]=-(e*(o*d-c*h)-s*(r*d-a*h)+u*(r*c-a*o)),n[12]=-(s*(h*p-f*v)-u*(o*p-l*v)+g*(o*f-l*h)),n[13]=e*(h*p-f*v)-u*(r*p-i*v)+g*(r*f-i*h),n[14]=-(e*(o*p-l*v)-s*(r*p-i*v)+g*(r*l-i*o)),n[15]=e*(o*f-l*h)-s*(r*f-i*h)+u*(r*l-i*o),n}function TP(n){var t=n[0],e=n[1],r=n[2],i=n[3],a=n[4],s=n[5],o=n[6],l=n[7],c=n[8],u=n[9],h=n[10],f=n[11],d=n[12],g=n[13],v=n[14],p=n[15],y=t*s-e*a,m=t*o-r*a,w=t*l-i*a,E=e*o-r*s,S=e*l-i*s,O=r*l-i*o,k=c*g-u*d,T=c*v-h*d,C=c*p-f*d,P=u*v-h*g,N=u*p-f*g,L=h*p-f*v;return y*L-m*N+w*P+E*C-S*T+O*k}function Zn(n,t,e){var r=t[0],i=t[1],a=t[2],s=t[3],o=t[4],l=t[5],c=t[6],u=t[7],h=t[8],f=t[9],d=t[10],g=t[11],v=t[12],p=t[13],y=t[14],m=t[15],w=e[0],E=e[1],S=e[2],O=e[3];return n[0]=w*r+E*o+S*h+O*v,n[1]=w*i+E*l+S*f+O*p,n[2]=w*a+E*c+S*d+O*y,n[3]=w*s+E*u+S*g+O*m,w=e[4],E=e[5],S=e[6],O=e[7],n[4]=w*r+E*o+S*h+O*v,n[5]=w*i+E*l+S*f+O*p,n[6]=w*a+E*c+S*d+O*y,n[7]=w*s+E*u+S*g+O*m,w=e[8],E=e[9],S=e[10],O=e[11],n[8]=w*r+E*o+S*h+O*v,n[9]=w*i+E*l+S*f+O*p,n[10]=w*a+E*c+S*d+O*y,n[11]=w*s+E*u+S*g+O*m,w=e[12],E=e[13],S=e[14],O=e[15],n[12]=w*r+E*o+S*h+O*v,n[13]=w*i+E*l+S*f+O*p,n[14]=w*a+E*c+S*d+O*y,n[15]=w*s+E*u+S*g+O*m,n}function bo(n,t,e){var r=e[0],i=e[1],a=e[2],s,o,l,c,u,h,f,d,g,v,p,y;return t===n?(n[12]=t[0]*r+t[4]*i+t[8]*a+t[12],n[13]=t[1]*r+t[5]*i+t[9]*a+t[13],n[14]=t[2]*r+t[6]*i+t[10]*a+t[14],n[15]=t[3]*r+t[7]*i+t[11]*a+t[15]):(s=t[0],o=t[1],l=t[2],c=t[3],u=t[4],h=t[5],f=t[6],d=t[7],g=t[8],v=t[9],p=t[10],y=t[11],n[0]=s,n[1]=o,n[2]=l,n[3]=c,n[4]=u,n[5]=h,n[6]=f,n[7]=d,n[8]=g,n[9]=v,n[10]=p,n[11]=y,n[12]=s*r+u*i+g*a+t[12],n[13]=o*r+h*i+v*a+t[13],n[14]=l*r+f*i+p*a+t[14],n[15]=c*r+d*i+y*a+t[15]),n}function kP(n,t,e){var r=e[0],i=e[1],a=e[2];return n[0]=t[0]*r,n[1]=t[1]*r,n[2]=t[2]*r,n[3]=t[3]*r,n[4]=t[4]*i,n[5]=t[5]*i,n[6]=t[6]*i,n[7]=t[7]*i,n[8]=t[8]*a,n[9]=t[9]*a,n[10]=t[10]*a,n[11]=t[11]*a,n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n}function MF(n,t,e,r){var i=r[0],a=r[1],s=r[2],o=Math.hypot(i,a,s),l,c,u,h,f,d,g,v,p,y,m,w,E,S,O,k,T,C,P,N,L,D,G,H;return o<Ve?null:(o=1/o,i*=o,a*=o,s*=o,l=Math.sin(e),c=Math.cos(e),u=1-c,h=t[0],f=t[1],d=t[2],g=t[3],v=t[4],p=t[5],y=t[6],m=t[7],w=t[8],E=t[9],S=t[10],O=t[11],k=i*i*u+c,T=a*i*u+s*l,C=s*i*u-a*l,P=i*a*u-s*l,N=a*a*u+c,L=s*a*u+i*l,D=i*s*u+a*l,G=a*s*u-i*l,H=s*s*u+c,n[0]=h*k+v*T+w*C,n[1]=f*k+p*T+E*C,n[2]=d*k+y*T+S*C,n[3]=g*k+m*T+O*C,n[4]=h*P+v*N+w*L,n[5]=f*P+p*N+E*L,n[6]=d*P+y*N+S*L,n[7]=g*P+m*N+O*L,n[8]=h*D+v*G+w*H,n[9]=f*D+p*G+E*H,n[10]=d*D+y*G+S*H,n[11]=g*D+m*G+O*H,t!==n&&(n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n)}function AP(n,t,e){var r=Math.sin(e),i=Math.cos(e),a=t[4],s=t[5],o=t[6],l=t[7],c=t[8],u=t[9],h=t[10],f=t[11];return t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[4]=a*i+c*r,n[5]=s*i+u*r,n[6]=o*i+h*r,n[7]=l*i+f*r,n[8]=c*i-a*r,n[9]=u*i-s*r,n[10]=h*i-o*r,n[11]=f*i-l*r,n}function CP(n,t,e){var r=Math.sin(e),i=Math.cos(e),a=t[0],s=t[1],o=t[2],l=t[3],c=t[8],u=t[9],h=t[10],f=t[11];return t!==n&&(n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=a*i-c*r,n[1]=s*i-u*r,n[2]=o*i-h*r,n[3]=l*i-f*r,n[8]=a*r+c*i,n[9]=s*r+u*i,n[10]=o*r+h*i,n[11]=l*r+f*i,n}function OF(n,t,e){var r=Math.sin(e),i=Math.cos(e),a=t[0],s=t[1],o=t[2],l=t[3],c=t[4],u=t[5],h=t[6],f=t[7];return t!==n&&(n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=a*i+c*r,n[1]=s*i+u*r,n[2]=o*i+h*r,n[3]=l*i+f*r,n[4]=c*i-a*r,n[5]=u*i-s*r,n[6]=h*i-o*r,n[7]=f*i-l*r,n}function Ta(n,t){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=t[0],n[13]=t[1],n[14]=t[2],n[15]=1,n}function vs(n,t){return n[0]=t[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=t[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=t[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function PP(n,t,e){var r=e[0],i=e[1],a=e[2],s=Math.hypot(r,i,a),o,l,c;return s<Ve?null:(s=1/s,r*=s,i*=s,a*=s,o=Math.sin(t),l=Math.cos(t),c=1-l,n[0]=r*r*c+l,n[1]=i*r*c+a*o,n[2]=a*r*c-i*o,n[3]=0,n[4]=r*i*c-a*o,n[5]=i*i*c+l,n[6]=a*i*c+r*o,n[7]=0,n[8]=r*a*c+i*o,n[9]=i*a*c-r*o,n[10]=a*a*c+l,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n)}function NP(n,t){var e=Math.sin(t),r=Math.cos(t);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=r,n[6]=e,n[7]=0,n[8]=0,n[9]=-e,n[10]=r,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function RP(n,t){var e=Math.sin(t),r=Math.cos(t);return n[0]=r,n[1]=0,n[2]=-e,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=e,n[9]=0,n[10]=r,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function B1(n,t){var e=Math.sin(t),r=Math.cos(t);return n[0]=r,n[1]=e,n[2]=0,n[3]=0,n[4]=-e,n[5]=r,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function LP(n,t,e){var r=t[0],i=t[1],a=t[2],s=t[3],o=r+r,l=i+i,c=a+a,u=r*o,h=r*l,f=r*c,d=i*l,g=i*c,v=a*c,p=s*o,y=s*l,m=s*c;return n[0]=1-(d+v),n[1]=h+m,n[2]=f-y,n[3]=0,n[4]=h-m,n[5]=1-(u+v),n[6]=g+p,n[7]=0,n[8]=f+y,n[9]=g-p,n[10]=1-(u+d),n[11]=0,n[12]=e[0],n[13]=e[1],n[14]=e[2],n[15]=1,n}function TF(n,t){var e=new bn(3),r=-t[0],i=-t[1],a=-t[2],s=t[3],o=t[4],l=t[5],c=t[6],u=t[7],h=r*r+i*i+a*a+s*s;return h>0?(e[0]=(o*s+u*r+l*a-c*i)*2/h,e[1]=(l*s+u*i+c*r-o*a)*2/h,e[2]=(c*s+u*a+o*i-l*r)*2/h):(e[0]=(o*s+u*r+l*a-c*i)*2,e[1]=(l*s+u*i+c*r-o*a)*2,e[2]=(c*s+u*a+o*i-l*r)*2),LP(n,t,e),n}function ah(n,t){return n[0]=t[12],n[1]=t[13],n[2]=t[14],n}function ko(n,t){var e=t[0],r=t[1],i=t[2],a=t[4],s=t[5],o=t[6],l=t[8],c=t[9],u=t[10];return n[0]=Math.hypot(e,r,i),n[1]=Math.hypot(a,s,o),n[2]=Math.hypot(l,c,u),n}function sh(n,t){var e=new bn(3);ko(e,t);var r=1/e[0],i=1/e[1],a=1/e[2],s=t[0]*r,o=t[1]*i,l=t[2]*a,c=t[4]*r,u=t[5]*i,h=t[6]*a,f=t[8]*r,d=t[9]*i,g=t[10]*a,v=s+u+g,p=0;return v>0?(p=Math.sqrt(v+1)*2,n[3]=.25*p,n[0]=(h-d)/p,n[1]=(f-l)/p,n[2]=(o-c)/p):s>u&&s>g?(p=Math.sqrt(1+s-u-g)*2,n[3]=(h-d)/p,n[0]=.25*p,n[1]=(o+c)/p,n[2]=(f+l)/p):u>g?(p=Math.sqrt(1+u-s-g)*2,n[3]=(f-l)/p,n[0]=(o+c)/p,n[1]=.25*p,n[2]=(h+d)/p):(p=Math.sqrt(1+g-s-u)*2,n[3]=(o-c)/p,n[0]=(f+l)/p,n[1]=(h+d)/p,n[2]=.25*p),n}function kF(n,t,e,r){var i=t[0],a=t[1],s=t[2],o=t[3],l=i+i,c=a+a,u=s+s,h=i*l,f=i*c,d=i*u,g=a*c,v=a*u,p=s*u,y=o*l,m=o*c,w=o*u,E=r[0],S=r[1],O=r[2];return n[0]=(1-(g+p))*E,n[1]=(f+w)*E,n[2]=(d-m)*E,n[3]=0,n[4]=(f-w)*S,n[5]=(1-(h+p))*S,n[6]=(v+y)*S,n[7]=0,n[8]=(d+m)*O,n[9]=(v-y)*O,n[10]=(1-(h+g))*O,n[11]=0,n[12]=e[0],n[13]=e[1],n[14]=e[2],n[15]=1,n}function Al(n,t,e,r,i){var a=t[0],s=t[1],o=t[2],l=t[3],c=a+a,u=s+s,h=o+o,f=a*c,d=a*u,g=a*h,v=s*u,p=s*h,y=o*h,m=l*c,w=l*u,E=l*h,S=r[0],O=r[1],k=r[2],T=i[0],C=i[1],P=i[2],N=(1-(v+y))*S,L=(d+E)*S,D=(g-w)*S,G=(d-E)*O,H=(1-(f+y))*O,W=(p+m)*O,q=(g+w)*k,z=(p-m)*k,Z=(1-(f+v))*k;return n[0]=N,n[1]=L,n[2]=D,n[3]=0,n[4]=G,n[5]=H,n[6]=W,n[7]=0,n[8]=q,n[9]=z,n[10]=Z,n[11]=0,n[12]=e[0]+T-(N*T+G*C+q*P),n[13]=e[1]+C-(L*T+H*C+z*P),n[14]=e[2]+P-(D*T+W*C+Z*P),n[15]=1,n}function fw(n,t){var e=t[0],r=t[1],i=t[2],a=t[3],s=e+e,o=r+r,l=i+i,c=e*s,u=r*s,h=r*o,f=i*s,d=i*o,g=i*l,v=a*s,p=a*o,y=a*l;return n[0]=1-h-g,n[1]=u+y,n[2]=f-p,n[3]=0,n[4]=u-y,n[5]=1-c-g,n[6]=d+v,n[7]=0,n[8]=f+p,n[9]=d-v,n[10]=1-c-h,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function AF(n,t,e,r,i,a,s){var o=1/(e-t),l=1/(i-r),c=1/(a-s);return n[0]=a*2*o,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=a*2*l,n[6]=0,n[7]=0,n[8]=(e+t)*o,n[9]=(i+r)*l,n[10]=(s+a)*c,n[11]=-1,n[12]=0,n[13]=0,n[14]=s*a*2*c,n[15]=0,n}function IP(n,t,e,r,i){var a=1/Math.tan(t/2),s;return n[0]=a/e,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=a,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,i!=null&&i!==1/0?(s=1/(r-i),n[10]=(i+r)*s,n[14]=2*i*r*s):(n[10]=-1,n[14]=-2*r),n}var CF=IP;function PF(n,t,e,r,i){var a=1/Math.tan(t/2),s;return n[0]=a/e,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=a,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,i!=null&&i!==1/0?(s=1/(r-i),n[10]=i*s,n[14]=i*r*s):(n[10]=-1,n[14]=-r),n}function NF(n,t,e,r){var i=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),s=Math.tan(t.leftDegrees*Math.PI/180),o=Math.tan(t.rightDegrees*Math.PI/180),l=2/(s+o),c=2/(i+a);return n[0]=l,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=c,n[6]=0,n[7]=0,n[8]=-((s-o)*l*.5),n[9]=(i-a)*c*.5,n[10]=r/(e-r),n[11]=-1,n[12]=0,n[13]=0,n[14]=r*e/(e-r),n[15]=0,n}function DP(n,t,e,r,i,a,s){var o=1/(t-e),l=1/(r-i),c=1/(a-s);return n[0]=-2*o,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*l,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*c,n[11]=0,n[12]=(t+e)*o,n[13]=(i+r)*l,n[14]=(s+a)*c,n[15]=1,n}var FP=DP;function BP(n,t,e,r,i,a,s){var o=1/(t-e),l=1/(r-i),c=1/(a-s);return n[0]=-2*o,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*l,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=c,n[11]=0,n[12]=(t+e)*o,n[13]=(i+r)*l,n[14]=a*c,n[15]=1,n}function zP(n,t,e,r){var i,a,s,o,l,c,u,h,f,d,g=t[0],v=t[1],p=t[2],y=r[0],m=r[1],w=r[2],E=e[0],S=e[1],O=e[2];return Math.abs(g-E)<Ve&&Math.abs(v-S)<Ve&&Math.abs(p-O)<Ve?Wa(n):(u=g-E,h=v-S,f=p-O,d=1/Math.hypot(u,h,f),u*=d,h*=d,f*=d,i=m*f-w*h,a=w*u-y*f,s=y*h-m*u,d=Math.hypot(i,a,s),d?(d=1/d,i*=d,a*=d,s*=d):(i=0,a=0,s=0),o=h*s-f*a,l=f*i-u*s,c=u*a-h*i,d=Math.hypot(o,l,c),d?(d=1/d,o*=d,l*=d,c*=d):(o=0,l=0,c=0),n[0]=i,n[1]=o,n[2]=u,n[3]=0,n[4]=a,n[5]=l,n[6]=h,n[7]=0,n[8]=s,n[9]=c,n[10]=f,n[11]=0,n[12]=-(i*g+a*v+s*p),n[13]=-(o*g+l*v+c*p),n[14]=-(u*g+h*v+f*p),n[15]=1,n)}function RF(n,t,e,r){var i=t[0],a=t[1],s=t[2],o=r[0],l=r[1],c=r[2],u=i-e[0],h=a-e[1],f=s-e[2],d=u*u+h*h+f*f;d>0&&(d=1/Math.sqrt(d),u*=d,h*=d,f*=d);var g=l*f-c*h,v=c*u-o*f,p=o*h-l*u;return d=g*g+v*v+p*p,d>0&&(d=1/Math.sqrt(d),g*=d,v*=d,p*=d),n[0]=g,n[1]=v,n[2]=p,n[3]=0,n[4]=h*p-f*v,n[5]=f*g-u*p,n[6]=u*v-h*g,n[7]=0,n[8]=u,n[9]=h,n[10]=f,n[11]=0,n[12]=i,n[13]=a,n[14]=s,n[15]=1,n}function LF(n){return"mat4("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+", "+n[6]+", "+n[7]+", "+n[8]+", "+n[9]+", "+n[10]+", "+n[11]+", "+n[12]+", "+n[13]+", "+n[14]+", "+n[15]+")"}function IF(n){return Math.hypot(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15])}function DF(n,t,e){return n[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n[3]=t[3]+e[3],n[4]=t[4]+e[4],n[5]=t[5]+e[5],n[6]=t[6]+e[6],n[7]=t[7]+e[7],n[8]=t[8]+e[8],n[9]=t[9]+e[9],n[10]=t[10]+e[10],n[11]=t[11]+e[11],n[12]=t[12]+e[12],n[13]=t[13]+e[13],n[14]=t[14]+e[14],n[15]=t[15]+e[15],n}function jP(n,t,e){return n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n[3]=t[3]-e[3],n[4]=t[4]-e[4],n[5]=t[5]-e[5],n[6]=t[6]-e[6],n[7]=t[7]-e[7],n[8]=t[8]-e[8],n[9]=t[9]-e[9],n[10]=t[10]-e[10],n[11]=t[11]-e[11],n[12]=t[12]-e[12],n[13]=t[13]-e[13],n[14]=t[14]-e[14],n[15]=t[15]-e[15],n}function FF(n,t,e){return n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e,n[3]=t[3]*e,n[4]=t[4]*e,n[5]=t[5]*e,n[6]=t[6]*e,n[7]=t[7]*e,n[8]=t[8]*e,n[9]=t[9]*e,n[10]=t[10]*e,n[11]=t[11]*e,n[12]=t[12]*e,n[13]=t[13]*e,n[14]=t[14]*e,n[15]=t[15]*e,n}function BF(n,t,e,r){return n[0]=t[0]+e[0]*r,n[1]=t[1]+e[1]*r,n[2]=t[2]+e[2]*r,n[3]=t[3]+e[3]*r,n[4]=t[4]+e[4]*r,n[5]=t[5]+e[5]*r,n[6]=t[6]+e[6]*r,n[7]=t[7]+e[7]*r,n[8]=t[8]+e[8]*r,n[9]=t[9]+e[9]*r,n[10]=t[10]+e[10]*r,n[11]=t[11]+e[11]*r,n[12]=t[12]+e[12]*r,n[13]=t[13]+e[13]*r,n[14]=t[14]+e[14]*r,n[15]=t[15]+e[15]*r,n}function z1(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]&&n[3]===t[3]&&n[4]===t[4]&&n[5]===t[5]&&n[6]===t[6]&&n[7]===t[7]&&n[8]===t[8]&&n[9]===t[9]&&n[10]===t[10]&&n[11]===t[11]&&n[12]===t[12]&&n[13]===t[13]&&n[14]===t[14]&&n[15]===t[15]}function zF(n,t){var e=n[0],r=n[1],i=n[2],a=n[3],s=n[4],o=n[5],l=n[6],c=n[7],u=n[8],h=n[9],f=n[10],d=n[11],g=n[12],v=n[13],p=n[14],y=n[15],m=t[0],w=t[1],E=t[2],S=t[3],O=t[4],k=t[5],T=t[6],C=t[7],P=t[8],N=t[9],L=t[10],D=t[11],G=t[12],H=t[13],W=t[14],q=t[15];return Math.abs(e-m)<=Ve*Math.max(1,Math.abs(e),Math.abs(m))&&Math.abs(r-w)<=Ve*Math.max(1,Math.abs(r),Math.abs(w))&&Math.abs(i-E)<=Ve*Math.max(1,Math.abs(i),Math.abs(E))&&Math.abs(a-S)<=Ve*Math.max(1,Math.abs(a),Math.abs(S))&&Math.abs(s-O)<=Ve*Math.max(1,Math.abs(s),Math.abs(O))&&Math.abs(o-k)<=Ve*Math.max(1,Math.abs(o),Math.abs(k))&&Math.abs(l-T)<=Ve*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(c-C)<=Ve*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(u-P)<=Ve*Math.max(1,Math.abs(u),Math.abs(P))&&Math.abs(h-N)<=Ve*Math.max(1,Math.abs(h),Math.abs(N))&&Math.abs(f-L)<=Ve*Math.max(1,Math.abs(f),Math.abs(L))&&Math.abs(d-D)<=Ve*Math.max(1,Math.abs(d),Math.abs(D))&&Math.abs(g-G)<=Ve*Math.max(1,Math.abs(g),Math.abs(G))&&Math.abs(v-H)<=Ve*Math.max(1,Math.abs(v),Math.abs(H))&&Math.abs(p-W)<=Ve*Math.max(1,Math.abs(p),Math.abs(W))&&Math.abs(y-q)<=Ve*Math.max(1,Math.abs(y),Math.abs(q))}var qP=Zn,jF=jP;const qF=Object.freeze(Object.defineProperty({__proto__:null,add:DF,adjoint:_F,clone:_P,copy:To,create:Ne,determinant:TP,equals:zF,exactEquals:z1,frob:IF,fromQuat:fw,fromQuat2:TF,fromRotation:PP,fromRotationTranslation:LP,fromRotationTranslationScale:kF,fromRotationTranslationScaleOrigin:Al,fromScaling:vs,fromTranslation:Ta,fromValues:MP,fromXRotation:NP,fromYRotation:RP,fromZRotation:B1,frustum:AF,getRotation:sh,getScaling:ko,getTranslation:ah,identity:Wa,invert:Ai,lookAt:zP,mul:qP,multiply:Zn,multiplyScalar:FF,multiplyScalarAndAdd:BF,ortho:FP,orthoNO:DP,orthoZO:BP,perspective:CF,perspectiveFromFieldOfView:NF,perspectiveNO:IP,perspectiveZO:PF,rotate:MF,rotateX:AP,rotateY:CP,rotateZ:OF,scale:kP,set:F1,str:LF,sub:jF,subtract:jP,targetTo:RF,translate:bo,transpose:OP},Symbol.toStringTag,{value:"Module"}));function ge(){var n=new bn(3);return bn!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function Ui(n){var t=new bn(3);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t}function Ji(n){var t=n[0],e=n[1],r=n[2];return Math.hypot(t,e,r)}function Fe(n,t,e){var r=new bn(3);return r[0]=n,r[1]=t,r[2]=e,r}function Ci(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n}function Kn(n,t,e,r){return n[0]=t,n[1]=e,n[2]=r,n}function Fa(n,t,e){return n[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n}function j1(n,t,e){return n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n}function $F(n,t,e){return n[0]=t[0]*e[0],n[1]=t[1]*e[1],n[2]=t[2]*e[2],n}function GF(n,t,e){return n[0]=Math.min(t[0],e[0]),n[1]=Math.min(t[1],e[1]),n[2]=Math.min(t[2],e[2]),n}function WF(n,t,e){return n[0]=Math.max(t[0],e[0]),n[1]=Math.max(t[1],e[1]),n[2]=Math.max(t[2],e[2]),n}function oh(n,t,e){return n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e,n}function VF(n,t){var e=t[0]-n[0],r=t[1]-n[1],i=t[2]-n[2];return Math.hypot(e,r,i)}function Os(n,t){var e=t[0],r=t[1],i=t[2],a=e*e+r*r+i*i;return a>0&&(a=1/Math.sqrt(a)),n[0]=t[0]*a,n[1]=t[1]*a,n[2]=t[2]*a,n}function Pi(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function $u(n,t,e){var r=t[0],i=t[1],a=t[2],s=e[0],o=e[1],l=e[2];return n[0]=i*l-a*o,n[1]=a*s-r*l,n[2]=r*o-i*s,n}function q1(n,t,e,r){var i=t[0],a=t[1],s=t[2];return n[0]=i+r*(e[0]-i),n[1]=a+r*(e[1]-a),n[2]=s+r*(e[2]-s),n}function Jn(n,t,e){var r=t[0],i=t[1],a=t[2],s=e[3]*r+e[7]*i+e[11]*a+e[15];return s=s||1,n[0]=(e[0]*r+e[4]*i+e[8]*a+e[12])/s,n[1]=(e[1]*r+e[5]*i+e[9]*a+e[13])/s,n[2]=(e[2]*r+e[6]*i+e[10]*a+e[14])/s,n}function HF(n,t,e){var r=t[0],i=t[1],a=t[2];return n[0]=r*e[0]+i*e[3]+a*e[6],n[1]=r*e[1]+i*e[4]+a*e[7],n[2]=r*e[2]+i*e[5]+a*e[8],n}function UF(n,t,e){var r=e[0],i=e[1],a=e[2],s=e[3],o=t[0],l=t[1],c=t[2],u=i*c-a*l,h=a*o-r*c,f=r*l-i*o,d=i*f-a*h,g=a*u-r*f,v=r*h-i*u,p=s*2;return u*=p,h*=p,f*=p,d*=2,g*=2,v*=2,n[0]=o+u+d,n[1]=l+h+g,n[2]=c+f+v,n}function Zo(n,t){var e=n[0],r=n[1],i=n[2],a=t[0],s=t[1],o=t[2];return Math.abs(e-a)<=Ve*Math.max(1,Math.abs(e),Math.abs(a))&&Math.abs(r-s)<=Ve*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-o)<=Ve*Math.max(1,Math.abs(i),Math.abs(o))}var YF=j1,fE=VF,$P=Ji;(function(){var n=ge();return function(t,e,r,i,a,s){var o,l;for(e||(e=3),r||(r=0),i?l=Math.min(i*e+r,t.length):l=t.length,o=r;o<l;o+=e)n[0]=t[o],n[1]=t[o+1],n[2]=t[o+2],a(n,n,s),t[o]=n[0],t[o+1]=n[1],t[o+2]=n[2];return t}})();function Ni(){var n=new bn(4);return bn!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0),n}function ul(n,t,e,r){var i=new bn(4);return i[0]=n,i[1]=t,i[2]=e,i[3]=r,i}function XF(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n}function KF(n,t,e,r,i){return n[0]=t,n[1]=e,n[2]=r,n[3]=i,n}function ZF(n,t){var e=t[0],r=t[1],i=t[2],a=t[3],s=e*e+r*r+i*i+a*a;return s>0&&(s=1/Math.sqrt(s)),n[0]=e*s,n[1]=r*s,n[2]=i*s,n[3]=a*s,n}function ra(n,t,e){var r=t[0],i=t[1],a=t[2],s=t[3];return n[0]=e[0]*r+e[4]*i+e[8]*a+e[12]*s,n[1]=e[1]*r+e[5]*i+e[9]*a+e[13]*s,n[2]=e[2]*r+e[6]*i+e[10]*a+e[14]*s,n[3]=e[3]*r+e[7]*i+e[11]*a+e[15]*s,n}(function(){var n=Ni();return function(t,e,r,i,a,s){var o,l;for(e||(e=4),r||(r=0),i?l=Math.min(i*e+r,t.length):l=t.length,o=r;o<l;o+=e)n[0]=t[o],n[1]=t[o+1],n[2]=t[o+2],n[3]=t[o+3],a(n,n,s),t[o]=n[0],t[o+1]=n[1],t[o+2]=n[2],t[o+3]=n[3];return t}})();function _n(){var n=new bn(4);return bn!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function Aa(n,t,e){e=e*.5;var r=Math.sin(e);return n[0]=r*t[0],n[1]=r*t[1],n[2]=r*t[2],n[3]=Math.cos(e),n}function Ba(n,t,e){var r=t[0],i=t[1],a=t[2],s=t[3],o=e[0],l=e[1],c=e[2],u=e[3];return n[0]=r*u+s*o+i*c-a*l,n[1]=i*u+s*l+a*o-r*c,n[2]=a*u+s*c+r*l-i*o,n[3]=s*u-r*o-i*l-a*c,n}function $d(n,t,e,r){var i=t[0],a=t[1],s=t[2],o=t[3],l=e[0],c=e[1],u=e[2],h=e[3],f,d,g,v,p;return d=i*l+a*c+s*u+o*h,d<0&&(d=-d,l=-l,c=-c,u=-u,h=-h),1-d>Ve?(f=Math.acos(d),g=Math.sin(f),v=Math.sin((1-r)*f)/g,p=Math.sin(r*f)/g):(v=1-r,p=r),n[0]=v*i+p*l,n[1]=v*a+p*c,n[2]=v*s+p*u,n[3]=v*o+p*h,n}function Gd(n,t){var e=t[0],r=t[1],i=t[2],a=t[3],s=e*e+r*r+i*i+a*a,o=s?1/s:0;return n[0]=-e*o,n[1]=-r*o,n[2]=-i*o,n[3]=a*o,n}function JF(n,t){var e=t[0]+t[4]+t[8],r;if(e>0)r=Math.sqrt(e+1),n[3]=.5*r,r=.5/r,n[0]=(t[5]-t[7])*r,n[1]=(t[6]-t[2])*r,n[2]=(t[1]-t[3])*r;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[i*3+i]&&(i=2);var a=(i+1)%3,s=(i+2)%3;r=Math.sqrt(t[i*3+i]-t[a*3+a]-t[s*3+s]+1),n[i]=.5*r,r=.5/r,n[3]=(t[a*3+s]-t[s*3+a])*r,n[a]=(t[a*3+i]+t[i*3+a])*r,n[s]=(t[s*3+i]+t[i*3+s])*r}return n}function qc(n,t,e,r){var i=.5*Math.PI/180;t*=i,e*=i,r*=i;var a=Math.sin(t),s=Math.cos(t),o=Math.sin(e),l=Math.cos(e),c=Math.sin(r),u=Math.cos(r);return n[0]=a*l*u-s*o*c,n[1]=s*o*u+a*l*c,n[2]=s*l*c-a*o*u,n[3]=s*l*u+a*o*c,n}var QF=ul,$c=XF,dE=KF,gE=Ba,lh=ZF;(function(){var n=ge(),t=Fe(1,0,0),e=Fe(0,1,0);return function(r,i,a){var s=Pi(i,a);return s<-.999999?($u(n,t,i),$P(n)<1e-6&&$u(n,e,i),Os(n,n),Aa(r,n,Math.PI),r):s>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):($u(n,i,a),r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=1+s,lh(r,r))}})();(function(){var n=_n(),t=_n();return function(e,r,i,a,s,o){return $d(n,r,s,o),$d(t,i,a,o),$d(e,n,t,2*o*(1-o)),e}})();(function(){var n=SP();return function(t,e,r,i){return n[0]=r[0],n[3]=r[1],n[6]=r[2],n[1]=i[0],n[4]=i[1],n[7]=i[2],n[2]=-e[0],n[5]=-e[1],n[8]=-e[2],lh(t,JF(t,n))}})();function dw(){var n=new bn(2);return bn!=Float32Array&&(n[0]=0,n[1]=0),n}function tB(n,t){return n[0]=t[0],n[1]=t[1],n}function eB(n,t,e){return n[0]=t,n[1]=e,n}function nB(n,t){var e=t[0],r=t[1],i=e*e+r*r;return i>0&&(i=1/Math.sqrt(i)),n[0]=t[0]*i,n[1]=t[1]*i,n}function rB(n,t){return n[0]*t[0]+n[1]*t[1]}function iB(n,t){return n[0]===t[0]&&n[1]===t[1]}(function(){var n=dw();return function(t,e,r,i,a,s){var o,l;for(e||(e=2),r||(r=0),i?l=Math.min(i*e+r,t.length):l=t.length,o=r;o<l;o+=e)n[0]=t[o],n[1]=t[o+1],a(n,n,s),t[o]=n[0],t[o+1]=n[1];return t}})();var Gl=function(n){return n!==null&&typeof n!="function"&&isFinite(n.length)},aB=function(n,t){return Gl(n)?n.indexOf(t)>-1:!1},sB=function(n,t){if(!Gl(n))return n;for(var e=[],r=0;r<n.length;r++){var i=n[r];t(i,r)&&e.push(i)}return e},oB=function(n,t){return t===void 0&&(t=[]),sB(n,function(e){return!aB(t,e)})};function zt(n){return typeof n=="function"}function Ut(n){return n==null}function $r(n){return Array.isArray(n)}const hn=function(n){var t=typeof n;return n!==null&&t==="object"||t==="function"};function GP(n,t){if(n){var e;if($r(n))for(var r=0,i=n.length;r<i&&(e=t(n[r],r),e!==!1);r++);else if(hn(n)){for(var a in n)if(n.hasOwnProperty(a)&&(e=t(n[a],a),e===!1))break}}}var $1=function(n){return typeof n=="object"&&n!==null},lB={}.toString,WP=function(n,t){return lB.call(n)==="[object "+t+"]"},Ao=function(n){if(!$1(n)||!WP(n,"Object"))return!1;if(Object.getPrototypeOf(n)===null)return!0;for(var t=n;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(n)===t};function ch(n){if(!Array.isArray(n))return-1/0;var t=n.length;if(!t)return-1/0;for(var e=n[0],r=1;r<t;r++)e=Math.max(e,n[r]);return e}const uh=function(n){if($r(n))return n.reduce(function(t,e){return Math.min(t,e)},n[0])};var cB=function(n,t,e){if(!$r(n)&&!Ao(n))return n;var r=e;return GP(n,function(i,a){r=t(r,i,a)}),r};function me(n){return typeof n=="string"}function uB(n,t){t===void 0&&(t=new Map);var e=[];if(Array.isArray(n))for(var r=0,i=n.length;r<i;r++){var a=n[r];t.has(a)||(e.push(a),t.set(a,!0))}return e}var hB=Object.prototype.hasOwnProperty;function Kh(n,t){if(!t||!$r(n))return{};for(var e={},r=zt(t)?t:function(o){return o[t]},i,a=0;a<n.length;a++){var s=n[a];i=r(s),hB.call(e,i)?e[i].push(s):e[i]=[s]}return e}var tn=function(n,t,e){return n<t?t:n>e?e:n};function Lt(n){return typeof n=="number"}var fB=1e-5;function Cl(n,t,e){return e===void 0&&(e=fB),n===t||Math.abs(n-t)<e}const dB=function(n,t){if($r(n)){for(var e,r=-1/0,i=0;i<n.length;i++){var a=n[i],s=zt(t)?t(a):a[t];s>r&&(e=a,r=s)}return e}},gB=function(n,t){if($r(n)){for(var e,r=1/0,i=0;i<n.length;i++){var a=n[i],s=zt(t)?t(a):a[t];s<r&&(e=a,r=s)}return e}};var VP=function(n,t){return(n%t+t)%t};const HP=function(n){return Ut(n)?"":n.toString()};var pB=function(n){var t=HP(n);return t.charAt(0).toLowerCase()+t.substring(1)};function vB(n,t){return!n||!t?n:n.replace(/\\?\{([^{}]+)\}/g,function(e,r){return e.charAt(0)==="\\"?e.slice(1):t[r]===void 0?"":t[r]})}var hh=function(n){var t=HP(n);return t.charAt(0).toUpperCase()+t.substring(1)},yB={}.toString,mB=function(n){return yB.call(n).replace(/^\[object /,"").replace(/]$/,"")},fh=function(n){return WP(n,"Boolean")};function bB(n){return n instanceof Date}function wB(n){return n===null}var xB=Object.prototype,EB=function(n){var t=n&&n.constructor,e=typeof t=="function"&&t.prototype||xB;return n===e},Qt=function(n){return n===void 0},Va=function(n){if(typeof n!="object"||n===null)return n;var t;if($r(n)){t=[];for(var e=0,r=n.length;e<r;e++)typeof n[e]=="object"&&n[e]!=null?t[e]=Va(n[e]):t[e]=n[e]}else{t={};for(var i in n)typeof n[i]=="object"&&n[i]!=null?t[i]=Va(n[i]):t[i]=n[i]}return t};function cc(n,t,e){var r;return function(){var i=this,a=arguments,s=function(){r=null,e||n.apply(i,a)},o=e&&!r;clearTimeout(r),r=setTimeout(s,t),o&&n.apply(i,a)}}function SB(n){var t,e,r,i=n||1;function a(o,l){++t>i&&(r=e,s(1),++t),e[o]=l}function s(o){t=0,e=Object.create(null),o||(r=Object.create(null))}return s(),{clear:s,has:function(o){return e[o]!==void 0||r[o]!==void 0},get:function(o){var l=e[o];if(l!==void 0)return l;if((l=r[o])!==void 0)return a(o,l),l},set:function(o,l){e[o]!==void 0?e[o]=l:a(o,l)}}}var Wd=new Map;function G1(n,t,e){e===void 0&&(e=128);var r=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var s=t?t.apply(this,i):i[0];Wd.has(n)||Wd.set(n,SB(e));var o=Wd.get(n);if(o.has(s))return o.get(s);var l=n.apply(this,i);return o.set(s,l),l};return r}var _B=5;function MB(n,t){if(Object.hasOwn)return Object.hasOwn(n,t);if(n==null)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(n),t)}function UP(n,t,e,r){e=e||0,r=r||_B;for(var i in t)if(MB(t,i)){var a=t[i];a!==null&&Ao(a)?(Ao(n[i])||(n[i]={}),e<r?UP(n[i],a,e+1,r):n[i]=t[i]):$r(a)?(n[i]=[],n[i]=n[i].concat(a)):a!==void 0&&(n[i]=a)}}var fr=function(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];for(var r=0;r<t.length;r+=1)UP(n,t[r]);return n},OB=Object.prototype.hasOwnProperty;function Ti(n){if(Ut(n))return!0;if(Gl(n))return!n.length;var t=mB(n);if(t==="Map"||t==="Set")return!n.size;if(EB(n))return!Object.keys(n).length;for(var e in n)if(OB.call(n,e))return!1;return!0}var en=function(n,t){if(n===t)return!0;if(!n||!t||me(n)||me(t))return!1;if(Gl(n)||Gl(t)){if(n.length!==t.length)return!1;for(var e=!0,r=0;r<n.length&&(e=en(n[r],t[r]),!!e);r++);return e}if($1(n)||$1(t)){var i=Object.keys(n),a=Object.keys(t);if(i.length!==a.length)return!1;for(var e=!0,r=0;r<i.length&&(e=en(n[i[r]],t[i[r]]),!!e);r++);return e}return!1};const sr=function(n,t,e){for(var r=0,i=me(t)?t.split("."):t;n&&r<i.length;)n=n[i[r++]];return n===void 0||r<i.length?e:n},Wl=function(n,t,e){var r=n,i=me(t)?t.split("."):t;return i.forEach(function(a,s){s<i.length-1?(hn(r[a])||(r[a]=Lt(i[s+1])?[]:{}),r=r[a]):r[a]=e}),n};var TB=Object.prototype.hasOwnProperty;const Ns=function(n,t){if(n===null||!Ao(n))return{};var e={};return GP(t,function(r){TB.call(n,r)&&(e[r]=n[r])}),e},gw=function(n,t){return cB(n,function(e,r,i){return t.includes(i)||(e[i]=r),e},{})},YP=function(n,t,e){var r,i,a,s,o=0;e||(e={});var l=function(){o=e.leading===!1?0:Date.now(),r=null,s=n.apply(i,a),r||(i=a=null)},c=function(){var u=Date.now();!o&&e.leading===!1&&(o=u);var h=t-(u-o);return i=this,a=arguments,h<=0||h>t?(r&&(clearTimeout(r),r=null),o=u,s=n.apply(i,a),r||(i=a=null)):!r&&e.trailing!==!1&&(r=setTimeout(l,h)),s};return c.cancel=function(){clearTimeout(r),o=0,r=i=a=null},c};var Gc={};const kB=function(n){return n=n||"g",Gc[n]?Gc[n]+=1:Gc[n]=1,n+Gc[n]},Vd=function(){},W1=function(n){return n};var V1=function(n,t){return V1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},V1(n,t)};function le(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");V1(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var pt=function(){return pt=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++){e=arguments[r];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},pt.apply(this,arguments)};function an(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e}function oe(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(r.next(u))}catch(h){s(h)}}function l(u){try{c(r.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((r=r.apply(n,t||[])).next())})}function uc(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function $(n,t){var e=typeof Symbol=="function"&&n[Symbol.iterator];if(!e)return n;var r=e.call(n),i,a=[],s;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(o){s={error:o}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(s)throw s.error}}return a}function AB(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;for(var r=Array(n),i=0,t=0;t<e;t++)for(var a=arguments[t],s=0,o=a.length;s<o;s++,i++)r[i]=a[s];return r}function Rt(n,t,e){if(e||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return n.concat(a||Array.prototype.slice.call(t))}function Hd(n,t,e,r){if(e==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?n!==t||!r:!t.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?r:e==="a"?r.call(n):r?r.value:t.get(n)}var XP={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function CB(n,t,e){if(n[e].length>7){n[e].shift();for(var r=n[e],i=e;r.length;)t[e]="A",n.splice(i+=1,0,["C"].concat(r.splice(0,6)));n.splice(e,1)}}var Pl={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function KP(n){return Array.isArray(n)&&n.every(function(t){var e=t[0].toLowerCase();return Pl[e]===t.length-1&&"achlmqstvz".includes(e)})}function ZP(n){return KP(n)&&n.every(function(t){var e=t[0];return e===e.toUpperCase()})}function JP(n){return ZP(n)&&n.every(function(t){var e=t[0];return"ACLMQZ".includes(e)})}function pE(n){for(var t=n.pathValue[n.segmentStart],e=t.toLowerCase(),r=n.data;r.length>=Pl[e]&&(e==="m"&&r.length>2?(n.segments.push([t].concat(r.splice(0,2))),e="l",t=t==="m"?"l":"L"):n.segments.push([t].concat(r.splice(0,Pl[e]))),!!Pl[e]););}function PB(n){var t=n.index,e=n.pathValue,r=e.charCodeAt(t);if(r===48){n.param=0,n.index+=1;return}if(r===49){n.param=1,n.index+=1;return}n.err='[path-util]: invalid Arc flag "'.concat(e[t],'", expecting 0 or 1 at index ').concat(t)}function NB(n){return n>=48&&n<=57||n===43||n===45||n===46}function Zs(n){return n>=48&&n<=57}function RB(n){var t=n.max,e=n.pathValue,r=n.index,i=r,a=!1,s=!1,o=!1,l=!1,c;if(i>=t){n.err="[path-util]: Invalid path value at index ".concat(i,', "pathValue" is missing param');return}if(c=e.charCodeAt(i),(c===43||c===45)&&(i+=1,c=e.charCodeAt(i)),!Zs(c)&&c!==46){n.err="[path-util]: Invalid path value at index ".concat(i,', "').concat(e[i],'" is not a number');return}if(c!==46){if(a=c===48,i+=1,c=e.charCodeAt(i),a&&i<t&&c&&Zs(c)){n.err="[path-util]: Invalid path value at index ".concat(r,', "').concat(e[r],'" illegal number');return}for(;i<t&&Zs(e.charCodeAt(i));)i+=1,s=!0;c=e.charCodeAt(i)}if(c===46){for(l=!0,i+=1;Zs(e.charCodeAt(i));)i+=1,o=!0;c=e.charCodeAt(i)}if(c===101||c===69){if(l&&!s&&!o){n.err="[path-util]: Invalid path value at index ".concat(i,', "').concat(e[i],'" invalid float exponent');return}if(i+=1,c=e.charCodeAt(i),(c===43||c===45)&&(i+=1),i<t&&Zs(e.charCodeAt(i)))for(;i<t&&Zs(e.charCodeAt(i));)i+=1;else{n.err="[path-util]: Invalid path value at index ".concat(i,', "').concat(e[i],'" invalid integer exponent');return}}n.index=i,n.param=+n.pathValue.slice(r,i)}function LB(n){var t=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];return n===10||n===13||n===8232||n===8233||n===32||n===9||n===11||n===12||n===160||n>=5760&&t.includes(n)}function Gu(n){for(var t=n.pathValue,e=n.max;n.index<e&&LB(t.charCodeAt(n.index));)n.index+=1}function IB(n){switch(n|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}function DB(n){return(n|32)===97}function FB(n){var t=n.max,e=n.pathValue,r=n.index,i=e.charCodeAt(r),a=Pl[e[r].toLowerCase()];if(n.segmentStart=r,!IB(i)){n.err='[path-util]: Invalid path value "'.concat(e[r],'" is not a path command');return}if(n.index+=1,Gu(n),n.data=[],!a){pE(n);return}for(;;){for(var s=a;s>0;s-=1){if(DB(i)&&(s===3||s===4)?PB(n):RB(n),n.err.length)return;n.data.push(n.param),Gu(n),n.index<t&&e.charCodeAt(n.index)===44&&(n.index+=1,Gu(n))}if(n.index>=n.max||!NB(e.charCodeAt(n.index)))break}pE(n)}var BB=function(){function n(t){this.pathValue=t,this.segments=[],this.max=t.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""}return n}();function zB(n){if(KP(n))return[].concat(n);var t=new BB(n);for(Gu(t);t.index<t.max&&!t.err.length;)FB(t);return t.err?t.err:t.segments}function jB(n){if(ZP(n))return[].concat(n);var t=zB(n),e=0,r=0,i=0,a=0;return t.map(function(s){var o=s.slice(1).map(Number),l=s[0],c=l.toUpperCase();if(l==="M")return e=o[0],r=o[1],i=e,a=r,["M",e,r];var u;if(l!==c)switch(c){case"A":u=[c,o[0],o[1],o[2],o[3],o[4],o[5]+e,o[6]+r];break;case"V":u=[c,o[0]+r];break;case"H":u=[c,o[0]+e];break;default:{var h=o.map(function(d,g){return d+(g%2?r:e)});u=[c].concat(h)}}else u=[c].concat(o);var f=u.length;switch(c){case"Z":e=i,r=a;break;case"H":e=u[1];break;case"V":r=u[1];break;default:e=u[f-2],r=u[f-1],c==="M"&&(i=e,a=r)}return u})}function qB(n,t){var e=n[0],r=t.x1,i=t.y1,a=t.x2,s=t.y2,o=n.slice(1).map(Number),l=n;if("TQ".includes(e)||(t.qx=null,t.qy=null),e==="H")l=["L",n[1],i];else if(e==="V")l=["L",r,n[1]];else if(e==="S"){var c=r*2-a,u=i*2-s;t.x1=c,t.y1=u,l=["C",c,u].concat(o)}else if(e==="T"){var h=r*2-t.qx,f=i*2-t.qy;t.qx=h,t.qy=f,l=["Q",h,f].concat(o)}else if(e==="Q"){var d=o[0],g=o[1];t.qx=d,t.qy=g}return l}function dh(n){if(JP(n))return[].concat(n);for(var t=jB(n),e=pt({},XP),r=0;r<t.length;r+=1){t[r]=qB(t[r],e);var i=t[r],a=i.length;e.x1=+i[a-2],e.y1=+i[a-1],e.x2=+i[a-4]||e.x1,e.y2=+i[a-3]||e.y1}return t}function $B(n){return JP(n)&&n.every(function(t){var e=t[0];return"MC".includes(e)})}function Wc(n,t,e){var r=n*Math.cos(e)-t*Math.sin(e),i=n*Math.sin(e)+t*Math.cos(e);return{x:r,y:i}}function pw(n,t,e,r,i,a,s,o,l,c){var u=n,h=t,f=e,d=r,g=o,v=l,p=Math.PI*120/180,y=Math.PI/180*(+i||0),m=[],w,E,S,O,k;if(c)E=c[0],S=c[1],O=c[2],k=c[3];else{w=Wc(u,h,-y),u=w.x,h=w.y,w=Wc(g,v,-y),g=w.x,v=w.y;var T=(u-g)/2,C=(h-v)/2,P=T*T/(f*f)+C*C/(d*d);P>1&&(P=Math.sqrt(P),f*=P,d*=P);var N=f*f,L=d*d,D=(a===s?-1:1)*Math.sqrt(Math.abs((N*L-N*C*C-L*T*T)/(N*C*C+L*T*T)));O=D*f*C/d+(u+g)/2,k=D*-d*T/f+(h+v)/2,E=Math.asin(((h-k)/d*Math.pow(10,9)>>0)/Math.pow(10,9)),S=Math.asin(((v-k)/d*Math.pow(10,9)>>0)/Math.pow(10,9)),E=u<O?Math.PI-E:E,S=g<O?Math.PI-S:S,E<0&&(E=Math.PI*2+E),S<0&&(S=Math.PI*2+S),s&&E>S&&(E-=Math.PI*2),!s&&S>E&&(S-=Math.PI*2)}var G=S-E;if(Math.abs(G)>p){var H=S,W=g,q=v;S=E+p*(s&&S>E?1:-1),g=O+f*Math.cos(S),v=k+d*Math.sin(S),m=pw(g,v,f,d,i,0,s,W,q,[S,H,O,k])}G=S-E;var z=Math.cos(E),Z=Math.sin(E),at=Math.cos(S),ft=Math.sin(S),ct=Math.tan(G/4),Gt=4/3*f*ct,J=4/3*d*ct,V=[u,h],nt=[u+Gt*Z,h-J*z],dt=[g+Gt*ft,v-J*at],Nt=[g,v];if(nt[0]=2*V[0]-nt[0],nt[1]=2*V[1]-nt[1],c)return nt.concat(dt,Nt,m);m=nt.concat(dt,Nt,m);for(var Wt=[],Kt=0,qe=m.length;Kt<qe;Kt+=1)Wt[Kt]=Kt%2?Wc(m[Kt-1],m[Kt],y).y:Wc(m[Kt],m[Kt+1],y).x;return Wt}function GB(n,t,e,r,i,a){var s=.3333333333333333,o=2/3;return[s*n+o*e,s*t+o*r,s*i+o*e,s*a+o*r,i,a]}function _a(n,t,e){var r=n[0],i=n[1],a=t[0],s=t[1];return[r+(a-r)*e,i+(s-i)*e]}var vE=function(n,t,e,r){var i=.5,a=_a([n,t],[e,r],i);return Rt(Rt([],a,!0),[e,r,e,r],!1)};function WB(n,t){var e=n[0],r=n.slice(1).map(Number),i=r[0],a=r[1],s,o=t.x1,l=t.y1,c=t.x,u=t.y;switch("TQ".includes(e)||(t.qx=null,t.qy=null),e){case"M":return t.x=i,t.y=a,n;case"A":return s=[o,l].concat(r),["C"].concat(pw(s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7],s[8],s[9]));case"Q":return t.qx=i,t.qy=a,s=[o,l].concat(r),["C"].concat(GB(s[0],s[1],s[2],s[3],s[4],s[5]));case"L":return["C"].concat(vE(o,l,i,a));case"Z":return o===c&&l===u?["C",o,l,c,u,c,u]:["C"].concat(vE(o,l,c,u))}return n}function H1(n,t){if(t===void 0&&(t=!1),$B(n)){var e=[].concat(n);return t?[e,[]]:e}for(var r=dh(n),i=pt({},XP),a=[],s="",o=r.length,l,c,u=[],h=0;h<o;h+=1){r[h]&&(s=r[h][0]),a[h]=s;var f=WB(r[h],i);r[h]=f,CB(r,a,h),o=r.length,s==="Z"&&u.push(h),l=r[h],c=l.length,i.x1=+l[c-2],i.y1=+l[c-1],i.x2=+l[c-4]||i.x1,i.y2=+l[c-3]||i.y1}return t?[r,u]:r}function VB(n){return n.map(function(t){return Array.isArray(t)?[].concat(t):t})}function HB(n){var t=n.slice(1).map(function(e,r,i){return r?i[r-1].slice(-2).concat(e.slice(1)):n[0].slice(1).concat(e.slice(1))}).map(function(e){return e.map(function(r,i){return e[e.length-i-2*(1-i%2)]})}).reverse();return[["M"].concat(t[0].slice(0,2))].concat(t.map(function(e){return["C"].concat(e.slice(2))}))}function mr(n,t){return Math.sqrt((n[0]-t[0])*(n[0]-t[0])+(n[1]-t[1])*(n[1]-t[1]))}function U1(n,t,e,r,i){var a=mr([n,t],[e,r]),s={x:0,y:0};if(typeof i=="number")if(i<=0)s={x:n,y:t};else if(i>=a)s={x:e,y:r};else{var o=_a([n,t],[e,r],i/a),l=o[0],c=o[1];s={x:l,y:c}}return{length:a,point:s,min:{x:Math.min(n,e),y:Math.min(t,r)},max:{x:Math.max(n,e),y:Math.max(t,r)}}}function yE(n,t){var e=n.x,r=n.y,i=t.x,a=t.y,s=e*i+r*a,o=Math.sqrt((Math.pow(e,2)+Math.pow(r,2))*(Math.pow(i,2)+Math.pow(a,2))),l=e*a-r*i<0?-1:1,c=l*Math.acos(s/o);return c}function UB(n,t,e,r,i,a,s,o,l,c){var u=Math.abs,h=Math.sin,f=Math.cos,d=Math.sqrt,g=Math.PI,v=u(e),p=u(r),y=(i%360+360)%360,m=y*(g/180);if(n===o&&t===l)return{x:n,y:t};if(v===0||p===0)return U1(n,t,o,l,c).point;var w=(n-o)/2,E=(t-l)/2,S={x:f(m)*w+h(m)*E,y:-h(m)*w+f(m)*E},O=Math.pow(S.x,2)/Math.pow(v,2)+Math.pow(S.y,2)/Math.pow(p,2);O>1&&(v*=d(O),p*=d(O));var k=Math.pow(v,2)*Math.pow(p,2)-Math.pow(v,2)*Math.pow(S.y,2)-Math.pow(p,2)*Math.pow(S.x,2),T=Math.pow(v,2)*Math.pow(S.y,2)+Math.pow(p,2)*Math.pow(S.x,2),C=k/T;C=C<0?0:C;var P=(a!==s?1:-1)*d(C),N={x:P*(v*S.y/p),y:P*(-(p*S.x)/v)},L={x:f(m)*N.x-h(m)*N.y+(n+o)/2,y:h(m)*N.x+f(m)*N.y+(t+l)/2},D={x:(S.x-N.x)/v,y:(S.y-N.y)/p},G=yE({x:1,y:0},D),H={x:(-S.x-N.x)/v,y:(-S.y-N.y)/p},W=yE(D,H);!s&&W>0?W-=2*g:s&&W<0&&(W+=2*g),W%=2*g;var q=G+W*c,z=v*f(q),Z=p*h(q),at={x:f(m)*z-h(m)*Z+L.x,y:h(m)*z+f(m)*Z+L.y};return at}function YB(n,t,e,r,i,a,s,o,l,c,u){var h,f=u.bbox,d=f===void 0?!0:f,g=u.length,v=g===void 0?!0:g,p=u.sampleSize,y=p===void 0?30:p,m=typeof c=="number",w=n,E=t,S=0,O=[w,E,S],k=[w,E],T=0,C={x:0,y:0},P=[{x:w,y:E}];m&&c<=0&&(C={x:w,y:E});for(var N=0;N<=y;N+=1){if(T=N/y,h=UB(n,t,e,r,i,a,s,o,l,T),w=h.x,E=h.y,d&&P.push({x:w,y:E}),v&&(S+=mr(k,[w,E])),k=[w,E],m&&S>=c&&c>O[2]){var L=(S-c)/(S-O[2]);C={x:k[0]*(1-L)+O[0]*L,y:k[1]*(1-L)+O[1]*L}}O=[w,E,S]}return m&&c>=S&&(C={x:o,y:l}),{length:S,point:C,min:{x:Math.min.apply(null,P.map(function(D){return D.x})),y:Math.min.apply(null,P.map(function(D){return D.y}))},max:{x:Math.max.apply(null,P.map(function(D){return D.x})),y:Math.max.apply(null,P.map(function(D){return D.y}))}}}function XB(n,t,e,r,i,a,s,o,l){var c=1-l;return{x:Math.pow(c,3)*n+3*Math.pow(c,2)*l*e+3*c*Math.pow(l,2)*i+Math.pow(l,3)*s,y:Math.pow(c,3)*t+3*Math.pow(c,2)*l*r+3*c*Math.pow(l,2)*a+Math.pow(l,3)*o}}function QP(n,t,e,r,i,a,s,o,l,c){var u,h=c.bbox,f=h===void 0?!0:h,d=c.length,g=d===void 0?!0:d,v=c.sampleSize,p=v===void 0?10:v,y=typeof l=="number",m=n,w=t,E=0,S=[m,w,E],O=[m,w],k=0,T={x:0,y:0},C=[{x:m,y:w}];y&&l<=0&&(T={x:m,y:w});for(var P=0;P<=p;P+=1){if(k=P/p,u=XB(n,t,e,r,i,a,s,o,k),m=u.x,w=u.y,f&&C.push({x:m,y:w}),g&&(E+=mr(O,[m,w])),O=[m,w],y&&E>=l&&l>S[2]){var N=(E-l)/(E-S[2]);T={x:O[0]*(1-N)+S[0]*N,y:O[1]*(1-N)+S[1]*N}}S=[m,w,E]}return y&&l>=E&&(T={x:s,y:o}),{length:E,point:T,min:{x:Math.min.apply(null,C.map(function(L){return L.x})),y:Math.min.apply(null,C.map(function(L){return L.y}))},max:{x:Math.max.apply(null,C.map(function(L){return L.x})),y:Math.max.apply(null,C.map(function(L){return L.y}))}}}function KB(n,t,e,r,i,a,s){var o=1-s;return{x:Math.pow(o,2)*n+2*o*s*e+Math.pow(s,2)*i,y:Math.pow(o,2)*t+2*o*s*r+Math.pow(s,2)*a}}function ZB(n,t,e,r,i,a,s,o){var l,c=o.bbox,u=c===void 0?!0:c,h=o.length,f=h===void 0?!0:h,d=o.sampleSize,g=d===void 0?10:d,v=typeof s=="number",p=n,y=t,m=0,w=[p,y,m],E=[p,y],S=0,O={x:0,y:0},k=[{x:p,y}];v&&s<=0&&(O={x:p,y});for(var T=0;T<=g;T+=1){if(S=T/g,l=KB(n,t,e,r,i,a,S),p=l.x,y=l.y,u&&k.push({x:p,y}),f&&(m+=mr(E,[p,y])),E=[p,y],v&&m>=s&&s>w[2]){var C=(m-s)/(m-w[2]);O={x:E[0]*(1-C)+w[0]*C,y:E[1]*(1-C)+w[1]*C}}w=[p,y,m]}return v&&s>=m&&(O={x:i,y:a}),{length:m,point:O,min:{x:Math.min.apply(null,k.map(function(P){return P.x})),y:Math.min.apply(null,k.map(function(P){return P.y}))},max:{x:Math.max.apply(null,k.map(function(P){return P.x})),y:Math.max.apply(null,k.map(function(P){return P.y}))}}}function tN(n,t,e){for(var r,i,a,s,o,l,c=dh(n),u=typeof t=="number",h,f=[],d,g=0,v=0,p=0,y=0,m,w=[],E=[],S=0,O={x:0,y:0},k=O,T=O,C=O,P=0,N=0,L=c.length;N<L;N+=1)m=c[N],d=m[0],h=d==="M",f=h?f:[g,v].concat(m.slice(1)),h?(p=m[1],y=m[2],O={x:p,y},k=O,S=0,u&&t<.001&&(C=O)):d==="L"?(r=U1(f[0],f[1],f[2],f[3],(t||0)-P),S=r.length,O=r.min,k=r.max,T=r.point):d==="A"?(i=YB(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8],(t||0)-P,e||{}),S=i.length,O=i.min,k=i.max,T=i.point):d==="C"?(a=QP(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],(t||0)-P,e||{}),S=a.length,O=a.min,k=a.max,T=a.point):d==="Q"?(s=ZB(f[0],f[1],f[2],f[3],f[4],f[5],(t||0)-P,e||{}),S=s.length,O=s.min,k=s.max,T=s.point):d==="Z"&&(f=[g,v,p,y],o=U1(f[0],f[1],f[2],f[3],(t||0)-P),S=o.length,O=o.min,k=o.max,T=o.point),u&&P<t&&P+S>=t&&(C=T),E.push(k),w.push(O),P+=S,l=d!=="Z"?m.slice(-2):[p,y],g=l[0],v=l[1];return u&&t>=P&&(C={x:g,y:v}),{length:P,point:C,min:{x:Math.min.apply(null,w.map(function(D){return D.x})),y:Math.min.apply(null,w.map(function(D){return D.y}))},max:{x:Math.max.apply(null,E.map(function(D){return D.x})),y:Math.max.apply(null,E.map(function(D){return D.y}))}}}function JB(n,t){return tN(n,void 0,pt(pt({},t),{bbox:!1,length:!0})).length}function QB(n){var t=n.length,e=t-1;return n.map(function(r,i){return n.map(function(a,s){var o=i+s,l;return s===0||n[o]&&n[o][0]==="M"?(l=n[o],["M"].concat(l.slice(-2))):(o>=t&&(o-=e),n[o])})})}function t4(n,t){var e=n.length-1,r=[],i=0,a=0,s=QB(n);return s.forEach(function(o,l){n.slice(1).forEach(function(c,u){a+=mr(n[(l+u)%e].slice(-2),t[u%e].slice(-2))}),r[l]=a,a=0}),i=r.indexOf(Math.min.apply(null,r)),s[i]}function e4(n,t,e,r,i,a,s,o){return 3*((o-t)*(e+i)-(s-n)*(r+a)+r*(n-i)-e*(t-a)+o*(i+n/3)-s*(a+t/3))/20}function n4(n){var t=0,e=0,r=0;return H1(n).map(function(i){var a;switch(i[0]){case"M":return t=i[1],e=i[2],0;default:var s=i.slice(1),o=s[0],l=s[1],c=s[2],u=s[3],h=s[4],f=s[5];return r=e4(t,e,o,l,c,u,h,f),a=i.slice(-2),t=a[0],e=a[1],r}}).reduce(function(i,a){return i+a},0)}function mE(n){return n4(n)>=0}function r4(n,t,e){return tN(n,t,pt(pt({},e),{bbox:!1,length:!0})).point}function i4(n,t){t===void 0&&(t=.5);var e=n.slice(0,2),r=n.slice(2,4),i=n.slice(4,6),a=n.slice(6,8),s=_a(e,r,t),o=_a(r,i,t),l=_a(i,a,t),c=_a(s,o,t),u=_a(o,l,t),h=_a(c,u,t);return[["C"].concat(s,c,h),["C"].concat(u,l,a)]}function bE(n){return n.map(function(t,e,r){var i=e&&r[e-1].slice(-2).concat(t.slice(1)),a=e?QP(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],{bbox:!1}).length:0,s;return e?s=a?i4(i):[t,t]:s=[t],{s:t,ss:s,l:a}})}function eN(n,t,e){var r=bE(n),i=bE(t),a=r.length,s=i.length,o=r.filter(function(p){return p.l}).length,l=i.filter(function(p){return p.l}).length,c=r.filter(function(p){return p.l}).reduce(function(p,y){var m=y.l;return p+m},0)/o||0,u=i.filter(function(p){return p.l}).reduce(function(p,y){var m=y.l;return p+m},0)/l||0,h=e||Math.max(a,s),f=[c,u],d=[h-a,h-s],g=0,v=[r,i].map(function(p,y){return p.l===h?p.map(function(m){return m.s}):p.map(function(m,w){return g=w&&d[y]&&m.l>=f[y],d[y]-=g?1:0,g?m.ss:[m.s]}).flat()});return v[0].length===v[1].length?v:eN(v[0],v[1],h)}function Y1(n){var t=document.createElement("div");t.innerHTML=n;var e=t.childNodes[0];return e&&t.contains(e)&&t.removeChild(e),e}function a4(n,t){for(;!{}.hasOwnProperty.call(n,t)&&(n=Oo(n))!==null;);return n}function X1(){return X1=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(n,t,e){var r=a4(n,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?n:e):i.value}},X1.apply(null,arguments)}function wE(n,t,e,r){var i=X1(Oo(n.prototype),t,e);return typeof i=="function"?function(a){return i.apply(e,a)}:i}function aa(n,t,e,r){var i=n-e,a=t-r;return Math.sqrt(i*i+a*a)}function nN(n,t){var e=Math.min.apply(Math,Rt([],$(n),!1)),r=Math.min.apply(Math,Rt([],$(t),!1)),i=Math.max.apply(Math,Rt([],$(n),!1)),a=Math.max.apply(Math,Rt([],$(t),!1));return{x:e,y:r,width:i-e,height:a-r}}function s4(n,t,e){return Math.atan(-t/n*Math.tan(e))}function o4(n,t,e){return Math.atan(t/(n*Math.tan(e)))}function l4(n,t,e,r,i,a){return e*Math.cos(i)*Math.cos(a)-r*Math.sin(i)*Math.sin(a)+n}function c4(n,t,e,r,i,a){return e*Math.sin(i)*Math.cos(a)+r*Math.cos(i)*Math.sin(a)+t}function u4(n,t,e,r,i,a,s){for(var o=s4(e,r,i),l=1/0,c=-1/0,u=[a,s],h=-Math.PI*2;h<=Math.PI*2;h+=Math.PI){var f=o+h;a<s?a<f&&f<s&&u.push(f):s<f&&f<a&&u.push(f)}for(var h=0;h<u.length;h++){var d=l4(n,t,e,r,i,u[h]);d<l&&(l=d),d>c&&(c=d)}for(var g=o4(e,r,i),v=1/0,p=-1/0,y=[a,s],h=-Math.PI*2;h<=Math.PI*2;h+=Math.PI){var m=g+h;a<s?a<m&&m<s&&y.push(m):s<m&&m<a&&y.push(m)}for(var h=0;h<y.length;h++){var w=c4(n,t,e,r,i,y[h]);w<v&&(v=w),w>p&&(p=w)}return{x:l,y:v,width:c-l,height:p-v}}var h4=1e-4;function rN(n,t,e,r,i,a){var s=-1,o=1/0,l=[e,r],c=20;a&&a>200&&(c=a/10);for(var u=1/c,h=u/10,f=0;f<=c;f++){var d=f*u,g=[i.apply(void 0,Rt([],$(n.concat([d])),!1)),i.apply(void 0,Rt([],$(t.concat([d])),!1))],v=aa(l[0],l[1],g[0],g[1]);v<o&&(s=d,o=v)}if(s===0)return{x:n[0],y:t[0]};if(s===1){var p=n.length;return{x:n[p-1],y:t[p-1]}}o=1/0;for(var f=0;f<32&&!(h<h4);f++){var y=s-h,m=s+h,g=[i.apply(void 0,Rt([],$(n.concat([y])),!1)),i.apply(void 0,Rt([],$(t.concat([y])),!1))],v=aa(l[0],l[1],g[0],g[1]);if(y>=0&&v<o)s=y,o=v;else{var w=[i.apply(void 0,Rt([],$(n.concat([m])),!1)),i.apply(void 0,Rt([],$(t.concat([m])),!1))],E=aa(l[0],l[1],w[0],w[1]);m<=1&&E<o?(s=m,o=E):h*=.5}}return{x:i.apply(void 0,Rt([],$(n.concat([s])),!1)),y:i.apply(void 0,Rt([],$(t.concat([s])),!1))}}function iN(n,t,e,r){return aa(n,t,e,r)}function aN(n,t,e,r,i){return{x:(1-i)*n+i*e,y:(1-i)*t+i*r}}function f4(n,t,e,r,i,a){var s=[e-n,r-t];if(iB(s,[0,0]))return Math.sqrt((i-n)*(i-n)+(a-t)*(a-t));var o=[-s[1],s[0]];nB(o,o);var l=[i-n,a-t];return Math.abs(rB(l,o))}function K1(n,t,e,r,i){var a=1-i;return a*a*a*n+3*t*i*a*a+3*e*i*i*a+r*i*i*i}function xE(n,t,e,r){var i=-3*n+9*t-9*e+3*r,a=6*n-12*t+6*e,s=3*t-3*n,o=[],l,c,u;if(Cl(i,0))Cl(a,0)||(l=-s/a,l>=0&&l<=1&&o.push(l));else{var h=a*a-4*i*s;Cl(h,0)?o.push(-a/(2*i)):h>0&&(u=Math.sqrt(h),l=(-a+u)/(2*i),c=(-a-u)/(2*i),l>=0&&l<=1&&o.push(l),c>=0&&c<=1&&o.push(c))}return o}function d4(n,t,e,r,i,a,s,o){for(var l=[n,s],c=[t,o],u=xE(n,e,i,s),h=xE(t,r,a,o),f=0;f<u.length;f++)l.push(K1(n,e,i,s,u[f]));for(var f=0;f<h.length;f++)c.push(K1(t,r,a,o,h[f]));return nN(l,c)}function g4(n,t,e,r,i,a,s,o,l,c,u){return rN([n,e,i,s],[t,r,a,o],l,c,K1,u)}function EE(n,t,e,r,i,a,s,o,l,c,u){var h=g4(n,t,e,r,i,a,s,o,l,c,u);return aa(h.x,h.y,l,c)}function p4(n){if(n.length<2)return 0;for(var t=0,e=0;e<n.length-1;e++){var r=n[e],i=n[e+1];t+=aa(r[0],r[1],i[0],i[1])}return t}function v4(n){return p4(n)}function Z1(n,t,e,r){var i=1-r;return i*i*n+2*r*i*t+r*r*e}function SE(n,t,e){var r=n+e-2*t;if(Cl(r,0))return[.5];var i=(n-t)/r;return i<=1&&i>=0?[i]:[]}function y4(n,t,e,r,i,a){var s=SE(n,e,i)[0],o=SE(t,r,a)[0],l=[n,i],c=[t,a];return s!==void 0&&l.push(Z1(n,e,i,s)),o!==void 0&&c.push(Z1(t,r,a,o)),nN(l,c)}function m4(n,t,e,r,i,a,s,o){return rN([n,e,i],[t,r,a],s,o,Z1)}function b4(n,t,e,r,i,a,s,o){var l=m4(n,t,e,r,i,a,s,o);return aa(l.x,l.y,s,o)}function qn(){qn=function(){return t};var n,t={},e=Object.prototype,r=e.hasOwnProperty,i=Object.defineProperty||function(W,q,z){W[q]=z.value},a=typeof Symbol=="function"?Symbol:{},s=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function c(W,q,z){return Object.defineProperty(W,q,{value:z,enumerable:!0,configurable:!0,writable:!0}),W[q]}try{c({},"")}catch{c=function(z,Z,at){return z[Z]=at}}function u(W,q,z,Z){var at=q&&q.prototype instanceof y?q:y,ft=Object.create(at.prototype),ct=new G(Z||[]);return i(ft,"_invoke",{value:P(W,z,ct)}),ft}function h(W,q,z){try{return{type:"normal",arg:W.call(q,z)}}catch(Z){return{type:"throw",arg:Z}}}t.wrap=u;var f="suspendedStart",d="suspendedYield",g="executing",v="completed",p={};function y(){}function m(){}function w(){}var E={};c(E,s,function(){return this});var S=Object.getPrototypeOf,O=S&&S(S(H([])));O&&O!==e&&r.call(O,s)&&(E=O);var k=w.prototype=y.prototype=Object.create(E);function T(W){["next","throw","return"].forEach(function(q){c(W,q,function(z){return this._invoke(q,z)})})}function C(W,q){function z(at,ft,ct,Gt){var J=h(W[at],W,ft);if(J.type!=="throw"){var V=J.arg,nt=V.value;return nt&&Ga(nt)=="object"&&r.call(nt,"__await")?q.resolve(nt.__await).then(function(dt){z("next",dt,ct,Gt)},function(dt){z("throw",dt,ct,Gt)}):q.resolve(nt).then(function(dt){V.value=dt,ct(V)},function(dt){return z("throw",dt,ct,Gt)})}Gt(J.arg)}var Z;i(this,"_invoke",{value:function(ft,ct){function Gt(){return new q(function(J,V){z(ft,ct,J,V)})}return Z=Z?Z.then(Gt,Gt):Gt()}})}function P(W,q,z){var Z=f;return function(at,ft){if(Z===g)throw Error("Generator is already running");if(Z===v){if(at==="throw")throw ft;return{value:n,done:!0}}for(z.method=at,z.arg=ft;;){var ct=z.delegate;if(ct){var Gt=N(ct,z);if(Gt){if(Gt===p)continue;return Gt}}if(z.method==="next")z.sent=z._sent=z.arg;else if(z.method==="throw"){if(Z===f)throw Z=v,z.arg;z.dispatchException(z.arg)}else z.method==="return"&&z.abrupt("return",z.arg);Z=g;var J=h(W,q,z);if(J.type==="normal"){if(Z=z.done?v:d,J.arg===p)continue;return{value:J.arg,done:z.done}}J.type==="throw"&&(Z=v,z.method="throw",z.arg=J.arg)}}}function N(W,q){var z=q.method,Z=W.iterator[z];if(Z===n)return q.delegate=null,z==="throw"&&W.iterator.return&&(q.method="return",q.arg=n,N(W,q),q.method==="throw")||z!=="return"&&(q.method="throw",q.arg=new TypeError("The iterator does not provide a '"+z+"' method")),p;var at=h(Z,W.iterator,q.arg);if(at.type==="throw")return q.method="throw",q.arg=at.arg,q.delegate=null,p;var ft=at.arg;return ft?ft.done?(q[W.resultName]=ft.value,q.next=W.nextLoc,q.method!=="return"&&(q.method="next",q.arg=n),q.delegate=null,p):ft:(q.method="throw",q.arg=new TypeError("iterator result is not an object"),q.delegate=null,p)}function L(W){var q={tryLoc:W[0]};1 in W&&(q.catchLoc=W[1]),2 in W&&(q.finallyLoc=W[2],q.afterLoc=W[3]),this.tryEntries.push(q)}function D(W){var q=W.completion||{};q.type="normal",delete q.arg,W.completion=q}function G(W){this.tryEntries=[{tryLoc:"root"}],W.forEach(L,this),this.reset(!0)}function H(W){if(W||W===""){var q=W[s];if(q)return q.call(W);if(typeof W.next=="function")return W;if(!isNaN(W.length)){var z=-1,Z=function at(){for(;++z<W.length;)if(r.call(W,z))return at.value=W[z],at.done=!1,at;return at.value=n,at.done=!0,at};return Z.next=Z}}throw new TypeError(Ga(W)+" is not iterable")}return m.prototype=w,i(k,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:m,configurable:!0}),m.displayName=c(w,l,"GeneratorFunction"),t.isGeneratorFunction=function(W){var q=typeof W=="function"&&W.constructor;return!!q&&(q===m||(q.displayName||q.name)==="GeneratorFunction")},t.mark=function(W){return Object.setPrototypeOf?Object.setPrototypeOf(W,w):(W.__proto__=w,c(W,l,"GeneratorFunction")),W.prototype=Object.create(k),W},t.awrap=function(W){return{__await:W}},T(C.prototype),c(C.prototype,o,function(){return this}),t.AsyncIterator=C,t.async=function(W,q,z,Z,at){at===void 0&&(at=Promise);var ft=new C(u(W,q,z,Z),at);return t.isGeneratorFunction(q)?ft:ft.next().then(function(ct){return ct.done?ct.value:ft.next()})},T(k),c(k,l,"Generator"),c(k,s,function(){return this}),c(k,"toString",function(){return"[object Generator]"}),t.keys=function(W){var q=Object(W),z=[];for(var Z in q)z.push(Z);return z.reverse(),function at(){for(;z.length;){var ft=z.pop();if(ft in q)return at.value=ft,at.done=!1,at}return at.done=!0,at}},t.values=H,G.prototype={constructor:G,reset:function(q){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(D),!q)for(var z in this)z.charAt(0)==="t"&&r.call(this,z)&&!isNaN(+z.slice(1))&&(this[z]=n)},stop:function(){this.done=!0;var q=this.tryEntries[0].completion;if(q.type==="throw")throw q.arg;return this.rval},dispatchException:function(q){if(this.done)throw q;var z=this;function Z(V,nt){return ct.type="throw",ct.arg=q,z.next=V,nt&&(z.method="next",z.arg=n),!!nt}for(var at=this.tryEntries.length-1;at>=0;--at){var ft=this.tryEntries[at],ct=ft.completion;if(ft.tryLoc==="root")return Z("end");if(ft.tryLoc<=this.prev){var Gt=r.call(ft,"catchLoc"),J=r.call(ft,"finallyLoc");if(Gt&&J){if(this.prev<ft.catchLoc)return Z(ft.catchLoc,!0);if(this.prev<ft.finallyLoc)return Z(ft.finallyLoc)}else if(Gt){if(this.prev<ft.catchLoc)return Z(ft.catchLoc,!0)}else{if(!J)throw Error("try statement without catch or finally");if(this.prev<ft.finallyLoc)return Z(ft.finallyLoc)}}}},abrupt:function(q,z){for(var Z=this.tryEntries.length-1;Z>=0;--Z){var at=this.tryEntries[Z];if(at.tryLoc<=this.prev&&r.call(at,"finallyLoc")&&this.prev<at.finallyLoc){var ft=at;break}}ft&&(q==="break"||q==="continue")&&ft.tryLoc<=z&&z<=ft.finallyLoc&&(ft=null);var ct=ft?ft.completion:{};return ct.type=q,ct.arg=z,ft?(this.method="next",this.next=ft.finallyLoc,p):this.complete(ct)},complete:function(q,z){if(q.type==="throw")throw q.arg;return q.type==="break"||q.type==="continue"?this.next=q.arg:q.type==="return"?(this.rval=this.arg=q.arg,this.method="return",this.next="end"):q.type==="normal"&&z&&(this.next=z),p},finish:function(q){for(var z=this.tryEntries.length-1;z>=0;--z){var Z=this.tryEntries[z];if(Z.finallyLoc===q)return this.complete(Z.completion,Z.afterLoc),D(Z),p}},catch:function(q){for(var z=this.tryEntries.length-1;z>=0;--z){var Z=this.tryEntries[z];if(Z.tryLoc===q){var at=Z.completion;if(at.type==="throw"){var ft=at.arg;D(Z)}return ft}}throw Error("illegal catch attempt")},delegateYield:function(q,z,Z){return this.delegate={iterator:H(q),resultName:z,nextLoc:Z},this.method==="next"&&(this.arg=n),p}},t}function _E(n,t,e,r,i,a,s){try{var o=n[a](s),l=o.value}catch(c){return void e(c)}o.done?t(l):Promise.resolve(l).then(r,i)}function Ha(n){return function(){var t=this,e=arguments;return new Promise(function(r,i){var a=n.apply(t,e);function s(l){_E(a,r,i,s,o,"next",l)}function o(l){_E(a,r,i,s,o,"throw",l)}s(void 0)})}}function ys(n,t){var e=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!e){if(Array.isArray(n)||(e=hw(n))||t){e&&(n=e);var r=0,i=function(){};return{s:i,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,s=!0,o=!1;return{s:function(){e=e.call(n)},n:function(){var c=e.next();return s=c.done,c},e:function(c){o=!0,a=c},f:function(){try{s||e.return==null||e.return()}finally{if(o)throw a}}}}function w4(n,t){if(n==null)return{};var e={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(t.indexOf(r)!==-1)continue;e[r]=n[r]}return e}function qs(n,t){if(n==null)return{};var e,r,i=w4(n,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);for(r=0;r<a.length;r++)e=a[r],t.indexOf(e)===-1&&{}.propertyIsEnumerable.call(n,e)&&(i[e]=n[e])}return i}/*!
 * @antv/g-lite
 * @description A core module for rendering engine implements DOM API.
 * @version 2.2.16
 * @date 1/23/2025, 8:31:51 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var x4=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},sN={exports:{}};(function(n,t){(function(e,r){n.exports=r()})(x4,function(){function e(S,O,k,T,C){r(S,O,k||0,T||S.length-1,C||a)}function r(S,O,k,T,C){for(;T>k;){if(T-k>600){var P=T-k+1,N=O-k+1,L=Math.log(P),D=.5*Math.exp(2*L/3),G=.5*Math.sqrt(L*D*(P-D)/P)*(N-P/2<0?-1:1),H=Math.max(k,Math.floor(O-N*D/P+G)),W=Math.min(T,Math.floor(O+(P-N)*D/P+G));r(S,O,H,W,C)}var q=S[O],z=k,Z=T;for(i(S,k,O),C(S[T],q)>0&&i(S,k,T);z<Z;){for(i(S,z,Z),z++,Z--;C(S[z],q)<0;)z++;for(;C(S[Z],q)>0;)Z--}C(S[k],q)===0?i(S,k,Z):(Z++,i(S,Z,T)),Z<=O&&(k=Z+1),O<=Z&&(T=Z-1)}}function i(S,O,k){var T=S[O];S[O]=S[k],S[k]=T}function a(S,O){return S<O?-1:S>O?1:0}var s=function(O){O===void 0&&(O=9),this._maxEntries=Math.max(4,O),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()};s.prototype.all=function(){return this._all(this.data,[])},s.prototype.search=function(O){var k=this.data,T=[];if(!m(O,k))return T;for(var C=this.toBBox,P=[];k;){for(var N=0;N<k.children.length;N++){var L=k.children[N],D=k.leaf?C(L):L;m(O,D)&&(k.leaf?T.push(L):y(O,D)?this._all(L,T):P.push(L))}k=P.pop()}return T},s.prototype.collides=function(O){var k=this.data;if(!m(O,k))return!1;for(var T=[];k;){for(var C=0;C<k.children.length;C++){var P=k.children[C],N=k.leaf?this.toBBox(P):P;if(m(O,N)){if(k.leaf||y(O,N))return!0;T.push(P)}}k=T.pop()}return!1},s.prototype.load=function(O){if(!(O&&O.length))return this;if(O.length<this._minEntries){for(var k=0;k<O.length;k++)this.insert(O[k]);return this}var T=this._build(O.slice(),0,O.length-1,0);if(!this.data.children.length)this.data=T;else if(this.data.height===T.height)this._splitRoot(this.data,T);else{if(this.data.height<T.height){var C=this.data;this.data=T,T=C}this._insert(T,this.data.height-T.height-1,!0)}return this},s.prototype.insert=function(O){return O&&this._insert(O,this.data.height-1),this},s.prototype.clear=function(){return this.data=w([]),this},s.prototype.remove=function(O,k){if(!O)return this;for(var T=this.data,C=this.toBBox(O),P=[],N=[],L,D,G;T||P.length;){if(T||(T=P.pop(),D=P[P.length-1],L=N.pop(),G=!0),T.leaf){var H=o(O,T.children,k);if(H!==-1)return T.children.splice(H,1),P.push(T),this._condense(P),this}!G&&!T.leaf&&y(T,C)?(P.push(T),N.push(L),L=0,D=T,T=T.children[0]):D?(L++,T=D.children[L],G=!1):T=null}return this},s.prototype.toBBox=function(O){return O},s.prototype.compareMinX=function(O,k){return O.minX-k.minX},s.prototype.compareMinY=function(O,k){return O.minY-k.minY},s.prototype.toJSON=function(){return this.data},s.prototype.fromJSON=function(O){return this.data=O,this},s.prototype._all=function(O,k){for(var T=[];O;)O.leaf?k.push.apply(k,O.children):T.push.apply(T,O.children),O=T.pop();return k},s.prototype._build=function(O,k,T,C){var P=T-k+1,N=this._maxEntries,L;if(P<=N)return L=w(O.slice(k,T+1)),l(L,this.toBBox),L;C||(C=Math.ceil(Math.log(P)/Math.log(N)),N=Math.ceil(P/Math.pow(N,C-1))),L=w([]),L.leaf=!1,L.height=C;var D=Math.ceil(P/N),G=D*Math.ceil(Math.sqrt(N));E(O,k,T,G,this.compareMinX);for(var H=k;H<=T;H+=G){var W=Math.min(H+G-1,T);E(O,H,W,D,this.compareMinY);for(var q=H;q<=W;q+=D){var z=Math.min(q+D-1,W);L.children.push(this._build(O,q,z,C-1))}}return l(L,this.toBBox),L},s.prototype._chooseSubtree=function(O,k,T,C){for(;C.push(k),!(k.leaf||C.length-1===T);){for(var P=1/0,N=1/0,L=void 0,D=0;D<k.children.length;D++){var G=k.children[D],H=d(G),W=v(O,G)-H;W<N?(N=W,P=H<P?H:P,L=G):W===N&&H<P&&(P=H,L=G)}k=L||k.children[0]}return k},s.prototype._insert=function(O,k,T){var C=T?O:this.toBBox(O),P=[],N=this._chooseSubtree(C,this.data,k,P);for(N.children.push(O),u(N,C);k>=0&&P[k].children.length>this._maxEntries;)this._split(P,k),k--;this._adjustParentBBoxes(C,P,k)},s.prototype._split=function(O,k){var T=O[k],C=T.children.length,P=this._minEntries;this._chooseSplitAxis(T,P,C);var N=this._chooseSplitIndex(T,P,C),L=w(T.children.splice(N,T.children.length-N));L.height=T.height,L.leaf=T.leaf,l(T,this.toBBox),l(L,this.toBBox),k?O[k-1].children.push(L):this._splitRoot(T,L)},s.prototype._splitRoot=function(O,k){this.data=w([O,k]),this.data.height=O.height+1,this.data.leaf=!1,l(this.data,this.toBBox)},s.prototype._chooseSplitIndex=function(O,k,T){for(var C,P=1/0,N=1/0,L=k;L<=T-k;L++){var D=c(O,0,L,this.toBBox),G=c(O,L,T,this.toBBox),H=p(D,G),W=d(D)+d(G);H<P?(P=H,C=L,N=W<N?W:N):H===P&&W<N&&(N=W,C=L)}return C||T-k},s.prototype._chooseSplitAxis=function(O,k,T){var C=O.leaf?this.compareMinX:h,P=O.leaf?this.compareMinY:f,N=this._allDistMargin(O,k,T,C),L=this._allDistMargin(O,k,T,P);N<L&&O.children.sort(C)},s.prototype._allDistMargin=function(O,k,T,C){O.children.sort(C);for(var P=this.toBBox,N=c(O,0,k,P),L=c(O,T-k,T,P),D=g(N)+g(L),G=k;G<T-k;G++){var H=O.children[G];u(N,O.leaf?P(H):H),D+=g(N)}for(var W=T-k-1;W>=k;W--){var q=O.children[W];u(L,O.leaf?P(q):q),D+=g(L)}return D},s.prototype._adjustParentBBoxes=function(O,k,T){for(var C=T;C>=0;C--)u(k[C],O)},s.prototype._condense=function(O){for(var k=O.length-1,T=void 0;k>=0;k--)O[k].children.length===0?k>0?(T=O[k-1].children,T.splice(T.indexOf(O[k]),1)):this.clear():l(O[k],this.toBBox)};function o(S,O,k){if(!k)return O.indexOf(S);for(var T=0;T<O.length;T++)if(k(S,O[T]))return T;return-1}function l(S,O){c(S,0,S.children.length,O,S)}function c(S,O,k,T,C){C||(C=w(null)),C.minX=1/0,C.minY=1/0,C.maxX=-1/0,C.maxY=-1/0;for(var P=O;P<k;P++){var N=S.children[P];u(C,S.leaf?T(N):N)}return C}function u(S,O){return S.minX=Math.min(S.minX,O.minX),S.minY=Math.min(S.minY,O.minY),S.maxX=Math.max(S.maxX,O.maxX),S.maxY=Math.max(S.maxY,O.maxY),S}function h(S,O){return S.minX-O.minX}function f(S,O){return S.minY-O.minY}function d(S){return(S.maxX-S.minX)*(S.maxY-S.minY)}function g(S){return S.maxX-S.minX+(S.maxY-S.minY)}function v(S,O){return(Math.max(O.maxX,S.maxX)-Math.min(O.minX,S.minX))*(Math.max(O.maxY,S.maxY)-Math.min(O.minY,S.minY))}function p(S,O){var k=Math.max(S.minX,O.minX),T=Math.max(S.minY,O.minY),C=Math.min(S.maxX,O.maxX),P=Math.min(S.maxY,O.maxY);return Math.max(0,C-k)*Math.max(0,P-T)}function y(S,O){return S.minX<=O.minX&&S.minY<=O.minY&&O.maxX<=S.maxX&&O.maxY<=S.maxY}function m(S,O){return O.minX<=S.maxX&&O.minY<=S.maxY&&O.maxX>=S.minX&&O.maxY>=S.minY}function w(S){return{children:S,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function E(S,O,k,T,C){for(var P=[O,k];P.length;)if(k=P.pop(),O=P.pop(),!(k-O<=T)){var N=O+Math.ceil((k-O)/T/2)*T;e(S,N,O,k,C),P.push(O,N,N,k)}}return s})})(sN);var E4=sN.exports,ot=function(n){return n.GROUP="g",n.FRAGMENT="fragment",n.CIRCLE="circle",n.ELLIPSE="ellipse",n.IMAGE="image",n.RECT="rect",n.LINE="line",n.POLYLINE="polyline",n.POLYGON="polygon",n.TEXT="text",n.PATH="path",n.HTML="html",n.MESH="mesh",n}({}),Wu=function(n){return n[n.ZERO=0]="ZERO",n[n.NEGATIVE_ONE=1]="NEGATIVE_ONE",n}({}),Ja=function(){function n(){yt(this,n),this.plugins=[]}return mt(n,[{key:"addRenderingPlugin",value:function(e){this.plugins.push(e),this.context.renderingPlugins.push(e)}},{key:"removeAllRenderingPlugins",value:function(){var e=this;this.plugins.forEach(function(r){var i=e.context.renderingPlugins.indexOf(r);i>=0&&e.context.renderingPlugins.splice(i,1)})}}])}(),S4=function(){function n(t){yt(this,n),this.clipSpaceNearZ=Wu.NEGATIVE_ONE,this.plugins=[],this.config=ie({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0,enableRenderingOptimization:!1},t)}return mt(n,[{key:"registerPlugin",value:function(e){var r=this.plugins.findIndex(function(i){return i===e});r===-1&&this.plugins.push(e)}},{key:"unregisterPlugin",value:function(e){var r=this.plugins.findIndex(function(i){return i===e});r>-1&&this.plugins.splice(r,1)}},{key:"getPlugins",value:function(){return this.plugins}},{key:"getPlugin",value:function(e){return this.plugins.find(function(r){return r.name===e})}},{key:"getConfig",value:function(){return this.config}},{key:"setConfig",value:function(e){Object.assign(this.config,e)}}])}(),Ud=Fa,Js=Ci,_4=WF,M4=GF,ME=oh,Yd=YF,Re=function(){function n(){yt(this,n),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return mt(n,[{key:"update",value:function(e,r){Js(this.center,e),Js(this.halfExtents,r),Yd(this.min,this.center,this.halfExtents),Ud(this.max,this.center,this.halfExtents)}},{key:"setMinMax",value:function(e,r){Ud(this.center,r,e),ME(this.center,this.center,.5),Yd(this.halfExtents,r,e),ME(this.halfExtents,this.halfExtents,.5),Js(this.min,e),Js(this.max,r)}},{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"add",value:function(e){if(!n.isEmpty(e)){if(n.isEmpty(this)){this.setMinMax(e.getMin(),e.getMax());return}var r=this.center,i=r[0],a=r[1],s=r[2],o=this.halfExtents,l=o[0],c=o[1],u=o[2],h=i-l,f=i+l,d=a-c,g=a+c,v=s-u,p=s+u,y=e.center,m=y[0],w=y[1],E=y[2],S=e.halfExtents,O=S[0],k=S[1],T=S[2],C=m-O,P=m+O,N=w-k,L=w+k,D=E-T,G=E+T;C<h&&(h=C),P>f&&(f=P),N<d&&(d=N),L>g&&(g=L),D<v&&(v=D),G>p&&(p=G),r[0]=(h+f)*.5,r[1]=(d+g)*.5,r[2]=(v+p)*.5,o[0]=(f-h)*.5,o[1]=(g-d)*.5,o[2]=(p-v)*.5,this.min[0]=h,this.min[1]=d,this.min[2]=v,this.max[0]=f,this.max[1]=g,this.max[2]=p}}},{key:"setFromTransformedAABB",value:function(e,r){var i=this.center,a=this.halfExtents,s=e.center,o=e.halfExtents,l=r[0],c=r[4],u=r[8],h=r[1],f=r[5],d=r[9],g=r[2],v=r[6],p=r[10],y=Math.abs(l),m=Math.abs(c),w=Math.abs(u),E=Math.abs(h),S=Math.abs(f),O=Math.abs(d),k=Math.abs(g),T=Math.abs(v),C=Math.abs(p);i[0]=r[12]+l*s[0]+c*s[1]+u*s[2],i[1]=r[13]+h*s[0]+f*s[1]+d*s[2],i[2]=r[14]+g*s[0]+v*s[1]+p*s[2],a[0]=y*o[0]+m*o[1]+w*o[2],a[1]=E*o[0]+S*o[1]+O*o[2],a[2]=k*o[0]+T*o[1]+C*o[2],Yd(this.min,i,a),Ud(this.max,i,a)}},{key:"intersects",value:function(e){var r=this.getMax(),i=this.getMin(),a=e.getMax(),s=e.getMin();return i[0]<=a[0]&&r[0]>=s[0]&&i[1]<=a[1]&&r[1]>=s[1]&&i[2]<=a[2]&&r[2]>=s[2]}},{key:"intersection",value:function(e){if(!this.intersects(e))return null;var r=new n,i=_4([0,0,0],this.getMin(),e.getMin()),a=M4([0,0,0],this.getMax(),e.getMax());return r.setMinMax(i,a),r}},{key:"getNegativeFarPoint",value:function(e){return e.pnVertexFlag===273?Js([0,0,0],this.min):e.pnVertexFlag===272?[this.min[0],this.min[1],this.max[2]]:e.pnVertexFlag===257?[this.min[0],this.max[1],this.min[2]]:e.pnVertexFlag===256?[this.min[0],this.max[1],this.max[2]]:e.pnVertexFlag===17?[this.max[0],this.min[1],this.min[2]]:e.pnVertexFlag===16?[this.max[0],this.min[1],this.max[2]]:e.pnVertexFlag===1?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]}},{key:"getPositiveFarPoint",value:function(e){return e.pnVertexFlag===273?Js([0,0,0],this.max):e.pnVertexFlag===272?[this.max[0],this.max[1],this.min[2]]:e.pnVertexFlag===257?[this.max[0],this.min[1],this.max[2]]:e.pnVertexFlag===256?[this.max[0],this.min[1],this.min[2]]:e.pnVertexFlag===17?[this.min[0],this.max[1],this.max[2]]:e.pnVertexFlag===16?[this.min[0],this.max[1],this.min[2]]:e.pnVertexFlag===1?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]}}],[{key:"isEmpty",value:function(e){return!e||e.halfExtents[0]===0&&e.halfExtents[1]===0&&e.halfExtents[2]===0}}])}(),O4=function(){function n(t,e){yt(this,n),this.distance=t||0,this.normal=e||Fe(0,1,0),this.updatePNVertexFlag()}return mt(n,[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(+(this.normal[0]>=0)<<8)+(+(this.normal[1]>=0)<<4)+ +(this.normal[2]>=0)}},{key:"distanceToPoint",value:function(e){return Pi(e,this.normal)-this.distance}},{key:"normalize",value:function(){var e=1/$P(this.normal);oh(this.normal,this.normal,e),this.distance*=e}},{key:"intersectsLine",value:function(e,r,i){var a=this.distanceToPoint(e),s=this.distanceToPoint(r),o=a/(a-s),l=o>=0&&o<=1;return l&&i&&q1(i,e,r,o),l}}])}(),Qs=function(n){return n[n.OUTSIDE=4294967295]="OUTSIDE",n[n.INSIDE=0]="INSIDE",n[n.INDETERMINATE=2147483647]="INDETERMINATE",n}({}),T4=function(){function n(t){if(yt(this,n),this.planes=[],t)this.planes=t;else for(var e=0;e<6;e++)this.planes.push(new O4)}return mt(n,[{key:"extractFromVPMatrix",value:function(e){var r=ne(e,16),i=r[0],a=r[1],s=r[2],o=r[3],l=r[4],c=r[5],u=r[6],h=r[7],f=r[8],d=r[9],g=r[10],v=r[11],p=r[12],y=r[13],m=r[14],w=r[15];Kn(this.planes[0].normal,o-i,h-l,v-f),this.planes[0].distance=w-p,Kn(this.planes[1].normal,o+i,h+l,v+f),this.planes[1].distance=w+p,Kn(this.planes[2].normal,o+a,h+c,v+d),this.planes[2].distance=w+y,Kn(this.planes[3].normal,o-a,h-c,v-d),this.planes[3].distance=w-y,Kn(this.planes[4].normal,o-s,h-u,v-g),this.planes[4].distance=w-m,Kn(this.planes[5].normal,o+s,h+u,v+g),this.planes[5].distance=w+m,this.planes.forEach(function(E){E.normalize(),E.updatePNVertexFlag()})}}])}(),zn=function(){function n(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;yt(this,n),this.x=0,this.y=0,this.x=t,this.y=e}return mt(n,[{key:"clone",value:function(){return new n(this.x,this.y)}},{key:"copyFrom",value:function(e){this.x=e.x,this.y=e.y}}])}(),Co=function(){function n(t,e,r,i){yt(this,n),this.x=t,this.y=e,this.width=r,this.height=i,this.left=t,this.right=t+r,this.top=e,this.bottom=e+i}return mt(n,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(e){return new n(e.x,e.y,e.width,e.height)}},{key:"applyTransform",value:function(e,r){var i=ul(e.x,e.y,0,1),a=ul(e.x+e.width,e.y,0,1),s=ul(e.x,e.y+e.height,0,1),o=ul(e.x+e.width,e.y+e.height,0,1),l=Ni(),c=Ni(),u=Ni(),h=Ni();ra(l,i,r),ra(c,a,r),ra(u,s,r),ra(h,o,r);var f=Math.min(l[0],c[0],u[0],h[0]),d=Math.min(l[1],c[1],u[1],h[1]),g=Math.max(l[0],c[0],u[0],h[0]),v=Math.max(l[1],c[1],u[1],h[1]);return n.fromRect({x:f,y:d,width:g-f,height:v-d})}}])}(),Ee="Method not implemented.",to="Use document.documentElement instead.",k4="Cannot append a destroyed element.";function wo(n){return n===void 0?0:n>360||n<-360?n%360:n}var Xd=ge();function rr(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;return Array.isArray(n)&&n.length===3?r?Ui(n):Ci(Xd,n):Lt(n)?r?Fe(n,t,e):Kn(Xd,n,t,e):r?Fe(n[0],n[1]||t,n[2]||e):Kn(Xd,n[0],n[1]||t,n[2]||e)}var A4=Math.PI/180;function Se(n){return n*A4}var C4=180/Math.PI;function br(n){return n*C4}function P4(n){return 360*n}var gh=Math.PI/2;function N4(n,t){var e=t[0],r=t[1],i=t[2],a=t[3],s=e*e,o=r*r,l=i*i,c=a*a,u=s+o+l+c,h=e*a-r*i;return h>.499995*u?(n[0]=gh,n[1]=2*Math.atan2(r,e),n[2]=0):h<-.499995*u?(n[0]=-gh,n[1]=2*Math.atan2(r,e),n[2]=0):(n[0]=Math.asin(2*(e*i-a*r)),n[1]=Math.atan2(2*(e*a+r*i),1-2*(l+c)),n[2]=Math.atan2(2*(e*r+i*a),1-2*(o+l))),n}function R4(n,t){var e,r,i=ko(ge(),t),a=ne(i,3),s=a[0],o=a[1],l=a[2],c=Math.asin(-t[2]/s);return c<gh?c>-gh?(e=Math.atan2(t[6]/o,t[10]/l),r=Math.atan2(t[1]/s,t[0]/s)):(r=0,e=-Math.atan2(t[4]/o,t[5]/o)):(r=0,e=Math.atan2(t[4]/o,t[5]/o)),n[0]=e,n[1]=c,n[2]=r,n}function Kd(n,t){return t.length===16?R4(n,t):N4(n,t)}function L4(n,t,e,r,i){var a=Math.cos(n),s=Math.sin(n);return SF(r*a,i*s,0,-r*s,i*a,0,t,e,1)}function I4(n,t,e,r,i,a,s){var o=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,l=2*a,c=e-t,u=r-i,h=l/c,f=l/u,d=(e+t)/c,g=(r+i)/u,v,p,y=s-a,m=s*a;return o?(v=-s/y,p=-m/y):(v=-(s+a)/y,p=-2*m/y),n[0]=h,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=f,n[6]=0,n[7]=0,n[8]=d,n[9]=g,n[10]=v,n[11]=-1,n[12]=0,n[13]=0,n[14]=p,n[15]=0,n}function OE(n){var t=n[0],e=n[1],r=n[3],i=n[4],a=Math.sqrt(t*t+e*e),s=Math.sqrt(r*r+i*i),o=t*i-e*r;if(o<0&&(t<i?a=-a:s=-s),a){var l=1/a;t*=l,e*=l}if(s){var c=1/s;r*=c,i*=c}var u=Math.atan2(e,t),h=br(u);return[n[6],n[7],a,s,h]}var xi=Ne(),ii=Ne(),Jo=Ni(),Xt=[ge(),ge(),ge()],TE=ge();function D4(n,t,e,r,i,a){if(!F4(xi,n)||(To(ii,xi),ii[3]=0,ii[7]=0,ii[11]=0,ii[15]=1,Math.abs(TP(ii))<1e-8))return!1;var s=xi[3],o=xi[7],l=xi[11],c=xi[12],u=xi[13],h=xi[14],f=xi[15];if(s!==0||o!==0||l!==0){Jo[0]=s,Jo[1]=o,Jo[2]=l,Jo[3]=f;var d=Ai(ii,ii);if(!d)return!1;OP(ii,ii),ra(i,Jo,ii)}else i[0]=i[1]=i[2]=0,i[3]=1;if(t[0]=c,t[1]=u,t[2]=h,B4(Xt,xi),e[0]=Ji(Xt[0]),Os(Xt[0],Xt[0]),r[0]=Pi(Xt[0],Xt[1]),Zd(Xt[1],Xt[1],Xt[0],1,-r[0]),e[1]=Ji(Xt[1]),Os(Xt[1],Xt[1]),r[0]/=e[1],r[1]=Pi(Xt[0],Xt[2]),Zd(Xt[2],Xt[2],Xt[0],1,-r[1]),r[2]=Pi(Xt[1],Xt[2]),Zd(Xt[2],Xt[2],Xt[1],1,-r[2]),e[2]=Ji(Xt[2]),Os(Xt[2],Xt[2]),r[1]/=e[2],r[2]/=e[2],$u(TE,Xt[1],Xt[2]),Pi(Xt[0],TE)<0)for(var g=0;g<3;g++)e[g]*=-1,Xt[g][0]*=-1,Xt[g][1]*=-1,Xt[g][2]*=-1;return a[0]=.5*Math.sqrt(Math.max(1+Xt[0][0]-Xt[1][1]-Xt[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-Xt[0][0]+Xt[1][1]-Xt[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-Xt[0][0]-Xt[1][1]+Xt[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+Xt[0][0]+Xt[1][1]+Xt[2][2],0)),Xt[2][1]>Xt[1][2]&&(a[0]=-a[0]),Xt[0][2]>Xt[2][0]&&(a[1]=-a[1]),Xt[1][0]>Xt[0][1]&&(a[2]=-a[2]),!0}function F4(n,t){var e=t[15];if(e===0)return!1;for(var r=1/e,i=0;i<16;i++)n[i]=t[i]*r;return!0}function B4(n,t){n[0][0]=t[0],n[0][1]=t[1],n[0][2]=t[2],n[1][0]=t[4],n[1][1]=t[5],n[1][2]=t[6],n[2][0]=t[8],n[2][1]=t[9],n[2][2]=t[10]}function Zd(n,t,e,r,i){n[0]=t[0]*r+e[0]*i,n[1]=t[1]*r+e[1]*i,n[2]=t[2]*r+e[2]*i}var xe=function(n){return n[n.ORBITING=0]="ORBITING",n[n.EXPLORING=1]="EXPLORING",n[n.TRACKING=2]="TRACKING",n}({}),J1=function(n){return n[n.DEFAULT=0]="DEFAULT",n[n.ROTATIONAL=1]="ROTATIONAL",n[n.TRANSLATIONAL=2]="TRANSLATIONAL",n[n.CINEMATIC=3]="CINEMATIC",n}({}),Yr=function(n){return n[n.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",n[n.PERSPECTIVE=1]="PERSPECTIVE",n}({}),oN={UPDATED:"updated"},kE=2e-4,lN=function(){function n(){yt(this,n),this.clipSpaceNearZ=Wu.NEGATIVE_ONE,this.eventEmitter=new EP,this.matrix=Ne(),this.right=Fe(1,0,0),this.up=Fe(0,1,0),this.forward=Fe(0,0,1),this.position=Fe(0,0,1),this.focalPoint=Fe(0,0,0),this.distanceVector=Fe(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=Ne(),this.projectionMatrixInverse=Ne(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=xe.EXPLORING,this.trackingMode=J1.DEFAULT,this.projectionMode=Yr.PERSPECTIVE,this.frustum=new T4,this.orthoMatrix=Ne()}return mt(n,[{key:"isOrtho",value:function(){return this.projectionMode===Yr.ORTHOGRAPHIC}},{key:"getProjectionMode",value:function(){return this.projectionMode}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse}},{key:"getFrustum",value:function(){return this.frustum}},{key:"getPosition",value:function(){return this.position}},{key:"getFocalPoint",value:function(){return this.focalPoint}},{key:"getDollyingStep",value:function(){return this.dollyingStep}},{key:"getNear",value:function(){return this.near}},{key:"getFar",value:function(){return this.far}},{key:"getZoom",value:function(){return this.zoom}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix}},{key:"getView",value:function(){return this.view}},{key:"setEnableUpdate",value:function(e){this.enableUpdate=e}},{key:"setType",value:function(e,r){return this.type=e,this.type===xe.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===xe.TRACKING&&r!==void 0&&this.setTrackingMode(r),this}},{key:"setProjectionMode",value:function(e){return this.projectionMode=e,this}},{key:"setTrackingMode",value:function(e){if(this.type!==xe.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=e,this}},{key:"setWorldRotation",value:function(e){return this.rotateWorld=e,this._getAngles(),this}},{key:"getViewTransform",value:function(){return Ai(Ne(),this.matrix)}},{key:"getWorldTransform",value:function(){return this.matrix}},{key:"jitterProjectionMatrix",value:function(e,r){var i=Ta(Ne(),[e,r,0]);this.jitteredProjectionMatrix=Zn(Ne(),i,this.projectionMatrix)}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0}},{key:"setMatrix",value:function(e){return this.matrix=e,this._update(),this}},{key:"setProjectionMatrix",value:function(e){this.projectionMatrix=e}},{key:"setFov",value:function(e){return this.setPerspective(this.near,this.far,e,this.aspect),this}},{key:"setAspect",value:function(e){return this.setPerspective(this.near,this.far,this.fov,e),this}},{key:"setNear",value:function(e){return this.projectionMode===Yr.PERSPECTIVE?this.setPerspective(e,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,e,this.far),this}},{key:"setFar",value:function(e){return this.projectionMode===Yr.PERSPECTIVE?this.setPerspective(this.near,e,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,e),this}},{key:"setViewOffset",value:function(e,r,i,a,s,o){return this.aspect=e/r,this.view===void 0&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=r,this.view.offsetX=i,this.view.offsetY=a,this.view.width=s,this.view.height=o,this.projectionMode===Yr.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"clearViewOffset",value:function(){return this.view!==void 0&&(this.view.enabled=!1),this.projectionMode===Yr.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"setZoom",value:function(e){return this.zoom=e,this.projectionMode===Yr.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===Yr.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this}},{key:"setZoomByViewportPoint",value:function(e,r){var i=this.canvas.viewport2Canvas({x:r[0],y:r[1]}),a=i.x,s=i.y,o=this.roll;this.rotate(0,0,-o),this.setPosition(a,s),this.setFocalPoint(a,s),this.setZoom(e),this.rotate(0,0,o);var l=this.canvas.viewport2Canvas({x:r[0],y:r[1]}),c=l.x,u=l.y,h=Fe(c-a,u-s,0),f=Pi(h,this.right)/Ji(this.right),d=Pi(h,this.up)/Ji(this.up),g=this.getPosition(),v=ne(g,2),p=v[0],y=v[1],m=this.getFocalPoint(),w=ne(m,2),E=w[0],S=w[1];return this.setPosition(p-f,y-d),this.setFocalPoint(E-f,S-d),this}},{key:"setPerspective",value:function(e,r,i,a){var s;this.projectionMode=Yr.PERSPECTIVE,this.fov=i,this.near=e,this.far=r,this.aspect=a;var o=this.near*Math.tan(Se(.5*this.fov))/this.zoom,l=2*o,c=this.aspect*l,u=-.5*c;if((s=this.view)!==null&&s!==void 0&&s.enabled){var h=this.view.fullWidth,f=this.view.fullHeight;u+=this.view.offsetX*c/h,o-=this.view.offsetY*l/f,c*=this.view.width/h,l*=this.view.height/f}return I4(this.projectionMatrix,u,u+c,o-l,o,e,this.far,this.clipSpaceNearZ===Wu.ZERO),Ai(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this}},{key:"setOrthographic",value:function(e,r,i,a,s,o){var l;this.projectionMode=Yr.ORTHOGRAPHIC,this.rright=r,this.left=e,this.top=i,this.bottom=a,this.near=s,this.far=o;var c=(this.rright-this.left)/(2*this.zoom),u=(this.top-this.bottom)/(2*this.zoom),h=(this.rright+this.left)/2,f=(this.top+this.bottom)/2,d=h-c,g=h+c,v=f+u,p=f-u;if((l=this.view)!==null&&l!==void 0&&l.enabled){var y=(this.rright-this.left)/this.view.fullWidth/this.zoom,m=(this.top-this.bottom)/this.view.fullHeight/this.zoom;d+=y*this.view.offsetX,g=d+y*this.view.width,v-=m*this.view.offsetY,p=v-m*this.view.height}return this.clipSpaceNearZ===Wu.NEGATIVE_ONE?FP(this.projectionMatrix,d,g,v,p,s,o):BP(this.projectionMatrix,d,g,v,p,s,o),Ai(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this}},{key:"setPosition",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.position[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.position[2],a=rr(e,r,i);return this._setPosition(a),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this}},{key:"setFocalPoint",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.focalPoint[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.focalPoint[2],a=Fe(0,1,0);if(this.focalPoint=rr(e,r,i),this.trackingMode===J1.CINEMATIC){var s=j1(ge(),this.focalPoint,this.position);e=s[0],r=s[1],i=s[2];var o=Ji(s),l=br(Math.asin(r/o)),c=90+br(Math.atan2(i,e)),u=Ne();CP(u,u,Se(c)),AP(u,u,Se(l)),a=Jn(ge(),[0,1,0],u)}return Ai(this.matrix,zP(Ne(),this.position,this.focalPoint,a)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this}},{key:"getDistance",value:function(){return this.distance}},{key:"getDistanceVector",value:function(){return this.distanceVector}},{key:"setDistance",value:function(e){if(this.distance===e||e<0)return this;this.distance=e,this.distance<kE&&(this.distance=kE),this.dollyingStep=this.distance/100;var r=ge();e=this.distance;var i=this.forward,a=this.focalPoint;return r[0]=e*i[0]+a[0],r[1]=e*i[1]+a[1],r[2]=e*i[2]+a[2],this._setPosition(r),this.triggerUpdate(),this}},{key:"setMaxDistance",value:function(e){return this.maxDistance=e,this}},{key:"setMinDistance",value:function(e){return this.minDistance=e,this}},{key:"setAzimuth",value:function(e){return this.azimuth=wo(e),this.computeMatrix(),this._getAxes(),this.type===xe.ORBITING||this.type===xe.EXPLORING?this._getPosition():this.type===xe.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getAzimuth",value:function(){return this.azimuth}},{key:"setElevation",value:function(e){return this.elevation=wo(e),this.computeMatrix(),this._getAxes(),this.type===xe.ORBITING||this.type===xe.EXPLORING?this._getPosition():this.type===xe.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getElevation",value:function(){return this.elevation}},{key:"setRoll",value:function(e){return this.roll=wo(e),this.computeMatrix(),this._getAxes(),this.type===xe.ORBITING||this.type===xe.EXPLORING?this._getPosition():this.type===xe.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getRoll",value:function(){return this.roll}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()}},{key:"computeMatrix",value:function(){var e=Aa(_n(),[0,0,1],Se(this.roll));Wa(this.matrix);var r=Aa(_n(),[1,0,0],Se((this.rotateWorld&&this.type!==xe.TRACKING||this.type===xe.TRACKING?1:-1)*this.elevation)),i=Aa(_n(),[0,1,0],Se((this.rotateWorld&&this.type!==xe.TRACKING||this.type===xe.TRACKING?1:-1)*this.azimuth)),a=Ba(_n(),i,r);a=Ba(_n(),a,e);var s=fw(Ne(),a);this.type===xe.ORBITING||this.type===xe.EXPLORING?(bo(this.matrix,this.matrix,this.focalPoint),Zn(this.matrix,this.matrix,s),bo(this.matrix,this.matrix,[0,0,this.distance])):this.type===xe.TRACKING&&(bo(this.matrix,this.matrix,this.position),Zn(this.matrix,this.matrix,s))}},{key:"_setPosition",value:function(e,r,i){this.position=rr(e,r,i);var a=this.matrix;a[12]=this.position[0],a[13]=this.position[1],a[14]=this.position[2],a[15]=1,this._getOrthoMatrix()}},{key:"_getAxes",value:function(){Ci(this.right,rr(ra(Ni(),[1,0,0,0],this.matrix))),Ci(this.up,rr(ra(Ni(),[0,1,0,0],this.matrix))),Ci(this.forward,rr(ra(Ni(),[0,0,1,0],this.matrix))),Os(this.right,this.right),Os(this.up,this.up),Os(this.forward,this.forward)}},{key:"_getAngles",value:function(){var e=this.distanceVector[0],r=this.distanceVector[1],i=this.distanceVector[2],a=Ji(this.distanceVector);if(a===0){this.elevation=0,this.azimuth=0;return}this.type===xe.TRACKING?(this.elevation=br(Math.asin(r/a)),this.azimuth=br(Math.atan2(-e,-i))):this.rotateWorld?(this.elevation=br(Math.asin(r/a)),this.azimuth=br(Math.atan2(-e,-i))):(this.elevation=-br(Math.asin(r/a)),this.azimuth=-br(Math.atan2(-e,-i)))}},{key:"_getPosition",value:function(){Ci(this.position,rr(ra(Ni(),[0,0,0,1],this.matrix))),this._getDistance()}},{key:"_getFocalPoint",value:function(){HF(this.distanceVector,[0,0,-this.distance],EF(SP(),this.matrix)),Fa(this.focalPoint,this.position,this.distanceVector),this._getDistance()}},{key:"_getDistance",value:function(){this.distanceVector=j1(ge(),this.focalPoint,this.position),this.distance=Ji(this.distanceVector),this.dollyingStep=this.distance/100}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===Yr.ORTHOGRAPHIC){var e=this.position,r=Aa(_n(),[0,0,1],-this.roll*Math.PI/180);Al(this.orthoMatrix,r,Fe((this.rright-this.left)/2-e[0],(this.top-this.bottom)/2-e[1],0),Fe(this.zoom,this.zoom,1),e)}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var e=this.getViewTransform(),r=Zn(Ne(),this.getPerspective(),e);this.getFrustum().extractFromVPMatrix(r),this.eventEmitter.emit(oN.UPDATED)}}},{key:"rotate",value:function(e,r,i){throw new Error(Ee)}},{key:"pan",value:function(e,r){throw new Error(Ee)}},{key:"dolly",value:function(e){throw new Error(Ee)}},{key:"createLandmark",value:function(e,r){throw new Error(Ee)}},{key:"gotoLandmark",value:function(e,r){throw new Error(Ee)}},{key:"cancelLandmarkAnimation",value:function(){throw new Error(Ee)}}])}(),z4=function(n){return n[n.Standard=0]="Standard",n}({}),ph=function(n){return n[n.ADDED=0]="ADDED",n[n.REMOVED=1]="REMOVED",n[n.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",n}({}),cN={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Co(0,0,0,0)},kt=function(n){return n.COORDINATE="<coordinate>",n.COLOR="<color>",n.PAINT="<paint>",n.NUMBER="<number>",n.ANGLE="<angle>",n.OPACITY_VALUE="<opacity-value>",n.SHADOW_BLUR="<shadow-blur>",n.LENGTH="<length>",n.PERCENTAGE="<percentage>",n.LENGTH_PERCENTAGE="<length> | <percentage>",n.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",n.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",n.LIST_OF_POINTS="<list-of-points>",n.PATH="<path>",n.FILTER="<filter>",n.Z_INDEX="<z-index>",n.OFFSET_DISTANCE="<offset-distance>",n.DEFINED_PATH="<defined-path>",n.MARKER="<marker>",n.TRANSFORM="<transform>",n.TRANSFORM_ORIGIN="<transform-origin>",n.TEXT="<text>",n.TEXT_TRANSFORM="<text-transform>",n}({});function vw(n,t,e){n.prototype=t.prototype=e,e.constructor=n}function uN(n,t){var e=Object.create(n.prototype);for(var r in t)e[r]=t[r];return e}function hc(){}var Vl=.7,vh=1/Vl,xo="\\s*([+-]?\\d+)\\s*",Hl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ii="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",j4=/^#([0-9a-f]{3,8})$/,q4=new RegExp(`^rgb\\(${xo},${xo},${xo}\\)$`),$4=new RegExp(`^rgb\\(${Ii},${Ii},${Ii}\\)$`),G4=new RegExp(`^rgba\\(${xo},${xo},${xo},${Hl}\\)$`),W4=new RegExp(`^rgba\\(${Ii},${Ii},${Ii},${Hl}\\)$`),V4=new RegExp(`^hsl\\(${Hl},${Ii},${Ii}\\)$`),H4=new RegExp(`^hsla\\(${Hl},${Ii},${Ii},${Hl}\\)$`),AE={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};vw(hc,Zh,{copy(n){return Object.assign(new this.constructor,this,n)},displayable(){return this.rgb().displayable()},hex:CE,formatHex:CE,formatHex8:U4,formatHsl:Y4,formatRgb:PE,toString:PE});function CE(){return this.rgb().formatHex()}function U4(){return this.rgb().formatHex8()}function Y4(){return hN(this).formatHsl()}function PE(){return this.rgb().formatRgb()}function Zh(n){var t,e;return n=(n+"").trim().toLowerCase(),(t=j4.exec(n))?(e=t[1].length,t=parseInt(t[1],16),e===6?NE(t):e===3?new Er(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):e===8?Vc(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):e===4?Vc(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=q4.exec(n))?new Er(t[1],t[2],t[3],1):(t=$4.exec(n))?new Er(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=G4.exec(n))?Vc(t[1],t[2],t[3],t[4]):(t=W4.exec(n))?Vc(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=V4.exec(n))?IE(t[1],t[2]/100,t[3]/100,1):(t=H4.exec(n))?IE(t[1],t[2]/100,t[3]/100,t[4]):AE.hasOwnProperty(n)?NE(AE[n]):n==="transparent"?new Er(NaN,NaN,NaN,0):null}function NE(n){return new Er(n>>16&255,n>>8&255,n&255,1)}function Vc(n,t,e,r){return r<=0&&(n=t=e=NaN),new Er(n,t,e,r)}function X4(n){return n instanceof hc||(n=Zh(n)),n?(n=n.rgb(),new Er(n.r,n.g,n.b,n.opacity)):new Er}function K4(n,t,e,r){return arguments.length===1?X4(n):new Er(n,t,e,r??1)}function Er(n,t,e,r){this.r=+n,this.g=+t,this.b=+e,this.opacity=+r}vw(Er,K4,uN(hc,{brighter(n){return n=n==null?vh:Math.pow(vh,n),new Er(this.r*n,this.g*n,this.b*n,this.opacity)},darker(n){return n=n==null?Vl:Math.pow(Vl,n),new Er(this.r*n,this.g*n,this.b*n,this.opacity)},rgb(){return this},clamp(){return new Er(Ts(this.r),Ts(this.g),Ts(this.b),yh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:RE,formatHex:RE,formatHex8:Z4,formatRgb:LE,toString:LE}));function RE(){return`#${bs(this.r)}${bs(this.g)}${bs(this.b)}`}function Z4(){return`#${bs(this.r)}${bs(this.g)}${bs(this.b)}${bs((isNaN(this.opacity)?1:this.opacity)*255)}`}function LE(){const n=yh(this.opacity);return`${n===1?"rgb(":"rgba("}${Ts(this.r)}, ${Ts(this.g)}, ${Ts(this.b)}${n===1?")":`, ${n})`}`}function yh(n){return isNaN(n)?1:Math.max(0,Math.min(1,n))}function Ts(n){return Math.max(0,Math.min(255,Math.round(n)||0))}function bs(n){return n=Ts(n),(n<16?"0":"")+n.toString(16)}function IE(n,t,e,r){return r<=0?n=t=e=NaN:e<=0||e>=1?n=t=NaN:t<=0&&(n=NaN),new li(n,t,e,r)}function hN(n){if(n instanceof li)return new li(n.h,n.s,n.l,n.opacity);if(n instanceof hc||(n=Zh(n)),!n)return new li;if(n instanceof li)return n;n=n.rgb();var t=n.r/255,e=n.g/255,r=n.b/255,i=Math.min(t,e,r),a=Math.max(t,e,r),s=NaN,o=a-i,l=(a+i)/2;return o?(t===a?s=(e-r)/o+(e<r)*6:e===a?s=(r-t)/o+2:s=(t-e)/o+4,o/=l<.5?a+i:2-a-i,s*=60):o=l>0&&l<1?0:s,new li(s,o,l,n.opacity)}function J4(n,t,e,r){return arguments.length===1?hN(n):new li(n,t,e,r??1)}function li(n,t,e,r){this.h=+n,this.s=+t,this.l=+e,this.opacity=+r}vw(li,J4,uN(hc,{brighter(n){return n=n==null?vh:Math.pow(vh,n),new li(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?Vl:Math.pow(Vl,n),new li(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=this.h%360+(this.h<0)*360,t=isNaN(n)||isNaN(this.s)?0:this.s,e=this.l,r=e+(e<.5?e:1-e)*t,i=2*e-r;return new Er(Jd(n>=240?n-240:n+120,i,r),Jd(n,i,r),Jd(n<120?n+240:n-120,i,r),this.opacity)},clamp(){return new li(DE(this.h),Hc(this.s),Hc(this.l),yh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const n=yh(this.opacity);return`${n===1?"hsl(":"hsla("}${DE(this.h)}, ${Hc(this.s)*100}%, ${Hc(this.l)*100}%${n===1?")":`, ${n})`}`}}));function DE(n){return n=(n||0)%360,n<0?n+360:n}function Hc(n){return Math.max(0,Math.min(1,n||0))}function Jd(n,t,e){return(n<60?t+(e-t)*n/60:n<180?e:n<240?t+(e-t)*(240-n)/60:t)*255}function wn(n,t){if(typeof n!="function"||t!=null&&typeof t!="function")throw new TypeError("Expected a function");var e=function(){for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];var o=t?t.apply(this,a):a[0],l=e.cache;if(l.has(o))return l.get(o);var c=n.apply(this,a);return e.cache=l.set(o,c)||l,c};return e.cache=new(wn.Cache||Map),wn.cacheList.push(e.cache),e}wn.Cache=Map;wn.cacheList=[];wn.clearCache=function(){wn.cacheList.forEach(function(n){return n.clear()})};var Ct=function(n){return n[n.kUnknown=0]="kUnknown",n[n.kNumber=1]="kNumber",n[n.kPercentage=2]="kPercentage",n[n.kEms=3]="kEms",n[n.kPixels=4]="kPixels",n[n.kRems=5]="kRems",n[n.kDegrees=6]="kDegrees",n[n.kRadians=7]="kRadians",n[n.kGradians=8]="kGradians",n[n.kTurns=9]="kTurns",n[n.kMilliseconds=10]="kMilliseconds",n[n.kSeconds=11]="kSeconds",n[n.kInteger=12]="kInteger",n}({}),oi=function(n){return n[n.kUNumber=0]="kUNumber",n[n.kUPercent=1]="kUPercent",n[n.kULength=2]="kULength",n[n.kUAngle=3]="kUAngle",n[n.kUTime=4]="kUTime",n[n.kUOther=5]="kUOther",n}({}),Q4=function(n){return n[n.kYes=0]="kYes",n[n.kNo=1]="kNo",n}({}),t5=function(n){return n[n.kYes=0]="kYes",n[n.kNo=1]="kNo",n}({}),e5=[{name:"em",unit_type:Ct.kEms},{name:"px",unit_type:Ct.kPixels},{name:"deg",unit_type:Ct.kDegrees},{name:"rad",unit_type:Ct.kRadians},{name:"grad",unit_type:Ct.kGradians},{name:"ms",unit_type:Ct.kMilliseconds},{name:"s",unit_type:Ct.kSeconds},{name:"rem",unit_type:Ct.kRems},{name:"turn",unit_type:Ct.kTurns}],Po=function(n){return n[n.kUnknownType=0]="kUnknownType",n[n.kUnparsedType=1]="kUnparsedType",n[n.kKeywordType=2]="kKeywordType",n[n.kUnitType=3]="kUnitType",n[n.kSumType=4]="kSumType",n[n.kProductType=5]="kProductType",n[n.kNegateType=6]="kNegateType",n[n.kInvertType=7]="kInvertType",n[n.kMinType=8]="kMinType",n[n.kMaxType=9]="kMaxType",n[n.kClampType=10]="kClampType",n[n.kTransformType=11]="kTransformType",n[n.kPositionType=12]="kPositionType",n[n.kURLImageType=13]="kURLImageType",n[n.kColorType=14]="kColorType",n[n.kUnsupportedColorType=15]="kUnsupportedColorType",n}({}),n5=function(t){return e5.find(function(e){return e.name===t}).unit_type},r5=function(t){return t?t==="number"?Ct.kNumber:t==="percent"||t==="%"?Ct.kPercentage:n5(t):Ct.kUnknown},i5=function(t){switch(t){case Ct.kNumber:case Ct.kInteger:return oi.kUNumber;case Ct.kPercentage:return oi.kUPercent;case Ct.kPixels:return oi.kULength;case Ct.kMilliseconds:case Ct.kSeconds:return oi.kUTime;case Ct.kDegrees:case Ct.kRadians:case Ct.kGradians:case Ct.kTurns:return oi.kUAngle;default:return oi.kUOther}},a5=function(t){switch(t){case oi.kUNumber:return Ct.kNumber;case oi.kULength:return Ct.kPixels;case oi.kUPercent:return Ct.kPercentage;case oi.kUTime:return Ct.kSeconds;case oi.kUAngle:return Ct.kDegrees;default:return Ct.kUnknown}},FE=function(t){var e=1;switch(t){case Ct.kPixels:case Ct.kDegrees:case Ct.kSeconds:break;case Ct.kMilliseconds:e=.001;break;case Ct.kRadians:e=180/Math.PI;break;case Ct.kGradians:e=.9;break;case Ct.kTurns:e=360;break}return e},Q1=function(t){switch(t){case Ct.kNumber:case Ct.kInteger:return"";case Ct.kPercentage:return"%";case Ct.kEms:return"em";case Ct.kRems:return"rem";case Ct.kPixels:return"px";case Ct.kDegrees:return"deg";case Ct.kRadians:return"rad";case Ct.kGradians:return"grad";case Ct.kMilliseconds:return"ms";case Ct.kSeconds:return"s";case Ct.kTurns:return"turn"}return""},Jh=function(){function n(){yt(this,n)}return mt(n,[{key:"toString",value:function(){return this.buildCSSText(Q4.kNo,t5.kNo,"")}},{key:"isNumericValue",value:function(){return this.getType()>=Po.kUnitType&&this.getType()<=Po.kClampType}}],[{key:"isAngle",value:function(e){return e===Ct.kDegrees||e===Ct.kRadians||e===Ct.kGradians||e===Ct.kTurns}},{key:"isLength",value:function(e){return e>=Ct.kEms&&e<Ct.kDegrees}},{key:"isRelativeUnit",value:function(e){return e===Ct.kPercentage||e===Ct.kEms||e===Ct.kRems}},{key:"isTime",value:function(e){return e===Ct.kSeconds||e===Ct.kMilliseconds}}])}(),s5=function(n){function t(e){var r;return yt(this,t),r=ae(this,t),r.colorSpace=e,r}return se(t,n),mt(t,[{key:"getType",value:function(){return Po.kColorType}},{key:"to",value:function(r){return this}}])}(Jh),Ca=function(n){return n[n.Constant=0]="Constant",n[n.LinearGradient=1]="LinearGradient",n[n.RadialGradient=2]="RadialGradient",n}({}),Uc=function(n){function t(e,r){var i;return yt(this,t),i=ae(this,t),i.type=e,i.value=r,i}return se(t,n),mt(t,[{key:"clone",value:function(){return new t(this.type,this.value)}},{key:"buildCSSText",value:function(r,i,a){return a}},{key:"getType",value:function(){return Po.kColorType}}])}(Jh),Jr=function(n){function t(e){var r;return yt(this,t),r=ae(this,t),r.value=e,r}return se(t,n),mt(t,[{key:"clone",value:function(){return new t(this.value)}},{key:"getType",value:function(){return Po.kKeywordType}},{key:"buildCSSText",value:function(r,i,a){return a+this.value}}])}(Jh),o5=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",r="";return Number.isFinite(t)?r="NaN":t>0?r="infinity":r="-infinity",r+=e},tb=function(t){return a5(i5(t))},Cn=function(n){function t(e){var r,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ct.kNumber;yt(this,t),r=ae(this,t);var a;return typeof i=="string"?a=r5(i):a=i,r.unit=a,r.value=e,r}return se(t,n),mt(t,[{key:"clone",value:function(){return new t(this.value,this.unit)}},{key:"equals",value:function(r){var i=r;return this.value===i.value&&this.unit===i.unit}},{key:"getType",value:function(){return Po.kUnitType}},{key:"convertTo",value:function(r){if(this.unit===r)return new t(this.value,this.unit);var i=tb(this.unit);if(i!==tb(r)||i===Ct.kUnknown)return null;var a=FE(this.unit)/FE(r);return new t(this.value*a,r)}},{key:"buildCSSText",value:function(r,i,a){var s;switch(this.unit){case Ct.kUnknown:break;case Ct.kInteger:s=Number(this.value).toFixed(0);break;case Ct.kNumber:case Ct.kPercentage:case Ct.kEms:case Ct.kRems:case Ct.kPixels:case Ct.kDegrees:case Ct.kRadians:case Ct.kGradians:case Ct.kMilliseconds:case Ct.kSeconds:case Ct.kTurns:{var o=-999999,l=999999,c=this.value,u=Q1(this.unit);if(c<o||c>l){var h=Q1(this.unit);!Number.isFinite(c)||Number.isNaN(c)?s=o5(c,h):s=c+(h||"")}else s="".concat(c).concat(u)}}return a+=s,a}}])}(Jh),ai=new Cn(0,"px");new Cn(1,"px");var Rs=new Cn(0,"deg"),yw=function(n){function t(e,r,i){var a,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return yt(this,t),a=ae(this,t,["rgb"]),a.r=e,a.g=r,a.b=i,a.alpha=s,a.isNone=o,a}return se(t,n),mt(t,[{key:"clone",value:function(){return new t(this.r,this.g,this.b,this.alpha)}},{key:"buildCSSText",value:function(r,i,a){return"".concat(a,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")}}])}(s5),BE=new Jr("unset"),l5=new Jr("initial"),c5=new Jr("inherit"),Qd={"":BE,unset:BE,initial:l5,inherit:c5},u5=function(t){return Qd[t]||(Qd[t]=new Jr(t)),Qd[t]},fN=new yw(0,0,0,0,!0),dN=new yw(0,0,0,0),h5=wn(function(n,t,e,r){return new yw(n,t,e,r)},function(n,t,e,r){return"rgba(".concat(n,",").concat(t,",").concat(e,",").concat(r,")")}),He=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ct.kNumber;return new Cn(t,e)};new Cn(50,"%");function f5(n){var t=n.type,e=n.value;return t==="hex"?"#".concat(e):t==="literal"?e:t==="rgb"?"rgb(".concat(e.join(","),")"):"rgba(".concat(e.join(","),")")}var d5=function(){var n={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},t="";function e(q){throw new Error("".concat(t,": ").concat(q))}function r(){var q=i();return t.length>0&&e("Invalid input not EOF"),q}function i(){return w(a)}function a(){return s("linear-gradient",n.linearGradient,l)||s("repeating-linear-gradient",n.repeatingLinearGradient,l)||s("radial-gradient",n.radialGradient,h)||s("repeating-radial-gradient",n.repeatingRadialGradient,h)||s("conic-gradient",n.conicGradient,h)}function s(q,z,Z){return o(z,function(at){var ft=Z();return ft&&(H(n.comma)||e("Missing comma before color stops")),{type:q,orientation:ft,colorStops:w(E)}})}function o(q,z){var Z=H(q);if(Z){H(n.startCall)||e("Missing (");var at=z(Z);return H(n.endCall)||e("Missing )"),at}}function l(){return c()||u()}function c(){return G("directional",n.sideOrCorner,1)}function u(){return G("angular",n.angleValue,1)}function h(){var q,z=f(),Z;return z&&(q=[],q.push(z),Z=t,H(n.comma)&&(z=f(),z?q.push(z):t=Z)),q}function f(){var q=d()||g();if(q)q.at=p();else{var z=v();if(z){q=z;var Z=p();Z&&(q.at=Z)}else{var at=y();at&&(q={type:"default-radial",at})}}return q}function d(){var q=G("shape",/^(circle)/i,0);return q&&(q.style=D()||v()),q}function g(){var q=G("shape",/^(ellipse)/i,0);return q&&(q.style=N()||v()),q}function v(){return G("extent-keyword",n.extentKeywords,1)}function p(){if(G("position",/^at/,0)){var q=y();return q||e("Missing positioning value"),q}}function y(){var q=m();if(q.x||q.y)return{type:"position",value:q}}function m(){return{x:N(),y:N()}}function w(q){var z=q(),Z=[];if(z)for(Z.push(z);H(n.comma);)z=q(),z?Z.push(z):e("One extra comma");return Z}function E(){var q=S();return q||e("Expected color definition"),q.length=N(),q}function S(){return k()||C()||T()||O()}function O(){return G("literal",n.literalColor,0)}function k(){return G("hex",n.hexColor,1)}function T(){return o(n.rgbColor,function(){return{type:"rgb",value:w(P)}})}function C(){return o(n.rgbaColor,function(){return{type:"rgba",value:w(P)}})}function P(){return H(n.number)[1]}function N(){return G("%",n.percentageValue,1)||L()||D()}function L(){return G("position-keyword",n.positionKeywords,1)}function D(){return G("px",n.pixelValue,1)||G("em",n.emValue,1)}function G(q,z,Z){var at=H(z);if(at)return{type:q,value:at[Z]}}function H(q){var z=/^[\n\r\t\s]+/.exec(t);z&&W(z[0].length);var Z=q.exec(t);return Z&&W(Z[0].length),Z}function W(q){t=t.substring(q)}return function(q){return t=q,r()}}();function g5(n,t,e,r){var i=Se(r.value),a=0,s=0,o=a+t/2,l=s+e/2,c=Math.abs(t*Math.cos(i))+Math.abs(e*Math.sin(i)),u=n[0]+o-Math.cos(i)*c/2,h=n[1]+l-Math.sin(i)*c/2,f=n[0]+o+Math.cos(i)*c/2,d=n[1]+l+Math.sin(i)*c/2;return{x1:u,y1:h,x2:f,y2:d}}function p5(n,t,e,r,i,a){var s=r.value,o=i.value;r.unit===Ct.kPercentage&&(s=r.value/100*t),i.unit===Ct.kPercentage&&(o=i.value/100*e);var l=Math.max(mr([0,0],[s,o]),mr([0,e],[s,o]),mr([t,e],[s,o]),mr([t,0],[s,o]));return a&&(a instanceof Cn?l=a.value:a instanceof Jr&&(a.value==="closest-side"?l=Math.min(s,t-s,o,e-o):a.value==="farthest-side"?l=Math.max(s,t-s,o,e-o):a.value==="closest-corner"&&(l=Math.min(mr([0,0],[s,o]),mr([0,e],[s,o]),mr([t,e],[s,o]),mr([t,0],[s,o]))))),{x:s+n[0],y:o+n[1],r:l}}var v5=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,y5=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,m5=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,gN=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function b5(n){var t,e=n.length;if(n[e-1].length=(t=n[e-1].length)!==null&&t!==void 0?t:{type:"%",value:"100"},e>1){var r;n[0].length=(r=n[0].length)!==null&&r!==void 0?r:{type:"%",value:"0"}}for(var i=0,a=Number(n[0].length.value),s=1;s<e;s++){var o,l=(o=n[s].length)===null||o===void 0?void 0:o.value;if(!Ut(l)&&!Ut(a)){for(var c=1;c<s-i;c++)n[i+c].length={type:"%",value:"".concat(a+(Number(l)-a)*c/(s-i))};i=s,a=Number(l)}}}var w5={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},x5=wn(function(n){var t;return n.type==="angular"?t=Number(n.value):t=w5[n.value]||0,He(t,"deg")}),E5=wn(function(n){var t=50,e=50,r="%",i="%";if((n==null?void 0:n.type)==="position"){var a=n.value,s=a.x,o=a.y;(s==null?void 0:s.type)==="position-keyword"&&(s.value==="left"?t=0:s.value==="center"?t=50:s.value==="right"?t=100:s.value==="top"?e=0:s.value==="bottom"&&(e=100)),(o==null?void 0:o.type)==="position-keyword"&&(o.value==="left"?t=0:o.value==="center"?e=50:o.value==="right"?t=100:o.value==="top"?e=0:o.value==="bottom"&&(e=100)),((s==null?void 0:s.type)==="px"||(s==null?void 0:s.type)==="%"||(s==null?void 0:s.type)==="em")&&(r=s==null?void 0:s.type,t=Number(s.value)),((o==null?void 0:o.type)==="px"||(o==null?void 0:o.type)==="%"||(o==null?void 0:o.type)==="em")&&(i=o==null?void 0:o.type,e=Number(o.value))}return{cx:He(t,r),cy:He(e,i)}}),S5=wn(function(n){if(n.indexOf("linear")>-1||n.indexOf("radial")>-1){var t=d5(n);return t.map(function(o){var l=o.type,c=o.orientation,u=o.colorStops;b5(u);var h=u.map(function(w){return{offset:He(Number(w.length.value),"%"),color:f5(w)}});if(l==="linear-gradient")return new Uc(Ca.LinearGradient,{angle:c?x5(c):Rs,steps:h});if(l==="radial-gradient"&&(c||(c=[{type:"shape",value:"circle"}]),c[0].type==="shape"&&c[0].value==="circle")){var f=E5(c[0].at),d=f.cx,g=f.cy,v;if(c[0].style){var p=c[0].style,y=p.type,m=p.value;y==="extent-keyword"?v=u5(m):v=He(m,y)}return new Uc(Ca.RadialGradient,{cx:d,cy:g,size:v,steps:h})}})}var e=n[0];if(n[1]==="("||n[2]==="("){if(e==="l"){var r=v5.exec(n);if(r){var i,a=((i=r[2].match(gN))===null||i===void 0?void 0:i.map(function(o){return o.split(":")}))||[];return[new Uc(Ca.LinearGradient,{angle:He(parseFloat(r[1]),"deg"),steps:a.map(function(o){var l=ne(o,2),c=l[0],u=l[1];return{offset:He(Number(c)*100,"%"),color:u}})})]}}else if(e==="r"){var s=_5(n);if(s)if(me(s))n=s;else return[new Uc(Ca.RadialGradient,s)]}else if(e==="p")return M5(n)}});function _5(n){var t=y5.exec(n);if(t){var e,r=((e=t[4].match(gN))===null||e===void 0?void 0:e.map(function(i){return i.split(":")}))||[];return{cx:He(50,"%"),cy:He(50,"%"),steps:r.map(function(i){var a=ne(i,2),s=a[0],o=a[1];return{offset:He(Number(s)*100,"%"),color:o}})}}return null}function M5(n){var t=m5.exec(n);if(t){var e=t[1],r=t[2];switch(e){case"a":e="repeat";break;case"x":e="repeat-x";break;case"y":e="repeat-y";break;case"n":e="no-repeat";break;default:e="no-repeat"}return{image:r,repetition:e}}return null}function Ls(n){return n&&!!n.image}function mh(n){return n&&!Ut(n.r)&&!Ut(n.g)&&!Ut(n.b)}var Nl=wn(function(n){if(Ls(n))return ie({repetition:"repeat"},n);if(Ut(n)&&(n=""),n==="transparent")return dN;if(n==="currentColor")n="black";else if(n==="none")return fN;var t=S5(n);if(t)return t;var e=Zh(n),r=[0,0,0,0];return e!==null&&(r[0]=e.r||0,r[1]=e.g||0,r[2]=e.b||0,r[3]=e.opacity),h5.apply(void 0,r)});function O5(n,t){if(!(!mh(n)||!mh(t)))return[[Number(n.r),Number(n.g),Number(n.b),Number(n.alpha)],[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],function(e){var r=e.slice();if(r[3])for(var i=0;i<3;i++)r[i]=Math.round(tn(r[i],0,255));return r[3]=tn(r[3],0,1),"rgba(".concat(r.join(","),")")}]}function fc(n,t){if(Ut(t))return He(0,"px");if(t="".concat(t).trim().toLowerCase(),isFinite(Number(t))){if("px".search(n)>=0)return He(Number(t),"px");if("deg".search(n)>=0)return He(Number(t),"deg")}var e=[];t=t.replace(n,function(i){return e.push(i),"U".concat(i)});var r="U(".concat(n.source,")");return e.map(function(i){return He(Number(t.replace(new RegExp("U".concat(i),"g"),"").replace(new RegExp(r,"g"),"*0")),i)})[0]}var pN=function(t){return fc(new RegExp("px","g"),t)},T5=wn(pN),k5=function(t){return fc(new RegExp("%","g"),t)};wn(k5);var vN=function(t){return Lt(t)||isFinite(Number(t))?He(Number(t)||0,"px"):fc(new RegExp("px|%|em|rem","g"),t)},eb=wn(vN),yN=function(t){return fc(new RegExp("deg|rad|grad|turn","g"),t)},A5=wn(yN);function C5(n,t,e,r){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,a="",s=n.value||0,o=t.value||0,l=tb(n.unit),c=n.convertTo(l),u=t.convertTo(l);return c&&u?(s=c.value,o=u.value,a=Q1(n.unit)):(Cn.isLength(n.unit)||Cn.isLength(t.unit))&&(s=Nr(n,i,e),o=Nr(t,i,e),a="px"),[s,o,function(h){return h+a}]}function wr(n){var t=0;return n.unit===Ct.kDegrees?t=n.value:n.unit===Ct.kRadians?t=br(Number(n.value)):n.unit===Ct.kTurns?t=P4(Number(n.value)):n.value&&(t=n.value),t}function zE(n,t){var e;return Array.isArray(n)?e=n.map(function(r){return Number(r)}):me(n)?e=n.split(" ").map(function(r){return Number(r)}):Lt(n)&&(e=[n]),t===2?e.length===1?[e[0],e[0]]:[e[0],e[1]]:t===4?e.length===1?[e[0],e[0],e[0],e[0]]:e.length===2?[e[0],e[1],e[0],e[1]]:e.length===3?[e[0],e[1],e[2],e[1]]:[e[0],e[1],e[2],e[3]]:t==="even"&&e.length%2===1?[].concat(Ie(e),Ie(e)):e}function Nr(n,t,e){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(n.unit===Ct.kPixels)return Number(n.value);if(n.unit===Ct.kPercentage&&e){var i=e.nodeName===ot.GROUP?e.getLocalBounds():e.getGeometryBounds();return(r?i.min[t]:0)+n.value/100*i.halfExtents[t]*2}return 0}var P5=function(t){return fc(/deg|rad|grad|turn|px|%/g,t)},N5=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function R5(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";if(n=n.toLowerCase().trim(),n==="none")return[];for(var t=/\s*([\w-]+)\(([^)]*)\)/g,e=[],r,i=0;r=t.exec(n);){if(r.index!==i)return[];if(i=r.index+r[0].length,N5.indexOf(r[1])>-1&&e.push({name:r[1],params:r[2].split(" ").map(function(a){return P5(a)||Nl(a)})}),t.lastIndex===n.length)return e}return[]}function mN(n){return n.toString()}var bN=function(t){return typeof t=="number"?He(t):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(t)?He(Number(t)):He(0)},nb=wn(bN);wn(function(n){return me(n)?n.split(" ").map(nb):n.map(nb)});function mw(n,t){return[n,t,mN]}function bw(n,t){return function(e,r){return[e,r,function(i){return mN(tn(i,n,t))}]}}function wN(n,t){if(n.length===t.length)return[n,t,function(e){return e}]}function rb(n){return n.parsedStyle.d.totalLength===0&&(n.parsedStyle.d.totalLength=JB(n.parsedStyle.d.absolutePath)),n.parsedStyle.d.totalLength}function L5(n){return n.parsedStyle.points.totalLength===0&&(n.parsedStyle.points.totalLength=v4(n.parsedStyle.points.points)),n.parsedStyle.points.totalLength}function I5(n){for(var t=0;t<n.length;t++){var e=n[t-1],r=n[t],i=r[0];if(i==="M"&&e){var a=e[0],s=[r[1],r[2]],o=void 0;a==="L"||a==="M"?o=[e[1],e[2]]:(a==="C"||a==="A"||a==="Q")&&(o=[e[e.length-2],e[e.length-1]]),o&&bh(s,o)&&(n.splice(t,1),t--)}}}function D5(n){for(var t=!1,e=n.length,r=0;r<e;r++){var i=n[r],a=i[0];if(a==="C"||a==="A"||a==="Q"){t=!0;break}}return t}function F5(n){for(var t=[],e=[],r=[],i=0;i<n.length;i++){var a=n[i],s=a[0];s==="M"?(r.length&&(e.push(r),r=[]),r.push([a[1],a[2]])):s==="Z"?r.length&&(t.push(r),r=[]):r.push([a[1],a[2]])}return r.length>0&&e.push(r),{polygons:t,polylines:e}}function bh(n,t){return n[0]===t[0]&&n[1]===t[1]}function B5(n,t){for(var e=[],r=[],i=[],a=0;a<n.length;a++){var s=n[a],o=s.currentPoint,l=s.params,c=s.prePoint,u=void 0;switch(s.command){case"Q":u=y4(c[0],c[1],l[1],l[2],l[3],l[4]);break;case"C":u=d4(c[0],c[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var h=s.arcParams;u=u4(h.cx,h.cy,h.rx,h.ry,h.xRotation,h.startAngle,h.endAngle);break;default:e.push(o[0]),r.push(o[1]);break}u&&(s.box=u,e.push(u.x,u.x+u.width),r.push(u.y,u.y+u.height))}e=e.filter(function(E){return!Number.isNaN(E)&&E!==1/0&&E!==-1/0}),r=r.filter(function(E){return!Number.isNaN(E)&&E!==1/0&&E!==-1/0});var f=uh(e),d=uh(r),g=ch(e),v=ch(r);if(i.length===0)return{x:f,y:d,width:g-f,height:v-d};for(var p=0;p<i.length;p++){var y=i[p],m=y.currentPoint,w=void 0;m[0]===f?(w=Yc(y,t),f-=w.xExtra):m[0]===g&&(w=Yc(y,t),g+=w.xExtra),m[1]===d?(w=Yc(y,t),d-=w.yExtra):m[1]===v&&(w=Yc(y,t),v+=w.yExtra)}return{x:f,y:d,width:g-f,height:v-d}}function Yc(n,t){var e=n.prePoint,r=n.currentPoint,i=n.nextPoint,a=Math.pow(r[0]-e[0],2)+Math.pow(r[1]-e[1],2),s=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),o=Math.pow(e[0]-i[0],2)+Math.pow(e[1]-i[1],2),l=Math.acos((a+s-o)/(2*Math.sqrt(a)*Math.sqrt(s)));if(!l||Math.sin(l)===0||Cl(l,0))return{xExtra:0,yExtra:0};var c=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),u=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));c=c>Math.PI/2?Math.PI-c:c,u=u>Math.PI/2?Math.PI-u:u;var h={xExtra:Math.cos(l/2-c)*(t/2*(1/Math.sin(l/2)))-t/2||0,yExtra:Math.cos(u-l/2)*(t/2*(1/Math.sin(l/2)))-t/2||0};return h}function jE(n,t){return[t[0]+(t[0]-n[0]),t[1]+(t[1]-n[1])]}var qE=function(t,e){var r=t.x*e.x+t.y*e.y,i=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2))),a=t.x*e.y-t.y*e.x<0?-1:1,s=a*Math.acos(r/i);return s},$E=function(t,e,r,i,a,s,o,l){e=Math.abs(e),r=Math.abs(r),i=VP(i,360);var c=Se(i);if(t.x===o.x&&t.y===o.y)return{x:t.x,y:t.y,ellipticalArcAngle:0};if(e===0||r===0)return{x:0,y:0,ellipticalArcAngle:0};var u=(t.x-o.x)/2,h=(t.y-o.y)/2,f={x:Math.cos(c)*u+Math.sin(c)*h,y:-Math.sin(c)*u+Math.cos(c)*h},d=Math.pow(f.x,2)/Math.pow(e,2)+Math.pow(f.y,2)/Math.pow(r,2);d>1&&(e*=Math.sqrt(d),r*=Math.sqrt(d));var g=Math.pow(e,2)*Math.pow(r,2)-Math.pow(e,2)*Math.pow(f.y,2)-Math.pow(r,2)*Math.pow(f.x,2),v=Math.pow(e,2)*Math.pow(f.y,2)+Math.pow(r,2)*Math.pow(f.x,2),p=g/v;p=p<0?0:p;var y=(a!==s?1:-1)*Math.sqrt(p),m={x:y*(e*f.y/r),y:y*(-(r*f.x)/e)},w={x:Math.cos(c)*m.x-Math.sin(c)*m.y+(t.x+o.x)/2,y:Math.sin(c)*m.x+Math.cos(c)*m.y+(t.y+o.y)/2},E={x:(f.x-m.x)/e,y:(f.y-m.y)/r},S=qE({x:1,y:0},E),O={x:(-f.x-m.x)/e,y:(-f.y-m.y)/r},k=qE(E,O);!s&&k>0?k-=2*Math.PI:s&&k<0&&(k+=2*Math.PI),k%=2*Math.PI;var T=S+k*l,C=e*Math.cos(T),P=r*Math.sin(T),N={x:Math.cos(c)*C-Math.sin(c)*P+w.x,y:Math.sin(c)*C+Math.cos(c)*P+w.y,ellipticalArcStartAngle:S,ellipticalArcEndAngle:S+k,ellipticalArcAngle:T,ellipticalArcCenter:w,resultantRx:e,resultantRy:r};return N};function z5(n){for(var t=[],e=null,r=null,i=null,a=0,s=n.length,o=0;o<s;o++){var l=n[o];r=n[o+1];var c=l[0],u={command:c,prePoint:e,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(c){case"M":i=[l[1],l[2]],a=o;break;case"A":var h=j5(e,l);u.arcParams=h;break}if(c==="Z")e=i,r=n[a+1];else{var f=l.length;e=[l[f-2],l[f-1]]}r&&r[0]==="Z"&&(r=n[a],t[a]&&(t[a].prePoint=e)),u.currentPoint=e,t[a]&&bh(e,t[a].currentPoint)&&(t[a].prePoint=u.prePoint);var d=r?[r[r.length-2],r[r.length-1]]:null;u.nextPoint=d;var g=u.prePoint;if(["L","H","V"].includes(c))u.startTangent=[g[0]-e[0],g[1]-e[1]],u.endTangent=[e[0]-g[0],e[1]-g[1]];else if(c==="Q"){var v=[l[1],l[2]];u.startTangent=[g[0]-v[0],g[1]-v[1]],u.endTangent=[e[0]-v[0],e[1]-v[1]]}else if(c==="T"){var p=t[o-1],y=jE(p.currentPoint,g);p.command==="Q"?(u.command="Q",u.startTangent=[g[0]-y[0],g[1]-y[1]],u.endTangent=[e[0]-y[0],e[1]-y[1]]):(u.command="TL",u.startTangent=[g[0]-e[0],g[1]-e[1]],u.endTangent=[e[0]-g[0],e[1]-g[1]])}else if(c==="C"){var m=[l[1],l[2]],w=[l[3],l[4]];u.startTangent=[g[0]-m[0],g[1]-m[1]],u.endTangent=[e[0]-w[0],e[1]-w[1]],u.startTangent[0]===0&&u.startTangent[1]===0&&(u.startTangent=[m[0]-w[0],m[1]-w[1]]),u.endTangent[0]===0&&u.endTangent[1]===0&&(u.endTangent=[w[0]-m[0],w[1]-m[1]])}else if(c==="S"){var E=t[o-1],S=jE(E.currentPoint,g),O=[l[1],l[2]];E.command==="C"?(u.command="C",u.startTangent=[g[0]-S[0],g[1]-S[1]],u.endTangent=[e[0]-O[0],e[1]-O[1]]):(u.command="SQ",u.startTangent=[g[0]-O[0],g[1]-O[1]],u.endTangent=[e[0]-O[0],e[1]-O[1]])}else if(c==="A"){var k=GE(u,0),T=k.x,C=k.y,P=GE(u,1,!1),N=P.x,L=P.y;u.startTangent=[T,C],u.endTangent=[N,L]}t.push(u)}return t}function GE(n,t){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=n.arcParams,i=r.rx,a=i===void 0?0:i,s=r.ry,o=s===void 0?0:s,l=r.xRotation,c=r.arcFlag,u=r.sweepFlag,h=$E({x:n.prePoint[0],y:n.prePoint[1]},a,o,l,!!c,!!u,{x:n.currentPoint[0],y:n.currentPoint[1]},t),f=$E({x:n.prePoint[0],y:n.prePoint[1]},a,o,l,!!c,!!u,{x:n.currentPoint[0],y:n.currentPoint[1]},e?t+.005:t-.005),d=f.x-h.x,g=f.y-h.y,v=Math.sqrt(d*d+g*g);return{x:-d/v,y:-g/v}}function Xc(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function ib(n,t){return Xc(n)*Xc(t)?(n[0]*t[0]+n[1]*t[1])/(Xc(n)*Xc(t)):1}function WE(n,t){return(n[0]*t[1]<n[1]*t[0]?-1:1)*Math.acos(ib(n,t))}function j5(n,t){var e=t[1],r=t[2],i=VP(Se(t[3]),Math.PI*2),a=t[4],s=t[5],o=n[0],l=n[1],c=t[6],u=t[7],h=Math.cos(i)*(o-c)/2+Math.sin(i)*(l-u)/2,f=-1*Math.sin(i)*(o-c)/2+Math.cos(i)*(l-u)/2,d=h*h/(e*e)+f*f/(r*r);d>1&&(e*=Math.sqrt(d),r*=Math.sqrt(d));var g=e*e*(f*f)+r*r*(h*h),v=g?Math.sqrt((e*e*(r*r)-g)/g):1;a===s&&(v*=-1),isNaN(v)&&(v=0);var p=r?v*e*f/r:0,y=e?v*-r*h/e:0,m=(o+c)/2+Math.cos(i)*p-Math.sin(i)*y,w=(l+u)/2+Math.sin(i)*p+Math.cos(i)*y,E=[(h-p)/e,(f-y)/r],S=[(-1*h-p)/e,(-1*f-y)/r],O=WE([1,0],E),k=WE(E,S);return ib(E,S)<=-1&&(k=Math.PI),ib(E,S)>=1&&(k=0),s===0&&k>0&&(k-=2*Math.PI),s===1&&k<0&&(k+=2*Math.PI),{cx:m,cy:w,rx:bh(n,[c,u])?0:e,ry:bh(n,[c,u])?0:r,startAngle:O,endAngle:O+k,xRotation:i,arcFlag:a,sweepFlag:s}}var xN=function(t){if(t===""||Array.isArray(t)&&t.length===0)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var e;try{e=dh(t)}catch{e=dh(""),console.error("[g]: Invalid SVG Path definition: ".concat(t))}I5(e);var r=D5(e),i=F5(e),a=i.polygons,s=i.polylines,o=z5(e),l=B5(o,0),c=l.x,u=l.y,h=l.width,f=l.height;return{absolutePath:e,hasArc:r,segments:o,polygons:a,polylines:s,totalLength:0,rect:{x:Number.isFinite(c)?c:0,y:Number.isFinite(u)?u:0,width:Number.isFinite(h)?h:0,height:Number.isFinite(f)?f:0}}},q5=wn(xN);function EN(n){return me(n)?q5(n):xN(n)}function $5(n,t,e){var r=n.curve,i=t.curve;(!r||r.length===0)&&(r=H1(n.absolutePath,!1),n.curve=r),(!i||i.length===0)&&(i=H1(t.absolutePath,!1),t.curve=i);var a=[r,i];r.length!==i.length&&(a=eN(r,i));var s=mE(a[0])!==mE(a[1])?HB(a[0]):VB(a[0]);return[s,t4(a[1],s),function(o){return o}]}function G5(n,t){var e;return me(n)?e=n.split(" ").map(function(r){var i=r.split(","),a=ne(i,2),s=a[0],o=a[1];return[Number(s),Number(o)]}):e=n,{points:e,totalLength:0,segments:[]}}function W5(n,t){return[n.points,t.points,function(e){return e}]}var Qe=null,Eo=/\s*(\w+)\(([^)]*)\)/g;function pr(n){return function(t){var e=0;return n.map(function(r){return r===Qe?t[e++]:r})}}function cs(n){return n}var Ul={matrix:["NNNNNN",[Qe,Qe,0,0,Qe,Qe,0,0,0,0,1,0,Qe,Qe,0,1],cs],matrix3d:["NNNNNNNNNNNNNNNN",cs],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",pr([Qe,Qe,new Cn(1)]),cs],scaleX:["N",pr([Qe,new Cn(1),new Cn(1)]),pr([Qe,new Cn(1)])],scaleY:["N",pr([new Cn(1),Qe,new Cn(1)]),pr([new Cn(1),Qe])],scaleZ:["N",pr([new Cn(1),new Cn(1),Qe])],scale3d:["NNN",cs],skew:["Aa",null,cs],skewX:["A",null,pr([Qe,Rs])],skewY:["A",null,pr([Rs,Qe])],translate:["Tt",pr([Qe,Qe,ai]),cs],translateX:["T",pr([Qe,ai,ai]),pr([Qe,ai])],translateY:["T",pr([ai,Qe,ai]),pr([ai,Qe])],translateZ:["L",pr([ai,ai,Qe])],translate3d:["TTL",cs]};function SN(n){for(var t=[],e=n.length,r=0;r<e;r++){var i=n[r],a=i[0],s=i.slice(1);a==="translate"||a==="skew"?s.length===1&&s.push(0):a==="scale"&&s.length===1&&s.push(s[0]);var o=Ul[a];if(!o)return[];var l=s.map(function(c){return He(c)});t.push({t:a,d:l})}return t}function _N(n){if(Array.isArray(n))return SN(n);if(n=(n||"none").trim(),n==="none")return[];var t=[],e,r=0;for(Eo.lastIndex=0;e=Eo.exec(n);){if(e.index!==r)return[];r=e.index+e[0].length;var i=e[1],a=Ul[i];if(!a)return[];var s=e[2].split(","),o=a[0];if(o.length<s.length)return[];for(var l=[],c=0;c<o.length;c++){var u=s[c],h=o[c],f=void 0;if(u?f={A:function(g){return g.trim()==="0"?Rs:A5(g)},N:nb,T:eb,L:T5}[h.toUpperCase()](u):f={a:Rs,n:l[0],t:ai}[h],f===void 0)return[];l.push(f)}if(t.push({t:i,d:l}),Eo.lastIndex===n.length)return t}return[]}function V5(n){if(Array.isArray(n))return SN(n);if(n=(n||"none").trim(),n==="none")return[];var t=[],e,r=0;for(Eo.lastIndex=0;e=Eo.exec(n);){if(e.index!==r)return[];r=e.index+e[0].length;var i=e[1],a=Ul[i];if(!a)return[];var s=e[2].split(","),o=a[0];if(o.length<s.length)return[];for(var l=[],c=0;c<o.length;c++){var u=s[c],h=o[c],f=void 0;if(u?f={A:function(g){return g.trim()==="0"?Rs:yN(g)},N:bN,T:vN,L:pN}[h.toUpperCase()](u):f={a:Rs,n:l[0],t:ai}[h],f===void 0)return[];l.push(f)}if(t.push({t:i,d:l}),Eo.lastIndex===n.length)return t}return[]}function H5(n){var t,e,r,i;switch(n.t){case"rotateX":return i=Se(wr(n.d[0])),[1,0,0,0,0,Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotateY":return i=Se(wr(n.d[0])),[Math.cos(i),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotateZ":return i=Se(wr(n.d[0])),[Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":t=n.d[0].value,e=n.d[1].value,r=n.d[2].value,i=Se(wr(n.d[3]));var a=t*t+e*e+r*r;if(a===0)t=1,e=0,r=0;else if(a!==1){var s=Math.sqrt(a);t/=s,e/=s,r/=s}var o=Math.sin(i/2),l=o*Math.cos(i/2),c=o*o;return[1-2*(e*e+r*r)*c,2*(t*e*c+r*l),2*(t*r*c-e*l),0,2*(t*e*c-r*l),1-2*(t*t+r*r)*c,2*(e*r*c+t*l),0,2*(t*r*c+e*l),2*(e*r*c-t*l),1-2*(t*t+e*e)*c,0,0,0,0,1];case"scale":return[n.d[0].value,0,0,0,0,n.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[n.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,n.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,n.d[0].value,0,0,0,0,1];case"scale3d":return[n.d[0].value,0,0,0,0,n.d[1].value,0,0,0,0,n.d[2].value,0,0,0,0,1];case"skew":var u=Se(wr(n.d[0])),h=Se(wr(n.d[1]));return[1,Math.tan(h),0,0,Math.tan(u),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return i=Se(wr(n.d[0])),[1,0,0,0,Math.tan(i),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return i=Se(wr(n.d[0])),[1,Math.tan(i),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return t=Nr(n.d[0],0,null)||0,e=Nr(n.d[1],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,t,e,0,1];case"translateX":return t=Nr(n.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,t,0,0,1];case"translateY":return e=Nr(n.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,e,0,1];case"translateZ":return r=Nr(n.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r,1];case"translate3d":return t=Nr(n.d[0],0,null)||0,e=Nr(n.d[1],0,null)||0,r=Nr(n.d[2],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,t,e,r,1];case"perspective":var f=Nr(n.d[0],0,null)||0,d=f?-1/f:0;return[1,0,0,0,0,1,0,0,0,0,1,d,0,0,0,1];case"matrix":return[n.d[0].value,n.d[1].value,0,0,n.d[2].value,n.d[3].value,0,0,0,0,1,0,n.d[4].value,n.d[5].value,0,1];case"matrix3d":return n.d.map(function(g){return g.value})}}function U5(n,t){return[n[0]*t[0]+n[4]*t[1]+n[8]*t[2]+n[12]*t[3],n[1]*t[0]+n[5]*t[1]+n[9]*t[2]+n[13]*t[3],n[2]*t[0]+n[6]*t[1]+n[10]*t[2]+n[14]*t[3],n[3]*t[0]+n[7]*t[1]+n[11]*t[2]+n[15]*t[3],n[0]*t[4]+n[4]*t[5]+n[8]*t[6]+n[12]*t[7],n[1]*t[4]+n[5]*t[5]+n[9]*t[6]+n[13]*t[7],n[2]*t[4]+n[6]*t[5]+n[10]*t[6]+n[14]*t[7],n[3]*t[4]+n[7]*t[5]+n[11]*t[6]+n[15]*t[7],n[0]*t[8]+n[4]*t[9]+n[8]*t[10]+n[12]*t[11],n[1]*t[8]+n[5]*t[9]+n[9]*t[10]+n[13]*t[11],n[2]*t[8]+n[6]*t[9]+n[10]*t[10]+n[14]*t[11],n[3]*t[8]+n[7]*t[9]+n[11]*t[10]+n[15]*t[11],n[0]*t[12]+n[4]*t[13]+n[8]*t[14]+n[12]*t[15],n[1]*t[12]+n[5]*t[13]+n[9]*t[14]+n[13]*t[15],n[2]*t[12]+n[6]*t[13]+n[10]*t[14]+n[14]*t[15],n[3]*t[12]+n[7]*t[13]+n[11]*t[14]+n[15]*t[15]]}function Y5(n){return n.length===0?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:n.map(H5).reduce(U5)}function VE(n){var t=[0,0,0],e=[1,1,1],r=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return D4(Y5(n),t,e,r,i,a),[[t,e,r,a,i]]}var X5=function(){function n(r,i){for(var a=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],s=0;s<4;s++)for(var o=0;o<4;o++)for(var l=0;l<4;l++)a[s][o]+=i[s][l]*r[l][o];return a}function t(r){return r[0][2]===0&&r[0][3]===0&&r[1][2]===0&&r[1][3]===0&&r[2][0]===0&&r[2][1]===0&&r[2][2]===1&&r[2][3]===0&&r[3][2]===0&&r[3][3]===1}function e(r,i,a,s,o){for(var l=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],c=0;c<4;c++)l[c][3]=o[c];for(var u=0;u<3;u++)for(var h=0;h<3;h++)l[3][u]+=r[h]*l[h][u];var f=s[0],d=s[1],g=s[2],v=s[3],p=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];p[0][0]=1-2*(d*d+g*g),p[0][1]=2*(f*d-g*v),p[0][2]=2*(f*g+d*v),p[1][0]=2*(f*d+g*v),p[1][1]=1-2*(f*f+g*g),p[1][2]=2*(d*g-f*v),p[2][0]=2*(f*g-d*v),p[2][1]=2*(d*g+f*v),p[2][2]=1-2*(f*f+d*d),l=n(l,p);var y=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];a[2]&&(y[2][1]=a[2],l=n(l,y)),a[1]&&(y[2][1]=0,y[2][0]=a[0],l=n(l,y)),a[0]&&(y[2][0]=0,y[1][0]=a[0],l=n(l,y));for(var m=0;m<3;m++)for(var w=0;w<3;w++)l[m][w]*=i[m];return t(l)?[l[0][0],l[0][1],l[1][0],l[1][1],l[3][0],l[3][1]]:l[0].concat(l[1],l[2],l[3])}return e}();function K5(n){return n.toFixed(6).replace(".000000","")}function tg(n,t){var e,r;return n.decompositionPair!==t&&(n.decompositionPair=t,e=VE(n)),t.decompositionPair!==n&&(t.decompositionPair=n,r=VE(t)),e[0]===null||r[0]===null?[[!1],[!0],function(i){return i?t[0].d:n[0].d}]:(e[0].push(0),r[0].push(1),[e,r,function(i){var a=J5(e[0][3],r[0][3],i[5]),s=X5(i[0],i[1],i[2],a,i[4]),o=s.map(K5).join(",");return o}])}function Z5(n,t){for(var e=0,r=0;r<n.length;r++)e+=n[r]*t[r];return e}function J5(n,t,e){var r=Z5(n,t);r=tn(r,-1,1);var i=[];if(r===1)i=n;else for(var a=Math.acos(r),s=Math.sin(e*a)*1/Math.sqrt(1-r*r),o=0;o<4;o++)i.push(n[o]*(Math.cos(e*a)-r*s)+t[o]*s);return i}function eg(n){return n.replace(/[XY]/,"")}function ng(n){return n.replace(/(X|Y|Z|3d)?$/,"3d")}var Q5=function(t,e){return t==="perspective"&&e==="perspective"||(t==="matrix"||t==="matrix3d")&&(e==="matrix"||e==="matrix3d")};function tz(n,t,e){var r=!1;if(!n.length||!t.length){n.length||(r=!0,n=t,t=[]);for(var i=function(){var N=n[a],L=N.t,D=N.d,G=L.substring(0,5)==="scale"?1:0;t.push({t:L,d:D.map(function(H){return typeof H=="number"?He(G):He(G,H.unit)})})},a=0;a<n.length;a++)i()}var s=[],o=[],l=[];if(n.length!==t.length){var c=tg(n,t);s=[c[0]],o=[c[1]],l=[["matrix",[c[2]]]]}else for(var u=0;u<n.length;u++){var h=n[u].t,f=t[u].t,d=n[u].d,g=t[u].d,v=Ul[h],p=Ul[f],y=void 0;if(Q5(h,f)){var m=tg([n[u]],[t[u]]);s.push(m[0]),o.push(m[1]),l.push(["matrix",[m[2]]]);continue}else if(h===f)y=h;else if(v[2]&&p[2]&&eg(h)===eg(f))y=eg(h),d=v[2](d),g=p[2](g);else if(v[1]&&p[1]&&ng(h)===ng(f))y=ng(h),d=v[1](d),g=p[1](g);else{var w=tg(n,t);s=[w[0]],o=[w[1]],l=[["matrix",[w[2]]]];break}for(var E=[],S=[],O=[],k=0;k<d.length;k++){var T=C5(d[k],g[k],e,!1,k);E[k]=T[0],S[k]=T[1],O.push(T[2])}s.push(E),o.push(S),l.push([y,O])}if(r){var C=s;s=o,o=C}return[s,o,function(P){return P.map(function(N,L){var D=N.map(function(G,H){return l[L][1][H](G)}).join(",");return l[L][0]==="matrix"&&D.split(",").length===16&&(l[L][0]="matrix3d"),l[L][0]==="matrix3d"&&D.split(",").length===6&&(l[L][0]="matrix"),"".concat(l[L][0],"(").concat(D,")")}).join(" ")}]}var ez=wn(function(n){if(me(n)){if(n==="text-anchor")return[He(0,"px"),He(0,"px")];var t=n.split(" ");return t.length===1&&(t[0]==="top"||t[0]==="bottom"?(t[1]=t[0],t[0]="center"):t[1]="center"),t.length!==2?null:[eb(HE(t[0])),eb(HE(t[1]))]}return[He(n[0]||0,"px"),He(n[1]||0,"px")]});function HE(n){return n==="center"?"50%":n==="left"||n==="top"?"0%":n==="right"||n==="bottom"?"100%":n}var ww=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:kt.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:kt.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:kt.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:kt.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:kt.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:kt.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:kt.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:kt.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:kt.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:kt.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:kt.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:kt.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:kt.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:kt.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:kt.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:kt.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:kt.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:kt.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:kt.FILTER},{n:"clipPath",syntax:kt.DEFINED_PATH},{n:"textPath",syntax:kt.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:kt.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:kt.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:kt.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:kt.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:kt.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:kt.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:kt.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:kt.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:kt.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:kt.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:kt.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:kt.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:kt.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:kt.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:kt.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:kt.COORDINATE},{n:"y1",int:!0,l:!0,syntax:kt.COORDINATE},{n:"z1",int:!0,l:!0,syntax:kt.COORDINATE},{n:"x2",int:!0,l:!0,syntax:kt.COORDINATE},{n:"y2",int:!0,l:!0,syntax:kt.COORDINATE},{n:"z2",int:!0,l:!0,syntax:kt.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:kt.PATH,p:50},{n:"points",int:!0,l:!0,syntax:kt.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:kt.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:kt.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:kt.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:kt.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:kt.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:kt.NUMBER,d:function(t){return t===ot.PATH||t===ot.POLYGON||t===ot.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:kt.MARKER},{n:"markerEnd",syntax:kt.MARKER},{n:"markerMid",syntax:kt.MARKER},{n:"markerStartOffset",syntax:kt.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:kt.LENGTH,l:!0,int:!0,d:"0"}],nz=new Set(ww.filter(function(n){return!!n.l}).map(function(n){return n.n})),MN={},rz=function(){function n(t){var e=this;yt(this,n),this.runtime=t,ww.forEach(function(r){e.registerMetadata(r)})}return mt(n,[{key:"registerMetadata",value:function(e){[e.n].concat(Ie(e.a||[])).forEach(function(r){MN[r]=e})}},{key:"getPropertySyntax",value:function(e){return this.runtime.CSSPropertySyntaxFactory[e]}},{key:"processProperties",value:function(e,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{forceUpdateGeometry:!1};Object.assign(e.attributes,r);var a=e.parsedStyle.clipPath,s=e.parsedStyle.offsetPath;iz(e,r);var o=!!i.forceUpdateGeometry;if(!o){for(var l in r)if(nz.has(l)){o=!0;break}}var c=ON(e);c.has("fill")&&r.fill&&(e.parsedStyle.fill=Nl(r.fill)),c.has("stroke")&&r.stroke&&(e.parsedStyle.stroke=Nl(r.stroke)),c.has("shadowColor")&&r.shadowColor&&(e.parsedStyle.shadowColor=Nl(r.shadowColor)),c.has("filter")&&r.filter&&(e.parsedStyle.filter=R5(r.filter)),c.has("radius")&&!Ut(r.radius)&&(e.parsedStyle.radius=zE(r.radius,4)),c.has("lineDash")&&!Ut(r.lineDash)&&(e.parsedStyle.lineDash=zE(r.lineDash,"even")),c.has("points")&&r.points&&(e.parsedStyle.points=G5(r.points)),c.has("d")&&r.d===""&&(e.parsedStyle.d=ie({},cN)),c.has("d")&&r.d&&(e.parsedStyle.d=EN(r.d)),c.has("textTransform")&&r.textTransform&&this.runtime.CSSPropertySyntaxFactory[kt.TEXT_TRANSFORM].calculator(null,null,{value:r.textTransform},e,null),c.has("clipPath")&&!Qt(r.clipPath)&&this.runtime.CSSPropertySyntaxFactory[kt.DEFINED_PATH].calculator("clipPath",a,r.clipPath,e,this.runtime),c.has("offsetPath")&&r.offsetPath&&this.runtime.CSSPropertySyntaxFactory[kt.DEFINED_PATH].calculator("offsetPath",s,r.offsetPath,e,this.runtime),c.has("transform")&&r.transform&&(e.parsedStyle.transform=_N(r.transform)),c.has("transformOrigin")&&r.transformOrigin&&(e.parsedStyle.transformOrigin=ez(r.transformOrigin)),c.has("markerStart")&&r.markerStart&&(e.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[kt.MARKER].calculator(null,r.markerStart,r.markerStart,null,null)),c.has("markerEnd")&&r.markerEnd&&(e.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[kt.MARKER].calculator(null,r.markerEnd,r.markerEnd,null,null)),c.has("markerMid")&&r.markerMid&&(e.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[kt.MARKER].calculator("",r.markerMid,r.markerMid,null,null)),c.has("zIndex")&&!Ut(r.zIndex)&&this.runtime.CSSPropertySyntaxFactory[kt.Z_INDEX].postProcessor(e),c.has("offsetDistance")&&!Ut(r.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[kt.OFFSET_DISTANCE].postProcessor(e),c.has("transform")&&r.transform&&this.runtime.CSSPropertySyntaxFactory[kt.TRANSFORM].postProcessor(e),c.has("transformOrigin")&&r.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[kt.TRANSFORM_ORIGIN].postProcessor(e),o&&(e.geometry.dirty=!0,e.renderable.boundsDirty=!0,e.renderable.renderBoundsDirty=!0,i.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(e))}},{key:"updateGeometry",value:function(e){var r=e.nodeName,i=this.runtime.geometryUpdaterFactory[r];if(i){var a=e.geometry;a.contentBounds||(a.contentBounds=new Re),a.renderBounds||(a.renderBounds=new Re);var s=e.parsedStyle,o=i.update(s,e),l=o.cx,c=l===void 0?0:l,u=o.cy,h=u===void 0?0:u,f=o.cz,d=f===void 0?0:f,g=o.hwidth,v=g===void 0?0:g,p=o.hheight,y=p===void 0?0:p,m=o.hdepth,w=m===void 0?0:m,E=[Math.abs(v),Math.abs(y),w],S=s.stroke,O=s.lineWidth,k=O===void 0?1:O,T=s.increasedLineWidthForHitTesting,C=T===void 0?0:T,P=s.shadowType,N=P===void 0?"outer":P,L=s.shadowColor,D=s.filter,G=D===void 0?[]:D,H=s.transformOrigin,W=[c,h,d];a.contentBounds.update(W,E);var q=r===ot.POLYLINE||r===ot.POLYGON||r===ot.PATH?Math.SQRT2:.5,z=S&&!S.isNone;if(z){var Z=((k||0)+(C||0))*q;E[0]+=Z,E[1]+=Z}if(a.renderBounds.update(W,E),L&&N&&N!=="inner"){var at=a.renderBounds,ft=at.min,ct=at.max,Gt=s.shadowBlur,J=s.shadowOffsetX,V=s.shadowOffsetY,nt=Gt||0,dt=J||0,Nt=V||0,Wt=ft[0]-nt+dt,Kt=ct[0]+nt+dt,qe=ft[1]-nt+Nt,U=ct[1]+nt+Nt;ft[0]=Math.min(ft[0],Wt),ct[0]=Math.max(ct[0],Kt),ft[1]=Math.min(ft[1],qe),ct[1]=Math.max(ct[1],U),a.renderBounds.setMinMax(ft,ct)}G.forEach(function(ut){var Pt=ut.name,xt=ut.params;if(Pt==="blur"){var At=xt[0].value;a.renderBounds.update(a.renderBounds.center,Fa(a.renderBounds.halfExtents,a.renderBounds.halfExtents,[At,At,0]))}else if(Pt==="drop-shadow"){var wt=xt[0].value,Bt=xt[1].value,_t=xt[2].value,$t=a.renderBounds,Vt=$t.min,Zt=$t.max,pe=Vt[0]-_t+wt,ue=Zt[0]+_t+wt,dn=Vt[1]-_t+Bt,on=Zt[1]+_t+Bt;Vt[0]=Math.min(Vt[0],pe),Zt[0]=Math.max(Zt[0],ue),Vt[1]=Math.min(Vt[1],dn),Zt[1]=Math.max(Zt[1],on),a.renderBounds.setMinMax(Vt,Zt)}}),e.geometry.dirty=!1;var X=v<0,rt=y<0,lt=(X?-1:1)*(H?Nr(H[0],0,e,!0):0),vt=(rt?-1:1)*(H?Nr(H[1],1,e,!0):0);(lt||vt)&&e.setOrigin(lt,vt)}}},{key:"updateSizeAttenuation",value:function(e,r){e.style.isSizeAttenuation?(e.style.rawLineWidth||(e.style.rawLineWidth=e.style.lineWidth),e.style.lineWidth=(e.style.rawLineWidth||1)/r,e.nodeName===ot.CIRCLE&&(e.style.rawR||(e.style.rawR=e.style.r),e.style.r=(e.style.rawR||1)/r)):(e.style.rawLineWidth&&(e.style.lineWidth=e.style.rawLineWidth,delete e.style.rawLineWidth),e.nodeName===ot.CIRCLE&&e.style.rawR&&(e.style.r=e.style.rawR,delete e.style.rawR))}}])}();function iz(n,t){var e=ON(n);for(var r in t)e.has(r)&&(n.parsedStyle[r]=t[r])}function ON(n){return n.constructor.PARSED_STYLE_LIST}var az=function(){function n(){yt(this,n),this.mixer=mw}return mt(n,[{key:"calculator",value:function(e,r,i,a){return wr(i)}}])}(),sz=function(){function n(){yt(this,n)}return mt(n,[{key:"calculator",value:function(e,r,i,a,s){return i instanceof Jr&&(i=null),s.sceneGraphService.updateDisplayObjectDependency(e,r,i,a),e==="clipPath"&&a.forEach(function(o){o.childNodes.length===0&&s.sceneGraphService.dirtifyToRoot(o)}),i}}])}(),oz=function(){function n(){yt(this,n),this.parser=Nl,this.mixer=O5}return mt(n,[{key:"calculator",value:function(e,r,i,a){return i instanceof Jr?i.value==="none"?fN:dN:i}}])}(),lz=function(){function n(){yt(this,n)}return mt(n,[{key:"calculator",value:function(e,r,i){return i instanceof Jr?[]:i}}])}();function UE(n){var t=n.parsedStyle,e=t.fontSize;return Ut(e)?null:e}var ab=function(){function n(){yt(this,n),this.mixer=mw}return mt(n,[{key:"calculator",value:function(e,r,i,a,s){if(Lt(i))return i;if(Cn.isRelativeUnit(i.unit)){if(i.unit===Ct.kPercentage)return 0;if(i.unit===Ct.kEms){if(a.parentNode){var o=UE(a.parentNode);if(o)return o*=i.value,o}return 0}if(i.unit===Ct.kRems){var l;if(a!=null&&(l=a.ownerDocument)!==null&&l!==void 0&&l.documentElement){var c=UE(a.ownerDocument.documentElement);if(c)return c*=i.value,c}return 0}}else return i.value}}])}(),cz=function(){function n(){yt(this,n),this.mixer=wN}return mt(n,[{key:"calculator",value:function(e,r,i){return i.map(function(a){return a.value})}}])}(),uz=function(){function n(){yt(this,n),this.mixer=wN}return mt(n,[{key:"calculator",value:function(e,r,i){return i.map(function(a){return a.value})}}])}(),hz=function(){function n(){yt(this,n)}return mt(n,[{key:"calculator",value:function(e,r,i,a){var s;i instanceof Jr&&(i=null);var o=(s=i)===null||s===void 0?void 0:s.cloneNode(!0);return o&&(o.style.isMarker=!0),o}}])}(),fz=function(){function n(){yt(this,n),this.mixer=mw}return mt(n,[{key:"calculator",value:function(e,r,i){return i.value}}])}(),dz=function(){function n(){yt(this,n),this.mixer=bw(0,1)}return mt(n,[{key:"calculator",value:function(e,r,i){return i.value}},{key:"postProcessor",value:function(e){var r=e.parsedStyle,i=r.offsetPath,a=r.offsetDistance;if(i){var s=i.nodeName;if(s===ot.LINE||s===ot.PATH||s===ot.POLYLINE){var o=i.getPoint(a);o&&e.setLocalPosition(o.x,o.y)}}}}])}(),gz=function(){function n(){yt(this,n),this.mixer=bw(0,1)}return mt(n,[{key:"calculator",value:function(e,r,i){return i.value}}])}(),pz=function(){function n(){yt(this,n),this.parser=EN,this.mixer=$5}return mt(n,[{key:"calculator",value:function(e,r,i){return i instanceof Jr&&i.value==="unset"?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Co(0,0,0,0)}:i}}])}(),vz=mt(function n(){yt(this,n),this.mixer=W5}),yz=function(n){function t(){var e;yt(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=ae(this,t,[].concat(i)),e.mixer=bw(0,1/0),e}return se(t,n),mt(t)}(ab),mz=function(){function n(){yt(this,n)}return mt(n,[{key:"calculator",value:function(e,r,i,a){return i instanceof Jr?i.value==="unset"?"":i.value:"".concat(i)}},{key:"postProcessor",value:function(e){e.nodeValue="".concat(e.parsedStyle.text)||""}}])}(),bz=function(){function n(){yt(this,n)}return mt(n,[{key:"calculator",value:function(e,r,i,a){var s=a.getAttribute("text");if(s){var o=s;i.value==="capitalize"?o=s.charAt(0).toUpperCase()+s.slice(1):i.value==="lowercase"?o=s.toLowerCase():i.value==="uppercase"&&(o=s.toUpperCase()),a.parsedStyle.text=o}return i.value}}])}(),rg=new WeakMap;function wz(n,t,e){if(n){var r=typeof n=="string"?document.getElementById(n):n;rg.has(r)&&rg.get(r).destroy(e),rg.set(r,t)}}var xw=typeof window<"u"&&typeof window.document<"u";function xz(n){return!!n.getAttribute}function Ez(n,t){for(var e=0,r=n.length;e<r;){var i=e+r>>>1;TN(n[i],t)<0?e=i+1:r=i}return e}function TN(n,t){var e=Number(n.parsedStyle.zIndex||0),r=Number(t.parsedStyle.zIndex||0);if(e===r){var i=n.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(n)-a.indexOf(t)}}return e-r}function kN(n){var t=n;do{var e,r=(e=t.parsedStyle)===null||e===void 0?void 0:e.clipPath;if(r)return t;t=t.parentElement}while(t!==null);return null}var YE="px";function Sz(n,t,e){xw&&n.style&&(n.style.width=t+YE,n.style.height=e+YE)}function AN(n,t){if(xw)return document.defaultView.getComputedStyle(n,null).getPropertyValue(t)}function _z(n){var t=AN(n,"width");return t==="auto"?n.offsetWidth:parseFloat(t)}function Mz(n){var t=AN(n,"height");return t==="auto"?n.offsetHeight:parseFloat(t)}var Oz=1,Tz={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},sb=typeof performance=="object"&&performance.now?performance:Date;function wh(n){return n.nodeName===ot.FRAGMENT?!0:n.getRootNode().nodeName===ot.FRAGMENT}function $s(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"auto",t=arguments.length>1?arguments[1]:void 0,e=arguments.length>2?arguments[2]:void 0,r=!1,i=!1,a=!!t&&!t.isNone,s=!!e&&!e.isNone;return n==="visiblepainted"||n==="painted"||n==="auto"?(r=a,i=s):n==="visiblefill"||n==="fill"?r=!0:n==="visiblestroke"||n==="stroke"?i=!0:(n==="visible"||n==="all")&&(r=!0,i=!0),[r,i]}var kz=1,Az=function(){return kz++},Di=typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:{},Cz=Date.now(),Pz=function(){return Di.performance&&typeof Di.performance.now=="function"?Di.performance.now():Date.now()-Cz},hl={},XE=Date.now(),Nz=function(t){if(typeof t!="function")throw new TypeError("".concat(t," is not a function"));var e=Date.now(),r=e-XE,i=r>16?0:16-r,a=Az();return hl[a]=t,Object.keys(hl).length>1||setTimeout(function(){XE=e;var s=hl;hl={},Object.keys(s).forEach(function(o){return s[o](Pz())})},i),a},Rz=function(t){delete hl[t]},Lz=["","webkit","moz","ms","o"],CN=function(t){return typeof t!="string"?Nz:t===""?Di.requestAnimationFrame:Di["".concat(t,"RequestAnimationFrame")]},Iz=function(t){return typeof t!="string"?Rz:t===""?Di.cancelAnimationFrame:Di["".concat(t,"CancelAnimationFrame")]||Di["".concat(t,"CancelRequestAnimationFrame")]},Dz=function(t,e){for(var r=0;t[r]!==void 0;){if(e(t[r]))return t[r];r+=1}},PN=Dz(Lz,function(n){return!!CN(n)}),Ew=CN(PN),NN=Iz(PN);Di.requestAnimationFrame=Ew;Di.cancelAnimationFrame=NN;var Fz=function(){function n(){yt(this,n),this.callbacks=[]}return mt(n,[{key:"getCallbacksNum",value:function(){return this.callbacks.length}},{key:"tapPromise",value:function(e,r){this.callbacks.push(r)}},{key:"promise",value:function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return Promise.all(this.callbacks.map(function(a){return a.apply(void 0,r)}))}}])}(),Bz=function(){function n(){yt(this,n),this.callbacks=[]}return mt(n,[{key:"tapPromise",value:function(e,r){this.callbacks.push(r)}},{key:"promise",value:function(){var t=Ha(qn().mark(function r(){var i,a,s,o,l=arguments;return qn().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!this.callbacks.length){u.next=14;break}return u.next=3,(i=this.callbacks)[0].apply(i,l);case 3:a=u.sent,s=0;case 5:if(!(s<this.callbacks.length-1)){u.next=13;break}return o=this.callbacks[s],u.next=9,o(a);case 9:a=u.sent;case 10:s++,u.next=5;break;case 13:return u.abrupt("return",a);case 14:return u.abrupt("return",null);case 15:case"end":return u.stop()}},r,this)}));function e(){return t.apply(this,arguments)}return e}()}])}(),er=function(){function n(){yt(this,n),this.callbacks=[]}return mt(n,[{key:"tap",value:function(e,r){this.callbacks.push(r)}},{key:"call",value:function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];var a=arguments;this.callbacks.forEach(function(s){s.apply(void 0,a)})}}])}(),ig=function(){function n(){yt(this,n),this.callbacks=[]}return mt(n,[{key:"tap",value:function(e,r){this.callbacks.push(r)}},{key:"call",value:function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];if(this.callbacks.length){for(var a=arguments,s=this.callbacks[0].apply(void 0,a),o=0;o<this.callbacks.length-1;o++){var l=this.callbacks[o];s=l(s)}return s}return null}}])}(),zz=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],jz=/([\"\'])[^\'\"]+\1/;function qz(n){for(var t=n.fontSize,e=t===void 0?16:t,r=n.fontFamily,i=r===void 0?"sans-serif":r,a=n.fontStyle,s=a===void 0?"normal":a,o=n.fontVariant,l=o===void 0?"normal":o,c=n.fontWeight,u=c===void 0?"normal":c,h=Lt(e)&&"".concat(e,"px")||"16px",f=i.split(","),d=f.length-1;d>=0;d--){var g=f[d].trim();!jz.test(g)&&zz.indexOf(g)<0&&(g='"'.concat(g,'"')),f[d]=g}return"".concat(s," ").concat(l," ").concat(u," ").concat(h," ").concat(f.join(","))}function ag(n,t,e){return Wa(n),n[4]=Math.tan(t),n[1]=Math.tan(e),n}var cn=Ne(),$z=Ne(),Gz={scale:function(t){vs(cn,[t[0].value,t[1].value,1])},scaleX:function(t){vs(cn,[t[0].value,1,1])},scaleY:function(t){vs(cn,[1,t[0].value,1])},scaleZ:function(t){vs(cn,[1,1,t[0].value])},scale3d:function(t){vs(cn,[t[0].value,t[1].value,t[2].value])},translate:function(t){Ta(cn,[t[0].value,t[1].value,0])},translateX:function(t){Ta(cn,[t[0].value,0,0])},translateY:function(t){Ta(cn,[0,t[0].value,0])},translateZ:function(t){Ta(cn,[0,0,t[0].value])},translate3d:function(t){Ta(cn,[t[0].value,t[1].value,t[2].value])},rotate:function(t){B1(cn,Se(wr(t[0])))},rotateX:function(t){NP(cn,Se(wr(t[0])))},rotateY:function(t){RP(cn,Se(wr(t[0])))},rotateZ:function(t){B1(cn,Se(wr(t[0])))},rotate3d:function(t){PP(cn,Se(wr(t[3])),[t[0].value,t[1].value,t[2].value])},skew:function(t){ag(cn,Se(t[0].value),Se(t[1].value))},skewX:function(t){ag(cn,Se(t[0].value),0)},skewY:function(t){ag(cn,0,Se(t[0].value))},matrix:function(t){F1(cn,t[0].value,t[1].value,0,0,t[2].value,t[3].value,0,0,0,0,1,0,t[4].value,t[5].value,0,1)},matrix3d:function(t){F1.apply(qF,[cn].concat(Ie(t.map(function(e){return e.value}))))}},Wz=Fe(1,1,1),Vz=ge(),KE={translate:function(t,e){bt.sceneGraphService.setLocalScale(t,Wz,!1),bt.sceneGraphService.setLocalEulerAngles(t,Vz,void 0,void 0,!1),bt.sceneGraphService.setLocalPosition(t,[e[0].value,e[1].value,0],!1),bt.sceneGraphService.dirtifyLocal(t,t.transformable)}};function RN(n,t){if(n.length){if(n.length===1&&KE[n[0].t]){KE[n[0].t](t,n[0].d);return}for(var e=Wa($z),r=0;r<n.length;r++){var i=n[r],a=i.t,s=i.d,o=Gz[a];o&&(o(s),qP(e,e,cn))}t.setLocalTransform(e)}else t.resetLocalTransform();return t.getLocalTransform()}var Hz=function(){function n(){yt(this,n),this.parser=V5,this.mixer=tz}return mt(n,[{key:"calculator",value:function(e,r,i,a){return i instanceof Jr?[]:i}},{key:"postProcessor",value:function(e){RN(e.parsedStyle.transform,e)}}])}(),Uz=function(){function n(){yt(this,n)}return mt(n,[{key:"postProcessor",value:function(e){var r=e.parsedStyle.transformOrigin;r[0].unit===Ct.kPixels&&r[1].unit===Ct.kPixels?e.setOrigin(r[0].value,r[1].value):e.getGeometryBounds()}}])}(),Yz=function(){function n(){yt(this,n)}return mt(n,[{key:"calculator",value:function(e,r,i,a){return i.value}},{key:"postProcessor",value:function(e){if(e.parentNode){var r=e.parentNode,i=r.renderable,a=r.sortable;i&&(i.dirty=!0),a&&(a.dirty=!0,a.dirtyReason=ph.Z_INDEX_CHANGED)}}}])}(),Xz=function(){function n(){yt(this,n)}return mt(n,[{key:"update",value:function(e,r){var i=e.cx,a=i===void 0?0:i,s=e.cy,o=s===void 0?0:s,l=e.r,c=l===void 0?0:l;return{cx:a,cy:o,hwidth:c,hheight:c}}}])}(),Kz=function(){function n(){yt(this,n)}return mt(n,[{key:"update",value:function(e,r){var i=e.cx,a=i===void 0?0:i,s=e.cy,o=s===void 0?0:s,l=e.rx,c=l===void 0?0:l,u=e.ry,h=u===void 0?0:u;return{cx:a,cy:o,hwidth:c,hheight:h}}}])}(),Zz=function(){function n(){yt(this,n)}return mt(n,[{key:"update",value:function(e){var r=e.x1,i=e.y1,a=e.x2,s=e.y2,o=Math.min(r,a),l=Math.max(r,a),c=Math.min(i,s),u=Math.max(i,s),h=l-o,f=u-c,d=h/2,g=f/2;return{cx:o+d,cy:c+g,hwidth:d,hheight:g}}}])}(),Jz=function(){function n(){yt(this,n)}return mt(n,[{key:"update",value:function(e){var r=e.d,i=r.rect,a=i.x,s=i.y,o=i.width,l=i.height,c=o/2,u=l/2;return{cx:a+c,cy:s+u,hwidth:c,hheight:u}}}])}(),Qz=function(){function n(){yt(this,n)}return mt(n,[{key:"update",value:function(e){if(e.points&&$r(e.points.points)){var r=e.points.points,i=Math.min.apply(Math,Ie(r.map(function(f){return f[0]}))),a=Math.max.apply(Math,Ie(r.map(function(f){return f[0]}))),s=Math.min.apply(Math,Ie(r.map(function(f){return f[1]}))),o=Math.max.apply(Math,Ie(r.map(function(f){return f[1]}))),l=a-i,c=o-s,u=l/2,h=c/2;return{cx:i+u,cy:s+h,hwidth:u,hheight:h}}return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),tj=function(){function n(){yt(this,n)}return mt(n,[{key:"update",value:function(e,r){var i=e.x,a=i===void 0?0:i,s=e.y,o=s===void 0?0:s,l=e.src,c=e.width,u=c===void 0?0:c,h=e.height,f=h===void 0?0:h,d=u,g=f;return l&&!me(l)&&(d||(d=l.width,e.width=d),g||(g=l.height,e.height=g)),{cx:a+d/2,cy:o+g/2,hwidth:d/2,hheight:g/2}}}])}(),ej=function(){function n(t){yt(this,n),this.globalRuntime=t}return mt(n,[{key:"isReadyToMeasure",value:function(e,r){var i=e.text;return i}},{key:"update",value:function(e,r){var i,a=e.text,s=e.textAlign,o=s===void 0?"start":s,l=e.lineWidth,c=l===void 0?1:l,u=e.textBaseline,h=u===void 0?"alphabetic":u,f=e.dx,d=f===void 0?0:f,g=e.dy,v=g===void 0?0:g,p=e.x,y=p===void 0?0:p,m=e.y,w=m===void 0?0:m;if(!this.isReadyToMeasure(e,r))return e.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var E=(r==null||(i=r.ownerDocument)===null||i===void 0||(i=i.defaultView)===null||i===void 0?void 0:i.getConfig())||{},S=E.offscreenCanvas,O=this.globalRuntime.textService.measureText(a,e,S);e.metrics=O;var k=O.width,T=O.height,C=k/2,P=T/2,N=y+C;o==="center"||o==="middle"?N+=c/2-C:(o==="right"||o==="end")&&(N+=c-C*2);var L=w-P;return h==="middle"?L+=P:h==="top"||h==="hanging"?L+=P*2:h==="alphabetic"||(h==="bottom"||h==="ideographic")&&(L+=0),d&&(N+=d),v&&(L+=v),{cx:N,cy:L,hwidth:C,hheight:P}}}])}(),nj=function(){function n(){yt(this,n)}return mt(n,[{key:"update",value:function(e,r){return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),rj=function(){function n(){yt(this,n)}return mt(n,[{key:"update",value:function(e,r){var i=e.x,a=i===void 0?0:i,s=e.y,o=s===void 0?0:s,l=e.width,c=l===void 0?0:l,u=e.height,h=u===void 0?0:u;return{cx:a+c/2,cy:o+h/2,hwidth:c/2,hheight:h/2}}}])}(),Qh=function(){function n(t){yt(this,n),this.eventPhase=n.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new zn,this.page=new zn,this.canvas=new zn,this.viewport=new zn,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}return mt(n,[{key:"name",get:function(){return this.type}},{key:"layerX",get:function(){return this.layer.x}},{key:"layerY",get:function(){return this.layer.y}},{key:"pageX",get:function(){return this.page.x}},{key:"pageY",get:function(){return this.page.y}},{key:"x",get:function(){return this.canvas.x}},{key:"y",get:function(){return this.canvas.y}},{key:"canvasX",get:function(){return this.canvas.x}},{key:"canvasY",get:function(){return this.canvas.y}},{key:"viewportX",get:function(){return this.viewport.x}},{key:"viewportY",get:function(){return this.viewport.y}},{key:"composedPath",value:function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}},{key:"propagationPath",get:function(){return this.composedPath()}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw new Error(Ee)}}])}(),LN=function(n){function t(){var e;yt(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=ae(this,t,[].concat(i)),e.client=new zn,e.movement=new zn,e.offset=new zn,e.global=new zn,e.screen=new zn,e}return se(t,n),mt(t,[{key:"clientX",get:function(){return this.client.x}},{key:"clientY",get:function(){return this.client.y}},{key:"movementX",get:function(){return this.movement.x}},{key:"movementY",get:function(){return this.movement.y}},{key:"offsetX",get:function(){return this.offset.x}},{key:"offsetY",get:function(){return this.offset.y}},{key:"globalX",get:function(){return this.global.x}},{key:"globalY",get:function(){return this.global.y}},{key:"screenX",get:function(){return this.screen.x}},{key:"screenY",get:function(){return this.screen.y}},{key:"getModifierState",value:function(r){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(r)}},{key:"initMouseEvent",value:function(){throw new Error(Ee)}}])}(Qh),xh=function(n){function t(){var e;yt(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=ae(this,t,[].concat(i)),e.width=0,e.height=0,e.isPrimary=!1,e}return se(t,n),mt(t,[{key:"getCoalescedEvents",value:function(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}},{key:"getPredictedEvents",value:function(){throw new Error("getPredictedEvents is not supported!")}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this)}}])}(LN),ob=function(n){function t(){return yt(this,t),ae(this,t,arguments)}return se(t,n),mt(t,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this)}}])}(LN),pn=function(n){function t(e,r){var i;return yt(this,t),i=ae(this,t,[null]),i.type=e,i.detail=r,Object.assign(i,r),i}return se(t,n),mt(t)}(Qh),ZE=new WeakMap,IN=function(){function n(){yt(this,n),this.emitter=new EP}return mt(n,[{key:"on",value:function(e,r,i){return this.addEventListener(e,r,i),this}},{key:"addEventListener",value:function(e,r,i){var a=!1,s=!1;if(fh(i))a=i;else if(i){var o=i.capture;a=o===void 0?!1:o;var l=i.once;s=l===void 0?!1:l}a&&(e+="capture"),r=zt(r)?r:r.handleEvent;var c=zt(r)?void 0:r;return s?this.emitter.once(e,r,c):this.emitter.on(e,r,c),this}},{key:"off",value:function(e,r,i){return e?this.removeEventListener(e,r,i):this.removeAllEventListeners(),this}},{key:"removeAllEventListeners",value:function(){var e;(e=this.emitter)===null||e===void 0||e.removeAllListeners()}},{key:"removeEventListener",value:function(e,r,i){var a;if(!this.emitter)return this;var s=fh(i)?i:i==null?void 0:i.capture;s&&(e+="capture"),r=zt(r)?r:(a=r)===null||a===void 0?void 0:a.handleEvent;var o=zt(r)?void 0:r;return this.emitter.off(e,r,o),this}},{key:"emit",value:function(e,r){this.dispatchEvent(new pn(e,r))}},{key:"dispatchEvent",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=ZE.get(this);if(!i){var a;this.document?i=this:this.defaultView?i=this.defaultView:i=(a=this.ownerDocument)===null||a===void 0?void 0:a.defaultView,i&&ZE.set(this,i)}if(i){if(e.manager=i.getEventService(),!e.manager)return!1;e.defaultPrevented=!1,e.path?e.path.length=0:e.page=[],r||(e.target=this),e.manager.dispatchEvent(e,e.type,r)}else this.emitter.emit(e.type,e);return!e.defaultPrevented}}])}(),Ke=function(n){function t(){var e;yt(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=ae(this,t,[].concat(i)),e.shadow=!1,e.ownerDocument=null,e.isConnected=!1,e.baseURI="",e.childNodes=[],e.nodeType=0,e.nodeName="",e.nodeValue=null,e.parentNode=null,e}return se(t,n),mt(t,[{key:"textContent",get:function(){var r="";this.nodeName===ot.TEXT&&(r+=this.style.text);var i=ys(this.childNodes),a;try{for(i.s();!(a=i.n()).done;){var s=a.value;s.nodeName===ot.TEXT?r+=s.nodeValue:r+=s.textContent}}catch(o){i.e(o)}finally{i.f()}return r},set:function(r){var i=this;this.childNodes.slice().forEach(function(a){i.removeChild(a)}),this.nodeName===ot.TEXT&&(this.style.text="".concat(r))}},{key:"getRootNode",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(r):r.composed&&this.host?this.host.getRootNode(r):this}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0}},{key:"isDefaultNamespace",value:function(r){throw new Error(Ee)}},{key:"lookupNamespaceURI",value:function(r){throw new Error(Ee)}},{key:"lookupPrefix",value:function(r){throw new Error(Ee)}},{key:"normalize",value:function(){throw new Error(Ee)}},{key:"isEqualNode",value:function(r){return this===r}},{key:"isSameNode",value:function(r){return this.isEqualNode(r)}},{key:"parent",get:function(){return this.parentNode}},{key:"parentElement",get:function(){return null}},{key:"nextSibling",get:function(){return null}},{key:"previousSibling",get:function(){return null}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null}},{key:"compareDocumentPosition",value:function(r){if(r===this)return 0;for(var i=r,a=this,s=[i],o=[a];(l=i.parentNode)!==null&&l!==void 0?l:a.parentNode;){var l;i=i.parentNode?(s.push(i.parentNode),i.parentNode):i,a=a.parentNode?(o.push(a.parentNode),a.parentNode):a}if(i!==a)return t.DOCUMENT_POSITION_DISCONNECTED|t.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|t.DOCUMENT_POSITION_PRECEDING;var c=s.length>o.length?s:o,u=c===s?o:s;if(c[c.length-u.length]===u[0])return c===s?t.DOCUMENT_POSITION_CONTAINED_BY|t.DOCUMENT_POSITION_FOLLOWING:t.DOCUMENT_POSITION_CONTAINS|t.DOCUMENT_POSITION_PRECEDING;for(var h=c.length-u.length,f=u.length-1;f>=0;f--){var d=u[f],g=c[h+f];if(g!==d){var v=d.parentNode.childNodes;return v.indexOf(d)<v.indexOf(g)?u===s?t.DOCUMENT_POSITION_PRECEDING:t.DOCUMENT_POSITION_FOLLOWING:c===s?t.DOCUMENT_POSITION_PRECEDING:t.DOCUMENT_POSITION_FOLLOWING}}return t.DOCUMENT_POSITION_FOLLOWING}},{key:"contain",value:function(r){return this.contains(r)}},{key:"contains",value:function(r){for(var i=r;i&&this!==i;)i=i.parentNode;return!!i}},{key:"getAncestor",value:function(r){for(var i=this;r>0&&i;)i=i.parentNode,r--;return i}},{key:"forEach",value:function(r){for(var i=[this];i.length>0;){var a=i.pop(),s=r(a);if(s===!1)break;for(var o=a.childNodes.length-1;o>=0;o--)i.push(a.childNodes[o])}}}],[{key:"isNode",value:function(r){return!!r.childNodes}}])}(IN);Ke.DOCUMENT_POSITION_DISCONNECTED=1;Ke.DOCUMENT_POSITION_PRECEDING=2;Ke.DOCUMENT_POSITION_FOLLOWING=4;Ke.DOCUMENT_POSITION_CONTAINS=8;Ke.DOCUMENT_POSITION_CONTAINED_BY=16;Ke.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32;var ij=2048,aj=function(){function n(t,e){var r=this;yt(this,n),this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=Ne(),this.tmpVec3=ge(),this.onPointerDown=function(i){var a=r.createPointerEvent(i);if(r.dispatchEvent(a,"pointerdown"),a.pointerType==="touch")r.dispatchEvent(a,"touchstart");else if(a.pointerType==="mouse"||a.pointerType==="pen"){var s=a.button===2;r.dispatchEvent(a,s?"rightdown":"mousedown")}var o=r.trackingData(i.pointerId);o.pressTargetsByButton[i.button]=a.composedPath(),r.freeEvent(a)},this.onPointerUp=function(i){var a=sb.now(),s=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(s,"pointerup"),s.pointerType==="touch")r.dispatchEvent(s,"touchend");else if(s.pointerType==="mouse"||s.pointerType==="pen"){var o=s.button===2;r.dispatchEvent(s,o?"rightup":"mouseup")}var l=r.trackingData(i.pointerId),c=r.findMountedTarget(l.pressTargetsByButton[i.button]),u=c;if(c&&!s.composedPath().includes(c)){for(var h=c;h&&!s.composedPath().includes(h);){if(s.currentTarget=h,r.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch")r.notifyTarget(s,"touchendoutside");else if(s.pointerType==="mouse"||s.pointerType==="pen"){var f=s.button===2;r.notifyTarget(s,f?"rightupoutside":"mouseupoutside")}Ke.isNode(h)&&(h=h.parentNode)}delete l.pressTargetsByButton[i.button],u=h}if(u){var d,g=r.clonePointerEvent(s,"click");g.target=u,g.path=[],l.clicksByButton[i.button]||(l.clicksByButton[i.button]={clickCount:0,target:g.target,timeStamp:a});var v=r.context.renderingContext.root.ownerDocument.defaultView,p=l.clicksByButton[i.button];p.target===g.target&&a-p.timeStamp<v.getConfig().dblClickSpeed?++p.clickCount:p.clickCount=1,p.target=g.target,p.timeStamp=a,g.detail=p.clickCount,(d=s.detail)!==null&&d!==void 0&&d.preventClick||(!r.context.config.useNativeClickEvent&&(g.pointerType==="mouse"||g.pointerType==="touch")&&r.dispatchEvent(g,"click"),r.dispatchEvent(g,"pointertap")),r.freeEvent(g)}r.freeEvent(s)},this.onPointerMove=function(i){var a=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),s=a.pointerType==="mouse"||a.pointerType==="pen",o=r.trackingData(i.pointerId),l=r.findMountedTarget(o.overTargets);if(o.overTargets&&l!==a.target){var c=i.type==="mousemove"?"mouseout":"pointerout",u=r.createPointerEvent(i,c,l||void 0);if(r.dispatchEvent(u,"pointerout"),s&&r.dispatchEvent(u,"mouseout"),!a.composedPath().includes(l)){var h=r.createPointerEvent(i,"pointerleave",l||void 0);for(h.eventPhase=h.AT_TARGET;h.target&&!a.composedPath().includes(h.target);)h.currentTarget=h.target,r.notifyTarget(h),s&&r.notifyTarget(h,"mouseleave"),Ke.isNode(h.target)&&(h.target=h.target.parentNode);r.freeEvent(h)}r.freeEvent(u)}if(l!==a.target){var f=i.type==="mousemove"?"mouseover":"pointerover",d=r.clonePointerEvent(a,f);r.dispatchEvent(d,"pointerover"),s&&r.dispatchEvent(d,"mouseover");for(var g=l&&Ke.isNode(l)&&l.parentNode;g&&g!==(Ke.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&g!==a.target;)g=g.parentNode;var v=!g||g===(Ke.isNode(r.rootTarget)&&r.rootTarget.parentNode);if(v){var p=r.clonePointerEvent(a,"pointerenter");for(p.eventPhase=p.AT_TARGET;p.target&&p.target!==l&&p.target!==(Ke.isNode(r.rootTarget)&&r.rootTarget.parentNode);)p.currentTarget=p.target,r.notifyTarget(p),s&&r.notifyTarget(p,"mouseenter"),Ke.isNode(p.target)&&(p.target=p.target.parentNode);r.freeEvent(p)}r.freeEvent(d)}r.dispatchEvent(a,"pointermove"),a.pointerType==="touch"&&r.dispatchEvent(a,"touchmove"),s&&(r.dispatchEvent(a,"mousemove"),r.cursor=r.getCursor(a.target)),o.overTargets=a.composedPath(),r.freeEvent(a)},this.onPointerOut=function(i){var a=r.trackingData(i.pointerId);if(a.overTargets){var s=i.pointerType==="mouse"||i.pointerType==="pen",o=r.findMountedTarget(a.overTargets),l=r.createPointerEvent(i,"pointerout",o||void 0);r.dispatchEvent(l),s&&r.dispatchEvent(l,"mouseout");var c=r.createPointerEvent(i,"pointerleave",o||void 0);for(c.eventPhase=c.AT_TARGET;c.target&&c.target!==(Ke.isNode(r.rootTarget)&&r.rootTarget.parentNode);)c.currentTarget=c.target,r.notifyTarget(c),s&&r.notifyTarget(c,"mouseleave"),Ke.isNode(c.target)&&(c.target=c.target.parentNode);a.overTargets=null,r.freeEvent(l),r.freeEvent(c)}r.cursor=null},this.onPointerOver=function(i){var a=r.trackingData(i.pointerId),s=r.createPointerEvent(i),o=s.pointerType==="mouse"||s.pointerType==="pen";r.dispatchEvent(s,"pointerover"),o&&r.dispatchEvent(s,"mouseover"),s.pointerType==="mouse"&&(r.cursor=r.getCursor(s.target));var l=r.clonePointerEvent(s,"pointerenter");for(l.eventPhase=l.AT_TARGET;l.target&&l.target!==(Ke.isNode(r.rootTarget)&&r.rootTarget.parentNode);)l.currentTarget=l.target,r.notifyTarget(l),o&&r.notifyTarget(l,"mouseenter"),Ke.isNode(l.target)&&(l.target=l.target.parentNode);a.overTargets=s.composedPath(),r.freeEvent(s),r.freeEvent(l)},this.onPointerUpOutside=function(i){var a=r.trackingData(i.pointerId),s=r.findMountedTarget(a.pressTargetsByButton[i.button]),o=r.createPointerEvent(i);if(s){for(var l=s;l;)o.currentTarget=l,r.notifyTarget(o,"pointerupoutside"),o.pointerType==="touch"||(o.pointerType==="mouse"||o.pointerType==="pen")&&r.notifyTarget(o,o.button===2?"rightupoutside":"mouseupoutside"),Ke.isNode(l)&&(l=l.parentNode);delete a.pressTargetsByButton[i.button]}r.freeEvent(o)},this.onWheel=function(i){var a=r.createWheelEvent(i);r.dispatchEvent(a),r.freeEvent(a)},this.onClick=function(i){if(r.context.config.useNativeClickEvent){var a=r.createPointerEvent(i);r.dispatchEvent(a),r.freeEvent(a)}},this.onPointerCancel=function(i){var a=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(a),r.freeEvent(a)},this.globalRuntime=t,this.context=e}return mt(n,[{key:"init",value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick)}},{key:"destroy",value:function(){this.mappingTable={},this.mappingState={},this.eventPool.clear()}},{key:"getScale",value:function(){var e=this.context.contextService.getBoundingClientRect(),r=1,i=1,a=this.context.contextService.getDomElement();if(a&&e){var s=a.offsetWidth,o=a.offsetHeight;s&&o&&(r=e.width/s,i=e.height/o)}return{scaleX:r,scaleY:i,bbox:e}}},{key:"client2Viewport",value:function(e){var r=this.getScale(),i=r.scaleX,a=r.scaleY,s=r.bbox;return new zn((e.x-((s==null?void 0:s.left)||0))/i,(e.y-((s==null?void 0:s.top)||0))/a)}},{key:"viewport2Client",value:function(e){var r=this.getScale(),i=r.scaleX,a=r.scaleY,s=r.bbox;return new zn((e.x+((s==null?void 0:s.left)||0))*i,(e.y+((s==null?void 0:s.top)||0))*a)}},{key:"viewport2Canvas",value:function(e){var r=e.x,i=e.y,a=this.rootTarget.defaultView,s=a.getCamera(),o=this.context.config,l=o.width,c=o.height,u=s.getPerspectiveInverse(),h=s.getWorldTransform(),f=Zn(this.tmpMatrix,h,u),d=Kn(this.tmpVec3,r/l*2-1,(1-i/c)*2-1,0);return Jn(d,d,f),new zn(d[0],d[1])}},{key:"canvas2Viewport",value:function(e){var r=this.rootTarget.defaultView,i=r.getCamera(),a=i.getPerspective(),s=i.getViewTransform(),o=Zn(this.tmpMatrix,a,s),l=Kn(this.tmpVec3,e.x,e.y,0);Jn(this.tmpVec3,this.tmpVec3,o);var c=this.context.config,u=c.width,h=c.height;return new zn((l[0]+1)/2*u,(1-(l[1]+1)/2)*h)}},{key:"setPickHandler",value:function(e){this.pickHandler=e}},{key:"addEventMapping",value:function(e,r){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:r,priority:0}),this.mappingTable[e].sort(function(i,a){return i.priority-a.priority})}},{key:"mapEvent",value:function(e){if(this.rootTarget){var r=this.mappingTable[e.type];if(r)for(var i=0,a=r.length;i<a;i++)r[i].fn(e);else console.warn("[EventService]: Event mapping not defined for ".concat(e.type))}}},{key:"dispatchEvent",value:function(e,r,i){if(!i)e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,r);else{e.eventPhase=e.AT_TARGET;var a=this.rootTarget.defaultView||null;e.currentTarget=a,this.notifyListeners(e,r)}}},{key:"propagate",value:function(e,r){if(e.target){var i=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(var a=i.length-1;a>=1;a--)if(e.currentTarget=i[a],this.notifyTarget(e,r),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,r),!(e.propagationStopped||e.propagationImmediatelyStopped)){var s=i.indexOf(e.currentTarget);e.eventPhase=e.BUBBLING_PHASE;for(var o=s+1;o<i.length;o++)if(e.currentTarget=i[o],this.notifyTarget(e,r),e.propagationStopped||e.propagationImmediatelyStopped)return}}}},{key:"propagationPath",value:function(e){var r=[e],i=this.rootTarget.defaultView||null;if(i&&i===e)return r.unshift(i.document),r;for(var a=0;a<ij&&e!==this.rootTarget;a++)Ke.isNode(e)&&e.parentNode&&(r.push(e.parentNode),e=e.parentNode);return i&&r.push(i),r}},{key:"hitTest",value:function(e){var r=e.viewportX,i=e.viewportY,a=this.context.config,s=a.width,o=a.height,l=a.disableHitTesting;return r<0||i<0||r>s||i>o?null:!l&&this.pickHandler(e)||this.rootTarget||null}},{key:"isNativeEventFromCanvas",value:function(e,r){var i,a=r==null?void 0:r.target;if((i=a)!==null&&i!==void 0&&i.shadowRoot&&(a=r.composedPath()[0]),a){if(a===e)return!0;if(e&&e.contains)return e.contains(a)}return r!=null&&r.composedPath?r.composedPath().indexOf(e)>-1:!1}},{key:"getExistedHTML",value:function(e){if(e.nativeEvent.composedPath)for(var r=0,i=e.nativeEvent.composedPath();r<i.length;r++){var a=i[r],s=this.nativeHTMLMap.get(a);if(s)return s}return null}},{key:"pickTarget",value:function(e){return this.hitTest({clientX:e.clientX,clientY:e.clientY,viewportX:e.viewportX,viewportY:e.viewportY,x:e.canvasX,y:e.canvasY})}},{key:"createPointerEvent",value:function(e,r,i,a){var s=this.allocateEvent(xh);this.copyPointerData(e,s),this.copyMouseData(e,s),this.copyData(e,s),s.nativeEvent=e.nativeEvent,s.originalEvent=e;var o=this.getExistedHTML(s),l=this.context.contextService.getDomElement();return s.target=i??(o||this.isNativeEventFromCanvas(l,s.nativeEvent)&&this.pickTarget(s)||a),typeof r=="string"&&(s.type=r),s}},{key:"createWheelEvent",value:function(e){var r=this.allocateEvent(ob);this.copyWheelData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.nativeEvent=e.nativeEvent,r.originalEvent=e;var i=this.getExistedHTML(r),a=this.context.contextService.getDomElement();return r.target=i||this.isNativeEventFromCanvas(a,r.nativeEvent)&&this.pickTarget(r),r}},{key:"trackingData",value:function(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}},{key:"cloneWheelEvent",value:function(e){var r=this.allocateEvent(ob);return r.nativeEvent=e.nativeEvent,r.originalEvent=e.originalEvent,this.copyWheelData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.target=e.target,r.path=e.composedPath().slice(),r.type=e.type,r}},{key:"clonePointerEvent",value:function(e,r){var i=this.allocateEvent(xh);return i.nativeEvent=e.nativeEvent,i.originalEvent=e.originalEvent,this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.target=e.target,i.path=e.composedPath().slice(),i.type=r??i.type,i}},{key:"copyPointerData",value:function(e,r){r.pointerId=e.pointerId,r.width=e.width,r.height=e.height,r.isPrimary=e.isPrimary,r.pointerType=e.pointerType,r.pressure=e.pressure,r.tangentialPressure=e.tangentialPressure,r.tiltX=e.tiltX,r.tiltY=e.tiltY,r.twist=e.twist}},{key:"copyMouseData",value:function(e,r){r.altKey=e.altKey,r.button=e.button,r.buttons=e.buttons,r.ctrlKey=e.ctrlKey,r.metaKey=e.metaKey,r.shiftKey=e.shiftKey,r.client.copyFrom(e.client),r.movement.copyFrom(e.movement),r.canvas.copyFrom(e.canvas),r.screen.copyFrom(e.screen),r.global.copyFrom(e.global),r.offset.copyFrom(e.offset)}},{key:"copyWheelData",value:function(e,r){r.deltaMode=e.deltaMode,r.deltaX=e.deltaX,r.deltaY=e.deltaY,r.deltaZ=e.deltaZ}},{key:"copyData",value:function(e,r){r.isTrusted=e.isTrusted,r.timeStamp=sb.now(),r.type=e.type,r.detail=e.detail,r.view=e.view,r.page.copyFrom(e.page),r.viewport.copyFrom(e.viewport)}},{key:"allocateEvent",value:function(e){this.eventPool.has(e)||this.eventPool.set(e,[]);var r=this.eventPool.get(e).pop()||new e(this);return r.eventPhase=r.NONE,r.currentTarget=null,r.path=[],r.target=null,r}},{key:"freeEvent",value:function(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var r=e.constructor;this.eventPool.has(r)||this.eventPool.set(r,[]),this.eventPool.get(r).push(e)}},{key:"notifyTarget",value:function(e,r){r=r??e.type;var i=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?"".concat(r,"capture"):r;this.notifyListeners(e,i),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,r)}},{key:"notifyListeners",value:function(e,r){var i=e.currentTarget.emitter,a=i._events[r];if(a)if("fn"in a)a.once&&i.removeListener(r,a.fn,void 0,!0),a.fn.call(e.currentTarget||a.context,e);else for(var s=0;s<a.length&&!e.propagationImmediatelyStopped;s++)a[s].once&&i.removeListener(r,a[s].fn,void 0,!0),a[s].fn.call(e.currentTarget||a[s].context,e)}},{key:"findMountedTarget",value:function(e){if(!e)return null;for(var r=e[e.length-1],i=e.length-2;i>=0;i--){var a=e[i];if(a===this.rootTarget||Ke.isNode(a)&&a.parentNode===r)r=e[i];else break}return r}},{key:"getCursor",value:function(e){for(var r=e;r;){var i=xz(r)&&r.getAttribute("cursor");if(i)return i;r=Ke.isNode(r)&&r.parentNode}}}])}(),Sw=function(){function n(){yt(this,n)}return mt(n,[{key:"getOrCreateCanvas",value:function(e,r){if(this.canvas)return this.canvas;if(e||bt.offscreenCanvas)this.canvas=e||bt.offscreenCanvas,this.context=this.canvas.getContext("2d",ie({willReadFrequently:!0},r));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",ie({willReadFrequently:!0},r)),(!this.context||!this.context.measureText)&&(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch{this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",ie({willReadFrequently:!0},r))}return this.canvas.width=10,this.canvas.height=10,this.canvas}},{key:"getOrCreateContext",value:function(e,r){return this.context?this.context:(this.getOrCreateCanvas(e,r),this.context)}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0)}catch{}try{return document.createElement("canvas")}catch{}return null}}])}(),So=function(n){return n[n.CAMERA_CHANGED=0]="CAMERA_CHANGED",n[n.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",n[n.NONE=2]="NONE",n}({}),sj=function(){function n(t,e){yt(this,n),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new er,initAsync:new Fz,dirtycheck:new ig,cull:new ig,beginFrame:new er,beforeRender:new er,render:new er,afterRender:new er,endFrame:new er,destroy:new er,pick:new Bz,pickSync:new ig,pointerDown:new er,pointerUp:new er,pointerMove:new er,pointerOut:new er,pointerOver:new er,pointerWheel:new er,pointerCancel:new er,click:new er},this.globalRuntime=t,this.context=e}return mt(n,[{key:"init",value:function(e){var r=this,i=ie(ie({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(a){a.apply(i,r.globalRuntime)}),this.hooks.init.call(),this.hooks.initAsync.getCallbacksNum()===0?(this.inited=!0,e()):this.hooks.initAsync.promise().then(function(){r.inited=!0,e()}).catch(function(a){})}},{key:"getStats",value:function(){return this.stats}},{key:"disableDirtyRectangleRendering",value:function(){var e=this.context.config.renderer,r=e.getConfig(),i=r.enableDirtyRectangleRendering;return!i||this.context.renderingContext.renderReasons.has(So.CAMERA_CHANGED)}},{key:"render",value:function(e,r,i){var a=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var s=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(s.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),s.renderReasons.size&&this.inited){s.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var o=s.renderReasons.size===1&&s.renderReasons.has(So.CAMERA_CHANGED),l=!e.disableRenderHooks||!(e.disableRenderHooks&&o);l&&this.renderDisplayObject(s.root,e,s),this.hooks.beginFrame.call(r),l&&s.renderListCurrentFrame.forEach(function(c){a.hooks.beforeRender.call(c),a.hooks.render.call(c),a.hooks.afterRender.call(c)}),this.hooks.endFrame.call(r),s.renderListCurrentFrame=[],s.renderReasons.clear(),i()}}},{key:"renderDisplayObject",value:function(e,r,i){var a=this,s=r.renderer.getConfig(),o=s.enableDirtyCheck,l=s.enableCulling;function c(g){var v=g.renderable,p=g.sortable,y=o?v.dirty||i.dirtyRectangleRenderingDisabled?g:null:g;if(y){var m=l?a.hooks.cull.call(y,a.context.camera):y;m&&(a.stats.rendered+=1,i.renderListCurrentFrame.push(m))}v.dirty=!1,p.renderOrder=a.zIndexCounter,a.zIndexCounter+=1,a.stats.total+=1,p.dirty&&(a.sort(g,p),p.dirty=!1,p.dirtyChildren=[],p.dirtyReason=void 0)}for(var u=[e];u.length>0;){var h=u.pop();c(h);for(var f=h.sortable.sorted||h.childNodes,d=f.length-1;d>=0;d--)u.push(f[d])}}},{key:"sort",value:function(e,r){r.sorted&&r.dirtyReason!==ph.Z_INDEX_CHANGED?r.dirtyChildren.forEach(function(i){var a=e.childNodes.indexOf(i);if(a===-1){var s=r.sorted.indexOf(i);s>=0&&r.sorted.splice(s,1)}else if(r.sorted.length===0)r.sorted.push(i);else{var o=Ez(r.sorted,i);r.sorted.splice(o,0,i)}}):r.sorted=e.childNodes.slice().sort(TN)}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents()}},{key:"dirtify",value:function(){this.context.renderingContext.renderReasons.add(So.DISPLAY_OBJECT_CHANGED)}}])}(),oj=/\[\s*(.*)=(.*)\s*\]/,lj=function(){function n(){yt(this,n)}return mt(n,[{key:"selectOne",value:function(e,r){var i=this;if(e.startsWith("."))return r.find(function(l){return((l==null?void 0:l.classList)||[]).indexOf(i.getIdOrClassname(e))>-1});if(e.startsWith("#"))return r.find(function(l){return l.id===i.getIdOrClassname(e)});if(e.startsWith("[")){var a=this.getAttribute(e),s=a.name,o=a.value;return s?r.find(function(l){return r!==l&&(s==="name"?l.name===o:i.attributeToString(l,s)===o)}):null}return r.find(function(l){return r!==l&&l.nodeName===e})}},{key:"selectAll",value:function(e,r){var i=this;if(e.startsWith("."))return r.findAll(function(l){return r!==l&&((l==null?void 0:l.classList)||[]).indexOf(i.getIdOrClassname(e))>-1});if(e.startsWith("#"))return r.findAll(function(l){return r!==l&&l.id===i.getIdOrClassname(e)});if(e.startsWith("[")){var a=this.getAttribute(e),s=a.name,o=a.value;return s?r.findAll(function(l){return r!==l&&(s==="name"?l.name===o:i.attributeToString(l,s)===o)}):[]}return r.findAll(function(l){return r!==l&&l.nodeName===e})}},{key:"is",value:function(e,r){if(e.startsWith("."))return r.className===this.getIdOrClassname(e);if(e.startsWith("#"))return r.id===this.getIdOrClassname(e);if(e.startsWith("[")){var i=this.getAttribute(e),a=i.name,s=i.value;return a==="name"?r.name===s:this.attributeToString(r,a)===s}return r.nodeName===e}},{key:"getIdOrClassname",value:function(e){return e.substring(1)}},{key:"getAttribute",value:function(e){var r=e.match(oj),i="",a="";return r&&r.length>2&&(i=r[1].replace(/"/g,""),a=r[2].replace(/"/g,"")),{name:i,value:a}}},{key:"attributeToString",value:function(e,r){if(!e.getAttribute)return"";var i=e.getAttribute(r);return Ut(i)?"":i.toString?i.toString():""}}])}(),ce=function(n){return n.ATTR_MODIFIED="DOMAttrModified",n.INSERTED="DOMNodeInserted",n.MOUNTED="DOMNodeInsertedIntoDocument",n.REMOVED="removed",n.UNMOUNTED="DOMNodeRemovedFromDocument",n.REPARENT="reparent",n.DESTROY="destroy",n.BOUNDS_CHANGED="bounds-changed",n.CULLED="culled",n}({}),Bi=function(n){function t(e,r,i,a,s,o,l,c){var u;return yt(this,t),u=ae(this,t,[null]),u.relatedNode=r,u.prevValue=i,u.newValue=a,u.attrName=s,u.attrChange=o,u.prevParsedValue=l,u.newParsedValue=c,u.type=e,u}return se(t,n),mt(t)}(Qh);Bi.ADDITION=2;Bi.MODIFICATION=1;Bi.REMOVAL=3;function JE(n){var t=n.renderable;t&&(t.renderBoundsDirty=!0,t.boundsDirty=!0)}var cj=new Bi(ce.REPARENT,null,"","","",0,"",""),uj=dw(),Kc=ge(),hj=Fe(1,1,1),fj=Ne(),dj=dw(),va=ge(),eo=Ne(),ya=_n(),gj=ge(),pj=_n(),vj=ge(),Qo=ge(),us=ge(),Zc=Ne(),QE=_n(),t2=_n(),Jc=_n(),sg={affectChildren:!0},yj=function(){function n(t){yt(this,n),this.pendingEvents=new Map,this.boundsChangedEvent=new pn(ce.BOUNDS_CHANGED),this.displayObjectDependencyMap=new WeakMap,this.runtime=t}return mt(n,[{key:"matches",value:function(e,r){return this.runtime.sceneGraphSelector.is(e,r)}},{key:"querySelector",value:function(e,r){return this.runtime.sceneGraphSelector.selectOne(e,r)}},{key:"querySelectorAll",value:function(e,r){return this.runtime.sceneGraphSelector.selectAll(e,r)}},{key:"attach",value:function(e,r,i){var a,s=!1;e.parentNode&&(s=e.parentNode!==r,this.detach(e));var o=e.nodeName===ot.FRAGMENT,l=wh(r);e.parentNode=r;var c=o?e.childNodes:[e];Lt(i)?c.forEach(function(d){r.childNodes.splice(i,0,d),d.parentNode=r}):c.forEach(function(d){r.childNodes.push(d),d.parentNode=r});var u=r,h=u.sortable;if((h!=null&&(a=h.sorted)!==null&&a!==void 0&&a.length||e.parsedStyle.zIndex)&&(h.dirtyChildren.indexOf(e)===-1&&h.dirtyChildren.push(e),h.dirty=!0,h.dirtyReason=ph.ADDED),!l){if(o)this.dirtifyFragment(e);else{var f=e.transformable;f&&this.dirtifyWorld(e,f)}s&&e.dispatchEvent(cj)}}},{key:"detach",value:function(e){if(e.parentNode){var r,i,a=e.transformable,s=e.parentNode,o=s.sortable;(o!=null&&(r=o.sorted)!==null&&r!==void 0&&r.length||(i=e.style)!==null&&i!==void 0&&i.zIndex)&&(o.dirtyChildren.indexOf(e)===-1&&o.dirtyChildren.push(e),o.dirty=!0,o.dirtyReason=ph.REMOVED);var l=e.parentNode.childNodes.indexOf(e);l>-1&&e.parentNode.childNodes.splice(l,1),a&&this.dirtifyWorld(e,a),e.parentNode=null}}},{key:"getOrigin",value:function(e){return e.getGeometryBounds(),e.transformable.origin}},{key:"setOrigin",value:function(e,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof r=="number"&&(r=[r,i,a]);var s=e.transformable;if(!(r[0]===s.origin[0]&&r[1]===s.origin[1]&&r[2]===s.origin[2])){var o=s.origin;o[0]=r[0],o[1]=r[1],o[2]=r[2]||0,this.dirtifyLocal(e,s)}}},{key:"rotate",value:function(e,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof r=="number"&&(r=Fe(r,i,a));var s=e.transformable;if(e.parentNode===null||!e.parentNode.transformable)this.rotateLocal(e,r);else{var o=ya;qc(o,r[0],r[1],r[2]);var l=this.getRotation(e),c=this.getRotation(e.parentNode);$c(Jc,c),Gd(Jc,Jc),Ba(o,Jc,o),Ba(s.localRotation,o,l),lh(s.localRotation,s.localRotation),this.dirtifyLocal(e,s)}}},{key:"rotateLocal",value:function(e,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof r=="number"&&(r=Fe(r,i,a));var s=e.transformable;qc(t2,r[0],r[1],r[2]),gE(s.localRotation,s.localRotation,t2),this.dirtifyLocal(e,s)}},{key:"setEulerAngles",value:function(e,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof r=="number"&&(r=Fe(r,i,a));var s=e.transformable;if(e.parentNode===null||!e.parentNode.transformable)this.setLocalEulerAngles(e,r);else{qc(s.localRotation,r[0],r[1],r[2]);var o=this.getRotation(e.parentNode);$c(QE,Gd(ya,o)),gE(s.localRotation,s.localRotation,QE),this.dirtifyLocal(e,s)}}},{key:"setLocalEulerAngles",value:function(e,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;typeof r=="number"&&(r=Fe(r,i,a));var o=e.transformable;qc(o.localRotation,r[0],r[1],r[2]),s&&this.dirtifyLocal(e,o)}},{key:"translateLocal",value:function(e,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof r=="number"&&(r=Fe(r,i,a));var s=e.transformable;Zo(r,Kc)||(UF(r,r,s.localRotation),Fa(s.localPosition,s.localPosition,r),this.dirtifyLocal(e,s))}},{key:"setPosition",value:function(e,r){var i,a=e.transformable;if(us[0]=r[0],us[1]=r[1],us[2]=(i=r[2])!==null&&i!==void 0?i:0,!Zo(this.getPosition(e),us)){if(Ci(a.position,us),e.parentNode===null||!e.parentNode.transformable)Ci(a.localPosition,us);else{var s=e.parentNode.transformable;To(Zc,s.worldTransform),Ai(Zc,Zc),Jn(a.localPosition,us,Zc)}this.dirtifyLocal(e,a)}}},{key:"setLocalPosition",value:function(e,r){var i,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=e.transformable;Qo[0]=r[0],Qo[1]=r[1],Qo[2]=(i=r[2])!==null&&i!==void 0?i:0,!Zo(s.localPosition,Qo)&&(Ci(s.localPosition,Qo),a&&this.dirtifyLocal(e,s))}},{key:"scaleLocal",value:function(e,r){var i,a=e.transformable;$F(a.localScale,a.localScale,Kn(va,r[0],r[1],(i=r[2])!==null&&i!==void 0?i:1)),this.dirtifyLocal(e,a)}},{key:"setLocalScale",value:function(e,r){var i,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=e.transformable;Kn(va,r[0],r[1],(i=r[2])!==null&&i!==void 0?i:s.localScale[2]),!Zo(va,s.localScale)&&(Ci(s.localScale,va),a&&this.dirtifyLocal(e,s))}},{key:"translate",value:function(e,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof r=="number"&&(r=Kn(va,r,i,a)),!Zo(r,Kc)&&(Fa(va,this.getPosition(e),r),this.setPosition(e,va))}},{key:"setRotation",value:function(e,r,i,a,s){var o=e.transformable;if(typeof r=="number"&&(r=QF(r,i,a,s)),e.parentNode===null||!e.parentNode.transformable)this.setLocalRotation(e,r);else{var l=this.getRotation(e.parentNode);$c(ya,l),Gd(ya,ya),Ba(o.localRotation,ya,r),lh(o.localRotation,o.localRotation),this.dirtifyLocal(e,o)}}},{key:"setLocalRotation",value:function(e,r,i,a,s){var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;typeof r=="number"&&(r=dE(ya,r,i,a,s));var l=e.transformable;$c(l.localRotation,r),o&&this.dirtifyLocal(e,l)}},{key:"setLocalSkew",value:function(e,r,i){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;typeof r=="number"&&(r=eB(dj,r,i));var s=e.transformable;tB(s.localSkew,r),a&&this.dirtifyLocal(e,s)}},{key:"dirtifyLocal",value:function(e,r){wh(e)||r.localDirtyFlag||(r.localDirtyFlag=!0,r.dirtyFlag||this.dirtifyWorld(e,r))}},{key:"dirtifyWorld",value:function(e,r){r.dirtyFlag||this.unfreezeParentToRoot(e),this.dirtifyWorldInternal(e,r),this.dirtifyToRoot(e,!0)}},{key:"dirtifyFragment",value:function(e){var r=e.transformable;r&&(r.frozen=!1,r.dirtyFlag=!0,r.localDirtyFlag=!0);var i=e.renderable;i&&(i.renderBoundsDirty=!0,i.boundsDirty=!0,i.dirty=!0);for(var a=e.childNodes.length,s=0;s<a;s++)this.dirtifyFragment(e.childNodes[s]);e.nodeName===ot.FRAGMENT&&this.pendingEvents.set(e,!1)}},{key:"triggerPendingEvents",value:function(){var e=this,r=new Set,i=function(s,o){!s.isConnected||r.has(s)||s.nodeName===ot.FRAGMENT||(e.boundsChangedEvent.detail=o,e.boundsChangedEvent.target=s,s.isMutationObserved?s.dispatchEvent(e.boundsChangedEvent):s.ownerDocument.defaultView.dispatchEvent(e.boundsChangedEvent,!0),r.add(s))};this.pendingEvents.forEach(function(a,s){s.nodeName!==ot.FRAGMENT&&(sg.affectChildren=a,a?s.forEach(function(o){i(o,sg)}):i(s,sg))}),r.clear(),this.clearPendingEvents()}},{key:"clearPendingEvents",value:function(){this.pendingEvents.clear()}},{key:"dirtifyToRoot",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=e;for(i.renderable&&(i.renderable.dirty=!0);i;)JE(i),i=i.parentNode;r&&e.forEach(function(a){JE(a)}),this.informDependentDisplayObjects(e),this.pendingEvents.set(e,r)}},{key:"updateDisplayObjectDependency",value:function(e,r,i,a){if(r&&r!==i){var s=this.displayObjectDependencyMap.get(r);if(s&&s[e]){var o=s[e].indexOf(a);s[e].splice(o,1)}}if(i){var l=this.displayObjectDependencyMap.get(i);l||(this.displayObjectDependencyMap.set(i,{}),l=this.displayObjectDependencyMap.get(i)),l[e]||(l[e]=[]),l[e].push(a)}}},{key:"informDependentDisplayObjects",value:function(e){var r=this,i=this.displayObjectDependencyMap.get(e);i&&Object.keys(i).forEach(function(a){i[a].forEach(function(s){r.dirtifyToRoot(s,!0),s.dispatchEvent(new Bi(ce.ATTR_MODIFIED,s,r,r,a,Bi.MODIFICATION,r,r)),s.isCustomElement&&s.isConnected&&s.attributeChangedCallback&&s.attributeChangedCallback(a,r,r)})})}},{key:"getPosition",value:function(e){var r=e.transformable;return ah(r.position,this.getWorldTransform(e,r))}},{key:"getRotation",value:function(e){var r=e.transformable;return sh(r.rotation,this.getWorldTransform(e,r))}},{key:"getScale",value:function(e){var r=e.transformable;return ko(r.scaling,this.getWorldTransform(e,r))}},{key:"getWorldTransform",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.transformable;return!r.localDirtyFlag&&!r.dirtyFlag||(e.parentNode&&e.parentNode.transformable&&this.getWorldTransform(e.parentNode),this.sync(e,r)),r.worldTransform}},{key:"getLocalPosition",value:function(e){return e.transformable.localPosition}},{key:"getLocalRotation",value:function(e){return e.transformable.localRotation}},{key:"getLocalScale",value:function(e){return e.transformable.localScale}},{key:"getLocalSkew",value:function(e){return e.transformable.localSkew}},{key:"calcLocalTransform",value:function(e){var r=e.localSkew[0]!==0||e.localSkew[1]!==0;if(r){Al(e.localTransform,e.localRotation,e.localPosition,Fe(1,1,1),e.origin),(e.localSkew[0]!==0||e.localSkew[1]!==0)&&(Wa(eo),eo[4]=Math.tan(e.localSkew[0]),eo[1]=Math.tan(e.localSkew[1]),Zn(e.localTransform,e.localTransform,eo));var i=Al(eo,dE(ya,0,0,0,1),Kn(va,1,1,1),e.localScale,e.origin);Zn(e.localTransform,e.localTransform,i)}else{var a=e.localTransform,s=e.localPosition,o=e.localRotation,l=e.localScale,c=e.origin,u=s[0]!==0||s[1]!==0||s[2]!==0,h=o[3]!==1||o[0]!==0||o[1]!==0||o[2]!==0,f=l[0]!==1||l[1]!==1||l[2]!==1,d=c[0]!==0||c[1]!==0||c[2]!==0;!h&&!f&&!d?u?Ta(a,s):Wa(a):Al(a,o,s,l,c)}}},{key:"getLocalTransform",value:function(e){var r=e.transformable;return r.localDirtyFlag&&(this.calcLocalTransform(r),r.localDirtyFlag=!1),r.localTransform}},{key:"setLocalTransform",value:function(e,r){var i=ah(gj,r),a=sh(pj,r),s=ko(vj,r);this.setLocalScale(e,s,!1),this.setLocalPosition(e,i,!1),this.setLocalRotation(e,a,void 0,void 0,void 0,!1),this.dirtifyLocal(e,e.transformable)}},{key:"resetLocalTransform",value:function(e){this.setLocalScale(e,hj,!1),this.setLocalPosition(e,Kc,!1),this.setLocalEulerAngles(e,Kc,void 0,void 0,!1),this.setLocalSkew(e,uj,void 0,!1),this.dirtifyLocal(e,e.transformable)}},{key:"getTransformedGeometryBounds",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2?arguments[2]:void 0,a=this.getGeometryBounds(e,r);if(!Re.isEmpty(a)){var s=i||new Re;return s.setFromTransformedAABB(a,this.getWorldTransform(e)),s}return null}},{key:"getGeometryBounds",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=e,a=i.geometry;a.dirty&&bt.styleValueRegistry.updateGeometry(e);var s=r?a.renderBounds:a.contentBounds||null;return s||new Re}},{key:"getBounds",value:function(e){var r=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=e,s=a.renderable;if(!s.boundsDirty&&!i&&s.bounds)return s.bounds;if(!s.renderBoundsDirty&&i&&s.renderBounds)return s.renderBounds;var o=i?s.renderBounds:s.bounds,l=this.getTransformedGeometryBounds(e,i,o),c=e.childNodes;if(c.forEach(function(f){var d=r.getBounds(f,i);d&&(l?l.add(d):(l=o||new Re,l.update(d.center,d.halfExtents)))}),l||(l=new Re),i){var u=kN(e);if(u){var h=u.parsedStyle.clipPath.getBounds(i);l?h&&(l=h.intersection(l)):l.update(h.center,h.halfExtents)}}return i?(s.renderBounds=l,s.renderBoundsDirty=!1):(s.bounds=l,s.boundsDirty=!1),l}},{key:"getLocalBounds",value:function(e){if(e.parentNode){var r=fj;e.parentNode.transformable&&(r=Ai(eo,this.getWorldTransform(e.parentNode)));var i=this.getBounds(e);if(!Re.isEmpty(i)){var a=new Re;return a.setFromTransformedAABB(i,r),a}}return this.getBounds(e)}},{key:"getBoundingClientRect",value:function(e){var r,i,a=this.getGeometryBounds(e);Re.isEmpty(a)||(i=new Re,i.setFromTransformedAABB(a,this.getWorldTransform(e)));var s=(r=e.ownerDocument)===null||r===void 0||(r=r.defaultView)===null||r===void 0?void 0:r.getContextService().getBoundingClientRect();if(i){var o=i.getMin(),l=ne(o,2),c=l[0],u=l[1],h=i.getMax(),f=ne(h,2),d=f[0],g=f[1];return new Co(c+((s==null?void 0:s.left)||0),u+((s==null?void 0:s.top)||0),d-c,g-u)}return new Co((s==null?void 0:s.left)||0,(s==null?void 0:s.top)||0,0,0)}},{key:"dirtifyWorldInternal",value:function(e,r){var i=this;if(!r.dirtyFlag){r.dirtyFlag=!0,r.frozen=!1,e.childNodes.forEach(function(o){var l=o.transformable;l.dirtyFlag||i.dirtifyWorldInternal(o,l)});var a=e,s=a.renderable;s&&(s.renderBoundsDirty=!0,s.boundsDirty=!0,s.dirty=!0)}}},{key:"syncHierarchy",value:function(e){var r=e.transformable;if(!r.frozen){r.frozen=!0,(r.localDirtyFlag||r.dirtyFlag)&&this.sync(e,r);for(var i=e.childNodes,a=0;a<i.length;a++)this.syncHierarchy(i[a])}}},{key:"sync",value:function(e,r){if(r.localDirtyFlag&&(this.calcLocalTransform(r),r.localDirtyFlag=!1),r.dirtyFlag){var i=e.parentNode,a=i&&i.transformable;i===null||!a?To(r.worldTransform,r.localTransform):Zn(r.worldTransform,a.worldTransform,r.localTransform),r.dirtyFlag=!1}}},{key:"unfreezeParentToRoot",value:function(e){for(var r=e.parentNode;r;){var i=r.transformable;i&&(i.frozen=!1),r=r.parentNode}}}])}(),hs={MetricsString:"|q",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},e2=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,mj=/[!%),.:;?\]}'""]/,bj=/[$('"]/,wj=/[!),.:;?\]}'""]/,xj=/[([{'"]/,Ej=/[)\]'"?!:;,.]/,Sj=/[(['"...]/,_j=/[!%),.:;?\]}'"]/,Mj=/[$([{'"#]/,Oj=new RegExp("".concat(mj.source,"|").concat(wj.source,"|").concat(Ej.source,"|").concat(_j.source)),Tj=new RegExp("".concat(bj.source,"|").concat(xj.source,"|").concat(Sj.source,"|").concat(Mj.source)),kj=function(){function n(t){var e=this;yt(this,n),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(r,i){return e.isBreakingSpace(i)?!1:!!(r&&(Tj.exec(i)||Oj.exec(r)))},this.trimByKinsokuShorui=function(r){var i=Ie(r),a=i[i.length-2];if(!a)return r;var s=a[a.length-1];return i[i.length-2]=a.slice(0,-1),i[i.length-1]=s+i[i.length-1],i},this.runtime=t}return mt(n,[{key:"measureFont",value:function(e,r){if(this.fontMetricsCache[e])return this.fontMetricsCache[e];var i={ascent:0,descent:0,fontSize:0},a=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(r),s=this.runtime.offscreenCanvasCreator.getOrCreateContext(r,{willReadFrequently:!0});s.font=e;var o=hs.MetricsString+hs.BaselineSymbol,l=Math.ceil(s.measureText(o).width),c=Math.ceil(s.measureText(hs.BaselineSymbol).width),u=hs.HeightMultiplier*c;c=c*hs.BaselineMultiplier|0,a.width=l,a.height=u,s.fillStyle="#f00",s.fillRect(0,0,l,u),s.font=e,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText(o,0,c);var h=s.getImageData(0,0,l||1,u||1).data,f=h.length,d=l*4,g=0,v=0,p=!1;for(g=0;g<c;++g){for(var y=0;y<d;y+=4)if(h[v+y]!==255){p=!0;break}if(!p)v+=d;else break}for(i.ascent=c-g,v=f-d,p=!1,g=u;g>c;--g){for(var m=0;m<d;m+=4)if(h[v+m]!==255){p=!0;break}if(!p)v-=d;else break}return i.descent=g-c,i.fontSize=i.ascent+i.descent,this.fontMetricsCache[e]=i,i}},{key:"measureText",value:function(e,r,i){var a=r.fontSize,s=a===void 0?16:a,o=r.wordWrap,l=o===void 0?!1:o,c=r.lineHeight,u=r.lineWidth,h=u===void 0?1:u,f=r.textBaseline,d=f===void 0?"alphabetic":f,g=r.textAlign,v=g===void 0?"start":g,p=r.letterSpacing,y=p===void 0?0:p,m=r.textPath;r.textPathSide,r.textPathStartOffset;var w=r.leading,E=w===void 0?0:w,S=qz(r),O=this.measureFont(S,i);O.fontSize===0&&(O.fontSize=s,O.ascent=s);var k=this.runtime.offscreenCanvasCreator.getOrCreateContext(i);k.font=S,r.isOverflowing=!1;var T=l?this.wordWrap(e,r,i):e,C=T.split(/(?:\r\n|\r|\n)/),P=new Array(C.length),N=0;if(m){m.getTotalLength();for(var L=0;L<C.length;L++)k.measureText(C[L]).width+(C[L].length-1)*y}else{for(var D=0;D<C.length;D++){var G=k.measureText(C[D]).width+(C[D].length-1)*y;P[D]=G,N=Math.max(N,G)}var H=N+h,W=c||O.fontSize+h,q=Math.max(W,O.fontSize+h)+(C.length-1)*(W+E);W+=E;var z=0;return d==="middle"?z=-q/2:d==="bottom"||d==="alphabetic"||d==="ideographic"?z=-q:(d==="top"||d==="hanging")&&(z=0),{font:S,width:H,height:q,lines:C,lineWidths:P,lineHeight:W,maxLineWidth:N,fontProperties:O,lineMetrics:P.map(function(Z,at){var ft=0;return v==="center"||v==="middle"?ft-=Z/2:(v==="right"||v==="end")&&(ft-=Z),new Co(ft-h/2,z+at*W,Z+h,W)})}}}},{key:"wordWrap",value:function(e,r,i){var a=this,s=this,o=r.wordWrapWidth,l=o===void 0?0:o,c=r.letterSpacing,u=c===void 0?0:c,h=r.maxLines,f=h===void 0?1/0:h,d=r.textOverflow,g=this.runtime.offscreenCanvasCreator.getOrCreateContext(i),v=l+u,p="";d==="ellipsis"?p="...":d&&d!=="clip"&&(p=d);var y=Array.from(e),m=[],w=0,E=0,S=0,O={},k=function(z){return a.getFromCache(z,u,O,g)},T=k(p);function C(q,z,Z,at){for(;k(q)<at&&z<y.length-1&&!s.isNewline(y[z+1]);)z+=1,q+=y[z];for(;k(q)>at&&z>Z;)z-=1,q=q.slice(0,-1);return{lineTxt:q,txtLastCharIndex:z}}function P(q,z){if(!(T<=0||T>v)){if(!m[q]){m[q]=p;return}var Z=C(m[q],z,S+1,v-T);m[q]=Z.lineTxt+p}}for(var N=0;N<y.length;N++){var L=y[N],D=y[N-1],G=y[N+1],H=k(L);if(this.isNewline(L)){if(w+1>=f){r.isOverflowing=!0,N<y.length-1&&P(w,N-1);break}S=N-1,w+=1,E=0,m[w]="";continue}if(E>0&&E+H>v){var W=C(m[w],N-1,S+1,v);if(W.txtLastCharIndex!==N-1){if(m[w]=W.lineTxt,W.txtLastCharIndex===y.length-1)break;N=W.txtLastCharIndex+1,L=y[N],D=y[N-1],G=y[N+1],H=k(L)}if(w+1>=f){r.isOverflowing=!0,P(w,N-1);break}if(S=N-1,w+=1,E=0,m[w]="",this.isBreakingSpace(L))continue;this.canBreakInLastChar(L)||(m=this.trimToBreakable(m),E=this.sumTextWidthByCache(m[w]||"",k)),this.shouldBreakByKinsokuShorui(L,G)&&(m=this.trimByKinsokuShorui(m),E+=k(D||""))}E+=H,m[w]=(m[w]||"")+L}return m.join(`
`)}},{key:"isBreakingSpace",value:function(e){return typeof e!="string"?!1:hs.BreakingSpaces.indexOf(e.charCodeAt(0))>=0}},{key:"isNewline",value:function(e){return typeof e!="string"?!1:hs.Newlines.indexOf(e.charCodeAt(0))>=0}},{key:"trimToBreakable",value:function(e){var r=Ie(e),i=r[r.length-2],a=this.findBreakableIndex(i);if(a===-1||!i)return r;var s=i.slice(a,a+1),o=this.isBreakingSpace(s),l=a+1,c=a+(o?0:1);return r[r.length-1]+=i.slice(l,i.length),r[r.length-2]=i.slice(0,c),r}},{key:"canBreakInLastChar",value:function(e){return!(e&&e2.test(e))}},{key:"sumTextWidthByCache",value:function(e,r){return e.split("").reduce(function(i,a){return i+r(a)},0)}},{key:"findBreakableIndex",value:function(e){for(var r=e.length-1;r>=0;r--)if(!e2.test(e[r]))return r;return-1}},{key:"getFromCache",value:function(e,r,i,a){var s=i[e];if(typeof s!="number"){var o=e.length*r,l=a.measureText(e);s=l.width+o,i[e]=s}return s}}])}(),bt={},Aj=function(n){var t=new tj,e=new Qz;return n={},It(It(It(It(It(It(It(It(It(It(n,ot.FRAGMENT,null),ot.CIRCLE,new Xz),ot.ELLIPSE,new Kz),ot.RECT,t),ot.IMAGE,t),ot.GROUP,new nj),ot.LINE,new Zz),ot.TEXT,new ej(bt)),ot.POLYLINE,e),ot.POLYGON,e),It(It(It(n,ot.PATH,new Jz),ot.HTML,new rj),ot.MESH,null)}(),Cj=function(n){var t=new oz,e=new ab;return n={},It(It(It(It(It(It(It(It(It(It(n,kt.PERCENTAGE,null),kt.NUMBER,new fz),kt.ANGLE,new az),kt.DEFINED_PATH,new sz),kt.PAINT,t),kt.COLOR,t),kt.FILTER,new lz),kt.LENGTH,e),kt.LENGTH_PERCENTAGE,e),kt.LENGTH_PERCENTAGE_12,new cz),It(It(It(It(It(It(It(It(It(It(n,kt.LENGTH_PERCENTAGE_14,new uz),kt.COORDINATE,new ab),kt.OFFSET_DISTANCE,new dz),kt.OPACITY_VALUE,new gz),kt.PATH,new pz),kt.LIST_OF_POINTS,new vz),kt.SHADOW_BLUR,new yz),kt.TEXT,new mz),kt.TEXT_TRANSFORM,new bz),kt.TRANSFORM,new Hz),It(It(It(n,kt.TRANSFORM_ORIGIN,new Uz),kt.Z_INDEX,new Yz),kt.MARKER,new hz)}(),Pj=function(){return typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}};bt.CameraContribution=lN;bt.AnimationTimeline=null;bt.EasingFunction=null;bt.offscreenCanvasCreator=new Sw;bt.sceneGraphSelector=new lj;bt.sceneGraphService=new yj(bt);bt.textService=new kj(bt);bt.geometryUpdaterFactory=Aj;bt.CSSPropertySyntaxFactory=Cj;bt.styleValueRegistry=new rz(bt);bt.layoutRegistry=null;bt.globalThis=Pj();bt.enableStyleSyntax=!0;bt.enableSizeAttenuation=!1;var Nj=0,lb=new Bi(ce.INSERTED,null,"","","",0,"",""),cb=new Bi(ce.REMOVED,null,"","","",0,"",""),DN=new pn(ce.DESTROY),Rj=function(n){function t(){var e;yt(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=ae(this,t,[].concat(i)),e.entity=Nj++,e.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},e.cullable={strategy:z4.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},e.transformable={dirtyFlag:!1,localDirtyFlag:!1,frozen:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},e.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},e.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},e.rBushNode={aabb:void 0},e.namespaceURI="g",e.scrollLeft=0,e.scrollTop=0,e.clientTop=0,e.clientLeft=0,e.destroyed=!1,e.style={},e.computedStyle={},e.parsedStyle={},e.attributes={},e}return se(t,n),mt(t,[{key:"className",get:function(){return this.getAttribute("class")||""},set:function(r){this.setAttribute("class",r)}},{key:"classList",get:function(){return this.className.split(" ").filter(function(r){return r!==""})}},{key:"tagName",get:function(){return this.nodeName}},{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"parentElement",get:function(){return this.parentNode}},{key:"nextSibling",get:function(){if(this.parentNode){var r=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[r+1]||null}return null}},{key:"previousSibling",get:function(){if(this.parentNode){var r=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[r-1]||null}return null}},{key:"cloneNode",value:function(r){throw new Error(Ee)}},{key:"appendChild",value:function(r,i){var a;if(r.destroyed)throw new Error(k4);return bt.sceneGraphService.attach(r,this,i),(a=this.ownerDocument)!==null&&a!==void 0&&a.defaultView&&(!wh(this)&&r.nodeName===ot.FRAGMENT?this.ownerDocument.defaultView.mountFragment(r):this.ownerDocument.defaultView.mountChildren(r)),this.isMutationObserved&&(lb.relatedNode=this,r.dispatchEvent(lb)),r}},{key:"insertBefore",value:function(r,i){if(!i)this.appendChild(r);else{r.parentElement&&r.parentElement.removeChild(r);var a=this.childNodes.indexOf(i);a===-1?this.appendChild(r):this.appendChild(r,a)}return r}},{key:"replaceChild",value:function(r,i){var a=this.childNodes.indexOf(i);return this.removeChild(i),this.appendChild(r,a),i}},{key:"removeChild",value:function(r){var i;return cb.relatedNode=this,r.dispatchEvent(cb),(i=r.ownerDocument)!==null&&i!==void 0&&i.defaultView&&r.ownerDocument.defaultView.unmountChildren(r),bt.sceneGraphService.detach(r),r}},{key:"removeChildren",value:function(){for(var r=this.childNodes.length-1;r>=0;r--){var i=this.childNodes[r];this.removeChild(i)}}},{key:"destroyChildren",value:function(){for(var r=this.childNodes.length-1;r>=0;r--){var i=this.childNodes[r];i.childNodes.length>0&&i.destroyChildren(),i.destroy()}}},{key:"matches",value:function(r){return bt.sceneGraphService.matches(r,this)}},{key:"getElementById",value:function(r){return bt.sceneGraphService.querySelector("#".concat(r),this)}},{key:"getElementsByName",value:function(r){return bt.sceneGraphService.querySelectorAll('[name="'.concat(r,'"]'),this)}},{key:"getElementsByClassName",value:function(r){return bt.sceneGraphService.querySelectorAll(".".concat(r),this)}},{key:"getElementsByTagName",value:function(r){return bt.sceneGraphService.querySelectorAll(r,this)}},{key:"querySelector",value:function(r){return bt.sceneGraphService.querySelector(r,this)}},{key:"querySelectorAll",value:function(r){return bt.sceneGraphService.querySelectorAll(r,this)}},{key:"closest",value:function(r){var i=this;do{if(bt.sceneGraphService.matches(r,i))return i;i=i.parentElement}while(i!==null);return null}},{key:"find",value:function(r){var i=this,a=null;return this.forEach(function(s){return s!==i&&r(s)?(a=s,!1):!0}),a}},{key:"findAll",value:function(r){var i=this,a=[];return this.forEach(function(s){s!==i&&r(s)&&a.push(s)}),a}},{key:"after",value:function(){var r=this;if(this.parentNode){for(var i=this.parentNode.childNodes.indexOf(this),a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];s.forEach(function(l,c){var u;return(u=r.parentNode)===null||u===void 0?void 0:u.appendChild(l,i+c+1)})}}},{key:"before",value:function(){if(this.parentNode){for(var r,i=this.parentNode.childNodes.indexOf(this),a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];var l=s[0],c=s.slice(1);this.parentNode.appendChild(l,i),(r=l).after.apply(r,Ie(c))}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove()}},{key:"append",value:function(){for(var r=this,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];a.forEach(function(o){return r.appendChild(o)})}},{key:"prepend",value:function(){for(var r=this,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];a.forEach(function(o,l){return r.appendChild(o,l)})}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments)}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this}},{key:"destroy",value:function(){this.destroyChildren(),this.dispatchEvent(DN),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0}},{key:"getGeometryBounds",value:function(){return bt.sceneGraphService.getGeometryBounds(this)}},{key:"getRenderBounds",value:function(){return bt.sceneGraphService.getBounds(this,!0)}},{key:"getBounds",value:function(){return bt.sceneGraphService.getBounds(this)}},{key:"getLocalBounds",value:function(){return bt.sceneGraphService.getLocalBounds(this)}},{key:"getBoundingClientRect",value:function(){return bt.sceneGraphService.getBoundingClientRect(this)}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle))}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes)}},{key:"getAttribute",value:function(r){if(typeof r!="symbol"){var i=this.attributes[r];return i}}},{key:"hasAttribute",value:function(r){return this.getAttributeNames().includes(r)}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length}},{key:"removeAttribute",value:function(r){this.setAttribute(r,null),delete this.attributes[r]}},{key:"setAttribute",value:function(r,i,a,s){this.attributes[r]=i}},{key:"getAttributeNS",value:function(r,i){throw new Error(Ee)}},{key:"getAttributeNode",value:function(r){throw new Error(Ee)}},{key:"getAttributeNodeNS",value:function(r,i){throw new Error(Ee)}},{key:"hasAttributeNS",value:function(r,i){throw new Error(Ee)}},{key:"removeAttributeNS",value:function(r,i){throw new Error(Ee)}},{key:"removeAttributeNode",value:function(r){throw new Error(Ee)}},{key:"setAttributeNS",value:function(r,i,a){throw new Error(Ee)}},{key:"setAttributeNode",value:function(r){throw new Error(Ee)}},{key:"setAttributeNodeNS",value:function(r){throw new Error(Ee)}},{key:"toggleAttribute",value:function(r,i){throw new Error(Ee)}}])}(Ke);function ye(n){return!!(n!=null&&n.nodeName)}var Lj=bt.globalThis.Proxy?bt.globalThis.Proxy:function(){},_i=new Bi(ce.ATTR_MODIFIED,null,null,null,null,Bi.MODIFICATION,null,null),tl=ge(),Ij=_n(),je=function(n){function t(e){var r;return yt(this,t),r=ae(this,t),r.isCustomElement=!1,r.isMutationObserved=!1,r.activeAnimations=[],r.config=e,r.id=e.id||"",r.name=e.name||"",(e.className||e.class)&&(r.className=e.className||e.class),r.nodeName=e.type||ot.GROUP,e.initialParsedStyle&&Object.assign(r.parsedStyle,e.initialParsedStyle),r.initAttributes(e.style),bt.enableStyleSyntax&&(r.style=new Lj({setProperty:function(a,s){r.setAttribute(a,s)},getPropertyValue:function(a){return r.getAttribute(a)},removeProperty:function(a){r.removeAttribute(a)},item:function(){return""}},{get:function(a,s){return a[s]!==void 0?a[s]:r.getAttribute(s)},set:function(a,s,o){return r.setAttribute(s,o),!0}})),r}return se(t,n),mt(t,[{key:"destroy",value:function(){wE(t,"destroy",this)([]),this.getAnimations().forEach(function(r){r.cancel()})}},{key:"cloneNode",value:function(r,i){var a=ie({},this.attributes);for(var s in a){var o=a[s];ye(o)&&s!=="clipPath"&&s!=="offsetPath"&&s!=="textPath"&&(a[s]=o.cloneNode(r)),i&&(a[s]=i(s,o))}var l=new this.constructor(ie(ie({},this.config),{},{style:a}));return l.setLocalTransform(this.getLocalTransform()),r&&this.children.forEach(function(c){if(!c.style.isMarker){var u=c.cloneNode(r);l.appendChild(u)}}),l}},{key:"initAttributes",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i={forceUpdateGeometry:!0};bt.styleValueRegistry.processProperties(this,r,i),this.renderable.dirty=!0}},{key:"setAttribute",value:function(r,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;Qt(i)||(a||i!==this.attributes[r])&&(this.internalSetAttribute(r,i,{memoize:s}),wE(t,"setAttribute",this)([r,i]))}},{key:"internalSetAttribute",value:function(r,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=this.renderable,o=this.attributes[r],l=this.parsedStyle[r];bt.styleValueRegistry.processProperties(this,It({},r,i),a),s.dirty=!0;var c=this.parsedStyle[r];if(this.isConnected&&(_i.relatedNode=this,_i.prevValue=o,_i.newValue=i,_i.attrName=r,_i.prevParsedValue=l,_i.newParsedValue=c,this.isMutationObserved?this.dispatchEvent(_i):(_i.target=this,this.ownerDocument.defaultView.dispatchEvent(_i,!0))),this.isCustomElement&&this.isConnected||!this.isCustomElement){var u,h;(u=(h=this).attributeChangedCallback)===null||u===void 0||u.call(h,r,o,i,l,c)}}},{key:"getBBox",value:function(){var r=this.getBounds(),i=r.getMin(),a=ne(i,2),s=a[0],o=a[1],l=r.getMax(),c=ne(l,2),u=c[0],h=c[1];return new Co(s,o,u-s,h-o)}},{key:"setOrigin",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return bt.sceneGraphService.setOrigin(this,rr(r,i,a,!1)),this}},{key:"getOrigin",value:function(){return bt.sceneGraphService.getOrigin(this)}},{key:"setPosition",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return bt.sceneGraphService.setPosition(this,rr(r,i,a,!1)),this}},{key:"setLocalPosition",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return bt.sceneGraphService.setLocalPosition(this,rr(r,i,a,!1)),this}},{key:"translate",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return bt.sceneGraphService.translate(this,rr(r,i,a,!1)),this}},{key:"translateLocal",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return bt.sceneGraphService.translateLocal(this,rr(r,i,a,!1)),this}},{key:"getPosition",value:function(){return bt.sceneGraphService.getPosition(this)}},{key:"getLocalPosition",value:function(){return bt.sceneGraphService.getLocalPosition(this)}},{key:"scale",value:function(r,i,a){return this.scaleLocal(r,i,a)}},{key:"scaleLocal",value:function(r,i,a){return typeof r=="number"&&(i=i||r,a=a||r,r=rr(r,i,a,!1)),bt.sceneGraphService.scaleLocal(this,r),this}},{key:"setLocalScale",value:function(r,i,a){return typeof r=="number"&&(i=i||r,a=a||r,r=rr(r,i,a,!1)),bt.sceneGraphService.setLocalScale(this,r),this}},{key:"getLocalScale",value:function(){return bt.sceneGraphService.getLocalScale(this)}},{key:"getScale",value:function(){return bt.sceneGraphService.getScale(this)}},{key:"getEulerAngles",value:function(){var r=Kd(tl,bt.sceneGraphService.getWorldTransform(this)),i=ne(r,3),a=i[2];return br(a)}},{key:"getLocalEulerAngles",value:function(){var r=Kd(tl,bt.sceneGraphService.getLocalRotation(this)),i=ne(r,3),a=i[2];return br(a)}},{key:"setEulerAngles",value:function(r){return bt.sceneGraphService.setEulerAngles(this,0,0,r),this}},{key:"setLocalEulerAngles",value:function(r){return bt.sceneGraphService.setLocalEulerAngles(this,0,0,r),this}},{key:"rotateLocal",value:function(r,i,a){return Ut(i)&&Ut(a)?bt.sceneGraphService.rotateLocal(this,0,0,r):bt.sceneGraphService.rotateLocal(this,r,i,a),this}},{key:"rotate",value:function(r,i,a){return Ut(i)&&Ut(a)?bt.sceneGraphService.rotate(this,0,0,r):bt.sceneGraphService.rotate(this,r,i,a),this}},{key:"setRotation",value:function(r,i,a,s){return bt.sceneGraphService.setRotation(this,r,i,a,s),this}},{key:"setLocalRotation",value:function(r,i,a,s){return bt.sceneGraphService.setLocalRotation(this,r,i,a,s),this}},{key:"setLocalSkew",value:function(r,i){return bt.sceneGraphService.setLocalSkew(this,r,i),this}},{key:"getRotation",value:function(){return bt.sceneGraphService.getRotation(this)}},{key:"getLocalRotation",value:function(){return bt.sceneGraphService.getLocalRotation(this)}},{key:"getLocalSkew",value:function(){return bt.sceneGraphService.getLocalSkew(this)}},{key:"getLocalTransform",value:function(){return bt.sceneGraphService.getLocalTransform(this)}},{key:"getWorldTransform",value:function(){return bt.sceneGraphService.getWorldTransform(this)}},{key:"setLocalTransform",value:function(r){return bt.sceneGraphService.setLocalTransform(this,r),this}},{key:"resetLocalTransform",value:function(){bt.sceneGraphService.resetLocalTransform(this)}},{key:"getAnimations",value:function(){return this.activeAnimations}},{key:"animate",value:function(r,i){var a,s=(a=this.ownerDocument)===null||a===void 0?void 0:a.timeline;return s?s.play(this,r,i):null}},{key:"isVisible",value:function(){var r;return((r=this.parsedStyle)===null||r===void 0?void 0:r.visibility)!=="hidden"}},{key:"interactive",get:function(){return this.isInteractive()},set:function(r){this.style.pointerEvents=r?"auto":"none"}},{key:"isInteractive",value:function(){var r;return((r=this.parsedStyle)===null||r===void 0?void 0:r.pointerEvents)!=="none"}},{key:"isCulled",value:function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible)}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,Ie(this.parentNode.children.map(function(r){return Number(r.style.zIndex)})))+1),this}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,Ie(this.parentNode.children.map(function(r){return Number(r.style.zIndex)})))-1),this}},{key:"getConfig",value:function(){return this.config}},{key:"attr",value:function(){for(var r=this,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];var o=a[0],l=a[1];return o?hn(o)?(Object.keys(o).forEach(function(c){r.setAttribute(c,o[c])}),this):a.length===2?(this.setAttribute(o,l),this):this.attributes[o]:this.attributes}},{key:"getMatrix",value:function(r){var i=r||this.getWorldTransform(),a=ah(tl,i),s=ne(a,2),o=s[0],l=s[1],c=ko(tl,i),u=ne(c,2),h=u[0],f=u[1],d=sh(Ij,i),g=Kd(tl,d),v=ne(g,3),p=v[0],y=v[2];return L4(p||y,o,l,h,f)}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform())}},{key:"setMatrix",value:function(r){var i=OE(r),a=ne(i,5),s=a[0],o=a[1],l=a[2],c=a[3],u=a[4];this.setEulerAngles(u).setPosition(s,o).setLocalScale(l,c)}},{key:"setLocalMatrix",value:function(r){var i=OE(r),a=ne(i,5),s=a[0],o=a[1],l=a[2],c=a[3],u=a[4];this.setLocalEulerAngles(u).setLocalPosition(s,o).setLocalScale(l,c)}},{key:"show",value:function(){this.forEach(function(r){r.style.visibility="visible"})}},{key:"hide",value:function(){this.forEach(function(r){r.style.visibility="hidden"})}},{key:"getCount",value:function(){return this.childElementCount}},{key:"getParent",value:function(){return this.parentElement}},{key:"getChildren",value:function(){return this.children}},{key:"getFirst",value:function(){return this.firstElementChild}},{key:"getLast",value:function(){return this.lastElementChild}},{key:"getChildByIndex",value:function(r){return this.children[r]||null}},{key:"add",value:function(r,i){return this.appendChild(r,i)}},{key:"set",value:function(r,i){this.config[r]=i}},{key:"get",value:function(r){return this.config[r]}},{key:"moveTo",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return this.setPosition(r,i,a),this}},{key:"move",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return this.setPosition(r,i,a),this}},{key:"setZIndex",value:function(r){return this.style.zIndex=r,this}}])}(Rj);je.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var da=function(n){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return yt(this,t),ae(this,t,[ie({type:ot.CIRCLE},e)])}return se(t,n),mt(t)}(je);da.PARSED_STYLE_LIST=new Set([].concat(Ie(je.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var Dj=["style"],_w=function(n){function t(){var e,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=r.style,a=qs(r,Dj);return yt(this,t),e=ae(this,t,[ie({style:i},a)]),e.isCustomElement=!0,e}return se(t,n),mt(t)}(je);_w.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var dc=function(n){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return yt(this,t),ae(this,t,[ie({type:ot.ELLIPSE},e)])}return se(t,n),mt(t)}(je);dc.PARSED_STYLE_LIST=new Set([].concat(Ie(je.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"]));var Fj=function(n){function t(){return yt(this,t),ae(this,t,[{type:ot.FRAGMENT}])}return se(t,n),mt(t)}(je);Fj.PARSED_STYLE_LIST=new Set(["class","className"]);var Tn=function(n){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return yt(this,t),ae(this,t,[ie({type:ot.GROUP},e)])}return se(t,n),mt(t)}(je);Tn.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var Bj=["style"],gc=function(n){function t(){var e,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=r.style,a=qs(r,Bj);return yt(this,t),e=ae(this,t,[ie({type:ot.HTML,style:i},a)]),e.cullable.enable=!1,e}return se(t,n),mt(t,[{key:"getDomElement",value:function(){return this.parsedStyle.$el}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"getLocalBounds",value:function(){if(this.parentNode){var r=Ai(Ne(),this.parentNode.getWorldTransform()),i=this.getBounds();if(!Re.isEmpty(i)){var a=new Re;return a.setFromTransformedAABB(i,r),a}}return this.getBounds()}}])}(je);gc.PARSED_STYLE_LIST=new Set([].concat(Ie(je.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"]));var pc=function(n){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return yt(this,t),ae(this,t,[ie({type:ot.IMAGE},e)])}return se(t,n),mt(t)}(je);pc.PARSED_STYLE_LIST=new Set([].concat(Ie(je.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var zj=["style"],Is=function(n){function t(){var e,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=r.style,a=qs(r,zj);yt(this,t),e=ae(this,t,[ie({type:ot.LINE,style:ie({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},i)},a)]),e.markerStartAngle=0,e.markerEndAngle=0;var s=e.parsedStyle,o=s.markerStart,l=s.markerEnd;return o&&ye(o)&&(e.markerStartAngle=o.getLocalEulerAngles(),e.appendChild(o)),l&&ye(l)&&(e.markerEndAngle=l.getLocalEulerAngles(),e.appendChild(l)),e.transformMarker(!0),e.transformMarker(!1),e}return se(t,n),mt(t,[{key:"attributeChangedCallback",value:function(r,i,a,s,o){r==="x1"||r==="y1"||r==="x2"||r==="y2"||r==="markerStartOffset"||r==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):r==="markerStart"?(s&&ye(s)&&(this.markerStartAngle=0,s.remove()),o&&ye(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):r==="markerEnd"&&(s&&ye(s)&&(this.markerEndAngle=0,s.remove()),o&&ye(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1)))}},{key:"transformMarker",value:function(r){var i=this.parsedStyle,a=i.markerStart,s=i.markerEnd,o=i.markerStartOffset,l=i.markerEndOffset,c=i.x1,u=i.x2,h=i.y1,f=i.y2,d=r?a:s;if(!(!d||!ye(d))){var g=0,v,p,y,m,w,E;r?(y=c,m=h,v=u-c,p=f-h,w=o||0,E=this.markerStartAngle):(y=u,m=f,v=c-u,p=h-f,w=l||0,E=this.markerEndAngle),g=Math.atan2(p,v),d.setLocalEulerAngles(g*180/Math.PI+E),d.setLocalPosition(y+Math.cos(g)*w,m+Math.sin(g)*w)}}},{key:"getPoint",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.parsedStyle,s=a.x1,o=a.y1,l=a.x2,c=a.y2,u=aN(s,o,l,c,r),h=u.x,f=u.y,d=Jn(ge(),Fe(h,f,0),i?this.getWorldTransform():this.getLocalTransform());return new zn(d[0],d[1])}},{key:"getPointAtLength",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPoint(r/this.getTotalLength(),i)}},{key:"getTotalLength",value:function(){var r=this.parsedStyle,i=r.x1,a=r.y1,s=r.x2,o=r.y2;return iN(i,a,s,o)}}])}(je);Is.PARSED_STYLE_LIST=new Set([].concat(Ie(je.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var jj=["style"],Fr=function(n){function t(){var e,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=r.style,a=qs(r,jj);yt(this,t),e=ae(this,t,[ie({type:ot.PATH,style:i,initialParsedStyle:{miterLimit:4,d:ie({},cN)}},a)]),e.markerStartAngle=0,e.markerEndAngle=0,e.markerMidList=[];var s=e.parsedStyle,o=s.markerStart,l=s.markerEnd,c=s.markerMid;return o&&ye(o)&&(e.markerStartAngle=o.getLocalEulerAngles(),e.appendChild(o)),c&&ye(c)&&e.placeMarkerMid(c),l&&ye(l)&&(e.markerEndAngle=l.getLocalEulerAngles(),e.appendChild(l)),e.transformMarker(!0),e.transformMarker(!1),e}return se(t,n),mt(t,[{key:"attributeChangedCallback",value:function(r,i,a,s,o){r==="d"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):r==="markerStartOffset"||r==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):r==="markerStart"?(s&&ye(s)&&(this.markerStartAngle=0,s.remove()),o&&ye(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):r==="markerEnd"?(s&&ye(s)&&(this.markerEndAngle=0,s.remove()),o&&ye(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1))):r==="markerMid"&&this.placeMarkerMid(o)}},{key:"transformMarker",value:function(r){var i=this.parsedStyle,a=i.markerStart,s=i.markerEnd,o=i.markerStartOffset,l=i.markerEndOffset,c=r?a:s;if(!(!c||!ye(c))){var u=0,h,f,d,g,v,p;if(r){var y=this.getStartTangent(),m=ne(y,2),w=m[0],E=m[1];d=E[0],g=E[1],h=w[0]-E[0],f=w[1]-E[1],v=o||0,p=this.markerStartAngle}else{var S=this.getEndTangent(),O=ne(S,2),k=O[0],T=O[1];d=T[0],g=T[1],h=k[0]-T[0],f=k[1]-T[1],v=l||0,p=this.markerEndAngle}u=Math.atan2(f,h),c.setLocalEulerAngles(u*180/Math.PI+p),c.setLocalPosition(d+Math.cos(u)*v,g+Math.sin(u)*v)}}},{key:"placeMarkerMid",value:function(r){var i=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(u){u.remove()}),r&&ye(r))for(var a=1;a<i.length-1;a++){var s=ne(i[a].currentPoint,2),o=s[0],l=s[1],c=a===1?r:r.cloneNode(!0);this.markerMidList.push(c),this.appendChild(c),c.setLocalPosition(o,l)}}},{key:"getTotalLength",value:function(){return rb(this)}},{key:"getPointAtLength",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.parsedStyle.d.absolutePath,s=r4(a,r),o=s.x,l=s.y,c=Jn(ge(),Fe(o,l,0),i?this.getWorldTransform():this.getLocalTransform());return new zn(c[0],c[1])}},{key:"getPoint",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPointAtLength(r*rb(this),i)}},{key:"getStartTangent",value:function(){var r=this.parsedStyle.d.segments,i=[];if(r.length>1){var a=r[0].currentPoint,s=r[1].currentPoint,o=r[1].startTangent;i=[],o?(i.push([a[0]-o[0],a[1]-o[1]]),i.push([a[0],a[1]])):(i.push([s[0],s[1]]),i.push([a[0],a[1]]))}return i}},{key:"getEndTangent",value:function(){var r=this.parsedStyle.d.segments,i=r.length,a=[];if(i>1){var s=r[i-2].currentPoint,o=r[i-1].currentPoint,l=r[i-1].endTangent;a=[],l?(a.push([o[0]-l[0],o[1]-l[1]]),a.push([o[0],o[1]])):(a.push([s[0],s[1]]),a.push([o[0],o[1]]))}return a}}])}(je);Fr.PARSED_STYLE_LIST=new Set([].concat(Ie(je.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var qj=["style"],Gs=function(n){function t(){var e,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=r.style,a=qs(r,qj);yt(this,t),e=ae(this,t,[ie({type:ot.POLYGON,style:i,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},a)]),e.markerStartAngle=0,e.markerEndAngle=0,e.markerMidList=[];var s=e.parsedStyle,o=s.markerStart,l=s.markerEnd,c=s.markerMid;return o&&ye(o)&&(e.markerStartAngle=o.getLocalEulerAngles(),e.appendChild(o)),c&&ye(c)&&e.placeMarkerMid(c),l&&ye(l)&&(e.markerEndAngle=l.getLocalEulerAngles(),e.appendChild(l)),e.transformMarker(!0),e.transformMarker(!1),e}return se(t,n),mt(t,[{key:"attributeChangedCallback",value:function(r,i,a,s,o){r==="points"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):r==="markerStartOffset"||r==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):r==="markerStart"?(s&&ye(s)&&(this.markerStartAngle=0,s.remove()),o&&ye(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):r==="markerEnd"?(s&&ye(s)&&(this.markerEndAngle=0,s.remove()),o&&ye(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1))):r==="markerMid"&&this.placeMarkerMid(o)}},{key:"transformMarker",value:function(r){var i=this.parsedStyle,a=i.markerStart,s=i.markerEnd,o=i.markerStartOffset,l=i.markerEndOffset,c=i.points,u=c||{},h=u.points,f=r?a:s;if(!(!f||!ye(f)||!h)){var d=0,g,v,p,y,m,w;if(p=h[0][0],y=h[0][1],r)g=h[1][0]-h[0][0],v=h[1][1]-h[0][1],m=o||0,w=this.markerStartAngle;else{var E=h.length;this.parsedStyle.isClosed?(g=h[E-1][0]-h[0][0],v=h[E-1][1]-h[0][1]):(p=h[E-1][0],y=h[E-1][1],g=h[E-2][0]-h[E-1][0],v=h[E-2][1]-h[E-1][1]),m=l||0,w=this.markerEndAngle}d=Math.atan2(v,g),f.setLocalEulerAngles(d*180/Math.PI+w),f.setLocalPosition(p+Math.cos(d)*m,y+Math.sin(d)*m)}}},{key:"placeMarkerMid",value:function(r){var i=this.parsedStyle.points,a=i||{},s=a.points;if(this.markerMidList.forEach(function(h){h.remove()}),this.markerMidList=[],r&&ye(r)&&s)for(var o=1;o<(this.parsedStyle.isClosed?s.length:s.length-1);o++){var l=s[o][0],c=s[o][1],u=o===1?r:r.cloneNode(!0);this.markerMidList.push(u),this.appendChild(u),u.setLocalPosition(l,c)}}}])}(je);Gs.PARSED_STYLE_LIST=new Set([].concat(Ie(je.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var $j=["style"],tf=function(n){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.style,i=qs(e,$j);return yt(this,t),ae(this,t,[ie({type:ot.POLYLINE,style:r,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},i)])}return se(t,n),mt(t,[{key:"getTotalLength",value:function(){return L5(this)}},{key:"getPointAtLength",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPoint(r/this.getTotalLength(),i)}},{key:"getPoint",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.parsedStyle.points.points;if(this.parsedStyle.points.segments.length===0){var s=[],o=0,l,c,u=this.getTotalLength();a.forEach(function(y,m){a[m+1]&&(l=[0,0],l[0]=o/u,c=iN(y[0],y[1],a[m+1][0],a[m+1][1]),o+=c,l[1]=o/u,s.push(l))}),this.parsedStyle.points.segments=s}var h=0,f=0;this.parsedStyle.points.segments.forEach(function(y,m){r>=y[0]&&r<=y[1]&&(h=(r-y[0])/(y[1]-y[0]),f=m)});var d=aN(a[f][0],a[f][1],a[f+1][0],a[f+1][1],h),g=d.x,v=d.y,p=Jn(ge(),Fe(g,v,0),i?this.getWorldTransform():this.getLocalTransform());return new zn(p[0],p[1])}},{key:"getStartTangent",value:function(){var r=this.parsedStyle.points.points,i=[];return i.push([r[1][0],r[1][1]]),i.push([r[0][0],r[0][1]]),i}},{key:"getEndTangent",value:function(){var r=this.parsedStyle.points.points,i=r.length-1,a=[];return a.push([r[i-1][0],r[i-1][1]]),a.push([r[i][0],r[i][1]]),a}}])}(Gs);tf.PARSED_STYLE_LIST=new Set([].concat(Ie(Gs.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var Rn=function(n){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return yt(this,t),ae(this,t,[ie({type:ot.RECT},e)])}return se(t,n),mt(t)}(je);Rn.PARSED_STYLE_LIST=new Set([].concat(Ie(je.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var Gj=["style"],Qa=function(n){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.style,i=qs(e,Gj);return yt(this,t),ae(this,t,[ie({type:ot.TEXT,style:ie({fill:"black"},r)},i)])}return se(t,n),mt(t,[{key:"getComputedTextLength",value:function(){var r;return this.getGeometryBounds(),((r=this.parsedStyle.metrics)===null||r===void 0?void 0:r.maxLineWidth)||0}},{key:"getLineBoundingRects",value:function(){var r;return this.getGeometryBounds(),((r=this.parsedStyle.metrics)===null||r===void 0?void 0:r.lineMetrics)||[]}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing}}])}(je);Qa.PARSED_STYLE_LIST=new Set([].concat(Ie(je.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textPathSide","textPathStartOffset","metrics","dx","dy"]));var Wj=function(){function n(){yt(this,n),this.registry={},this.define(ot.CIRCLE,da),this.define(ot.ELLIPSE,dc),this.define(ot.RECT,Rn),this.define(ot.IMAGE,pc),this.define(ot.LINE,Is),this.define(ot.GROUP,Tn),this.define(ot.PATH,Fr),this.define(ot.POLYGON,Gs),this.define(ot.POLYLINE,tf),this.define(ot.TEXT,Qa),this.define(ot.HTML,gc)}return mt(n,[{key:"define",value:function(e,r){this.registry[e]=r}},{key:"get",value:function(e){return this.registry[e]}}])}(),FN=function(n){function t(){var e;yt(this,t),e=ae(this,t),e.defaultView=null,e.ownerDocument=null,e.nodeName="document";try{e.timeline=new bt.AnimationTimeline(e)}catch{}var r={};return ww.forEach(function(i){var a=i.n,s=i.inh,o=i.d;s&&o&&(r[a]=zt(o)?o(ot.GROUP):o)}),e.documentElement=new Tn({id:"g-root",style:r}),e.documentElement.ownerDocument=e,e.documentElement.parentNode=e,e.childNodes=[e.documentElement],e}return se(t,n),mt(t,[{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"createElement",value:function(r,i){if(r==="svg")return this.documentElement;var a=this.defaultView.customElements.get(r);a||(console.warn("Unsupported tagName: ",r),a=r==="tspan"?Qa:Tn);var s=new a(i);return s.ownerDocument=this,s}},{key:"createElementNS",value:function(r,i,a){return this.createElement(i,a)}},{key:"cloneNode",value:function(r){throw new Error(Ee)}},{key:"destroy",value:function(){try{this.documentElement.destroyChildren(),this.timeline.destroy()}catch{}}},{key:"elementsFromBBox",value:function(r,i,a,s){var o=this.defaultView.context.rBushRoot,l=o.search({minX:r,minY:i,maxX:a,maxY:s}),c=[];return l.forEach(function(u){var h=u.displayObject,f=h.parsedStyle.pointerEvents,d=f===void 0?"auto":f,g=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(d);(!g||g&&h.isVisible())&&!h.isCulled()&&h.isInteractive()&&c.push(h)}),c.sort(function(u,h){return h.sortable.renderOrder-u.sortable.renderOrder}),c}},{key:"elementFromPointSync",value:function(r,i){var a=this.defaultView.canvas2Viewport({x:r,y:i}),s=a.x,o=a.y,l=this.defaultView.getConfig(),c=l.width,u=l.height;if(s<0||o<0||s>c||o>u)return null;var h=this.defaultView.viewport2Client({x:s,y:o}),f=h.x,d=h.y,g=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:r,y:i,viewportX:s,viewportY:o,clientX:f,clientY:d},picked:[]}),v=g.picked;return v&&v[0]||this.documentElement}},{key:"elementFromPoint",value:function(){var e=Ha(qn().mark(function i(a,s){var o,l,c,u,h,f,d,g,v,p,y;return qn().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(o=this.defaultView.canvas2Viewport({x:a,y:s}),l=o.x,c=o.y,u=this.defaultView.getConfig(),h=u.width,f=u.height,!(l<0||c<0||l>h||c>f)){w.next=4;break}return w.abrupt("return",null);case 4:return d=this.defaultView.viewport2Client({x:l,y:c}),g=d.x,v=d.y,w.next=7,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:a,y:s,viewportX:l,viewportY:c,clientX:g,clientY:v},picked:[]});case 7:return p=w.sent,y=p.picked,w.abrupt("return",y&&y[0]||this.documentElement);case 10:case"end":return w.stop()}},i,this)}));function r(i,a){return e.apply(this,arguments)}return r}()},{key:"elementsFromPointSync",value:function(r,i){var a=this.defaultView.canvas2Viewport({x:r,y:i}),s=a.x,o=a.y,l=this.defaultView.getConfig(),c=l.width,u=l.height;if(s<0||o<0||s>c||o>u)return[];var h=this.defaultView.viewport2Client({x:s,y:o}),f=h.x,d=h.y,g=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:r,y:i,viewportX:s,viewportY:o,clientX:f,clientY:d},picked:[]}),v=g.picked;return v[v.length-1]!==this.documentElement&&v.push(this.documentElement),v}},{key:"elementsFromPoint",value:function(){var e=Ha(qn().mark(function i(a,s){var o,l,c,u,h,f,d,g,v,p,y;return qn().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(o=this.defaultView.canvas2Viewport({x:a,y:s}),l=o.x,c=o.y,u=this.defaultView.getConfig(),h=u.width,f=u.height,!(l<0||c<0||l>h||c>f)){w.next=4;break}return w.abrupt("return",[]);case 4:return d=this.defaultView.viewport2Client({x:l,y:c}),g=d.x,v=d.y,w.next=7,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:a,y:s,viewportX:l,viewportY:c,clientX:g,clientY:v},picked:[]});case 7:return p=w.sent,y=p.picked,y[y.length-1]!==this.documentElement&&y.push(this.documentElement),w.abrupt("return",y);case 11:case"end":return w.stop()}},i,this)}));function r(i,a){return e.apply(this,arguments)}return r}()},{key:"appendChild",value:function(r,i){throw new Error(to)}},{key:"insertBefore",value:function(r,i){throw new Error(to)}},{key:"removeChild",value:function(r,i){throw new Error(to)}},{key:"replaceChild",value:function(r,i,a){throw new Error(to)}},{key:"append",value:function(){throw new Error(to)}},{key:"prepend",value:function(){throw new Error(to)}},{key:"getElementById",value:function(r){return this.documentElement.getElementById(r)}},{key:"getElementsByName",value:function(r){return this.documentElement.getElementsByName(r)}},{key:"getElementsByTagName",value:function(r){return this.documentElement.getElementsByTagName(r)}},{key:"getElementsByClassName",value:function(r){return this.documentElement.getElementsByClassName(r)}},{key:"querySelector",value:function(r){return this.documentElement.querySelector(r)}},{key:"querySelectorAll",value:function(r){return this.documentElement.querySelectorAll(r)}},{key:"find",value:function(r){return this.documentElement.find(r)}},{key:"findAll",value:function(r){return this.documentElement.findAll(r)}}])}(Ke),BN=function(){function n(t){yt(this,n),this.strategies=t}return mt(n,[{key:"apply",value:function(e){var r=e.camera,i=e.renderingService,a=e.renderingContext,s=this.strategies;i.hooks.cull.tap(n.tag,function(o){if(o){var l=o.cullable;return s.length===0?l.visible=a.unculledEntities.indexOf(o.entity)>-1:l.visible=s.every(function(c){return c.isVisible(r,o)}),!o.isCulled()&&o.isVisible()?o:(o.dispatchEvent(new pn(ce.CULLED)),null)}return o}),i.hooks.afterRender.tap(n.tag,function(o){o.cullable.visibilityPlaneMask=-1})}}])}();BN.tag="Culling";var zN=function(){function n(){var t=this;yt(this,n),this.autoPreventDefault=!1,this.rootPointerEvent=new xh(null),this.rootWheelEvent=new ob(null),this.onPointerMove=function(e){var r,i=(r=t.context.renderingContext.root)===null||r===void 0||(r=r.ownerDocument)===null||r===void 0?void 0:r.defaultView;if(!(i.supportsTouchEvents&&e.pointerType==="touch")){var a=t.normalizeToPointerEvent(e,i),s=ys(a),o;try{for(s.s();!(o=s.n()).done;){var l=o.value,c=t.bootstrapEvent(t.rootPointerEvent,l,i,e);t.context.eventService.mapEvent(c)}}catch(u){s.e(u)}finally{s.f()}t.setCursor(t.context.eventService.cursor)}},this.onClick=function(e){var r,i=(r=t.context.renderingContext.root)===null||r===void 0||(r=r.ownerDocument)===null||r===void 0?void 0:r.defaultView,a=t.normalizeToPointerEvent(e,i),s=ys(a),o;try{for(s.s();!(o=s.n()).done;){var l=o.value,c=t.bootstrapEvent(t.rootPointerEvent,l,i,e);t.context.eventService.mapEvent(c)}}catch(u){s.e(u)}finally{s.f()}t.setCursor(t.context.eventService.cursor)}}return mt(n,[{key:"apply",value:function(e){var r=this;this.context=e;var i=e.renderingService,a=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(s){var o=r.context.renderingService.hooks.pickSync.call({position:s,picked:[],topmost:!0}),l=o.picked;return l[0]||null}),i.hooks.pointerWheel.tap(n.tag,function(s){var o=r.normalizeWheelEvent(s);r.context.eventService.mapEvent(o)}),i.hooks.pointerDown.tap(n.tag,function(s){if(!(a.supportsTouchEvents&&s.pointerType==="touch")){var o=r.normalizeToPointerEvent(s,a);if(r.autoPreventDefault&&o[0].isNormalized){var l=s.cancelable||!("cancelable"in s);l&&s.preventDefault()}var c=ys(o),u;try{for(c.s();!(u=c.n()).done;){var h=u.value,f=r.bootstrapEvent(r.rootPointerEvent,h,a,s);r.context.eventService.mapEvent(f)}}catch(d){c.e(d)}finally{c.f()}r.setCursor(r.context.eventService.cursor)}}),i.hooks.pointerUp.tap(n.tag,function(s){if(!(a.supportsTouchEvents&&s.pointerType==="touch")){var o=r.context.contextService.getDomElement(),l=r.context.eventService.isNativeEventFromCanvas(o,s),c=l?"":"outside",u=r.normalizeToPointerEvent(s,a),h=ys(u),f;try{for(h.s();!(f=h.n()).done;){var d=f.value,g=r.bootstrapEvent(r.rootPointerEvent,d,a,s);g.type+=c,r.context.eventService.mapEvent(g)}}catch(v){h.e(v)}finally{h.f()}r.setCursor(r.context.eventService.cursor)}}),i.hooks.pointerMove.tap(n.tag,this.onPointerMove),i.hooks.pointerOver.tap(n.tag,this.onPointerMove),i.hooks.pointerOut.tap(n.tag,this.onPointerMove),i.hooks.click.tap(n.tag,this.onClick),i.hooks.pointerCancel.tap(n.tag,function(s){var o=r.normalizeToPointerEvent(s,a),l=ys(o),c;try{for(l.s();!(c=l.n()).done;){var u=c.value,h=r.bootstrapEvent(r.rootPointerEvent,u,a,s);r.context.eventService.mapEvent(h)}}catch(f){l.e(f)}finally{l.f()}r.setCursor(r.context.eventService.cursor)})}},{key:"bootstrapEvent",value:function(e,r,i,a){e.view=i,e.originalEvent=null,e.nativeEvent=a,e.pointerId=r.pointerId,e.width=r.width,e.height=r.height,e.isPrimary=r.isPrimary,e.pointerType=r.pointerType,e.pressure=r.pressure,e.tangentialPressure=r.tangentialPressure,e.tiltX=r.tiltX,e.tiltY=r.tiltY,e.twist=r.twist,this.transferMouseData(e,r);var s=this.context.eventService.client2Viewport({x:r.clientX,y:r.clientY}),o=s.x,l=s.y;e.viewport.x=o,e.viewport.y=l;var c=this.context.eventService.viewport2Canvas(e.viewport),u=c.x,h=c.y;return e.canvas.x=u,e.canvas.y=h,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.isTrusted=a.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=Tz[e.type]||e.type),e}},{key:"normalizeWheelEvent",value:function(e){var r=this.rootWheelEvent;this.transferMouseData(r,e),r.deltaMode=e.deltaMode,r.deltaX=e.deltaX,r.deltaY=e.deltaY,r.deltaZ=e.deltaZ;var i=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),a=i.x,s=i.y;r.viewport.x=a,r.viewport.y=s;var o=this.context.eventService.viewport2Canvas(r.viewport),l=o.x,c=o.y;return r.canvas.x=l,r.canvas.y=c,r.global.copyFrom(r.canvas),r.offset.copyFrom(r.canvas),r.nativeEvent=e,r.type=e.type,r}},{key:"transferMouseData",value:function(e,r){e.isTrusted=r.isTrusted,e.srcElement=r.srcElement,e.timeStamp=sb.now(),e.type=r.type,e.altKey=r.altKey,e.metaKey=r.metaKey,e.shiftKey=r.shiftKey,e.ctrlKey=r.ctrlKey,e.button=r.button,e.buttons=r.buttons,e.client.x=r.clientX,e.client.y=r.clientY,e.movement.x=r.movementX,e.movement.y=r.movementY,e.page.x=r.pageX,e.page.y=r.pageY,e.screen.x=r.screenX,e.screen.y=r.screenY,e.relatedTarget=null}},{key:"setCursor",value:function(e){this.context.contextService.applyCursorStyle(e||this.context.config.cursor||"default")}},{key:"normalizeToPointerEvent",value:function(e,r){var i=[];if(r.isTouchEvent(e))for(var a=0;a<e.changedTouches.length;a++){var s=e.changedTouches[a];Qt(s.button)&&(s.button=0),Qt(s.buttons)&&(s.buttons=1),Qt(s.isPrimary)&&(s.isPrimary=e.touches.length===1&&e.type==="touchstart"),Qt(s.width)&&(s.width=s.radiusX||1),Qt(s.height)&&(s.height=s.radiusY||1),Qt(s.tiltX)&&(s.tiltX=0),Qt(s.tiltY)&&(s.tiltY=0),Qt(s.pointerType)&&(s.pointerType="touch"),Qt(s.pointerId)&&(s.pointerId=s.identifier||0),Qt(s.pressure)&&(s.pressure=s.force||.5),Qt(s.twist)&&(s.twist=0),Qt(s.tangentialPressure)&&(s.tangentialPressure=0),s.isNormalized=!0,s.type=e.type,i.push(s)}else if(r.isMouseEvent(e)){var o=e;Qt(o.isPrimary)&&(o.isPrimary=!0),Qt(o.width)&&(o.width=1),Qt(o.height)&&(o.height=1),Qt(o.tiltX)&&(o.tiltX=0),Qt(o.tiltY)&&(o.tiltY=0),Qt(o.pointerType)&&(o.pointerType="mouse"),Qt(o.pointerId)&&(o.pointerId=Oz),Qt(o.pressure)&&(o.pressure=.5),Qt(o.twist)&&(o.twist=0),Qt(o.tangentialPressure)&&(o.tangentialPressure=0),o.isNormalized=!0,i.push(o)}else i.push(e);return i}}])}();zN.tag="Event";var Vj=[ot.CIRCLE,ot.ELLIPSE,ot.IMAGE,ot.RECT,ot.LINE,ot.POLYLINE,ot.POLYGON,ot.TEXT,ot.PATH,ot.HTML],Hj=function(){function n(){yt(this,n)}return mt(n,[{key:"isVisible",value:function(e,r){var i,a=r.cullable;if(!a.enable)return!0;var s=r.getRenderBounds();if(Re.isEmpty(s))return!1;var o=e.getFrustum(),l=(i=r.parentNode)===null||i===void 0||(i=i.cullable)===null||i===void 0?void 0:i.visibilityPlaneMask;return a.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(r,s,l||Qs.INDETERMINATE,o.planes),a.visible=a.visibilityPlaneMask!==Qs.OUTSIDE,a.visible}},{key:"computeVisibilityWithPlaneMask",value:function(e,r,i,a){if(i===Qs.OUTSIDE||i===Qs.INSIDE)return i;for(var s=Qs.INSIDE,o=Vj.indexOf(e.nodeName)>-1,l=0,c=a.length;l<c;++l){var u=1<<l;if((i&u)!==0&&!(o&&(l===4||l===5))){var h=a[l],f=h.normal,d=h.distance;if(Pi(f,r.getPositiveFarPoint(a[l]))+d<0)return Qs.OUTSIDE;Pi(f,r.getNegativeFarPoint(a[l]))+d<0&&(s|=u)}}return s}}])}(),jN=function(){function n(){yt(this,n),this.syncTasks=new Map,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1}return mt(n,[{key:"apply",value:function(e){var r=this,i,a=e.renderingService,s=e.renderingContext,o=e.rBushRoot,l=s.root.ownerDocument.defaultView;this.rBush=o;var c=function(v){var p=v.target;p.renderable.dirty=!0,a.dirtify()},u=function(v){r.syncTasks.set(v.target,v.detail.affectChildren),a.dirtify()},h=function(v){var p=v.target;bt.enableSizeAttenuation&&bt.styleValueRegistry.updateSizeAttenuation(p,l.getCamera().getZoom())},f=function(v){var p=v.target,y=p.rBushNode;y.aabb&&r.rBush.remove(y.aabb),r.syncTasks.delete(p),bt.sceneGraphService.dirtifyToRoot(p),a.dirtify()};a.hooks.init.tap(n.tag,function(){l.addEventListener(ce.MOUNTED,h),l.addEventListener(ce.UNMOUNTED,f),l.addEventListener(ce.ATTR_MODIFIED,c),l.addEventListener(ce.BOUNDS_CHANGED,u)}),a.hooks.destroy.tap(n.tag,function(){l.removeEventListener(ce.MOUNTED,h),l.removeEventListener(ce.UNMOUNTED,f),l.removeEventListener(ce.ATTR_MODIFIED,c),l.removeEventListener(ce.BOUNDS_CHANGED,u),r.syncTasks.clear()});var d=(i=bt.globalThis.requestIdleCallback)!==null&&i!==void 0?i:Ew.bind(bt.globalThis);a.hooks.endFrame.tap(n.tag,function(){r.isFirstTimeRendering?(r.isFirstTimeRendering=!1,r.syncing=!0,d(function(){r.syncRTree(!0),r.isFirstTimeRenderingFinished=!0})):r.syncRTree()})}},{key:"syncNode",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e.isConnected){var i=e.rBushNode;i.aabb&&this.rBush.remove(i.aabb);var a=e.getRenderBounds();if(a){var s=e.renderable;r&&(s.dirtyRenderBounds||(s.dirtyRenderBounds=new Re),s.dirtyRenderBounds.update(a.center,a.halfExtents));var o=a.getMin(),l=ne(o,2),c=l[0],u=l[1],h=a.getMax(),f=ne(h,2),d=f[0],g=f[1];i.aabb||(i.aabb={}),i.aabb.displayObject=e,i.aabb.minX=c,i.aabb.minY=u,i.aabb.maxX=d,i.aabb.maxY=g}if(i.aabb&&!isNaN(i.aabb.maxX)&&!isNaN(i.aabb.maxX)&&!isNaN(i.aabb.minX)&&!isNaN(i.aabb.minY))return i.aabb}}},{key:"syncRTree",value:function(){var e=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!r&&(this.syncing||this.syncTasks.size===0))){this.syncing=!0;var i=[],a=new Set,s=function(l){if(!a.has(l)&&l.renderable){var c=e.syncNode(l,r);c&&(i.push(c),a.add(l))}};this.syncTasks.forEach(function(o,l){o&&l.forEach(s);for(var c=l;c;)s(c),c=c.parentElement}),this.rBush.load(i),i.length=0,this.syncing=!1}}}])}();jN.tag="Prepare";var Lr=function(n){return n.READY="ready",n.BEFORE_RENDER="beforerender",n.RERENDER="rerender",n.AFTER_RENDER="afterrender",n.BEFORE_DESTROY="beforedestroy",n.AFTER_DESTROY="afterdestroy",n.RESIZE="resize",n.DIRTY_RECTANGLE="dirtyrectangle",n.RENDERER_CHANGED="rendererchanged",n}({}),n2=500,Uj=.1,Yj=1e3,Qc=new pn(ce.MOUNTED),tu=new pn(ce.UNMOUNTED),og=new pn(Lr.BEFORE_RENDER),r2=new pn(Lr.RERENDER),lg=new pn(Lr.AFTER_RENDER),ub=function(n){function t(e){var r;yt(this,t),r=ae(this,t),r.Element=je,r.inited=!1,r.context={};var i=e.container,a=e.canvas,s=e.renderer,o=e.width,l=e.height,c=e.background,u=e.cursor,h=e.supportsMutipleCanvasesInOneContainer,f=e.cleanUpOnDestroy,d=f===void 0?!0:f,g=e.offscreenCanvas,v=e.devicePixelRatio,p=e.requestAnimationFrame,y=e.cancelAnimationFrame,m=e.createImage,w=e.supportsTouchEvents,E=e.supportsPointerEvents,S=e.isTouchEvent,O=e.isMouseEvent,k=e.dblClickSpeed,T=o,C=l,P=v||xw&&window.devicePixelRatio||1;return P=P>=1?Math.ceil(P):1,a&&(T=o||_z(a)||a.width/P,C=l||Mz(a)||a.height/P),r.customElements=new Wj,r.devicePixelRatio=P,r.requestAnimationFrame=p??Ew.bind(bt.globalThis),r.cancelAnimationFrame=y??NN.bind(bt.globalThis),r.supportsTouchEvents=w??"ontouchstart"in bt.globalThis,r.supportsPointerEvents=E??!!bt.globalThis.PointerEvent,r.isTouchEvent=S??function(N){return r.supportsTouchEvents&&N instanceof bt.globalThis.TouchEvent},r.isMouseEvent=O??function(N){return!bt.globalThis.MouseEvent||N instanceof bt.globalThis.MouseEvent&&(!r.supportsPointerEvents||!(N instanceof bt.globalThis.PointerEvent))},g&&(bt.offscreenCanvas=g),r.document=new FN,r.document.defaultView=r,h||wz(i,r,d),r.initRenderingContext(ie(ie({},e),{},{width:T,height:C,background:c??"transparent",cursor:u??"default",cleanUpOnDestroy:d,devicePixelRatio:P,requestAnimationFrame:r.requestAnimationFrame,cancelAnimationFrame:r.cancelAnimationFrame,supportsTouchEvents:r.supportsTouchEvents,supportsPointerEvents:r.supportsPointerEvents,isTouchEvent:r.isTouchEvent,isMouseEvent:r.isMouseEvent,dblClickSpeed:k??200,createImage:m??function(){return new window.Image}})),r.initDefaultCamera(T,C,s.clipSpaceNearZ),r.initRenderer(s,!0),r}return se(t,n),mt(t,[{key:"initRenderingContext",value:function(r){this.context.config=r,this.context.renderingContext={root:this.document.documentElement,renderListCurrentFrame:[],unculledEntities:[],renderReasons:new Set,force:!1,dirty:!1}}},{key:"initDefaultCamera",value:function(r,i,a){var s=this,o=new bt.CameraContribution;o.clipSpaceNearZ=a,o.setType(xe.EXPLORING,J1.DEFAULT).setPosition(r/2,i/2,n2).setFocalPoint(r/2,i/2,0).setOrthographic(r/-2,r/2,i/2,i/-2,Uj,Yj),o.canvas=this,o.eventEmitter.on(oN.UPDATED,function(){s.context.renderingContext.renderReasons.add(So.CAMERA_CHANGED),bt.enableSizeAttenuation&&s.getConfig().renderer.getConfig().enableSizeAttenuation&&s.updateSizeAttenuation()}),this.context.camera=o}},{key:"updateSizeAttenuation",value:function(){var r=this.getCamera().getZoom();this.document.documentElement.forEach(function(i){bt.styleValueRegistry.updateSizeAttenuation(i,r)})}},{key:"getConfig",value:function(){return this.context.config}},{key:"getRoot",value:function(){return this.document.documentElement}},{key:"getCamera",value:function(){return this.context.camera}},{key:"getContextService",value:function(){return this.context.contextService}},{key:"getEventService",value:function(){return this.context.eventService}},{key:"getRenderingService",value:function(){return this.context.renderingService}},{key:"getRenderingContext",value:function(){return this.context.renderingContext}},{key:"getStats",value:function(){return this.getRenderingService().getStats()}},{key:"ready",get:function(){var r=this;return this.readyPromise||(this.readyPromise=new Promise(function(i){r.resolveReadyPromise=function(){i(r)}}),this.inited&&this.resolveReadyPromise()),this.readyPromise}},{key:"destroy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,i=arguments.length>1?arguments[1]:void 0;wn.clearCache(),i||this.dispatchEvent(new pn(Lr.BEFORE_DESTROY)),this.frameId&&this.cancelAnimationFrame(this.frameId);var a=this.getRoot();r&&(this.unmountChildren(a),this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),this.context.rBushRoot&&this.context.rBushRoot.clear(),i||this.dispatchEvent(new pn(Lr.AFTER_DESTROY));var s=function(l){l.currentTarget=null,l.manager=null,l.target=null,l.relatedNode=null};s(Qc),s(tu),s(og),s(r2),s(lg),s(_i),s(lb),s(cb),s(DN)}},{key:"changeSize",value:function(r,i){this.resize(r,i)}},{key:"resize",value:function(r,i){var a=this.context.config;a.width=r,a.height=i,this.getContextService().resize(r,i);var s=this.context.camera,o=s.getProjectionMode();s.setPosition(r/2,i/2,n2).setFocalPoint(r/2,i/2,0),o===Yr.ORTHOGRAPHIC?s.setOrthographic(r/-2,r/2,i/2,i/-2,s.getNear(),s.getFar()):s.setAspect(r/i),this.dispatchEvent(new pn(Lr.RESIZE,{width:r,height:i}))}},{key:"appendChild",value:function(r,i){return this.document.documentElement.appendChild(r,i)}},{key:"insertBefore",value:function(r,i){return this.document.documentElement.insertBefore(r,i)}},{key:"removeChild",value:function(r){return this.document.documentElement.removeChild(r)}},{key:"removeChildren",value:function(){this.document.documentElement.removeChildren()}},{key:"destroyChildren",value:function(){this.document.documentElement.destroyChildren()}},{key:"render",value:function(r){var i=this;r&&(og.detail=r,lg.detail=r),this.dispatchEvent(og);var a=this.getRenderingService();a.render(this.getConfig(),r,function(){i.dispatchEvent(r2)}),this.dispatchEvent(lg)}},{key:"run",value:function(){var r=this,i=function(s,o){r.render(o),r.frameId=r.requestAnimationFrame(i)};i()}},{key:"initRenderer",value:function(r){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!r)throw new Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new E4,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new zN,new jN,new BN([new Hj])),this.loadRendererContainerModule(r),this.context.contextService=new this.context.ContextService(ie(ie({},bt),this.context)),this.context.renderingService=new sj(bt,this.context),this.context.eventService=new aj(bt,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(r,a,!0)):this.context.contextService.initAsync().then(function(){i.initRenderingService(r,a)}).catch(function(s){console.error(s)})}},{key:"initRenderingService",value:function(r){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.context.renderingService.init(function(){i.inited=!0,a?s?i.requestAnimationFrame(function(){i.dispatchEvent(new pn(Lr.READY))}):i.dispatchEvent(new pn(Lr.READY)):i.dispatchEvent(new pn(Lr.RENDERER_CHANGED)),i.readyPromise&&i.resolveReadyPromise(),a||i.getRoot().forEach(function(o){var l=o,c=l.renderable;c&&(c.renderBoundsDirty=!0,c.boundsDirty=!0,c.dirty=!0)}),i.mountChildren(i.getRoot()),r.getConfig().enableAutoRendering&&i.run()})}},{key:"loadRendererContainerModule",value:function(r){var i=this,a=r.getPlugins();a.forEach(function(s){s.context=i.context,s.init(bt)})}},{key:"setRenderer",value:function(r){var i=this.getConfig();if(i.renderer!==r){var a=i.renderer;i.renderer=r,this.destroy(!1,!0),Ie((a==null?void 0:a.getPlugins())||[]).reverse().forEach(function(s){s.destroy(bt)}),this.initRenderer(r)}}},{key:"setCursor",value:function(r){var i=this.getConfig();i.cursor=r,this.getContextService().applyCursorStyle(r)}},{key:"unmountChildren",value:function(r){var i=this;r.childNodes.forEach(function(a){i.unmountChildren(a)}),this.inited&&(r.isMutationObserved?r.dispatchEvent(tu):(tu.target=r,this.dispatchEvent(tu,!0)),r!==this.document.documentElement&&(r.ownerDocument=null),r.isConnected=!1),r.isCustomElement&&r.disconnectedCallback&&r.disconnectedCallback()}},{key:"mountChildren",value:function(r){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:wh(r);this.inited?r.isConnected||(r.ownerDocument=this.document,r.isConnected=!0,a||(r.isMutationObserved?r.dispatchEvent(Qc):(Qc.target=r,this.dispatchEvent(Qc,!0)))):console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",r.nodeName),r.childNodes.forEach(function(s){i.mountChildren(s,a)}),r.isCustomElement&&r.connectedCallback&&r.connectedCallback()}},{key:"mountFragment",value:function(r){this.mountChildren(r,!1)}},{key:"client2Viewport",value:function(r){return this.getEventService().client2Viewport(r)}},{key:"viewport2Client",value:function(r){return this.getEventService().viewport2Client(r)}},{key:"viewport2Canvas",value:function(r){return this.getEventService().viewport2Canvas(r)}},{key:"canvas2Viewport",value:function(r){return this.getEventService().canvas2Viewport(r)}},{key:"getPointByClient",value:function(r,i){return this.client2Viewport({x:r,y:i})}},{key:"getClientByPoint",value:function(r,i){return this.viewport2Client({x:r,y:i})}}])}(IN);/*!
 * @antv/g-camera-api
 * @description A simple implementation of Camera API.
 * @version 2.0.35
 * @date 1/23/2025, 8:32:08 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var Xj=function(n){function t(){var e;yt(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=ae(this,t,[].concat(i)),e.landmarks=[],e}return se(t,n),mt(t,[{key:"rotate",value:function(r,i,a){if(this.relElevation=wo(i),this.relAzimuth=wo(r),this.relRoll=wo(a),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===xe.EXPLORING){var s=Aa(_n(),[1,0,0],Se((this.rotateWorld?1:-1)*this.relElevation)),o=Aa(_n(),[0,1,0],Se((this.rotateWorld?1:-1)*this.relAzimuth)),l=Aa(_n(),[0,0,1],Se(this.relRoll)),c=Ba(_n(),o,s);c=Ba(_n(),c,l);var u=fw(Ne(),c);bo(this.matrix,this.matrix,[0,0,-this.distance]),Zn(this.matrix,this.matrix,u),bo(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===xe.ORBITING||this.type===xe.EXPLORING?this._getPosition():this.type===xe.TRACKING&&this._getFocalPoint(),this._update(),this}},{key:"pan",value:function(r,i){var a=rr(r,i,0),s=Ui(this.position);return Fa(s,s,oh(ge(),this.right,a[0])),Fa(s,s,oh(ge(),this.up,a[1])),this._setPosition(s),this.triggerUpdate(),this}},{key:"dolly",value:function(r){var i=this.forward,a=Ui(this.position),s=r*this.dollyingStep,o=this.distance+r*this.dollyingStep;return s=Math.max(Math.min(o,this.maxDistance),this.minDistance)-this.distance,a[0]+=s*i[0],a[1]+=s*i[1],a[2]+=s*i[2],this._setPosition(a),this.type===xe.ORBITING||this.type===xe.EXPLORING?this._getDistance():this.type===xe.TRACKING&&Fa(this.focalPoint,a,this.distanceVector),this.triggerUpdate(),this}},{key:"cancelLandmarkAnimation",value:function(){this.landmarkAnimationID!==void 0&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID)}},{key:"createLandmark",value:function(r){var i,a,s,o,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=l.position,u=c===void 0?this.position:c,h=l.focalPoint,f=h===void 0?this.focalPoint:h,d=l.roll,g=l.zoom,v=new bt.CameraContribution;v.setType(this.type,void 0),v.setPosition(u[0],(i=u[1])!==null&&i!==void 0?i:this.position[1],(a=u[2])!==null&&a!==void 0?a:this.position[2]),v.setFocalPoint(f[0],(s=f[1])!==null&&s!==void 0?s:this.focalPoint[1],(o=f[2])!==null&&o!==void 0?o:this.focalPoint[2]),v.setRoll(d??this.roll),v.setZoom(g??this.zoom);var p={name:r,matrix:_P(v.getWorldTransform()),right:Ui(v.right),up:Ui(v.up),forward:Ui(v.forward),position:Ui(v.getPosition()),focalPoint:Ui(v.getFocalPoint()),distanceVector:Ui(v.getDistanceVector()),distance:v.getDistance(),dollyingStep:v.getDollyingStep(),azimuth:v.getAzimuth(),elevation:v.getElevation(),roll:v.getRoll(),relAzimuth:v.relAzimuth,relElevation:v.relElevation,relRoll:v.relRoll,zoom:v.getZoom()};return this.landmarks.push(p),p}},{key:"gotoLandmark",value:function(r){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=me(r)?this.landmarks.find(function(N){return N.name===r}):r;if(s){var o=Lt(a)?{duration:a}:a,l=o.easing,c=l===void 0?"linear":l,u=o.duration,h=u===void 0?100:u,f=o.easingFunction,d=f===void 0?void 0:f,g=o.onfinish,v=g===void 0?void 0:g,p=o.onframe,y=p===void 0?void 0:p,m=.01;this.cancelLandmarkAnimation();var w=s.position,E=s.focalPoint,S=s.zoom,O=s.roll,k=d||bt.EasingFunction(c),T,C=function(){i.setFocalPoint(E),i.setPosition(w),i.setRoll(O),i.setZoom(S),i.computeMatrix(),i.triggerUpdate(),v==null||v()};if(h===0)return C();var P=function(L){T===void 0&&(T=L);var D=L-T;if(D>=h){C();return}var G=k(D/h),H=ge(),W=ge(),q=1,z=0;q1(H,i.focalPoint,E,G),q1(W,i.position,w,G),z=i.roll*(1-G)+O*G,q=i.zoom*(1-G)+S*G,i.setFocalPoint(H),i.setPosition(W),i.setRoll(z),i.setZoom(q);var Z=fE(H,E)+fE(W,w);if(Z<=m&&S===void 0&&O===void 0)return C();i.computeMatrix(),i.triggerUpdate(),D<h&&(y==null||y(G),i.landmarkAnimationID=i.canvas.requestAnimationFrame(P))};this.canvas.requestAnimationFrame(P)}}}])}(lN);bt.CameraContribution=Xj;/*!
 * @antv/g-web-animations-api
 * @description A simple implementation of Web Animations API.
 * @version 2.1.21
 * @date 1/23/2025, 8:33:55 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var cg=function(n){function t(e,r,i,a){var s;return yt(this,t),s=ae(this,t,[e]),s.currentTime=i,s.timelineTime=a,s.target=r,s.type="finish",s.bubbles=!1,s.currentTarget=r,s.defaultPrevented=!1,s.eventPhase=s.AT_TARGET,s.timeStamp=Date.now(),s.currentTime=i,s.timelineTime=a,s}return se(t,n),mt(t)}(Qh),Kj=0,Zj=function(){function n(t,e){var r;yt(this,n),this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=t,t.animation=this,this.timeline=e,this.id="".concat(Kj++),this._inEffect=!!this.effect.update(0),this._totalDuration=Number((r=this.effect)===null||r===void 0?void 0:r.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()}return mt(n,[{key:"pending",get:function(){return this._startTime===null&&!this._paused&&this.playbackRate!==0||this.currentTimePending}},{key:"playState",get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"}},{key:"ready",get:function(){var e=this;return this.readyPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise(function(r,i){e.resolveReadyPromise=function(){r(e)},e.rejectReadyPromise=function(){i(new Error)}}),this.pending||this.resolveReadyPromise()),this.readyPromise}},{key:"finished",get:function(){var e=this;return this.finishedPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise(function(r,i){e.resolveFinishedPromise=function(){r(e)},e.rejectFinishedPromise=function(){i(new Error)}}),this.playState==="finished"&&this.resolveFinishedPromise()),this.finishedPromise}},{key:"currentTime",get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(e){if(e=Number(e),!isNaN(e)){if(this.timeline.restart(),!this._paused&&this._startTime!==null){var r;this._startTime=Number((r=this.timeline)===null||r===void 0?void 0:r.currentTime)-e/this.playbackRate}this.currentTimePending=!1,this._currentTime!==e&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(e,!0),this.timeline.applyDirtiedAnimation(this))}}},{key:"startTime",get:function(){return this._startTime},set:function(e){if(e!==null){if(this.updatePromises(),e=Number(e),isNaN(e)||this._paused||this._idle)return;this._startTime=e,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()}}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(e){if(e!==this._playbackRate){this.updatePromises();var r=this.currentTime;this._playbackRate=e,this.startTime=null,this.playState!=="paused"&&this.playState!=="idle"&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),r!==null&&(this.currentTime=r),this.updatePromises()}}},{key:"_isFinished",get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)}},{key:"totalDuration",get:function(){return this._totalDuration}},{key:"_needsTick",get:function(){return this.pending||this.playState==="running"||!this._finishedFlag}},{key:"updatePromises",value:function(){var e=this.oldPlayState,r=this.pending?"pending":this.playState;return this.readyPromise&&r!==e&&(r==="idle"?(this.rejectReadyPromise(),this.readyPromise=void 0):e==="pending"?this.resolveReadyPromise():r==="pending"&&(this.readyPromise=void 0)),this.finishedPromise&&r!==e&&(r==="idle"?(this.rejectFinishedPromise(),this.finishedPromise=void 0):r==="finished"?this.resolveFinishedPromise():e==="finished"&&(this.finishedPromise=void 0)),this.oldPlayState=r,this.readyPromise||this.finishedPromise}},{key:"play",value:function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),this.timeline.animations.indexOf(this)===-1&&this.timeline.animations.push(this),this.updatePromises()}},{key:"pause",value:function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),!this._isFinished&&!this._paused&&!this._idle?this.currentTimePending=!0:this._idle&&(this.rewind(),this._idle=!1),this._startTime=null,this._paused=!0,this.updatePromises()}},{key:"finish",value:function(){this.updatePromises(),!this._idle&&(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())}},{key:"cancel",value:function(){var e=this;if(this.updatePromises(),!!this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises(),this.oncancel)){var r=new cg(null,this,this.currentTime,null);setTimeout(function(){e.oncancel(r)})}}},{key:"reverse",value:function(){this.updatePromises();var e=this.currentTime;this.playbackRate*=-1,this.play(),e!==null&&(this.currentTime=e),this.updatePromises()}},{key:"updatePlaybackRate",value:function(e){this.playbackRate=e}},{key:"targetAnimations",value:function(){var e,r=(e=this.effect)===null||e===void 0?void 0:e.target;return r.getAnimations()}},{key:"markTarget",value:function(){var e=this.targetAnimations();e.indexOf(this)===-1&&e.push(this)}},{key:"unmarkTarget",value:function(){var e=this.targetAnimations(),r=e.indexOf(this);r!==-1&&e.splice(r,1)}},{key:"tick",value:function(e,r){!this._idle&&!this._paused&&(this._startTime===null?r&&(this.startTime=e-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((e-this._startTime)*this.playbackRate)),r&&(this.currentTimePending=!1,this.fireEvents(e))}},{key:"rewind",value:function(){if(this.playbackRate>=0)this.currentTime=0;else if(this._totalDuration<1/0)this.currentTime=this._totalDuration;else throw new Error("Unable to rewind negative playback rate animation with infinite duration")}},{key:"persist",value:function(){throw new Error(Ee)}},{key:"addEventListener",value:function(e,r,i){throw new Error(Ee)}},{key:"removeEventListener",value:function(e,r,i){throw new Error(Ee)}},{key:"dispatchEvent",value:function(e){throw new Error(Ee)}},{key:"commitStyles",value:function(){throw new Error(Ee)}},{key:"ensureAlive",value:function(){if(this.playbackRate<0&&this.currentTime===0){var e;this._inEffect=!!((e=this.effect)!==null&&e!==void 0&&e.update(-1))}else{var r;this._inEffect=!!((r=this.effect)!==null&&r!==void 0&&r.update(this.currentTime))}!this._inTimeline&&(this._inEffect||!this._finishedFlag)&&(this._inTimeline=!0,this.timeline.animations.push(this))}},{key:"tickCurrentTime",value:function(e,r){e!==this._currentTime&&(this._currentTime=e,this._isFinished&&!r&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive())}},{key:"fireEvents",value:function(e){var r=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var i=new cg(null,this,this.currentTime,e);setTimeout(function(){r.onfinish&&r.onfinish(i)})}this._finishedFlag=!0}}else{if(this.onframe&&this.playState==="running"){var a=new cg(null,this,this.currentTime,e);this.onframe(a)}this._finishedFlag=!1}}}])}(),Jj=4,Qj=.001,t8=1e-7,e8=10,fl=11,eu=1/(fl-1),n8=typeof Float32Array=="function",qN=function(t,e){return 1-3*e+3*t},$N=function(t,e){return 3*e-6*t},GN=function(t){return 3*t},Eh=function(t,e,r){return((qN(e,r)*t+$N(e,r))*t+GN(e))*t},WN=function(t,e,r){return 3*qN(e,r)*t*t+2*$N(e,r)*t+GN(e)},r8=function(t,e,r,i,a){var s,o,l=0;do o=e+(r-e)/2,s=Eh(o,i,a)-t,s>0?r=o:e=o;while(Math.abs(s)>t8&&++l<e8);return o},i8=function(t,e,r,i){for(var a=0;a<Jj;++a){var s=WN(e,r,i);if(s===0)return e;var o=Eh(e,r,i)-t;e-=o/s}return e},Mw=function(t,e,r,i){if(!(t>=0&&t<=1&&r>=0&&r<=1))throw new Error("bezier x values must be in [0, 1] range");if(t===e&&r===i)return function(l){return l};for(var a=n8?new Float32Array(fl):new Array(fl),s=0;s<fl;++s)a[s]=Eh(s*eu,t,r);var o=function(c){for(var u=0,h=1,f=fl-1;h!==f&&a[h]<=c;++h)u+=eu;--h;var d=(c-a[h])/(a[h+1]-a[h]),g=u+d*eu,v=WN(g,t,r);return v>=Qj?i8(c,g,t,r):v===0?g:r8(c,u,u+eu,t,r)};return function(l){return l===0||l===1?l:Eh(o(l),e,i)}},a8=function(t){return t=t.replace(/([A-Z])/g,function(e){return"-".concat(e.toLowerCase())}),t.charAt(0)==="-"?t.substring(1):t},nu=function(t){return Math.pow(t,2)},ru=function(t){return Math.pow(t,3)},iu=function(t){return Math.pow(t,4)},au=function(t){return Math.pow(t,5)},su=function(t){return Math.pow(t,6)},ou=function(t){return 1-Math.cos(t*Math.PI/2)},lu=function(t){return 1-Math.sqrt(1-t*t)},cu=function(t){return t*t*(3*t-2)},uu=function(t){for(var e,r=4;t<((e=Math.pow(2,--r))-1)/11;);return 1/Math.pow(4,3-r)-7.5625*Math.pow((e*3-2)/22-t,2)},hu=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=ne(e,2),i=r[0],a=i===void 0?1:i,s=r[1],o=s===void 0?.5:s,l=tn(Number(a),1,10),c=tn(Number(o),.1,2);return t===0||t===1?t:-l*Math.pow(2,10*(t-1))*Math.sin((t-1-c/(Math.PI*2)*Math.asin(1/l))*(Math.PI*2)/c)},el=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,i=ne(e,4),a=i[0],s=a===void 0?1:a,o=i[1],l=o===void 0?100:o,c=i[2],u=c===void 0?10:c,h=i[3],f=h===void 0?0:h;s=tn(s,.1,1e3),l=tn(l,.1,1e3),u=tn(u,.1,1e3),f=tn(f,.1,1e3);var d=Math.sqrt(l/s),g=u/(2*Math.sqrt(l*s)),v=g<1?d*Math.sqrt(1-g*g):0,p=1,y=g<1?(g*d+-f)/v:-f+d,m=r?r*t/1e3:t;return g<1?m=Math.exp(-m*g*d)*(p*Math.cos(v*m)+y*Math.sin(v*m)):m=(p+y*m)*Math.exp(-m*d),t===0||t===1?t:1-m},ug=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=e,i=ne(r,2),a=i[0],s=a===void 0?10:a,o=i[1],l=o==="start"?Math.ceil:Math.floor;return l(tn(t,0,1)*s)/s},i2=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=ne(e,4),i=r[0],a=r[1],s=r[2],o=r[3];return Mw(i,a,s,o)(t)},fu=Mw(.42,0,1,1),Wr=function(t){return function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;return 1-t(1-e,r,i)}},Vr=function(t){return function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;return e<.5?t(e*2,r,i)/2:1-t(e*-2+2,r,i)/2}},Hr=function(t){return function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;return e<.5?(1-t(1-e*2,r,i))/2:(t(e*2-1,r,i)+1)/2}},a2={steps:ug,"step-start":function(t){return ug(t,[1,"start"])},"step-end":function(t){return ug(t,[1,"end"])},linear:function(t){return t},"cubic-bezier":i2,ease:function(t){return i2(t,[.25,.1,.25,1])},in:fu,out:Wr(fu),"in-out":Vr(fu),"out-in":Hr(fu),"in-quad":nu,"out-quad":Wr(nu),"in-out-quad":Vr(nu),"out-in-quad":Hr(nu),"in-cubic":ru,"out-cubic":Wr(ru),"in-out-cubic":Vr(ru),"out-in-cubic":Hr(ru),"in-quart":iu,"out-quart":Wr(iu),"in-out-quart":Vr(iu),"out-in-quart":Hr(iu),"in-quint":au,"out-quint":Wr(au),"in-out-quint":Vr(au),"out-in-quint":Hr(au),"in-expo":su,"out-expo":Wr(su),"in-out-expo":Vr(su),"out-in-expo":Hr(su),"in-sine":ou,"out-sine":Wr(ou),"in-out-sine":Vr(ou),"out-in-sine":Hr(ou),"in-circ":lu,"out-circ":Wr(lu),"in-out-circ":Vr(lu),"out-in-circ":Hr(lu),"in-back":cu,"out-back":Wr(cu),"in-out-back":Vr(cu),"out-in-back":Hr(cu),"in-bounce":uu,"out-bounce":Wr(uu),"in-out-bounce":Vr(uu),"out-in-bounce":Hr(uu),"in-elastic":hu,"out-elastic":Wr(hu),"in-out-elastic":Vr(hu),"out-in-elastic":Hr(hu),spring:el,"spring-in":el,"spring-out":Wr(el),"spring-in-out":Vr(el),"spring-out-in":Hr(el)},s8=function(t){return a8(t).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim()},o8=function(t){return a2[s8(t)]||a2.linear},l8=function(t){return t},c8=1,u8=.5,s2=0;function o2(n,t){return function(e){if(e>=1)return 1;var r=1/n;return e+=t*r,e-e%r}}var du="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",h8=new RegExp("cubic-bezier\\(".concat(du,",").concat(du,",").concat(du,",").concat(du,"\\)")),f8=/steps\(\s*(\d+)\s*\)/,d8=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function Ow(n){var t=h8.exec(n);if(t)return Mw.apply(void 0,Ie(t.slice(1).map(Number)));var e=f8.exec(n);if(e)return o2(Number(e[1]),s2);var r=d8.exec(n);return r?o2(Number(r[1]),{start:c8,middle:u8,end:s2}[r[2]]):o8(n)}function g8(n){return Math.abs(p8(n)/(n.playbackRate||1))}function p8(n){var t;return n.duration===0||n.iterations===0?0:(n.duration==="auto"?0:Number(n.duration))*((t=n.iterations)!==null&&t!==void 0?t:1)}var VN=0,Tw=1,ef=2,HN=3;function v8(n,t,e){if(t===null)return VN;var r=e.endTime;return t<Math.min(e.delay,r)?Tw:t>=Math.min(e.delay+n+e.endDelay,r)?ef:HN}function y8(n,t,e,r,i){switch(r){case Tw:return t==="backwards"||t==="both"?0:null;case HN:return e-i;case ef:return t==="forwards"||t==="both"?n:null;case VN:return null}}function m8(n,t,e,r,i){var a=i;return n===0?t!==Tw&&(a+=e):a+=r/n,a}function b8(n,t,e,r,i,a){var s=n===1/0?t%1:n%1;return s===0&&e===ef&&r!==0&&(i!==0||a===0)&&(s=1),s}function w8(n,t,e,r){return n===ef&&t===1/0?1/0:e===1?Math.floor(r)-1:Math.floor(r)}function x8(n,t,e){var r=n;if(n!=="normal"&&n!=="reverse"){var i=t;n==="alternate-reverse"&&(i+=1),r="normal",i!==1/0&&i%2!==0&&(r="reverse")}return r==="normal"?e:1-e}function E8(n,t,e){var r=v8(n,t,e),i=y8(n,e.fill,t,r,e.delay);if(i===null)return null;var a=e.duration==="auto"?0:e.duration,s=m8(a,r,e.iterations,i,e.iterationStart),o=b8(s,e.iterationStart,r,e.iterations,i,a),l=w8(r,e.iterations,o,s),c=x8(e.direction,l,o);return e.currentIteration=l,e.progress=c,e.easingFunction(c)}function S8(n,t,e){var r=_8(n,t),i=M8(r,e);return function(a,s){if(s!==null)i.filter(function(l){return s>=l.applyFrom&&s<l.applyTo}).forEach(function(l){var c=s-l.startOffset,u=l.endOffset-l.startOffset,h=u===0?0:c/u;a.setAttribute(l.property,l.interpolation(h),!1,!1)});else for(var o in r)UN(o)&&a.setAttribute(o,null)}}function UN(n){return n!=="offset"&&n!=="easing"&&n!=="composite"&&n!=="computedOffset"}function _8(n,t){for(var e={},r=0;r<n.length;r++)for(var i in n[r])if(UN(i)){var a={offset:n[r].offset,computedOffset:n[r].computedOffset,easing:n[r].easing,easingFunction:Ow(n[r].easing)||t.easingFunction,value:n[r][i]};e[i]=e[i]||[],e[i].push(a)}return e}function M8(n,t){var e=[];for(var r in n)for(var i=n[r],a=0;a<i.length-1;a++){var s=a,o=a+1,l=i[s].computedOffset,c=i[o].computedOffset,u=l,h=c;a===0&&(u=-1/0,c===0&&(o=s)),a===i.length-2&&(h=1/0,l===1&&(s=o)),e.push({applyFrom:u,applyTo:h,startOffset:i[s].computedOffset,endOffset:i[o].computedOffset,easingFunction:i[s].easingFunction,property:r,interpolation:O8(r,i[s].value,i[o].value,t)})}return e.sort(function(f,d){return f.startOffset-d.startOffset}),e}var l2=function(t,e,r){return function(i){var a=YN(t,e,i);return Lt(a)?a:r(a)}};function O8(n,t,e,r){var i=MN[n];if(i&&i.syntax&&i.int){var a=bt.styleValueRegistry.getPropertySyntax(i.syntax);if(a){var s=a.parser,o=s?s(t,r):t,l=s?s(e,r):e,c=a.mixer(o,l,r);if(c){var u=l2.apply(void 0,Ie(c));return function(h){return h===0?t:h===1?e:u(h)}}}}return l2(!1,!0,function(h){return h?e:t})}function YN(n,t,e){if(typeof n=="number"&&typeof t=="number")return n*(1-e)+t*e;if(typeof n=="boolean"&&typeof t=="boolean"||typeof n=="string"&&typeof t=="string")return e<.5?n:t;if(Array.isArray(n)&&Array.isArray(t)){for(var r=n.length,i=t.length,a=Math.max(r,i),s=[],o=0;o<a;o++)s.push(YN(n[o<r?o:r-1],t[o<i?o:i-1],e));return s}throw new Error("Mismatched interpolation arguments ".concat(n,":").concat(t))}var T8=function(){function n(){yt(this,n),this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=l8,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null}return mt(n,[{key:"easing",get:function(){return this._easing},set:function(e){this.easingFunction=Ow(e),this._easing=e}}])}();function k8(n){var t=[];for(var e in n)if(!(e in["easing","offset","composite"])){var r=n[e];Array.isArray(r)||(r=[r]);for(var i=r.length,a=0;a<i;a++){if(!t[a]){var s={};"offset"in n&&(s.offset=Number(n.offset)),"easing"in n&&(s.easing=n.easing),"composite"in n&&(s.composite=n.composite),t[a]=s}r[a]!==void 0&&r[a]!==null&&(t[a][e]=r[a])}}return t.sort(function(o,l){return(o.computedOffset||0)-(l.computedOffset||0)}),t}function c2(n,t){if(n===null)return[];Array.isArray(n)||(n=k8(n));for(var e=n.map(function(l){var c={};t!=null&&t.composite&&(c.composite="auto");for(var u in l){var h=l[u];if(u==="offset"){if(h!==null){if(h=Number(h),!isFinite(h))throw new Error("Keyframe offsets must be numbers.");if(h<0||h>1)throw new Error("Keyframe offsets must be between 0 and 1.");c.computedOffset=h}}else if(u==="composite"&&["replace","add","accumulate","auto"].indexOf(h)===-1)throw new Error("".concat(h," compositing is not supported"));c[u]=h}return c.offset===void 0&&(c.offset=null),c.easing===void 0&&(c.easing=(t==null?void 0:t.easing)||"linear"),c.composite===void 0&&(c.composite="auto"),c}),r=!0,i=-1/0,a=0;a<e.length;a++){var s=e[a].offset;if(Ut(s))r=!1;else{if(s<i)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");i=s}}e=e.filter(function(l){return Number(l.offset)>=0&&Number(l.offset)<=1});function o(){var l,c=e,u=c.length;if(e[u-1].computedOffset=Number((l=e[u-1].offset)!==null&&l!==void 0?l:1),u>1){var h;e[0].computedOffset=Number((h=e[0].offset)!==null&&h!==void 0?h:0)}for(var f=0,d=Number(e[0].computedOffset),g=1;g<u;g++){var v=e[g].computedOffset;if(!Ut(v)&&!Ut(d)){for(var p=1;p<g-f;p++)e[f+p].computedOffset=d+(Number(v)-d)*p/(g-f);f=g,d=Number(v)}}}return r||o(),e}var A8="backwards|forwards|both|none".split("|"),C8="reverse|alternate|alternate-reverse".split("|");function P8(n,t){var e=new T8;return typeof n=="number"&&!isNaN(n)?e.duration=n:n!==void 0&&Object.keys(n).forEach(function(r){if(n[r]!==void 0&&n[r]!==null&&n[r]!=="auto"){if((typeof e[r]=="number"||r==="duration")&&(typeof n[r]!="number"||isNaN(n[r]))||r==="fill"&&A8.indexOf(n[r])===-1||r==="direction"&&C8.indexOf(n[r])===-1)return;e[r]=n[r]}}),e}function N8(n,t){return n=R8(n??{duration:"auto"}),P8(n)}function R8(n){return typeof n=="number"&&(isNaN(n)?n={duration:"auto"}:n={duration:n}),n}var L8=function(){function n(t,e,r){var i=this;yt(this,n),this.composite="replace",this.iterationComposite="replace",this.target=t,this.timing=N8(r),this.timing.effect=this,this.timing.activeDuration=g8(this.timing),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=c2(e,this.timing),this.interpolations=S8(this.normalizedKeyframes,this.timing,this.target);var a=bt.globalThis.Proxy;this.computedTiming=a?new a(this.timing,{get:function(o,l){return l==="duration"?o.duration==="auto"?0:o.duration:l==="fill"?o.fill==="auto"?"none":o.fill:l==="localTime"?i.animation&&i.animation.currentTime||null:l==="currentIteration"?!i.animation||i.animation.playState!=="running"?null:o.currentIteration||0:l==="progress"?!i.animation||i.animation.playState!=="running"?null:o.progress||0:o[l]},set:function(){return!0}}):this.timing}return mt(n,[{key:"applyInterpolations",value:function(){this.interpolations(this.target,Number(this.timeFraction))}},{key:"update",value:function(e){return e===null?!1:(this.timeFraction=E8(this.timing.activeDuration,e,this.timing),this.timeFraction!==null)}},{key:"getKeyframes",value:function(){return this.normalizedKeyframes}},{key:"setKeyframes",value:function(e){this.normalizedKeyframes=c2(e)}},{key:"getComputedTiming",value:function(){return this.computedTiming}},{key:"getTiming",value:function(){return this.timing}},{key:"updateTiming",value:function(e){var r=this;Object.keys(e||{}).forEach(function(i){r.timing[i]=e[i]})}}])}();function u2(n,t){return Number(n.id)-Number(t.id)}var I8=function(){function n(t){var e=this;yt(this,n),this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(r){e.currentTime=r,e.discardAnimations(),e.animations.length===0?e.timelineTicking=!1:e.requestAnimationFrame(e.webAnimationsNextTick)},this.processRafCallbacks=function(r){var i=e.rafCallbacks;e.rafCallbacks=[],r<Number(e.currentTime)&&(r=Number(e.currentTime)),e.animations.sort(u2),e.animations=e.tick(r,!0,e.animations)[0],i.forEach(function(a){a[1](r)}),e.applyPendingEffects()},this.document=t}return mt(n,[{key:"getAnimations",value:function(){return this.discardAnimations(),this.animations.slice()}},{key:"isTicking",value:function(){return this.inTick}},{key:"play",value:function(e,r,i){var a=new L8(e,r,i),s=new Zj(a,this);return this.animations.push(s),this.restartWebAnimationsNextTick(),s.updatePromises(),s.play(),s.updatePromises(),s}},{key:"applyDirtiedAnimation",value:function(e){var r=this;if(!this.inTick){e.markTarget();var i=e.targetAnimations();i.sort(u2);var a=this.tick(Number(this.currentTime),!1,i.slice())[1];a.forEach(function(s){var o=r.animations.indexOf(s);o!==-1&&r.animations.splice(o,1)}),this.applyPendingEffects()}}},{key:"restart",value:function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame(function(){}),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame}},{key:"destroy",value:function(){this.document.defaultView.cancelAnimationFrame(this.frameId)}},{key:"applyPendingEffects",value:function(){this.pendingEffects.forEach(function(e){e==null||e.applyInterpolations()}),this.pendingEffects=[]}},{key:"updateAnimationsPromises",value:function(){this.animationsWithPromises=this.animationsWithPromises.filter(function(e){return e.updatePromises()})}},{key:"discardAnimations",value:function(){this.updateAnimationsPromises(),this.animations=this.animations.filter(function(e){return e.playState!=="finished"&&e.playState!=="idle"})}},{key:"restartWebAnimationsNextTick",value:function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))}},{key:"rAF",value:function(e){var r=this.rafId++;return this.rafCallbacks.length===0&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([r,e]),r}},{key:"requestAnimationFrame",value:function(e){var r=this;return this.rAF(function(i){r.updateAnimationsPromises(),e(i),r.updateAnimationsPromises()})}},{key:"tick",value:function(e,r,i){var a=this,s,o;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=e,this.ticking=!1;var l=[],c=[],u=[],h=[];return i.forEach(function(f){f.tick(e,r),f._inEffect?(c.push(f.effect),f.markTarget()):(l.push(f.effect),f.unmarkTarget()),f._needsTick&&(a.ticking=!0);var d=f._inEffect||f._needsTick;f._inTimeline=d,d?u.push(f):h.push(f)}),(s=this.pendingEffects).push.apply(s,l),(o=this.pendingEffects).push.apply(o,c),this.ticking&&this.requestAnimationFrame(function(){}),this.inTick=!1,[u,h]}}])}();bt.EasingFunction=Ow;bt.AnimationTimeline=I8;const D8={duration:500},F8={duration:1e3,easing:"cubic-bezier(0.250, 0.460, 0.450, 0.940)",iterations:1,fill:"both"};var We;(function(n){n.NodeAdded="NodeAdded",n.NodeUpdated="NodeUpdated",n.NodeRemoved="NodeRemoved",n.EdgeAdded="EdgeAdded",n.EdgeUpdated="EdgeUpdated",n.EdgeRemoved="EdgeRemoved",n.ComboAdded="ComboAdded",n.ComboUpdated="ComboUpdated",n.ComboRemoved="ComboRemoved"})(We||(We={}));var yr;(function(n){n.DRAW="draw",n.COLLAPSE="collapse",n.EXPAND="expand",n.TRANSFORM="transform"})(yr||(yr={}));var oa;(function(n){n.CLICK="canvas:click",n.DBLCLICK="canvas:dblclick",n.POINTER_OVER="canvas:pointerover",n.POINTER_LEAVE="canvas:pointerleave",n.POINTER_ENTER="canvas:pointerenter",n.POINTER_MOVE="canvas:pointermove",n.POINTER_OUT="canvas:pointerout",n.POINTER_DOWN="canvas:pointerdown",n.POINTER_UP="canvas:pointerup",n.CONTEXT_MENU="canvas:contextmenu",n.DRAG_START="canvas:dragstart",n.DRAG="canvas:drag",n.DRAG_END="canvas:dragend",n.DRAG_ENTER="canvas:dragenter",n.DRAG_OVER="canvas:dragover",n.DRAG_LEAVE="canvas:dragleave",n.DROP="canvas:drop",n.WHEEL="canvas:wheel"})(oa||(oa={}));var ws;(function(n){n.CLICK="combo:click",n.DBLCLICK="combo:dblclick",n.POINTER_OVER="combo:pointerover",n.POINTER_LEAVE="combo:pointerleave",n.POINTER_ENTER="combo:pointerenter",n.POINTER_MOVE="combo:pointermove",n.POINTER_OUT="combo:pointerout",n.POINTER_DOWN="combo:pointerdown",n.POINTER_UP="combo:pointerup",n.CONTEXT_MENU="combo:contextmenu",n.DRAG_START="combo:dragstart",n.DRAG="combo:drag",n.DRAG_END="combo:dragend",n.DRAG_ENTER="combo:dragenter",n.DRAG_OVER="combo:dragover",n.DRAG_LEAVE="combo:dragleave",n.DROP="combo:drop"})(ws||(ws={}));var st;(function(n){n.CLICK="click",n.DBLCLICK="dblclick",n.POINTER_OVER="pointerover",n.POINTER_LEAVE="pointerleave",n.POINTER_ENTER="pointerenter",n.POINTER_MOVE="pointermove",n.POINTER_OUT="pointerout",n.POINTER_DOWN="pointerdown",n.POINTER_UP="pointerup",n.CONTEXT_MENU="contextmenu",n.DRAG_START="dragstart",n.DRAG="drag",n.DRAG_END="dragend",n.DRAG_ENTER="dragenter",n.DRAG_OVER="dragover",n.DRAG_LEAVE="dragleave",n.DROP="drop",n.KEY_DOWN="keydown",n.KEY_UP="keyup",n.WHEEL="wheel",n.PINCH="pinch"})(st||(st={}));var fo;(function(n){n.KEY_DOWN="keydown",n.KEY_UP="keyup"})(fo||(fo={}));var Sh;(function(n){n.CLICK="edge:click",n.DBLCLICK="edge:dblclick",n.POINTER_OVER="edge:pointerover",n.POINTER_LEAVE="edge:pointerleave",n.POINTER_ENTER="edge:pointerenter",n.POINTER_MOVE="edge:pointermove",n.POINTER_OUT="edge:pointerout",n.POINTER_DOWN="edge:pointerdown",n.POINTER_UP="edge:pointerup",n.CONTEXT_MENU="edge:contextmenu",n.DRAG_ENTER="edge:dragenter",n.DRAG_OVER="edge:dragover",n.DRAG_LEAVE="edge:dragleave",n.DROP="edge:drop"})(Sh||(Sh={}));var Mt;(function(n){n.BEFORE_CANVAS_INIT="beforecanvasinit",n.AFTER_CANVAS_INIT="aftercanvasinit",n.BEFORE_SIZE_CHANGE="beforesizechange",n.AFTER_SIZE_CHANGE="aftersizechange",n.BEFORE_ELEMENT_CREATE="beforeelementcreate",n.AFTER_ELEMENT_CREATE="afterelementcreate",n.BEFORE_ELEMENT_UPDATE="beforeelementupdate",n.AFTER_ELEMENT_UPDATE="afterelementupdate",n.BEFORE_ELEMENT_DESTROY="beforeelementdestroy",n.AFTER_ELEMENT_DESTROY="afterelementdestroy",n.BEFORE_ELEMENT_TRANSLATE="beforeelementtranslate",n.AFTER_ELEMENT_TRANSLATE="afterelementtranslate",n.BEFORE_DRAW="beforedraw",n.AFTER_DRAW="afterdraw",n.BEFORE_RENDER="beforerender",n.AFTER_RENDER="afterrender",n.BEFORE_ANIMATE="beforeanimate",n.AFTER_ANIMATE="afteranimate",n.BEFORE_LAYOUT="beforelayout",n.AFTER_LAYOUT="afterlayout",n.BEFORE_STAGE_LAYOUT="beforestagelayout",n.AFTER_STAGE_LAYOUT="afterstagelayout",n.BEFORE_TRANSFORM="beforetransform",n.AFTER_TRANSFORM="aftertransform",n.BATCH_START="batchstart",n.BATCH_END="batchend",n.BEFORE_DESTROY="beforedestroy",n.AFTER_DESTROY="afterdestroy",n.BEFORE_RENDERER_CHANGE="beforerendererchange",n.AFTER_RENDERER_CHANGE="afterrendererchange"})(Mt||(Mt={}));var Ma;(function(n){n.UNDO="undo",n.REDO="redo",n.CANCEL="cancel",n.ADD="add",n.CLEAR="clear",n.CHANGE="change"})(Ma||(Ma={}));var Kr;(function(n){n.CLICK="node:click",n.DBLCLICK="node:dblclick",n.POINTER_OVER="node:pointerover",n.POINTER_LEAVE="node:pointerleave",n.POINTER_ENTER="node:pointerenter",n.POINTER_MOVE="node:pointermove",n.POINTER_OUT="node:pointerout",n.POINTER_DOWN="node:pointerdown",n.POINTER_UP="node:pointerup",n.CONTEXT_MENU="node:contextmenu",n.DRAG_START="node:dragstart",n.DRAG="node:drag",n.DRAG_END="node:dragend",n.DRAG_ENTER="node:dragenter",n.DRAG_OVER="node:dragover",n.DRAG_LEAVE="node:dragleave",n.DROP="node:drop"})(Kr||(Kr={}));const Oe="combo",Ir="tree";var za;(function(n){n.NODE="node",n.EDGE="edge",n.COMBO="combo",n.THEME="theme",n.PALETTE="palette",n.LAYOUT="layout",n.BEHAVIOR="behavior",n.PLUGIN="plugin",n.ANIMATION="animation",n.TRANSFORM="transform",n.SHAPE="shape"})(za||(za={}));const hb={animation:{},behavior:{},combo:{},edge:{},layout:{},node:{},palette:{},theme:{},plugin:{},transform:{},shape:{}};function la(n,t){var e;const r=(e=hb[n])===null||e===void 0?void 0:e[t];if(r)return r}const B8="5.0.44",z8="G6";function ia(n){return`[${z8} v${B8}] ${n}`}const ji={mute:!1,debug:n=>{console.debug(ia(n))},info:n=>{console.info(ia(n))},warn:n=>{console.warn(ia(n))},error:n=>{console.error(ia(n))}};function XN(n){const{theme:t}=n;if(!t)return{};const e=la(za.THEME,t);return e||(ji.warn(`The theme of ${t} is not registered.`),{})}function kw(n,t){if(Array.isArray(n)&&n.length===0)return null;const e=Array.isArray(n)?n[0]:n,r=Array.isArray(n)?n.slice(1):t||[];return new Proxy(e,{get(i,a){return typeof i[a]=="function"&&!["onframe","onfinish"].includes(a)?(...s)=>{i[a](...s),r.forEach(o=>{var l;return(l=o[a])===null||l===void 0?void 0:l.call(o,...s)})}:a==="finished"?Promise.all([e.finished,...r.map(s=>s.finished)]):Reflect.get(i,a)},set(i,a,s){return["onframe","onfinish"].includes(a)||r.forEach(o=>{o[a]=s}),Reflect.set(i,a,s)}})}function fb(n){const t=n.reduce((r,i)=>(Object.entries(i).forEach(([a,s])=>{r[a]===void 0?r[a]=[s]:r[a].push(s)}),r),{});Object.entries(t).forEach(([r,i])=>{(i.length!==n.length||i.some(a=>Ut(a))||i.every(a=>!["sourceNode","targetNode","childrenNode"].includes(r)&&en(a,i[0])))&&delete t[r]});const e=Object.entries(t).reduce((r,[i,a])=>(a.forEach((s,o)=>{r[o]?r[o][i]=s:r[o]={[i]:s}}),r),[]);return n.length!==0&&e.length===0&&e.push({_:0},{_:0}),e}function Yl(n){switch(n){case"opacity":return 1;case"x":case"y":case"z":case"zIndex":return 0;case"visibility":return"visible";case"collapsed":return!1;case"states":return[];default:return}}function KN(n,t){const{animation:e}=n;if(e===!1||t===!1)return!1;const r=Object.assign({},D8);return hn(e)&&Object.assign(r,e),hn(t)&&Object.assign(r,t),r}function j8(n){if(typeof n=="string"){const t=la(za.ANIMATION,n);return t||(ji.warn(`The animation of ${n} is not registered.`),[])}return n}function q8(n,t,e,r){var i,a;const{animation:s}=n;if(s===!1||r===!1)return[];const o=(i=n==null?void 0:n[t])===null||i===void 0?void 0:i.animation;if(o===!1)return[];const l=o==null?void 0:o[e];if(l===!1)return[];const c=(a=XN(n)[t])===null||a===void 0?void 0:a.animation,u=(f=[])=>j8(f).map(d=>Object.assign(Object.assign(Object.assign(Object.assign({},F8),hn(s)&&s),d),hn(r)&&r));if(l)return u(l);if(!c)return[];const h=c[e];return h===!1?[]:u(h)}function ZN(n,t,e,r=[]){if(!r&&n===0&&t===0&&e===0)return null;if(Array.isArray(r)){let a=-1;const s=[];for(let o=0;o<r.length;o++){const l=r[o];if(l[0]==="translate"){if(l[1]===n&&l[2]===t)return null;a=o,s.push(["translate",n,t])}else if(l[0]==="translate3d"){if(l[1]===n&&l[2]===t&&l[3]===e)return null;a=o,s.push(["translate3d",n,t,e??0])}else s.push(l)}return a===-1&&s.splice(0,0,Lt(e)?["translate3d",n,t,e??0]:["translate",n,t]),s.length===0?null:s}const i=r?r.replace(/translate(3d)?\([^)]*\)/g,""):"";return e===0?`translate(${n}, ${t})${i}`:`translate3d(${n}, ${t}, ${e})${i}`}var $8=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};const G8=(n,t,e)=>{if(!e.length)return null;const[r,i]=t,a=c=>{var u;if(c){const h=n.getShape(c);if(!h)return null;const f=`get${hh(c)}Style`,d=((u=n==null?void 0:n[f])===null||u===void 0?void 0:u.bind(n))||(p=>p),g=(d==null?void 0:d(r))||{},v=(d==null?void 0:d(i))||{};return{shape:h,fromStyle:g,toStyle:v}}else return{shape:n,fromStyle:r,toStyle:i}};let s;const o=e.map(c=>{var{fields:u,shape:h,states:f}=c,d=$8(c,["fields","shape","states"]);const g=a(h);if(!g)return null;const{shape:v,fromStyle:p,toStyle:y}=g,m=[{},{}];if(u.forEach(E=>{var S,O;Object.assign(m[0],{[E]:(S=p[E])!==null&&S!==void 0?S:Yl(E)}),Object.assign(m[1],{[E]:(O=y[E])!==null&&O!==void 0?O:Yl(E)})}),m.some(E=>Object.keys(E).some(S=>["x","y","z"].includes(S)))){const{x:E=0,y:S=0,z:O,transform:k=""}=v.attributes||{};m.forEach(T=>{var C,P,N;T.transform=ZN((C=T.x)!==null&&C!==void 0?C:E,(P=T.y)!==null&&P!==void 0?P:S,(N=T.z)!==null&&N!==void 0?N:O,k)})}const w=v.animate(fb(m),d);return h===void 0&&(s=w),w}).filter(Boolean),l=s||(o==null?void 0:o[0]);return l?kw(l,o.filter(c=>c!==c)):null},W8=[{fields:["opacity"]}],V8=[{fields:["x","y"]}],JN=[{fields:["x","y"]}],H8=JN,QN=[{fields:["sourceNode","targetNode"]}],U8=QN,tR=[{fields:["childrenNode","x","y"]}],Y8=tR;function X8(n){return"source"in n&&"target"in n}function K8(n){return n.length===2}function No(n){return n instanceof Float32Array?!0:Array.isArray(n)&&(n.length===2||n.length===3)?n.every(t=>typeof t=="number"):!1}function zi(n,t,e){return n>=t&&n<=e}function qi(n=0){if(Array.isArray(n)){const[t=0,e=t,r=t,i=e]=n;return[t,e,r,i]}return[n,n,n,n]}function Z8(n=0){const t=qi(n);return t[0]+t[2]}function $i(n){return n.max[0]-n.min[0]}function Gi(n){return n.max[1]-n.min[1]}function ts(n){return[$i(n),Gi(n)]}function Pa(n,t){const e=No(n)?Aw(n):n.getShape("key").getBounds();return t?es(e,t):e}function Aw(n){const[t,e,r=0]=n,i=new Re;return i.setMinMax([t,e,r],[t,e,r]),i}function es(n,t){const[e,r,i,a]=qi(t),[s,o,l]=n.min,[c,u,h]=n.max,f=new Re;return f.setMinMax([s-a,o-e,l],[c+r,u+i,h]),f}function vc(n){if(n.length===0)return new Re;if(n.length===1)return n[0];const t=new Re;t.setMinMax(n[0].min,n[0].max);for(let e=1;e<n.length;e++){const r=n[e];t.setMinMax([Math.min(t.min[0],r.min[0]),Math.min(t.min[1],r.min[1]),Math.min(t.min[2],r.min[2])],[Math.max(t.max[0],r.max[0]),Math.max(t.max[1],r.max[1]),Math.max(t.max[2],r.max[2])])}return t}function J8(n,t){const[e,r]=n.min,[i,a]=n.max,[s,o]=t.min,[l,c]=t.max;return e>=s&&i<=l&&r>=o&&a<=c}function di(n,t){return zi(n[0],t.min[0],t.max[0])&&zi(n[1],t.min[1],t.max[1])}function eR(n,t,e=!1){const{min:[r,i],max:[a,s]}=t,o=(n[1]===i||n[1]===s)&&(e||zi(n[0],r,a)),l=(n[0]===r||n[0]===a)&&(e||zi(n[1],i,s));return o||l}function Q8(n,t){return!di(n,t)}function _h(n,t){const{center:e}=t;return n[0]===e[0]&&n[1]===e[1]}function Rl(n,t){const[e,r]=n,[i,a]=t.min,[s,o]=t.max,l=e-i,c=s-e,u=r-a,h=o-r,f=Math.min(l,c,u,h);return f===l?"left":f===c?"right":f===u?"top":f===h?"bottom":"left"}function ks(n,t){const e=Va(n);if(di(n,t))switch(Rl(n,t)){case"left":e[0]=t.min[0];break;case"right":e[0]=t.max[0];break;case"top":e[1]=t.min[1];break;case"bottom":e[1]=t.max[1];break}else{const[r,i]=n,[a,s]=t.min,[o,l]=t.max;e[0]=zi(r,a,o)?r:r<a?a:o,e[1]=zi(i,s,l)?i:i<s?s:l}return e}function t9(n,t){const{center:e}=n,[r,i]=ts(n),a=t==="up"||t==="down"?e[0]:t==="right"?e[0]-r/6:e[0]+r/6,s=t==="left"||t==="right"?e[1]:t==="down"?e[1]-i/6:e[1]+i/6;return[a,s]}function e9(n,t){let[e,r]=ts(n);return[e,r]=t==="up"||t==="down"?[e,r]:[r,e],(Math.pow(r,2)-Math.pow(Math.sqrt(Math.pow(e/2,2)+Math.pow(r,2))-e/2,2))/(2*r)}function n9(n){const{min:[t,e],max:[r,i]}=n,a=[t,i],s=[r,i],o=[r,e],l=[t,e];return[[a,s],[s,o],[o,l],[l,a]]}var r9=function(t,e){return t===e},h2=function(){function n(t,e){e===void 0&&(e=null),this.value=t,this.next=e}return n.prototype.toString=function(t){return t?t(this.value):"".concat(this.value)},n}(),i9=function(){function n(t){t===void 0&&(t=r9),this.head=null,this.tail=null,this.compare=t}return n.prototype.prepend=function(t){var e=new h2(t,this.head);return this.head=e,this.tail||(this.tail=e),this},n.prototype.append=function(t){var e=new h2(t);return this.head?(this.tail.next=e,this.tail=e,this):(this.head=e,this.tail=e,this)},n.prototype.delete=function(t){if(!this.head)return null;for(var e=null;this.head&&this.compare(this.head.value,t);)e=this.head,this.head=this.head.next;var r=this.head;if(r!==null)for(;r.next;)this.compare(r.next.value,t)?(e=r.next,r.next=r.next.next):r=r.next;return this.compare(this.tail.value,t)&&(this.tail=r),e},n.prototype.find=function(t){var e=t.value,r=e===void 0?void 0:e,i=t.callback,a=i===void 0?void 0:i;if(!this.head)return null;for(var s=this.head;s;){if(a&&a(s.value)||r!==void 0&&this.compare(s.value,r))return s;s=s.next}return null},n.prototype.deleteTail=function(){var t=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,t;for(var e=this.head;e.next;)e.next.next?e=e.next:e.next=null;return this.tail=e,t},n.prototype.deleteHead=function(){if(!this.head)return null;var t=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),t},n.prototype.fromArray=function(t){var e=this;return t.forEach(function(r){return e.append(r)}),this},n.prototype.toArray=function(){for(var t=[],e=this.head;e;)t.push(e),e=e.next;return t},n.prototype.reverse=function(){for(var t=this.head,e=null,r=null;t;)r=t.next,t.next=e,e=t,t=r;this.tail=this.head,this.head=e},n.prototype.toString=function(t){return t===void 0&&(t=void 0),this.toArray().map(function(e){return e.toString(t)}).toString()},n}(),a9=function(t,e,r){e===void 0&&(e=[]);var i=e.filter(function(l){return l.source===t||l.target===t});if(r==="target"){var a=function(c){return c.source===t};return i.filter(a).map(function(l){return l.target})}if(r==="source"){var s=function(c){return c.target===t};return i.filter(s).map(function(l){return l.source})}var o=function(c){return c.source===t?c.target:c.source};return i.map(o)},s9=function(t,e){return e.filter(function(r){return r.source===t})},o9=function(t,e){return e.filter(function(r){return r.source===t||r.target===t})},l9=function(t){var e={},r=t.nodes,i=r===void 0?[]:r,a=t.edges,s=a===void 0?[]:a;return i.forEach(function(o){e[o.id]={degree:0,inDegree:0,outDegree:0}}),s.forEach(function(o){e[o.source].degree++,e[o.source].outDegree++,e[o.target].degree++,e[o.target].inDegree++}),e},c9={}.toString,Cw=function(n,t){return c9.call(n)==="[object "+t+"]"};const nR=function(n){return Cw(n,"Function")},rR=function(n){return Array.isArray?Array.isArray(n):Cw(n,"Array")},u9=function(n){var t=typeof n;return n!==null&&t==="object"||t==="function"};function h9(n,t){if(n){var e;if(rR(n))for(var r=0,i=n.length;r<i&&(e=t(n[r],r),e!==!1);r++);else if(u9(n)){for(var a in n)if(n.hasOwnProperty(a)&&(e=t(n[a],a),e===!1))break}}}const f9=function(n){return Cw(n,"String")};var d9=Object.values?function(n){return Object.values(n)}:function(n){var t=[];return h9(n,function(e,r){nR(n)&&r==="prototype"||t.push(e)}),t};const g9=function(n,t){if(!nR(n))throw new TypeError("Expected a function");var e=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var a=t?t.apply(this,r):r[0],s=e.cache;if(s.has(a))return s.get(a);var o=n.apply(this,r);return s.set(a,o),o};return e.cache=new Map,e};var gu;g9(function(n,t){t===void 0&&(t={});var e=t.fontSize,r=t.fontFamily,i=t.fontWeight,a=t.fontStyle,s=t.fontVariant;return gu||(gu=document.createElement("canvas").getContext("2d")),gu.font=[a,s,i,e+"px",r].join(" "),gu.measureText(f9(n)?n:"").width},function(n,t){return t===void 0&&(t={}),AB([n],d9(t)).join("")});var p9=function(t,e,r){for(var i=1/0,a,s=0;s<e.length;s++){var o=e[s].id;!r[o]&&t[o]<=i&&(i=t[o],a=e[s])}return a},v9=function(t,e,r,i){var a=t.nodes,s=a===void 0?[]:a,o=t.edges,l=o===void 0?[]:o,c={},u={},h={};s.forEach(function(m,w){var E=m.id;u[E]=1/0,E===e&&(u[E]=0)});for(var f=s.length,d=function(w){var E=p9(u,s,c),S=E.id;if(c[S]=!0,u[S]===1/0)return"continue";var O=[];r?O=s9(S,l):O=o9(S,l),O.forEach(function(k){var T=k.target,C=k.source,P=T===S?C:T,N=i&&k[i]?k[i]:1;u[P]>u[E.id]+N?(u[P]=u[E.id]+N,h[P]=[E.id]):u[P]===u[E.id]+N&&h[P].push(E.id)})},g=0;g<f;g++)d();h[e]=[e];var v={};for(var p in u)u[p]!==1/0&&iR(e,p,h,v);var y={};for(var p in v)y[p]=v[p][0];return{length:u,path:y,allPath:v}};function iR(n,t,e,r){if(n===t)return[n];if(r[t])return r[t];for(var i=[],a=0,s=e[t];a<s.length;a++){var o=s[a],l=iR(n,o,e,r);if(!l)return;for(var c=0,u=l;c<u.length;c++){var h=u[c];rR(h)?i.push(Rt(Rt([],h,!0),[t],!1)):i.push([h,t])}}return r[t]=i,r[t]}var aR=function(t,e,r,i,a){var s=v9(t,e,i,a),o=s.length,l=s.path,c=s.allPath;return{length:o[r],path:l[r],allPath:c[r]}},f2;(function(n){n.EuclideanDistance="euclideanDistance"})(f2||(f2={}));var y9=function(t,e,r){typeof e!="number"&&(e=1e-6),typeof r!="number"&&(r=.85);for(var i=1,a=0,s=1e3,o=t.nodes,l=o===void 0?[]:o,c=t.edges,u=c===void 0?[]:c,h=l.length,f,d={},g={},v=0;v<h;++v){var p=l[v],y=p.id;d[y]=1/h,g[y]=1/h}for(var m=l9(t);s>0&&i>e;){a=0;for(var v=0;v<h;++v){var p=l[v],y=p.id;if(f=0,m[p.id].inDegree===0)d[y]=0;else{for(var w=a9(y,u,"source"),E=0;E<w.length;++E){var S=w[E],O=m[S].outDegree;O>0&&(f+=g[S]/O)}d[y]=r*f,a+=d[y]}}a=(1-a)/h,i=0;for(var v=0;v<h;++v){var p=l[v],y=p.id;f=d[y]+a,i+=Math.abs(f-g[y]),g[y]=f}s-=1}return g};(function(){function n(t){t===void 0&&(t=10),this.linkedList=new i9,this.maxStep=t}return Object.defineProperty(n.prototype,"length",{get:function(){return this.linkedList.toArray().length},enumerable:!1,configurable:!0}),n.prototype.isEmpty=function(){return!this.linkedList.head},n.prototype.isMaxStack=function(){return this.toArray().length>=this.maxStep},n.prototype.peek=function(){return this.isEmpty()?null:this.linkedList.head.value},n.prototype.push=function(t){this.linkedList.prepend(t),this.length>this.maxStep&&this.linkedList.deleteTail()},n.prototype.pop=function(){var t=this.linkedList.deleteHead();return t?t.value:null},n.prototype.toArray=function(){return this.linkedList.toArray().map(function(t){return t.value})},n.prototype.clear=function(){for(;!this.isEmpty();)this.pop()},n})();function tt(n){if(n.id!==void 0)return n.id;if(n.source!==void 0&&n.target!==void 0)return`${n.source}-${n.target}`;throw new Error(ia("The datum does not have available id."))}function pu(n){return n.combo}function sR(n,t){const e={nodes:(n.nodes||[]).map(tt),edges:(n.edges||[]).map(tt),combos:(n.combos||[]).map(tt)};return t?Object.values(e).flat():e}const oR=(n,t,e)=>{var r;switch(e.type){case"degree":{const i=new Map;return(r=n.nodes)===null||r===void 0||r.forEach(a=>{const s=t(tt(a),e.direction).length;i.set(tt(a),s)}),i}case"betweenness":return m9(n,e.directed,e.weightPropertyName);case"closeness":return b9(n,e.directed,e.weightPropertyName);case"eigenvector":return x9(n,e.directed);case"pagerank":return w9(n,e.epsilon,e.linkProb);default:return lR(n)}},lR=n=>{var t;const e=new Map;return(t=n.nodes)===null||t===void 0||t.forEach(r=>{e.set(tt(r),0)}),e},m9=(n,t,e)=>{const r=lR(n),{nodes:i=[]}=n;return i.forEach(a=>{i.forEach(s=>{if(a!==s){const{allPath:o}=aR(n,tt(a),tt(s),t,e),l=o.length;o.flat().forEach(c=>{c!==tt(a)&&c!==tt(s)&&r.set(c,r.get(c)+1/l)})}})}),r},b9=(n,t,e)=>{const r=new Map,{nodes:i=[]}=n;return i.forEach(a=>{const s=i.reduce((o,l)=>{if(a!==l){const{length:c}=aR(n,tt(a),tt(l),t,e);o+=c}return o},0);r.set(tt(a),1/s)}),r},w9=(n,t,e)=>{var r;const i=new Map,a=y9(n,t,e);return(r=n.nodes)===null||r===void 0||r.forEach(s=>{i.set(tt(s),a[tt(s)])}),i},x9=(n,t)=>{const{nodes:e=[]}=n,r=E9(n,t),i=S9(r,e.length),a=new Map;return e.forEach((s,o)=>{a.set(tt(s),i[o])}),a},E9=(n,t)=>{const{nodes:e=[],edges:r=[]}=n,i=Array(e.length).fill(null).map(()=>Array(e.length).fill(0));return r.forEach(({source:a,target:s})=>{const o=e.findIndex(c=>tt(c)===a),l=e.findIndex(c=>tt(c)===s);t?i[o][l]=1:(i[o][l]=1,i[l][o]=1)}),i},S9=(n,t,e=100,r=1e-6)=>{let i=Array(t).fill(1),a=1/0;for(let s=0;s<e&&a>r;s++){const o=Array(t).fill(0);for(let c=0;c<t;c++)for(let u=0;u<t;u++)o[c]+=n[c][u]*i[u];const l=Math.sqrt(o.reduce((c,u)=>c+u*u,0));for(let c=0;c<t;c++)o[c]/=l;a=Math.sqrt(o.reduce((c,u,h)=>c+(u-i[h])*u,0)),i=o}return i};function ja(n,t,e,r=en){const i=new Map(n.map(f=>[e(f),f])),a=new Map(t.map(f=>[e(f),f])),s=new Set(i.keys()),o=new Set(a.keys()),l=[],c=[],u=[],h=[];return o.forEach(f=>{s.has(f)?r(i.get(f),a.get(f))?h.push(a.get(f)):c.push(a.get(f)):l.push(a.get(f))}),s.forEach(f=>{o.has(f)||u.push(i.get(f))}),{enter:l,exit:u,keep:h,update:c}}function Ds(n,t,e){const r=i=>{e&&!e(i)||(i.style.visibility=t)};n.forEach(i=>{r(i)})}function _9(n,t,e){const r={},i=a=>(a in r||(r[a]=0),`${t}-${a}-${r[a]++}`);return e.map(a=>typeof a=="string"?{type:a,key:i(a)}:typeof a=="function"?a.call(n):a.key?a:Object.assign(Object.assign({},a),{key:i(a.type)}))}class Pw{constructor(t){this.extensions=[],this.extensionMap={},this.context=t}setExtensions(t){const e=_9(this.context.graph,this.category,t),{enter:r,update:i,exit:a,keep:s}=ja(this.extensions,e,o=>o.key);this.createExtensions(r),this.updateExtensions([...i,...s]),this.destroyExtensions(a),this.extensions=e}createExtension(t){const{category:e}=this,{key:r,type:i}=t,a=la(e,i);if(!a)return ji.warn(`The extension ${i} of ${e} is not registered.`);const s=new a(this.context,t);this.extensionMap[r]=s}createExtensions(t){t.forEach(e=>this.createExtension(e))}updateExtension(t){const{key:e}=t,r=this.extensionMap[e];r&&r.update(t)}updateExtensions(t){t.forEach(e=>this.updateExtension(e))}destroyExtension(t){const e=this.extensionMap[t];e&&(e.destroy(),delete this.extensionMap[t])}destroyExtensions(t){t.forEach(({key:e})=>this.destroyExtension(e))}destroy(){Object.values(this.extensionMap).forEach(t=>t.destroy()),this.context={},this.extensions=[],this.extensionMap={}}}class Nw{constructor(t,e){this.events=[],this.destroyed=!1,this.context=t,this.options=e}update(t){this.options=Object.assign(this.options,t)}destroy(){this.context={},this.options={},this.destroyed=!0}}class _r extends Nw{}class nf extends _r{constructor(t,e){super(t,Object.assign({},nf.defaultOptions,e)),this.isOverlapping=(r,i)=>i.some(a=>r.intersects(a)),this.occupiedBounds=[],this.detectLabelCollision=r=>{const i=this.context.viewport,a={show:[],hide:[]};return this.occupiedBounds=[],r.forEach(s=>{const o=s.getShape("label").getRenderBounds();i.isInViewport(o,!0)&&!this.isOverlapping(o,this.occupiedBounds)?(a.show.push(s),this.occupiedBounds.push(es(o,this.options.padding))):a.hide.push(s)}),a},this.hideLabelIfExceedViewport=(r,i)=>{const{exit:a}=ja(r,i,s=>s.id);a==null||a.forEach(this.hideLabel)},this.nodeCentralities=new Map,this.sortNodesByCentrality=(r,i)=>{const{model:a}=this.context,s=a.getData(),o=a.getRelatedEdgesData.bind(a);return r.map(c=>(this.nodeCentralities.has(c.id)||(this.nodeCentralities=oR(s,o,i)),{node:c,centrality:this.nodeCentralities.get(c.id)})).sort((c,u)=>u.centrality-c.centrality).map(c=>c.node)},this.sortLabelElementsInView=r=>{const{sort:i,sortNode:a,sortCombo:s,sortEdge:o}=this.options,{model:l}=this.context;if(zt(i))return r.sort((v,p)=>i(l.getElementDataById(v.id),l.getElementDataById(p.id)));const{node:c=[],edge:u=[],combo:h=[]}=Kh(r,v=>v.type),f=zt(s)?h.sort((v,p)=>s(...l.getComboData([v.id,p.id]))):h,d=zt(a)?c.sort((v,p)=>a(...l.getNodeData([v.id,p.id]))):this.sortNodesByCentrality(c,a),g=zt(o)?u.sort((v,p)=>o(...l.getEdgeData([v.id,p.id]))):u;return[...f,...d,...g]},this.labelElementsInView=[],this.isFirstRender=!0,this.onToggleVisibility=r=>{var i;if(((i=r.data)===null||i===void 0?void 0:i.stage)==="zIndex")return;if(!this.validate(r)){this.hiddenElements.size>0&&(this.hiddenElements.forEach(this.showLabel),this.hiddenElements.clear());return}const a=this.isFirstRender?this.getLabelElements():this.getLabelElementsInView();this.hideLabelIfExceedViewport(this.labelElementsInView,a),this.labelElementsInView=a;const s=this.sortLabelElementsInView(this.labelElementsInView),{show:o,hide:l}=this.detectLabelCollision(s);for(let c=o.length-1;c>=0;c--)this.showLabel(o[c]);l.forEach(this.hideLabel)},this.hiddenElements=new Map,this.hideLabel=r=>{const i=r.getShape("label");i&&Ds(i,"hidden"),this.hiddenElements.set(r.id,r)},this.showLabel=r=>{const i=r.getShape("label");i&&Ds(i,"visible"),r.toFront(),this.hiddenElements.delete(r.id)},this.onTransform=YP(this.onToggleVisibility,this.options.throttle,{leading:!0}),this.enableToggle=!0,this.toggle=r=>{this.enableToggle&&this.onToggleVisibility(r)},this.onBeforeRender=()=>{this.enableToggle=!1},this.onAfterRender=r=>{this.onToggleVisibility(r),this.enableToggle=!0},this.bindEvents()}update(t){this.unbindEvents(),super.update(t),this.bindEvents(),this.onToggleVisibility({})}getLabelElements(){const{elementMap:t}=this.context.element,e=[];for(const r in t){const i=t[r];i.isVisible()&&i.getShape("label")&&e.push(i)}return e}getLabelElementsInView(){const t=this.context.viewport;return this.getLabelElements().filter(e=>t.isInViewport(e.getShape("key").getRenderBounds()))}bindEvents(){const{graph:t}=this.context;t.on(Mt.BEFORE_RENDER,this.onBeforeRender),t.on(Mt.AFTER_RENDER,this.onAfterRender),t.on(Mt.AFTER_DRAW,this.toggle),t.on(Mt.AFTER_LAYOUT,this.toggle),t.on(Mt.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){const{graph:t}=this.context;t.off(Mt.BEFORE_RENDER,this.onBeforeRender),t.off(Mt.AFTER_RENDER,this.onAfterRender),t.off(Mt.AFTER_DRAW,this.toggle),t.off(Mt.AFTER_LAYOUT,this.toggle),t.off(Mt.AFTER_TRANSFORM,this.onTransform)}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return zt(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}}nf.defaultOptions={enable:!0,throttle:100,padding:0,sortNode:{type:"degree"}};const d2=[0,0,0];function re(n,t){return n.map((e,r)=>e+t[r])}function Me(n,t){return n.map((e,r)=>e-t[r])}function Qi(n,t){return typeof t=="number"?n.map(e=>e*t):n.map((e,r)=>e*t[r])}function gi(n,t){return typeof t=="number"?n.map(e=>e/t):n.map((e,r)=>e/t[r])}function M9(n,t){return n.reduce((e,r,i)=>e+r*t[i],0)}function O9(n,t){const e=Xl(n),r=Xl(t);return[e[1]*r[2]-e[2]*r[1],e[2]*r[0]-e[0]*r[2],e[0]*r[1]-e[1]*r[0]]}function Na(n,t){return n.map(e=>e*t)}function ze(n,t){return Math.sqrt(n.reduce((e,r,i)=>e+Math.pow(r-t[i]||0,2),0))}function Mh(n,t){return n.reduce((e,r,i)=>e+Math.abs(r-t[i]),0)}function sa(n){const t=n.reduce((e,r)=>e+Math.pow(r,2),0);return n.map(e=>e/Math.sqrt(t))}function Rw(n,t,e=!1){const r=n[0]*t[1]-n[1]*t[0];let i=Math.acos(Qi(n,t).reduce((a,s)=>a+s,0)/(ze(n,d2)*ze(t,d2)));return e&&r<0&&(i=2*Math.PI-i),i}function rf(n,t=!0){return t?[-n[1],n[0]]:[n[1],-n[0]]}function T9(n,t){return n.map(e=>e%t)}function Fs(n){return[n[0],n[1]]}function Xl(n){return K8(n)?[n[0],n[1],0]:n}function cR(n){const[t,e]=n;return!t&&!e?0:Math.atan2(e,t)}function uR(n,t){const[e,r]=n,[i,a]=t,s=Me(e,r),o=Me(i,a);return O9(s,o).every(l=>l===0)}function Lw(n,t,e=!1){if(uR(n,t))return;const[r,i]=n,[a,s]=t,o=((r[0]-a[0])*(a[1]-s[1])-(r[1]-a[1])*(a[0]-s[0]))/((r[0]-i[0])*(a[1]-s[1])-(r[1]-i[1])*(a[0]-s[0])),l=s[0]-a[0]?(r[0]-a[0]+o*(i[0]-r[0]))/(s[0]-a[0]):(r[1]-a[1]+o*(i[1]-r[1]))/(s[1]-a[1]);if(!(!e&&(!zi(o,0,1)||!zi(l,0,1))))return[r[0]+o*(i[0]-r[0]),r[1]+o*(i[1]-r[1])]}function hR(n){if(Array.isArray(n))return zi(n[0],0,1)&&zi(n[1],0,1)?n:[.5,.5];const t=n.split("-"),e=t.includes("left")?0:t.includes("right")?1:.5,r=t.includes("top")?0:t.includes("bottom")?1:.5;return[e,r]}function fn(n){const{x:t=0,y:e=0,z:r=0}=n.style||{};return[+t,+e,+r]}function k9(n){const{x:t,y:e,z:r}=n.style||{};return t!==void 0||e!==void 0||r!==void 0}function A9(n,t){const[e,r]=t,{min:i,max:a}=n;return[i[0]+e*(a[0]-i[0]),i[1]+r*(a[1]-i[1])]}function ta(n,t="center"){const e=hR(t);return A9(n,e)}function jn(n){var t;return[n.x,n.y,(t=n.z)!==null&&t!==void 0?t:0]}function ci(n){var t;return{x:n[0],y:n[1],z:(t=n[2])!==null&&t!==void 0?t:0}}function nl(n,t=0){return n.map(e=>parseFloat(e.toFixed(t)))}function qa(n,t,e,r=!1){if(en(n,t))return n;const i=r?Me(n,t):Me(t,n),a=sa(i),s=[a[0]*e,a[1]*e];return re(Fs(n),s)}function fR(n,t){return n[1]===t[1]}function C9(n,t){return n[0]===t[0]}function P9(n,t){return fR(n,t)||C9(n,t)}function dR(n,t,e){return uR([n,t],[t,e])}function gR(n,t){return[2*t[0]-n[0],2*t[1]-n[1]]}function pR(n,t,e,r=!0,i=!1){for(let a=0;a<e.length;a++){let s=e[a],o=e[(a+1)%e.length];r&&(s=re(t,s),o=re(t,o));const l=i?gR(n,t):n,c=Lw([t,l],[s,o]);if(c)return{point:c,line:[s,o]}}return{point:t,line:void 0}}function N9(n,t,e,r){const i=n[0],a=n[1];let s=!1;e===void 0&&(e=0),r===void 0&&(r=t.length);const o=r-e;for(let l=0,c=o-1;l<o;c=l++){const u=t[l+e][0],h=t[l+e][1],f=t[c+e][0],d=t[c+e][1];h>a!=d>a&&i<(f-u)*(a-h)/(d-h)+u&&(s=!s)}return s}function R9(n,t,e=!1){const r=ta(t,"center"),i=[ta(t,"left-top"),ta(t,"right-top"),ta(t,"right-bottom"),ta(t,"left-bottom")];return pR(n,r,i,!1,e).point}function af(n,t,e=!1){const r=t.center,i=e?gR(n,r):n,a=Me(i,t.center),s=Math.atan2(a[1],a[0]);if(isNaN(s))return r;const o=$i(t)/2,l=Gi(t)/2,c=r[0]+o*Math.cos(s),u=r[1]+l*Math.sin(s);return[c,u]}function L9(n,t){let e=1/0,r=[n[0],t[0]];return n.forEach(i=>{t.forEach(a=>{const s=ze(i,a);s<e&&(e=s,r=[i,a])})}),r}function I9(n,t){let e=1/0,r=[[0,0],[0,0]];return t.forEach(i=>{const a=D9(n,i);a<e&&(e=a,r=i)}),r}function D9(n,t){const e=vR(n,t);return ze(n,e)}function vR(n,t){const[e,r]=t[0],[i,a]=t[1],[s,o]=n,l=i-e,c=a-r;if(l===0&&c===0)return[e,r];let u=((s-e)*l+(o-r)*c)/(l*l+c*c);u>1?u=1:u<0&&(u=0);const h=e+u*l,f=r+u*c;return[h,f]}function F9(n){const t=n.reduce((e,r)=>re(e,r),[0,0]);return gi(t,n.length)}function Iw(n,t=!0){const e=F9(n);return n.sort(([r,i],[a,s])=>{const o=Math.atan2(i-e[1],r-e[0]),l=Math.atan2(s-e[1],a-e[0]);return t?l-o:o-l})}function g2(n,t){return[n,[n[0],t[1]],t,[t[0],n[1]]]}class un{constructor(t,e,r){if(this.phase=e,this.pointerByTouch=[],this.initialDistance=null,this.emitter=t,un.instance)return un.callbacks[this.phase].push(r),un.instance;this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.bindEvents(),un.instance=this,un.callbacks[this.phase].push(r)}bindEvents(){const{emitter:t}=this;t.on(st.POINTER_DOWN,this.onPointerDown),t.on(st.POINTER_MOVE,this.onPointerMove),t.on(st.POINTER_UP,this.onPointerUp)}updatePointerPosition(t,e,r){const i=this.pointerByTouch.findIndex(a=>a.pointerId===t);i>=0&&(this.pointerByTouch[i]={x:e,y:r,pointerId:t})}onPointerDown(t){const{x:e,y:r}=t.client||{};if(!(e===void 0||r===void 0)&&(this.pointerByTouch.push({x:e,y:r,pointerId:t.pointerId}),t.pointerType==="touch"&&this.pointerByTouch.length===2)){un.isPinching=!0;const i=this.pointerByTouch[0].x-this.pointerByTouch[1].x,a=this.pointerByTouch[0].y-this.pointerByTouch[1].y;this.initialDistance=Math.sqrt(i*i+a*a),un.callbacks.pinchstart.forEach(s=>s(t,{scale:0}))}}onPointerMove(t){if(this.pointerByTouch.length!==2||this.initialDistance===null)return;const{x:e,y:r}=t.client||{};if(e===void 0||r===void 0)return;this.updatePointerPosition(t.pointerId,e,r);const i=this.pointerByTouch[0].x-this.pointerByTouch[1].x,a=this.pointerByTouch[0].y-this.pointerByTouch[1].y,o=Math.sqrt(i*i+a*a)/this.initialDistance;un.callbacks.pinchmove.forEach(l=>l(t,{scale:(o-1)*5}))}onPointerUp(t){var e;un.callbacks.pinchend.forEach(r=>r(t,{scale:0})),un.isPinching=!1,this.initialDistance=null,this.pointerByTouch=[],(e=un.instance)===null||e===void 0||e.tryDestroy()}destroy(){this.emitter.off(st.POINTER_DOWN,this.onPointerDown),this.emitter.off(st.POINTER_MOVE,this.onPointerMove),this.emitter.off(st.POINTER_UP,this.onPointerUp),un.instance=null}off(t,e){const r=un.callbacks[t].indexOf(e);r>-1&&un.callbacks[t].splice(r,1),this.tryDestroy()}tryDestroy(){Object.values(un.callbacks).every(t=>t.length===0)&&this.destroy()}}un.isPinching=!1;un.instance=null;un.callbacks={pinchstart:[],pinchmove:[],pinchend:[]};const p2=n=>n.map(t=>me(t)?t.toLocaleLowerCase():t);class Fo{constructor(t){this.map=new Map,this.boundHandlePinch=()=>{},this.recordKey=new Set,this.onKeyDown=e=>{e!=null&&e.key&&(this.recordKey.add(e.key),this.trigger(e))},this.onKeyUp=e=>{e!=null&&e.key&&this.recordKey.delete(e.key)},this.onWheel=e=>{this.triggerExtendKey(st.WHEEL,e)},this.onDrag=e=>{this.triggerExtendKey(st.DRAG,e)},this.handlePinch=(e,r)=>{this.triggerExtendKey(st.PINCH,Object.assign(Object.assign({},e),r))},this.onFocus=()=>{this.recordKey.clear()},this.emitter=t,this.bindEvents()}bind(t,e){t.length!==0&&(t.includes(st.PINCH)&&!this.pinchHandler&&(this.boundHandlePinch=this.handlePinch.bind(this),this.pinchHandler=new un(this.emitter,"pinchmove",this.boundHandlePinch)),this.map.set(t,e))}unbind(t,e){this.map.forEach((r,i)=>{en(i,t)&&(!e||e===r)&&this.map.delete(i)})}unbindAll(){this.map.clear()}match(t){const e=p2(Array.from(this.recordKey)).sort(),r=p2(t).sort();return en(e,r)}bindEvents(){var t;const{emitter:e}=this;e.on(st.KEY_DOWN,this.onKeyDown),e.on(st.KEY_UP,this.onKeyUp),e.on(st.WHEEL,this.onWheel),e.on(st.DRAG,this.onDrag),(t=globalThis.addEventListener)===null||t===void 0||t.call(globalThis,"focus",this.onFocus)}trigger(t){this.map.forEach((e,r)=>{this.match(r)&&e(t)})}triggerExtendKey(t,e){this.map.forEach((r,i)=>{i.includes(t)&&en(Array.from(this.recordKey),i.filter(a=>a!==t))&&r(e)})}destroy(){var t,e;this.unbindAll(),this.emitter.off(st.KEY_DOWN,this.onKeyDown),this.emitter.off(st.KEY_UP,this.onKeyUp),this.emitter.off(st.WHEEL,this.onWheel),this.emitter.off(st.DRAG,this.onDrag),(t=this.pinchHandler)===null||t===void 0||t.off("pinchmove",this.boundHandlePinch),(e=globalThis.removeEventListener)===null||e===void 0||e.call(globalThis,"blur",this.onFocus)}}class yc extends _r{constructor(t,e){super(t,fr({},yc.defaultOptions,e)),this.shortcut=new Fo(t.graph),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.clearStates=this.clearStates.bind(this),this.bindEvents()}onPointerDown(t){if(!this.validate(t)||!this.isKeydown()||this.startPoint)return;const{canvas:e,graph:r}=this.context,i=Object.assign({},this.options.style);this.options.style.lineWidth&&(i.lineWidth=+this.options.style.lineWidth/r.getZoom()),this.rectShape=new Rn({id:"g6-brush-select",style:i}),e.appendChild(this.rectShape),this.startPoint=[t.canvas.x,t.canvas.y]}onPointerMove(t){var e;if(!this.startPoint)return;const{immediately:r,mode:i}=this.options;this.endPoint=Oh(t),(e=this.rectShape)===null||e===void 0||e.attr({x:Math.min(this.endPoint[0],this.startPoint[0]),y:Math.min(this.endPoint[1],this.startPoint[1]),width:Math.abs(this.endPoint[0]-this.startPoint[0]),height:Math.abs(this.endPoint[1]-this.startPoint[1])}),r&&i==="default"&&this.updateElementsStates(g2(this.startPoint,this.endPoint))}onPointerUp(t){if(this.startPoint){if(!this.endPoint){this.clearBrush();return}this.endPoint=Oh(t),this.updateElementsStates(g2(this.startPoint,this.endPoint)),this.clearBrush()}}clearStates(){this.endPoint||this.clearElementsStates()}clearElementsStates(){const{graph:t}=this.context,e=Object.values(t.getData()).reduce((r,i)=>Object.assign({},r,i.reduce((a,s)=>(a[tt(s)]=[],a),{})),{});t.setElementState(e,this.options.animation)}updateElementsStates(t){const{graph:e}=this.context,{enableElements:r,state:i,mode:a,onSelect:s}=this.options,o=this.selector(e,t,r);let l={};switch(a){case"union":o.forEach(c=>{l[c]=[...e.getElementState(c),i]});break;case"diff":o.forEach(c=>{const u=e.getElementState(c);l[c]=u.includes(i)?u.filter(h=>h!==i):[...u,i]});break;case"intersect":o.forEach(c=>{const u=e.getElementState(c);l[c]=u.includes(i)?[i]:[]});break;case"default":default:o.forEach(c=>{l[c]=[i]});break}zt(s)&&(l=s(l)),e.setElementState(l,this.options.animation)}selector(t,e,r){if(!r||r.length===0)return[];const i=[],a=t.getData();if(r.forEach(s=>{a[`${s}s`].forEach(o=>{const l=tt(o);t.getElementVisibility(l)!=="hidden"&&N9(t.getElementPosition(l),e)&&i.push(l)})}),r.includes("edge")){const s=a.edges;s==null||s.forEach(o=>{const{source:l,target:c}=o;i.includes(l)&&i.includes(c)&&i.push(tt(o))})}return i}clearBrush(){var t;(t=this.rectShape)===null||t===void 0||t.remove(),this.rectShape=void 0,this.startPoint=void 0,this.endPoint=void 0}isKeydown(){const{trigger:t}=this.options,e=Array.isArray(t)?t:[t];return this.shortcut.match(e.filter(r=>r!=="drag"))}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return zt(e)?e(t):!!e}bindEvents(){const{graph:t}=this.context;t.on(st.POINTER_DOWN,this.onPointerDown),t.on(st.POINTER_MOVE,this.onPointerMove),t.on(st.POINTER_UP,this.onPointerUp),t.on(oa.CLICK,this.clearStates)}unbindEvents(){const{graph:t}=this.context;t.off(st.POINTER_DOWN,this.onPointerDown),t.off(st.POINTER_MOVE,this.onPointerMove),t.off(st.POINTER_UP,this.onPointerUp),t.off(oa.CLICK,this.clearStates)}update(t){this.unbindEvents(),this.options=fr(this.options,t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}}yc.defaultOptions={animation:!1,enable:!0,enableElements:["node","combo","edge"],immediately:!1,mode:"default",state:"selected",trigger:["shift"],style:{width:0,height:0,lineWidth:1,fill:"#1677FF",stroke:"#1677FF",fillOpacity:.1,zIndex:2,pointerEvents:"none"}};const Oh=n=>[n.canvas.x,n.canvas.y],ca=.8,Bs=["node","edge","combo"];function As(n,t,e,r,i=0){r==="TB"&&t(n,i);const a=e(n);if(a)for(const s of a)As(s,t,e,r,i+1);r==="BT"&&t(n,i)}function B9(n,t,e){const r=[[n,0]];for(;r.length;){const[i,a]=r.shift();t(i,a);const s=e(i);if(s)for(const o of s)r.push([o,a+1])}}function yR(n,t,e,r,i="both"){if(t==="combo"||t==="node")return hg(n,e,r,i);const a=n.getEdgeData(e);if(!a)return[];const s=hg(n,a.source,r-1,i),o=hg(n,a.target,r-1,i);return Array.from(new Set([...s,...o,e]))}function hg(n,t,e,r="both"){const i=new Set,a=new Set,s=new Set;return B9(t,(o,l)=>{l>e||(s.add(o),n.getRelatedEdgesData(o,r).forEach(c=>{const u=tt(c);!a.has(u)&&l<e&&(s.add(u),a.add(u))}))},o=>n.getRelatedEdgesData(o,r).map(l=>l.source===o?l.target:l.source).filter(l=>i.has(l)?!1:(i.add(l),!0))),Array.from(s)}function fg(n){return n.states||[]}var vu=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(r.next(u))}catch(h){s(h)}}function l(u){try{c(r.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((r=r.apply(n,t||[])).next())})};class sf extends _r{constructor(t,e){super(t,Object.assign({},sf.defaultOptions,e)),this.onClickSelect=r=>vu(this,void 0,void 0,function*(){var i,a;this.validate(r)&&(yield this.updateState(r),(a=(i=this.options).onClick)===null||a===void 0||a.call(i,r))}),this.onClickCanvas=r=>vu(this,void 0,void 0,function*(){var i,a;this.validate(r)&&(yield this.clearState(),(a=(i=this.options).onClick)===null||a===void 0||a.call(i,r))}),this.shortcut=new Fo(t.graph),this.bindEvents()}bindEvents(){const{graph:t}=this.context;this.unbindEvents(),Bs.forEach(e=>{t.on(`${e}:${st.CLICK}`,this.onClickSelect)}),t.on(oa.CLICK,this.onClickCanvas)}get isMultipleSelect(){const{multiple:t,trigger:e}=this.options;return t&&this.shortcut.match(e)}getNeighborIds(t){const{target:e,targetType:r}=t,{graph:i}=this.context,{degree:a}=this.options;return yR(i,r,e.id,typeof a=="function"?a(t):a).filter(s=>s!==e.id)}updateState(t){return vu(this,void 0,void 0,function*(){const{state:e,unselectedState:r,neighborState:i,animation:a}=this.options;if(!e&&!i&&!r)return;const{target:s}=t,{graph:o}=this.context,l=o.getElementData(s.id),c=fg(l).includes(e)?"unselect":"select",u={},h=this.isMultipleSelect,f=[s.id],d=this.getNeighborIds(t);if(h)if(Object.assign(u,this.getDataStates()),c==="select"){const g=(v,p)=>{v.forEach(y=>{const m=new Set(o.getElementState(y));m.add(p),m.delete(r),u[y]=Array.from(m)})};g(f,e),g(d,i),r&&Object.keys(u).forEach(v=>{const p=u[v];!p.includes(e)&&!p.includes(i)&&!p.includes(r)&&u[v].push(r)})}else{const g=u[s.id];u[s.id]=g.filter(v=>v!==e&&v!==i),g.includes(r)||u[s.id].push(r),d.forEach(v=>{u[v]=u[v].filter(p=>p!==i),u[v].includes(e)||u[v].push(r)})}else if(c==="select"){Object.assign(u,this.getClearStates(!!r));const g=(v,p)=>{v.forEach(y=>{u[y]||(u[y]=o.getElementState(y)),u[y].push(p)})};g(f,e),g(d,i),r&&Object.keys(u).forEach(v=>{!f.includes(v)&&!d.includes(v)&&u[v].push(r)})}else Object.assign(u,this.getClearStates());yield o.setElementState(u,a)})}getDataStates(){const{graph:t}=this.context,{nodes:e,edges:r,combos:i}=t.getData(),a={};return[...e,...r,...i].forEach(s=>{a[tt(s)]=fg(s)}),a}getClearStates(t=!1){const{graph:e}=this.context,{state:r,unselectedState:i,neighborState:a}=this.options,s=new Set([r,i,a]),{nodes:o,edges:l,combos:c}=e.getData(),u={};return[...o,...l,...c].forEach(h=>{const f=fg(h),d=f.filter(g=>!s.has(g));(t||d.length!==f.length)&&(u[tt(h)]=d)}),u}clearState(){return vu(this,void 0,void 0,function*(){const{graph:t}=this.context;yield t.setElementState(this.getClearStates(),this.options.animation)})}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return zt(e)?e(t):!!e}unbindEvents(){const{graph:t}=this.context;Bs.forEach(e=>{t.off(`${e}:${st.CLICK}`,this.onClickSelect)}),t.off(oa.CLICK,this.onClickCanvas)}destroy(){this.unbindEvents(),super.destroy()}}sf.defaultOptions={animation:!0,enable:!0,multiple:!1,trigger:["shift"],state:"selected",neighborState:"selected",unselectedState:void 0,degree:0};function xr(n){var t;return!!(!((t=n.style)===null||t===void 0)&&t.collapsed)}function Th(n,t){if(!n.startsWith(t))return!1;const e=n[t.length];return e>="A"&&e<="Z"}function z9(n,t){return`${t}${hh(n)}`}function j9(n,t,e=!0){if(!t||!Th(n,t))return n;const r=n.slice(t.length);return e?pB(r):r}function yn(n,t){const e=Object.entries(n).reduce((r,[i,a])=>(i==="className"||i==="class"||Th(i,t)&&Object.assign(r,{[j9(i,t)]:a}),r),{});if("opacity"in n){const r=z9("opacity",t),i=n.opacity;if(r in n){const a=n[r];Object.assign(e,{opacity:i*a})}else Object.assign(e,{opacity:i})}return e}function db(n,t){const e=t.length;return Object.keys(n).reduce((r,i)=>{if(i.startsWith(t)){const a=i.slice(e);r[a]=n[i]}return r},{})}function mR(n,t){const e=typeof t=="string"?[t]:t,r={};return Object.keys(n).forEach(i=>{e.find(a=>i.startsWith(a))||(r[i]=n[i])}),r}function jr(n=0){if(typeof n=="number")return[n,n,n];const[t,e=t,r=t]=n;return[t,e,r]}var q9=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};function v2(n,t){const{datum:e,graph:r}=t;return typeof n=="function"?n.call(r,e):Object.fromEntries(Object.entries(n).map(([i,a])=>typeof a=="function"?[i,a.call(r,e)]:[i,a]))}function In(n,t){const e=(n==null?void 0:n.style)||{},r=(t==null?void 0:t.style)||{};for(const i in e)i in r||(r[i]=e[i]);return Object.assign({},n,t,{style:r})}function $9(n){const{x:t,y:e,z:r,class:i,className:a,transform:s,transformOrigin:o,zIndex:l,visibility:c}=n;return q9(n,["x","y","z","class","className","transform","transformOrigin","zIndex","visibility"])}function G9(n,t){const e=jr(n);let r={};return t.text&&!t.fontSize&&(r={fontSize:Math.min(...e)*.5}),t.src&&(!t.width||!t.height)&&(r={width:e[0]*.5,height:e[1]*.5}),r}function y2(n){if(n)return typeof n=="string"||typeof n=="function"||Array.isArray(n)?{type:"group",field:t=>t.id,color:n,invert:!1}:n}function W9(n,t){if(!t)return{};const{type:e,color:r,field:i,invert:a}=t,s=l=>{const c=typeof r=="string"?la("palette",r):r;if(typeof c=="function"){const u={};return l.forEach(([h,f])=>{u[h]=c(a?1-f:f)}),u}else if(Array.isArray(c)){const u=a?[...c].reverse():c,h={};return l.forEach(([f,d])=>{h[f]=u[d%c.length]}),h}return{}},o=(l,c)=>{var u;return typeof l=="string"?(u=c.data)===null||u===void 0?void 0:u[l]:l==null?void 0:l(c)};if(e==="group"){const l=Kh(n,f=>{if(!i)return"default";const d=o(i,f);return d?String(d):"default"}),c=Object.keys(l),u=s(c.map((f,d)=>[f,d])),h={};return Object.entries(l).forEach(([f,d])=>{d.forEach(g=>{h[tt(g)]=u[f]})}),h}else if(e==="value"){const[l,c]=n.reduce(([h,f],d)=>{const g=o(i,d);if(typeof g!="number")throw new Error(ia(`Palette field ${i} is not a number`));return[Math.min(h,g),Math.max(f,g)]},[1/0,-1/0]),u=c-l;return s(n.map(h=>[h.id,(o(i,h)-l)/u]))}}function bR(n){const t=typeof n=="string"?la("palette",n):n;if(typeof t!="function")return t}function wR(n,t){let e=2*n;return typeof t=="string"?e=n*Number(t.replace("%",""))/100:typeof t=="number"&&(e=t),isNaN(e)&&(e=2*n),e}function xR(n,t,e=1,r=!1){const i=r?e:1,a=(n.max[0]-n.min[0])*i;return wR(a,t)}function V9(n,t,e=1){const r=ze(n[0],n[1])*e;return wR(r,t)}class mc extends _w{constructor(t){m2(t.style),super(t),this.shapeMap={},this.animateMap={},this.render(this.attributes,this),this.setVisibility(),this.bindEvents()}get parsedAttributes(){return this.attributes}upsert(t,e,r,i,a){var s,o,l,c,u,h,f,d;const g=this.shapeMap[t];if(r===!1){g&&((s=a==null?void 0:a.beforeDestroy)===null||s===void 0||s.call(a,g),i.removeChild(g),delete this.shapeMap[t],(o=a==null?void 0:a.afterDestroy)===null||o===void 0||o.call(a,g));return}const v=typeof e=="string"?la(za.SHAPE,e):e;if(!v)throw new Error(ia(`Shape ${e} not found`));if(!g||g.destroyed||!(g instanceof v)){g&&((l=a==null?void 0:a.beforeDestroy)===null||l===void 0||l.call(a,g),g==null||g.destroy(),(c=a==null?void 0:a.afterDestroy)===null||c===void 0||c.call(a,g)),(u=a==null?void 0:a.beforeCreate)===null||u===void 0||u.call(a);const p=new v({className:t,style:r});return i.appendChild(p),this.shapeMap[t]=p,(h=a==null?void 0:a.afterCreate)===null||h===void 0||h.call(a,p),p}return(f=a==null?void 0:a.beforeUpdate)===null||f===void 0||f.call(a,g),xb(g,r),(d=a==null?void 0:a.afterUpdate)===null||d===void 0||d.call(a,g),g}update(t={}){const e=Object.assign({},this.attributes,t);m2(e),j$(this,e),this.render(e,this),this.setVisibility()}bindEvents(){}getGraphicStyle(t){return $9(t)}get compositeShapes(){return[["badges","badge-"],["ports","port-"]]}animate(t,e){if(t.length===0)return null;const r=[];if(t[0].x!==void 0||t[0].y!==void 0||t[0].z!==void 0){const{x:a=0,y:s=0,z:o=0}=this.attributes;t.forEach(l=>{const{x:c=a,y:u=s,z:h=o}=l;Object.assign(l,{transform:h?[["translate3d",c,u,h]]:[["translate",c,u]]})})}const i=super.animate(t,e);if(i&&(dg(this,i),r.push(i)),Array.isArray(t)&&t.length>0){const a=["transform","transformOrigin","x","y","z","zIndex"];if(Object.keys(t[0]).some(s=>!a.includes(s))){Object.entries(this.shapeMap).forEach(([o,l])=>{const c=`get${hh(o)}Style`,u=this[c];if(zt(u)){const h=t.map(d=>u.call(this,Object.assign(Object.assign({},this.attributes),d))),f=l.animate(fb(h),e);f&&(dg(l,f),r.push(f))}});const s=(o,l)=>{if(!Ti(o)){const c=`get${hh(l)}Style`,u=this[c];if(zt(u)){const h=t.map(f=>u.call(this,Object.assign(Object.assign({},this.attributes),f)));Object.entries(h[0]).map(([f])=>{const d=h.map(v=>v[f]),g=o[f];if(g){const v=g.animate(fb(d),e);v&&(dg(g,v),r.push(v))}})}}};this.compositeShapes.forEach(([o,l])=>{const c=db(this.shapeMap,l);s(c,o)})}}return kw(r)}getShape(t){return this.shapeMap[t]}setVisibility(){const{visibility:t}=this.attributes;Ds(this,t)}destroy(){this.shapeMap={},this.animateMap={},super.destroy()}}function dg(n,t){t==null||t.finished.then(()=>{const e=n.activeAnimations.findIndex(r=>r===t);e>-1&&n.activeAnimations.splice(e,1)})}function m2(n){if(!n)return{};if("x"in n||"y"in n||"z"in n){const{x:t=0,y:e=0,z:r,transform:i}=n,a=ZN(t,e,r,i);a&&(n.transform=a)}return n}var H9=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};class ns extends mc{constructor(t){super(In({style:ns.defaultStyleProps},t))}isTextStyle(t){return Th(t,"label")}isBackgroundStyle(t){return Th(t,"background")}getTextStyle(t){const e=this.getGraphicStyle(t),{padding:r}=e,i=H9(e,["padding"]);return mR(i,"background")}getBackgroundStyle(t){if(t.background===!1)return!1;const e=this.getGraphicStyle(t),{wordWrap:r,wordWrapWidth:i,padding:a}=e,s=yn(e,"background"),{min:[o,l],center:[c,u],halfExtents:[h,f]}=this.shapeMap.text.getGeometryBounds(),[d,g,v,p]=qi(a),y=h*2+p+g,{width:m,height:w}=s;m&&w?Object.assign(s,{x:c-Number(m)/2,y:u-Number(w)/2}):Object.assign(s,{x:o-p,y:l-d,width:r?Math.min(y,i+p+g):y,height:f*2+d+v});const{radius:E}=s;if(typeof E=="string"&&E.endsWith("%")){const S=Number(E.replace("%",""))/100;s.radius=Math.min(+s.width,+s.height)*S}return s}render(t=this.parsedAttributes,e=this){this.upsert("text",Qa,this.getTextStyle(t),e),this.upsert("background",Rn,this.getBackgroundStyle(t),e)}getGeometryBounds(){return(this.getShape("background")||this.getShape("text")).getGeometryBounds()}}ns.defaultStyleProps={padding:0,fontSize:12,fontFamily:"system-ui, sans-serif",wordWrap:!0,maxLines:1,wordWrapWidth:128,textOverflow:"...",textBaseline:"middle",backgroundOpacity:.75,backgroundZIndex:-1,backgroundLineWidth:0};class Ua extends mc{constructor(t){super(In({style:Ua.defaultStyleProps},t))}getBadgeStyle(t){return this.getGraphicStyle(t)}render(t=this.parsedAttributes,e=this){this.upsert("label",ns,this.getBadgeStyle(t),e)}getGeometryBounds(){const t=this.getShape("label");return(t.getShape("background")||t.getShape("text")).getGeometryBounds()}}Ua.defaultStyleProps={padding:[2,4,2,4],fontSize:10,wordWrap:!1,backgroundRadius:"50%",backgroundOpacity:1};function U9(n,t=!0){const e=[];return n.forEach((r,i)=>{e.push([i===0?"M":"L",...r])}),t&&e.push(["Z"]),e}const b2={M:["x","y"],m:["dx","dy"],H:["x"],h:["dx"],V:["y"],v:["dy"],L:["x","y"],l:["dx","dy"],Z:[],z:[],C:["x1","y1","x2","y2","x","y"],c:["dx1","dy1","dx2","dy2","dx","dy"],S:["x2","y2","x","y"],s:["dx2","dy2","dx","dy"],Q:["x1","y1","x","y"],q:["dx1","dy1","dx","dy"],T:["x","y"],t:["dx","dy"],A:["rx","ry","rotation","large-arc","sweep","x","y"],a:["rx","ry","rotation","large-arc","sweep","dx","dy"]};function Y9(n){const t=n.replace(/[\n\r]/g,"").replace(/-/g," -").replace(/(\d*\.)(\d+)(?=\.)/g,"$1$2 ").trim().split(/\s*,|\s+/),e=[];let r="",i={};for(;t.length>0;){let a=t.shift();a in b2?r=a:t.unshift(a),i={type:r},b2[r].forEach(l=>{a=t.shift(),i[l]=a}),r==="M"?r="L":r==="m"&&(r="l");const[s,...o]=Object.values(i);e.push([s,...o.map(Number)])}return e}function X9(n){const t=[];return(typeof n=="string"?Y9(n):n).forEach(r=>{const i=r[0];if(i==="Z"){t.push(t[0]);return}if(i!=="A")for(let a=1;a<r.length;a=a+2)t.push([r[a],r[a+1],0]);else{const a=r.length;t.push([r[a-2],r[a-1],0])}}),t}const ER=n=>{if(n.length<2)return[["M",0,0],["L",0,0]];const t=n[0],e=n[1],r=n[n.length-1],i=n[n.length-2];n.unshift(i,r),n.push(t,e);const a=[["M",r[0],r[1]]];for(let s=1;s<n.length-2;s+=1){const[o,l]=n[s-1],[c,u]=n[s],[h,f]=n[s+1],[d,g]=s!==n.length-2?n[s+2]:[h,f],v=c+(h-o)/6,p=u+(f-l)/6,y=h-(d-c)/6,m=f-(g-u)/6;a.push(["C",v,p,y,m,h,f])}return a};function K9(n,t,e,r,i,a,s){const[o,l]=ta(n,t),c={textAlign:t==="left"?"right":t==="right"?"left":"center",textBaseline:t==="top"?"bottom":t==="bottom"?"top":"middle",transform:[["translate",o+e,l+r]]};if(t==="center"||!i)return c;const u=X9(a);if(!u||u.length<=3)return c;const h=u.map((g,v)=>{const p=g,y=u[(v+1)%u.length];return en(p,y)?null:[p,y]}).filter(Boolean),f=I9([o,l],h),d=vR([o,l],f);if(d&&f&&(c.transform=[["translate",d[0]+e,d[1]+r]],s)){const g=Math.atan((f[0][1]-f[1][1])/(f[0][0]-f[1][0]));c.transform.push(["rotate",g/Math.PI*180]),c.textAlign="center",(t==="right"||t==="left")&&(g>0?c.textBaseline=t==="right"?"bottom":"top":c.textBaseline=t==="right"?"top":"bottom")}return c}var Z9=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};class bc extends mc{constructor(t){super(In({style:bc.defaultStyleProps},t))}getLabelStyle(t){if(!t.label||!t.d||t.d.length===0)return!1;const e=yn(this.getGraphicStyle(t),"label"),{maxWidth:r,offsetX:i,offsetY:a,autoRotate:s,placement:o,closeToPath:l}=e,c=Z9(e,["maxWidth","offsetX","offsetY","autoRotate","placement","closeToPath"]),u=this.shapeMap.key,h=u==null?void 0:u.getRenderBounds();return Object.assign(K9(h,o,i,a,l,t.d,s),{wordWrapWidth:xR(h,r)},c)}getKeyStyle(t){return this.getGraphicStyle(t)}render(t,e){this.upsert("key",Fr,this.getKeyStyle(t),e),this.upsert("label",ns,this.getLabelStyle(t),e)}}bc.defaultStyleProps={label:!0,labelPlacement:"bottom",labelCloseToPath:!0,labelAutoRotate:!0,labelOffsetX:0,labelOffsetY:0};function J9(n){const t=[],e=r=>{r!=null&&r.children.length&&r.children.forEach(i=>{t.push(i),e(i)})};return e(n),t}function Q9(n){const t=[];let e=n.parentNode;for(;e;)t.push(e),e=e.parentNode;return t}let Dw=class extends pc{constructor(t){super(t),this.onMounted=()=>{this.handleRadius()},this.onAttrModified=()=>{this.handleRadius()},co=this,this.isMutationObserved=!0,this.addEventListener(ce.MOUNTED,this.onMounted),this.addEventListener(ce.ATTR_MODIFIED,this.onAttrModified)}handleRadius(){const{radius:t,clipPath:e,width:r=0,height:i=0}=this.attributes;if(t&&r&&i){const[a,s]=this.getBounds().min,o={x:a,y:s,radius:t,width:r,height:i};if(e)Object.assign(this.parsedStyle.clipPath.style,o);else{const l=new Rn({style:o});this.style.clipPath=l}}else e&&(this.style.clipPath=null)}};const gb=new WeakMap;let co=null;const Fw=n=>{if(co&&Q9(co).includes(n)){const t=gb.get(n);t?t.includes(co)||t.push(co):gb.set(n,[co])}},Bw=n=>{const t=gb.get(n);t&&t.forEach(e=>e.handleRadius())};class SR extends mc{constructor(t){super(t)}isImage(){const{src:t}=this.attributes;return!!t}getIconStyle(t=this.attributes){const{width:e=0,height:r=0}=t,i=this.getGraphicStyle(t);return this.isImage()?Object.assign({x:-e/2,y:-r/2},i):Object.assign({textBaseline:"middle",textAlign:"center"},i)}render(t=this.attributes,e=this){this.upsert("icon",this.isImage()?Dw:Qa,this.getIconStyle(t),e)}}class _R extends mc{get context(){return this.config.context}get parsedAttributes(){return this.attributes}onframe(){}animate(t,e){const r=super.animate(t,e);return r&&(r.onframe=()=>this.onframe(),r.finished.then(()=>this.onframe())),r}}var yu=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};class Qr extends _R{constructor(t){super(In({style:Qr.defaultStyleProps},t)),this.type="node"}getSize(t=this.attributes){const{size:e}=t;return jr(e)}getKeyStyle(t){const e=this.getGraphicStyle(t);return Object.assign(mR(e,["label","halo","icon","badge","port"]))}getLabelStyle(t){if(t.label===!1||!t.labelText)return!1;const e=yn(this.getGraphicStyle(t),"label"),{placement:r,maxWidth:i,offsetX:a,offsetY:s}=e,o=yu(e,["placement","maxWidth","offsetX","offsetY"]),l=this.getShape("key").getLocalBounds();return Object.assign(I2(l,r,a,s),{wordWrapWidth:xR(l,i)},o)}getHaloStyle(t){if(t.halo===!1)return!1;const e=this.getKeyStyle(t),{fill:r}=e,i=yu(e,["fill"]),a=yn(this.getGraphicStyle(t),"halo");return Object.assign(Object.assign(Object.assign({},i),{stroke:r}),a)}getIconStyle(t){if(t.icon===!1||!t.iconText&&!t.iconSrc)return!1;const e=yn(this.getGraphicStyle(t),"icon");return Object.assign(G9(t.size,e),e)}getBadgesStyle(t){var e;const r=db(this.shapeMap,"badge-"),i={};if(Object.keys(r).forEach(h=>{i[h]=!1}),t.badge===!1||!(!((e=t.badges)===null||e===void 0)&&e.length))return i;const{badges:a=[],badgePalette:s,opacity:o=1}=t,l=yu(t,["badges","badgePalette","opacity"]),c=bR(s),u=yn(this.getGraphicStyle(l),"badge");return a.forEach((h,f)=>{i[f]=Object.assign(Object.assign({backgroundFill:c?c[f%(c==null?void 0:c.length)]:void 0,opacity:o},u),this.getBadgeStyle(h))}),i}getBadgeStyle(t){const e=this.getShape("key"),{placement:r="top",offsetX:i,offsetY:a}=t,s=yu(t,["placement","offsetX","offsetY"]),o=I2(e.getLocalBounds(),r,i,a,!0);return Object.assign(Object.assign({},o),s)}getPortsStyle(t){var e;const r=this.getPorts(),i={};if(Object.keys(r).forEach(o=>{i[o]=!1}),t.port===!1||!(!((e=t.ports)===null||e===void 0)&&e.length))return i;const a=yn(this.getGraphicStyle(t),"port"),{ports:s=[]}=t;return s.forEach((o,l)=>{const c=o.key||l,u=Object.assign(Object.assign({},a),o);if(VR(u))i[c]=!1;else{const[h,f]=this.getPortXY(t,o);i[c]=Object.assign({transform:[["translate",h,f]]},u)}}),i}getPortXY(t,e){const{placement:r="left"}=e,i=this.getShape("key");return Gw(tq(this.context,i),r)}getPorts(){return db(this.shapeMap,"port-")}getCenter(){return this.getShape("key").getBounds().center}getIntersectPoint(t,e=!1){const r=this.getShape("key").getBounds();return R9(t,r,e)}drawHaloShape(t,e){const r=this.getHaloStyle(t),i=this.getShape("key");this.upsert("halo",i.constructor,r,e)}drawIconShape(t,e){const r=this.getIconStyle(t);this.upsert("icon",SR,r,e),Fw(this)}drawBadgeShapes(t,e){const r=this.getBadgesStyle(t);Object.keys(r).forEach(i=>{const a=r[i];this.upsert(`badge-${i}`,Ua,a,e)})}drawPortShapes(t,e){const r=this.getPortsStyle(t);Object.keys(r).forEach(i=>{const a=r[i],s=`port-${i}`;this.upsert(s,da,a,e)})}drawLabelShape(t,e){const r=this.getLabelStyle(t);this.upsert("label",ns,r,e)}_drawKeyShape(t,e){return this.drawKeyShape(t,e)}render(t=this.parsedAttributes,e=this){this._drawKeyShape(t,e),this.getShape("key")&&(this.drawHaloShape(t,e),this.drawIconShape(t,e),this.drawBadgeShapes(t,e),this.drawLabelShape(t,e),this.drawPortShapes(t,e))}update(t){super.update(t),t&&("x"in t||"y"in t||"z"in t)&&Bw(this)}onframe(){this.drawBadgeShapes(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this)}}Qr.defaultStyleProps={x:0,y:0,size:32,droppable:!0,draggable:!0,port:!0,ports:[],portZIndex:2,portLinkToCenter:!1,badge:!0,badges:[],badgeZIndex:3,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloStrokeOpacity:.25,haloPointerEvents:"none",haloZIndex:-1,icon:!0,iconZIndex:1,label:!0,labelIsBillboard:!0,labelMaxWidth:"200%",labelPlacement:"bottom",labelWordWrap:!1,labelZIndex:0};function tq(n,t){if(!n)return t.getLocalBounds();const e=n.canvas.getLayer(),r=t.cloneNode();Ds(r,"hidden"),e.appendChild(r);const i=r.getLocalBounds();return r.destroy(),i}let wc=class MR extends Qr{constructor(t){super(In({style:MR.defaultStyleProps},t))}drawKeyShape(t,e){return this.upsert("key",da,this.getKeyStyle(t),e)}getKeyStyle(t){const e=super.getKeyStyle(t);return Object.assign(Object.assign({},e),{r:Math.min(...this.getSize(t))/2})}getIconStyle(t){const e=super.getIconStyle(t),{r}=this.getShape("key").attributes,i=r*2*ca;return e?Object.assign({width:i,height:i},e):!1}getIntersectPoint(t,e=!1){const r=this.getShape("key").getBounds();return af(t,r,e)}};wc.defaultStyleProps={size:32};class of extends Qr{constructor(t){super(t)}get parsedAttributes(){return this.attributes}drawKeyShape(t,e){return this.upsert("key",Gs,this.getKeyStyle(t),e)}getKeyStyle(t){const e=super.getKeyStyle(t);return Object.assign(Object.assign({},e),{points:this.getPoints(t)})}getIntersectPoint(t,e=!1){var r,i;const{points:a}=this.getShape("key").attributes,s=[+(((r=this.attributes)===null||r===void 0?void 0:r.x)||0),+(((i=this.attributes)===null||i===void 0?void 0:i.y)||0)];return pR(t,s,a,!0,e).point}}class eq extends of{constructor(t){super(t)}getPoints(t){const[e,r]=this.getSize(t);return B$(e,r)}}var nq=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};class lf extends wc{constructor(t){super(In({style:lf.defaultStyleProps},t))}parseOuterR(){const{size:t}=this.parsedAttributes;return Math.min(...jr(t))/2}parseInnerR(){const{innerR:t}=this.parsedAttributes;return me(t)?parseInt(t)/100*this.parseOuterR():t}drawDonutShape(t,e){const{donuts:r}=t;if(!(r!=null&&r.length))return;const i=r.map(h=>Lt(h)?{value:h}:h),a=yn(this.getGraphicStyle(t),"donut"),s=bR(t.donutPalette);if(!s)return;const o=i.reduce((h,f)=>{var d;return h+((d=f.value)!==null&&d!==void 0?d:0)},0),l=this.parseOuterR(),c=this.parseInnerR();let u=0;i.forEach((h,f)=>{const{value:d=0,color:g=s[f%s.length]}=h,v=nq(h,["value","color"]),p=(o===0?1/i.length:d/o)*360;this.upsert(`round${f}`,Fr,Object.assign(Object.assign(Object.assign({},a),{d:aq(l,c,u,u+p),fill:g}),v),e),u+=p})}render(t,e=this){super.render(t,e),this.drawDonutShape(t,e)}}lf.defaultStyleProps={innerR:"50%",donuts:[],donutPalette:"tableau"};const mu=(n,t,e,r)=>[n+Math.sin(r)*e,t-Math.cos(r)*e],rq=(n,t,e,r)=>r<=0||e<=r?[["M",n-e,t],["A",e,e,0,1,1,n+e,t],["A",e,e,0,1,1,n-e,t],["Z"]]:[["M",n-e,t],["A",e,e,0,1,1,n+e,t],["A",e,e,0,1,1,n-e,t],["Z"],["M",n+r,t],["A",r,r,0,1,0,n-r,t],["A",r,r,0,1,0,n+r,t],["Z"]],iq=(n,t,e,r,i,a)=>{const[s,o]=[i/360*2*Math.PI,a/360*2*Math.PI],l=[mu(n,t,r,s),mu(n,t,e,s),mu(n,t,e,o),mu(n,t,r,o)],c=o-s>Math.PI?1:0;return[["M",l[0][0],l[0][1]],["L",l[1][0],l[1][1]],["A",e,e,0,c,1,l[2][0],l[2][1]],["L",l[3][0],l[3][1]],["A",r,r,0,c,0,l[0][0],l[0][1]],["Z"]]},aq=(n=0,t=0,e,r)=>{const[i,a]=[0,0];return Math.abs(e-r)%360<1e-6?rq(i,a,n,t):iq(i,a,n,t,e,r)};class cf extends Qr{constructor(t){super(In({style:cf.defaultStyleProps},t))}drawKeyShape(t,e){return this.upsert("key",dc,this.getKeyStyle(t),e)}getKeyStyle(t){const e=super.getKeyStyle(t),[r,i]=this.getSize(t);return Object.assign(Object.assign({},e),{rx:r/2,ry:i/2})}getIconStyle(t){const e=super.getIconStyle(t),{rx:r,ry:i}=this.getShape("key").attributes,a=Math.min(+r,+i)*2*ca;return e?Object.assign({width:a,height:a},e):!1}getIntersectPoint(t,e=!1){const r=this.getShape("key").getBounds();return af(t,r,e)}}cf.defaultStyleProps={size:[45,35]};class sq extends of{constructor(t){super(t)}getOuterR(t){return t.outerR||Math.min(...this.getSize(t))/2}getPoints(t){return q$(this.getOuterR(t))}getIconStyle(t){const e=super.getIconStyle(t),r=this.getOuterR(t)*ca;return e?Object.assign({width:r,height:r},e):!1}}/*!
 * @antv/g-plugin-canvas-path-generator
 * @description A G plugin of path generator with Canvas2D API
 * @version 2.1.16
 * @date 1/23/2025, 8:32:57 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */function oq(n,t){var e=t.cx,r=e===void 0?0:e,i=t.cy,a=i===void 0?0:i,s=t.r;n.arc(r,a,s,0,Math.PI*2,!1)}function lq(n,t){var e=t.cx,r=e===void 0?0:e,i=t.cy,a=i===void 0?0:i,s=t.rx,o=t.ry;if(n.ellipse)n.ellipse(r,a,s,o,0,0,Math.PI*2,!1);else{var l=s>o?s:o,c=s>o?1:s/o,u=s>o?o/s:1;n.save(),n.scale(c,u),n.arc(r,a,l,0,Math.PI*2)}}function cq(n,t){var e=t.x1,r=t.y1,i=t.x2,a=t.y2,s=t.markerStart,o=t.markerEnd,l=t.markerStartOffset,c=t.markerEndOffset,u=0,h=0,f=0,d=0,g=0,v,p;s&&ye(s)&&l&&(v=i-e,p=a-r,g=Math.atan2(p,v),u=Math.cos(g)*(l||0),h=Math.sin(g)*(l||0)),o&&ye(o)&&c&&(v=e-i,p=r-a,g=Math.atan2(p,v),f=Math.cos(g)*(c||0),d=Math.sin(g)*(c||0)),n.moveTo(e+u,r+h),n.lineTo(i+f,a+d)}function uq(n,t){var e=t.markerStart,r=t.markerEnd,i=t.markerStartOffset,a=t.markerEndOffset,s=t.d,o=s.absolutePath,l=s.segments,c=0,u=0,h=0,f=0,d=0,g,v;if(e&&ye(e)&&i){var p=e.parentNode.getStartTangent(),y=ne(p,2),m=y[0],w=y[1];g=m[0]-w[0],v=m[1]-w[1],d=Math.atan2(v,g),c=Math.cos(d)*(i||0),u=Math.sin(d)*(i||0)}if(r&&ye(r)&&a){var E=r.parentNode.getEndTangent(),S=ne(E,2),O=S[0],k=S[1];g=O[0]-k[0],v=O[1]-k[1],d=Math.atan2(v,g),h=Math.cos(d)*(a||0),f=Math.sin(d)*(a||0)}for(var T=0;T<o.length;T++){var C=o[T],P=C[0],N=o[T+1],L=T===0&&(c!==0||u!==0),D=(T===o.length-1||N&&(N[0]==="M"||N[0]==="Z"))&&h!==0&&f!==0,G=L?[c,u]:[0,0],H=ne(G,2),W=H[0],q=H[1],z=D?[h,f]:[0,0],Z=ne(z,2),at=Z[0],ft=Z[1];switch(P){case"M":n.moveTo(C[1]+W,C[2]+q);break;case"L":n.lineTo(C[1]+at,C[2]+ft);break;case"Q":n.quadraticCurveTo(C[1],C[2],C[3]+at,C[4]+ft);break;case"C":n.bezierCurveTo(C[1],C[2],C[3],C[4],C[5]+at,C[6]+ft);break;case"A":{var ct=l[T].arcParams,Gt=ct.cx,J=ct.cy,V=ct.rx,nt=ct.ry,dt=ct.startAngle,Nt=ct.endAngle,Wt=ct.xRotation,Kt=ct.sweepFlag;if(n.ellipse)n.ellipse(Gt,J,V,nt,Wt,dt,Nt,!!(1-Kt));else{var qe=V>nt?V:nt,U=V>nt?1:V/nt,X=V>nt?nt/V:1;n.translate(Gt,J),n.rotate(Wt),n.scale(U,X),n.arc(0,0,qe,dt,Nt,!!(1-Kt)),n.scale(1/U,1/X),n.rotate(-Wt),n.translate(-Gt,-J)}D&&n.lineTo(C[6]+h,C[7]+f);break}case"Z":n.closePath();break}}}function hq(n,t){var e=t.markerStart,r=t.markerEnd,i=t.markerStartOffset,a=t.markerEndOffset,s=t.points.points,o=s.length,l=s[0][0],c=s[0][1],u=s[o-1][0],h=s[o-1][1],f=0,d=0,g=0,v=0,p=0,y,m;e&&ye(e)&&i&&(y=s[1][0]-s[0][0],m=s[1][1]-s[0][1],p=Math.atan2(m,y),f=Math.cos(p)*(i||0),d=Math.sin(p)*(i||0)),r&&ye(r)&&a&&(y=s[o-1][0]-s[0][0],m=s[o-1][1]-s[0][1],p=Math.atan2(m,y),g=Math.cos(p)*(a||0),v=Math.sin(p)*(a||0)),n.moveTo(l+(f||g),c+(d||v));for(var w=1;w<o-1;w++){var E=s[w];n.lineTo(E[0],E[1])}n.lineTo(u,h)}function fq(n,t){var e=t.markerStart,r=t.markerEnd,i=t.markerStartOffset,a=t.markerEndOffset,s=t.points.points,o=s.length,l=s[0][0],c=s[0][1],u=s[o-1][0],h=s[o-1][1],f=0,d=0,g=0,v=0,p=0,y,m;e&&ye(e)&&i&&(y=s[1][0]-s[0][0],m=s[1][1]-s[0][1],p=Math.atan2(m,y),f=Math.cos(p)*(i||0),d=Math.sin(p)*(i||0)),r&&ye(r)&&a&&(y=s[o-2][0]-s[o-1][0],m=s[o-2][1]-s[o-1][1],p=Math.atan2(m,y),g=Math.cos(p)*(a||0),v=Math.sin(p)*(a||0)),n.moveTo(l+f,c+d);for(var w=1;w<o-1;w++){var E=s[w];n.lineTo(E[0],E[1])}n.lineTo(u+g,h+v)}function dq(n,t){var e=t.x,r=e===void 0?0:e,i=t.y,a=i===void 0?0:i,s=t.radius,o=t.width,l=t.height,c=o,u=l,h=s&&s.some(function(S){return S!==0});if(!h)n.rect(r,a,c,u);else{var f=o>0?1:-1,d=l>0?1:-1,g=f+d===0,v=s.map(function(S){return tn(S,0,Math.min(Math.abs(c)/2,Math.abs(u)/2))}),p=ne(v,4),y=p[0],m=p[1],w=p[2],E=p[3];n.moveTo(f*y+r,a),n.lineTo(c-f*m+r,a),m!==0&&n.arc(c-f*m+r,d*m+a,m,-d*Math.PI/2,f>0?0:Math.PI,g),n.lineTo(c+r,u-d*w+a),w!==0&&n.arc(c-f*w+r,u-d*w+a,w,f>0?0:Math.PI,d>0?Math.PI/2:1.5*Math.PI,g),n.lineTo(f*E+r,u+a),E!==0&&n.arc(f*E+r,u-d*E+a,E,d>0?Math.PI/2:-Math.PI/2,f>0?Math.PI:0,g),n.lineTo(r,d*y+a),y!==0&&n.arc(f*y+r,d*y+a,y,f>0?Math.PI:0,d>0?Math.PI*1.5:Math.PI/2,g)}}var gq=function(n){function t(){var e;yt(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=ae(this,t,[].concat(i)),e.name="canvas-path-generator",e}return se(t,n),mt(t,[{key:"init",value:function(){var r,i=(r={},It(It(It(It(It(It(It(It(It(It(r,ot.CIRCLE,oq),ot.ELLIPSE,lq),ot.RECT,dq),ot.LINE,cq),ot.POLYLINE,fq),ot.POLYGON,hq),ot.PATH,uq),ot.TEXT,void 0),ot.GROUP,void 0),ot.IMAGE,void 0),It(It(It(r,ot.HTML,void 0),ot.MESH,void 0),ot.FRAGMENT,void 0));this.context.pathGeneratorFactory=i}},{key:"destroy",value:function(){delete this.context.pathGeneratorFactory}}])}(Ja);/*!
 * @antv/g-plugin-canvas-picker
 * @description A G plugin for picking in canvas
 * @version 2.1.19
 * @date 2/27/2025, 8:28:58 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var pq=ge(),vq=ge(),yq=ge(),mq=Ne(),OR=function(){function n(){var t=this;yt(this,n),this.isHit=function(e,r,i,a){var s=t.context.pointInPathPickerFactory[e.nodeName];if(s){var o=Ai(mq,i),l=Jn(vq,Kn(yq,r[0],r[1],0),o);if(s(e,new zn(l[0],l[1]),a,t.isPointInPath,t.context,t.runtime))return!0}return!1},this.isPointInPath=function(e,r){var i=t.runtime.offscreenCanvasCreator.getOrCreateContext(t.context.config.offscreenCanvas),a=t.context.pathGeneratorFactory[e.nodeName];return a&&(i.beginPath(),a(i,e.parsedStyle),i.closePath()),i.isPointInPath(r.x,r.y)}}return mt(n,[{key:"apply",value:function(e,r){var i,a=this,s=e.renderingService,o=e.renderingContext;this.context=e,this.runtime=r;var l=(i=o.root)===null||i===void 0?void 0:i.ownerDocument;s.hooks.pick.tapPromise(n.tag,function(){var c=Ha(qn().mark(function u(h){return qn().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",a.pick(l,h));case 1:case"end":return d.stop()}},u)}));return function(u){return c.apply(this,arguments)}}()),s.hooks.pickSync.tap(n.tag,function(c){return a.pick(l,c)})}},{key:"pick",value:function(e,r){var i=r.topmost,a=r.position,s=a.x,o=a.y,l=Kn(pq,s,o,0),c=e.elementsFromBBox(l[0],l[1],l[0],l[1]),u=[],h=ys(c),f;try{for(h.s();!(f=h.n()).done;){var d=f.value,g=d.getWorldTransform(),v=this.isHit(d,l,g,!1);if(v){var p=kN(d);if(p){var y=p.parsedStyle.clipPath,m=this.isHit(y,l,y.getWorldTransform(),!0);if(m){if(i)return r.picked=[d],r;u.push(d)}}else{if(i)return r.picked=[d],r;u.push(d)}}}}catch(w){h.e(w)}finally{h.f()}return r.picked=u,r}}])}();OR.tag="CanvasPicker";function bq(n,t,e){var r=n.parsedStyle,i=r.cx,a=i===void 0?0:i,s=r.cy,o=s===void 0?0:s,l=r.r,c=r.fill,u=r.stroke,h=r.lineWidth,f=h===void 0?1:h,d=r.increasedLineWidthForHitTesting,g=d===void 0?0:d,v=r.pointerEvents,p=v===void 0?"auto":v,y=(f+g)/2,m=aa(a,o,t.x,t.y),w=$s(p,c,u),E=ne(w,2),S=E[0],O=E[1];return S&&O||e?m<=l+y:S?m<=l:O?m>=l-y&&m<=l+y:!1}function bu(n,t,e,r){return n/(e*e)+t/(r*r)}function wq(n,t,e){var r=n.parsedStyle,i=r.cx,a=i===void 0?0:i,s=r.cy,o=s===void 0?0:s,l=r.rx,c=r.ry,u=r.fill,h=r.stroke,f=r.lineWidth,d=f===void 0?1:f,g=r.increasedLineWidthForHitTesting,v=g===void 0?0:g,p=r.pointerEvents,y=p===void 0?"auto":p,m=t.x,w=t.y,E=$s(y,u,h),S=ne(E,2),O=S[0],k=S[1],T=(d+v)/2,C=(m-a)*(m-a),P=(w-o)*(w-o);return O&&k||e?bu(C,P,l+T,c+T)<=1:O?bu(C,P,l,c)<=1:k?bu(C,P,l-T,c-T)>=1&&bu(C,P,l+T,c+T)<=1:!1}function xs(n,t,e,r,i,a){return i>=n&&i<=n+e&&a>=t&&a<=t+r}function xq(n,t,e,r,i,a,s){var o=i/2;return xs(n-o,t-o,e,i,a,s)||xs(n+e-o,t-o,i,r,a,s)||xs(n+o,t+r-o,e,i,a,s)||xs(n-o,t+o,i,r,a,s)}function wu(n,t,e,r,i,a,s,o){var l=(Math.atan2(o-t,s-n)+Math.PI*2)%(Math.PI*2),c={x:n+e*Math.cos(l),y:t+e*Math.sin(l)};return aa(c.x,c.y,s,o)<=a/2}function Ra(n,t,e,r,i,a,s){var o=Math.min(n,e),l=Math.max(n,e),c=Math.min(t,r),u=Math.max(t,r),h=i/2;return a>=o-h&&a<=l+h&&s>=c-h&&s<=u+h?f4(n,t,e,r,a,s)<=i/2:!1}function TR(n,t,e,r,i){var a=n.length;if(a<2)return!1;for(var s=0;s<a-1;s++){var o=n[s][0],l=n[s][1],c=n[s+1][0],u=n[s+1][1];if(Ra(o,l,c,u,t,e,r))return!0}if(i){var h=n[0],f=n[a-1];if(Ra(h[0],h[1],f[0],f[1],t,e,r))return!0}return!1}var Eq=1e-6;function gg(n){return Math.abs(n)<Eq?0:n<0?-1:1}function Sq(n,t,e){return(e[0]-n[0])*(t[1]-n[1])===(t[0]-n[0])*(e[1]-n[1])&&Math.min(n[0],t[0])<=e[0]&&e[0]<=Math.max(n[0],t[0])&&Math.min(n[1],t[1])<=e[1]&&e[1]<=Math.max(n[1],t[1])}function kR(n,t,e){var r=!1,i=n.length;if(i<=2)return!1;for(var a=0;a<i;a++){var s=n[a],o=n[(a+1)%i];if(Sq(s,o,[t,e]))return!0;gg(s[1]-e)>0!=gg(o[1]-e)>0&&gg(t-(e-s[1])*(s[0]-o[0])/(s[1]-o[1])-s[0])<0&&(r=!r)}return r}function w2(n,t,e){for(var r=!1,i=0;i<n.length;i++){var a=n[i];if(r=kR(a,t,e),r)break}return r}function _q(n,t,e){var r=n.parsedStyle,i=r.x1,a=r.y1,s=r.x2,o=r.y2,l=r.lineWidth,c=l===void 0?1:l,u=r.increasedLineWidthForHitTesting,h=u===void 0?0:u,f=r.pointerEvents,d=f===void 0?"auto":f,g=r.fill,v=r.stroke,p=$s(d,g,v),y=ne(p,2),m=y[1];return!m&&!e||!c?!1:Ra(i,a,s,o,c+h,t.x,t.y)}function Mq(n,t,e,r,i){for(var a=!1,s=t/2,o=0;o<n.length;o++){var l=n[o],c=l.currentPoint,u=l.params,h=l.prePoint,f=l.box;if(!(f&&!xs(f.x-s,f.y-s,f.width+t,f.height+t,e,r)))switch(l.command){case"L":case"Z":if(a=Ra(h[0],h[1],c[0],c[1],t,e,r),a)return!0;break;case"Q":var d=b4(h[0],h[1],u[1],u[2],u[3],u[4],e,r);if(a=d<=t/2,a)return!0;break;case"C":var g=EE(h[0],h[1],u[1],u[2],u[3],u[4],u[5],u[6],e,r,i);if(a=g<=t/2,a)return!0;break;case"A":l.cubicParams||(l.cubicParams=pw(h[0],h[1],u[1],u[2],u[3],u[4],u[5],u[6],u[7],void 0));for(var v=l.cubicParams,p=h,y=0;y<v.length;y+=6){var m=EE(p[0],p[1],v[y],v[y+1],v[y+2],v[y+3],v[y+4],v[y+5],e,r,i);if(p=[v[y+4],v[y+5]],a=m<=t/2,a)return!0}break}}return a}function Oq(n,t,e,r,i,a){var s=n.parsedStyle,o=s.lineWidth,l=o===void 0?1:o,c=s.increasedLineWidthForHitTesting,u=c===void 0?0:c,h=s.stroke,f=s.fill,d=s.d,g=s.pointerEvents,v=g===void 0?"auto":g,p=d.segments,y=d.hasArc,m=d.polylines,w=d.polygons,E=$s(v,(w==null?void 0:w.length)&&f,h),S=ne(E,2),O=S[0],k=S[1],T=rb(n),C=!1;return O||e?(y?C=r(n,t):C=w2(w,t.x,t.y)||w2(m,t.x,t.y),C):((k||e)&&(C=Mq(p,l+u,t.x,t.y,T)),C)}function Tq(n,t,e){var r=n.parsedStyle,i=r.stroke,a=r.fill,s=r.lineWidth,o=s===void 0?1:s,l=r.increasedLineWidthForHitTesting,c=l===void 0?0:l,u=r.points,h=r.pointerEvents,f=h===void 0?"auto":h,d=$s(f,a,i),g=ne(d,2),v=g[0],p=g[1],y=!1;return(p||e)&&(y=TR(u.points,o+c,t.x,t.y,!0)),!y&&(v||e)&&(y=kR(u.points,t.x,t.y)),y}function kq(n,t,e){var r=n.parsedStyle,i=r.lineWidth,a=i===void 0?1:i,s=r.increasedLineWidthForHitTesting,o=s===void 0?0:s,l=r.points,c=r.pointerEvents,u=c===void 0?"auto":c,h=r.fill,f=r.stroke,d=$s(u,h,f),g=ne(d,2),v=g[1];return!v&&!e||!a?!1:TR(l.points,a+o,t.x,t.y,!1)}function Aq(n,t,e,r,i){var a=n.parsedStyle,s=a.radius,o=a.fill,l=a.stroke,c=a.lineWidth,u=c===void 0?1:c,h=a.increasedLineWidthForHitTesting,f=h===void 0?0:h,d=a.x,g=d===void 0?0:d,v=a.y,p=v===void 0?0:v,y=a.width,m=a.height,w=a.pointerEvents,E=w===void 0?"auto":w,S=$s(E,o,l),O=ne(S,2),k=O[0],T=O[1],C=s&&s.some(function(D){return D!==0}),P=u+f;if(C){var L=!1;return(T||e)&&(L=Cq(g,p,y,m,s.map(function(D){return tn(D,0,Math.min(Math.abs(y)/2,Math.abs(m)/2))}),P,t.x,t.y)),!L&&(k||e)&&(L=r(n,t)),L}else{var N=P/2;if(k&&T||e)return xs(g-N,p-N,y+N,m+N,t.x,t.y);if(k)return xs(g,p,y,m,t.x,t.y);if(T)return xq(g,p,y,m,P,t.x,t.y)}return!1}function Cq(n,t,e,r,i,a,s,o){var l=ne(i,4),c=l[0],u=l[1],h=l[2],f=l[3];return Ra(n+c,t,n+e-u,t,a,s,o)||Ra(n+e,t+u,n+e,t+r-h,a,s,o)||Ra(n+e-h,t+r,n+f,t+r,a,s,o)||Ra(n,t+r-f,n,t+c,a,s,o)||wu(n+e-u,t+u,u,1.5*Math.PI,2*Math.PI,a,s,o)||wu(n+e-h,t+r-h,h,0,.5*Math.PI,a,s,o)||wu(n+f,t+r-f,f,.5*Math.PI,Math.PI,a,s,o)||wu(n+c,t+c,c,Math.PI,1.5*Math.PI,a,s,o)}function Pq(n,t,e,r,i,a){var s=n.parsedStyle,o=s.pointerEvents,l=o===void 0?"auto":o,c=s.x,u=c===void 0?0:c,h=s.y,f=h===void 0?0:h,d=s.width,g=s.height;if(l==="non-transparent-pixel"){var v=i.config.offscreenCanvas,p=a.offscreenCanvasCreator.getOrCreateCanvas(v),y=a.offscreenCanvasCreator.getOrCreateContext(v,{willReadFrequently:!0});p.width=d,p.height=g,i.defaultStyleRendererFactory[ot.IMAGE].render(y,ie(ie({},n.parsedStyle),{},{x:0,y:0}),n,void 0,void 0,void 0);var m=y.getImageData(t.x-u,t.y-f,1,1).data;return m.every(function(w){return w!==0})}return!0}function Nq(n,t,e,r){var i=n.getGeometryBounds();return t.x>=i.min[0]&&t.y>=i.min[1]&&t.x<=i.max[0]&&t.y<=i.max[1]}var Rq=function(n){function t(){var e;yt(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=ae(this,t,[].concat(i)),e.name="canvas-picker",e}return se(t,n),mt(t,[{key:"init",value:function(){var r,i=(r={},It(It(It(It(It(It(It(It(It(It(r,ot.CIRCLE,bq),ot.ELLIPSE,wq),ot.RECT,Aq),ot.LINE,_q),ot.POLYLINE,kq),ot.POLYGON,Tq),ot.PATH,Oq),ot.TEXT,Nq),ot.GROUP,null),ot.IMAGE,Pq),It(It(r,ot.HTML,null),ot.MESH,null));this.context.pointInPathPickerFactory=i,this.addRenderingPlugin(new OR)}},{key:"destroy",value:function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins()}}])}(Ja);function Ei(n,t){if(!{}.hasOwnProperty.call(n,t))throw new TypeError("attempted to use private field on non-instance");return n}var Lq=0;function Iq(n){return"__private_"+Lq+++"_"+n}/*!
 * @antv/g-plugin-image-loader
 * @description A G plugin for loading image
 * @version 2.1.19
 * @date 2/27/2025, 8:27:22 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var Dq=function(){function n(){yt(this,n),this.cacheStore=new Map}return mt(n,[{key:"onRefAdded",value:function(e){}},{key:"has",value:function(e){return this.cacheStore.has(e)}},{key:"put",value:function(e,r,i){return this.cacheStore.has(e)?!1:(this.cacheStore.set(e,{value:r,counter:new Set([i])}),this.onRefAdded(i),!0)}},{key:"get",value:function(e,r){var i=this.cacheStore.get(e);return i?(i.counter.has(r)||(i.counter.add(r),this.onRefAdded(r)),i.value):null}},{key:"update",value:function(e,r,i){var a=this.cacheStore.get(e);return a?(a.value=ie(ie({},a.value),r),a.counter.has(i)||(a.counter.add(i),this.onRefAdded(i)),!0):!1}},{key:"release",value:function(e,r){var i=this.cacheStore.get(e);return i?(i.counter.delete(r),i.counter.size<=0&&this.cacheStore.delete(e),!0):!1}},{key:"releaseRef",value:function(e){var r=this;Array.from(this.cacheStore.keys()).forEach(function(i){r.release(i,e)})}},{key:"getSize",value:function(){return this.cacheStore.size}},{key:"clear",value:function(){this.cacheStore.clear()}}])}(),pg=[],vg=[],pb=function(){function n(){yt(this,n)}return mt(n,null,[{key:"stop",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:n.api;n.rafId&&(e.cancelAnimationFrame(n.rafId),n.rafId=null)}},{key:"executeTask",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:n.api;pg.length<=0&&vg.length<=0||(vg.forEach(function(r){return r()}),vg=pg.splice(0,n.TASK_NUM_PER_FRAME),n.rafId=e.requestAnimationFrame(function(){n.executeTask(e)}))}},{key:"sliceImage",value:function(e,r,i,a){for(var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:n.api,l=e.naturalWidth||e.width,c=e.naturalHeight||e.height,u=r-s,h=i-s,f=Math.ceil(l/u),d=Math.ceil(c/h),g={tileSize:[r,i],gridSize:[d,f],tiles:Array(d).fill(null).map(function(){return Array(f).fill(null)})},v=function(m){for(var w=function(O){pg.push(function(){var k=O*u,T=m*h,C=[Math.min(r,l-k),Math.min(i,c-T)],P=C[0],N=C[1],L=o.createCanvas();L.width=r,L.height=i;var D=L.getContext("2d");D.drawImage(e,k,T,P,N,0,0,P,N),g.tiles[m][O]={x:k,y:T,tileX:O,tileY:m,data:L},a()})},E=0;E<f;E++)w(E)},p=0;p<d;p++)v(p);return n.stop(),n.executeTask(),g}}])}();pb.TASK_NUM_PER_FRAME=10;var kr=new Dq;kr.onRefAdded=function(t){var e=this;t.addEventListener(ce.DESTROY,function(){e.releaseRef(t)},{once:!0})};var zw=function(){function n(t,e){yt(this,n),this.gradientCache={},this.patternCache={},this.context=t,this.runtime=e}return mt(n,[{key:"getImageSync",value:function(e,r,i){var a=me(e)?e:e.src;if(kr.has(a)){var s=kr.get(a,r);if(s.img.complete)return i==null||i(s),s}return this.getOrCreateImage(e,r).then(function(o){i==null||i(o)}).catch(function(o){console.error(o)}),null}},{key:"getOrCreateImage",value:function(e,r){var i=this,a=me(e)?e:e.src;if(!me(e)&&!kr.has(a)){var s={img:e,size:[e.naturalWidth||e.width,e.naturalHeight||e.height],tileSize:xu(e)};kr.put(a,s,r)}if(kr.has(a)){var o=kr.get(a,r);return o.img.complete?Promise.resolve(o):new Promise(function(l,c){o.img.addEventListener("load",function(){o.size=[o.img.naturalWidth||o.img.width,o.img.naturalHeight||o.img.height],o.tileSize=xu(o.img),l(o)}),o.img.addEventListener("error",function(u){c(u)})})}return new Promise(function(l,c){var u=i.context.config.createImage();if(u){var h={img:u,size:[0,0],tileSize:xu(u)};kr.put(a,h,r),u.onload=function(){h.size=[u.naturalWidth||u.width,u.naturalHeight||u.height],h.tileSize=xu(h.img),l(h)},u.onerror=function(f){c(f)},u.crossOrigin="Anonymous",u.src=a}})}},{key:"createDownSampledImage",value:function(){var t=Ha(qn().mark(function r(i,a){var s,o,l,c,u,h,f,d,g,v,p,y,m,w;return qn().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,this.getOrCreateImage(i,a);case 2:if(s=S.sent,!(typeof s.downSamplingRate<"u")){S.next=5;break}return S.abrupt("return",s);case 5:if(o=this.context.config.enableLargeImageOptimization,l=typeof o=="boolean"?{}:o,c=l.maxDownSampledImageSize,u=c===void 0?2048:c,h=l.downSamplingRateThreshold,f=h===void 0?.5:h,d=this.runtime.globalThis.createImageBitmap,g=ne(s.size,2),v=g[0],p=g[1],y=s.img,m=Math.min((u+u)/(v+p),Math.max(.01,Math.min(f,.5))),w=ie(ie({},s),{},{downSamplingRate:m}),kr.update(s.img.src,w,a),!d){S.next=25;break}return S.prev=14,S.next=17,d(s.img,{resizeWidth:v*m,resizeHeight:p*m});case 17:y=S.sent,S.next=23;break;case 20:S.prev=20,S.t0=S.catch(14),m=1;case 23:S.next=26;break;case 25:m=1;case 26:return w=ie(ie({},this.getImageSync(i,a)),{},{downSampled:y,downSamplingRate:m}),kr.update(s.img.src,w,a),S.abrupt("return",w);case 29:case"end":return S.stop()}},r,this,[[14,20]])}));function e(r,i){return t.apply(this,arguments)}return e}()},{key:"createImageTiles",value:function(){var t=Ha(qn().mark(function r(i,a,s,o){var l,c,u,h,f;return qn().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.getOrCreateImage(i,o);case 2:return l=g.sent,c=o.ownerDocument.defaultView,u=c.requestAnimationFrame,h=c.cancelAnimationFrame,pb.api={requestAnimationFrame:u,cancelAnimationFrame:h,createCanvas:function(){return Sw.createCanvas()}},f=ie(ie({},l),pb.sliceImage(l.img,l.tileSize[0],l.tileSize[0],s)),kr.update(l.img.src,f,o),g.abrupt("return",f);case 8:case"end":return g.stop()}},r,this)}));function e(r,i,a,s){return t.apply(this,arguments)}return e}()},{key:"releaseImage",value:function(e,r){kr.release(me(e)?e:e.src,r)}},{key:"releaseImageRef",value:function(e){kr.releaseRef(e)}},{key:"getOrCreatePatternSync",value:function(e,r,i,a,s,o,l){var c=this.generatePatternKey(r);if(c&&this.patternCache[c])return this.patternCache[c];var u=r.image,h=r.repetition,f=r.transform,d,g=!1;if(me(u)){var v=this.getImageSync(u,e,l);d=v==null?void 0:v.img}else a?(d=a,g=!0):d=u;var p=d&&i.createPattern(d,h);if(p){var y;f?y=RN(_N(f),new je({})):y=Wa(Ne()),g&&kP(y,y,[1/s,1/s,1]),p.setTransform({a:y[0],b:y[1],c:y[4],d:y[5],e:y[12]+o[0],f:y[13]+o[1]})}return c&&p&&(this.patternCache[c]=p),p}},{key:"getOrCreateGradient",value:function(e,r){var i=this.generateGradientKey(e),a=e.type,s=e.steps,o=e.min,l=e.width,c=e.height,u=e.angle,h=e.cx,f=e.cy,d=e.size;if(this.gradientCache[i])return this.gradientCache[i];var g=null;if(a===Ca.LinearGradient){var v=g5(o,l,c,u),p=v.x1,y=v.y1,m=v.x2,w=v.y2;g=r.createLinearGradient(p,y,m,w)}else if(a===Ca.RadialGradient){var E=p5(o,l,c,h,f,d),S=E.x,O=E.y,k=E.r;g=r.createRadialGradient(S,O,0,S,O,k)}return g&&(s.forEach(function(T){var C=T.offset,P=T.color;if(C.unit===Ct.kPercentage){var N;(N=g)===null||N===void 0||N.addColorStop(C.value/100,P.toString())}}),this.gradientCache[i]=g),this.gradientCache[i]}},{key:"generateGradientKey",value:function(e){var r=e.type,i=e.min,a=e.width,s=e.height,o=e.steps,l=e.angle,c=e.cx,u=e.cy,h=e.size;return"gradient-".concat(r,"-").concat((l==null?void 0:l.toString())||0,"-").concat((c==null?void 0:c.toString())||0,"-").concat((u==null?void 0:u.toString())||0,"-").concat((h==null?void 0:h.toString())||0,"-").concat(i[0],"-").concat(i[1],"-").concat(a,"-").concat(s,"-").concat(o.map(function(f){var d=f.offset,g=f.color;return"".concat(d).concat(g)}).join("-"))}},{key:"generatePatternKey",value:function(e){var r=e.image,i=e.repetition;if(me(r))return"pattern-".concat(r,"-").concat(i);if(r.nodeName==="rect")return"pattern-".concat(r.entity,"-").concat(i)}}])}();zw.isSupportTile=!!Sw.createCanvas();function xu(n){if(!n.complete)return[0,0];var t=n.naturalWidth||n.width,e=n.naturalHeight||n.height,r=256;return[256,512].forEach(function(i){var a=Math.ceil(e/i),s=Math.ceil(t/i);a*s<1e3&&(r=i)}),[r,r]}var AR=function(){function n(){yt(this,n)}return mt(n,[{key:"apply",value:function(e){var r=e.renderingService,i=e.renderingContext,a=e.imagePool,s=i.root.ownerDocument.defaultView,o=function(h,f,d){var g=h.parsedStyle,v=g.width,p=g.height;v&&!p?h.setAttribute("height",d/f*v):!v&&p&&h.setAttribute("width",f/d*p)},l=function(h){var f=h.target,d=f.nodeName,g=f.attributes;if(d===ot.IMAGE){var v=g.src,p=g.keepAspectRatio;a.getImageSync(v,f,function(y){var m=y.img,w=m.width,E=m.height;p&&o(f,w,E),f.renderable.dirty=!0,r.dirtify()})}},c=function(h){var f=h.target,d=h.attrName,g=h.prevValue,v=h.newValue;f.nodeName!==ot.IMAGE||d!=="src"||(g!==v&&a.releaseImage(g,f),me(v)&&a.getOrCreateImage(v,f).then(function(p){var y=p.img,m=y.width,w=y.height;f.attributes.keepAspectRatio&&o(f,m,w),f.renderable.dirty=!0,r.dirtify()}).catch(function(){}))};r.hooks.init.tap(n.tag,function(){s.addEventListener(ce.MOUNTED,l),s.addEventListener(ce.ATTR_MODIFIED,c)}),r.hooks.destroy.tap(n.tag,function(){s.removeEventListener(ce.MOUNTED,l),s.removeEventListener(ce.ATTR_MODIFIED,c)})}}])}();AR.tag="LoadImage";var Fq=function(n){function t(){var e;yt(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=ae(this,t,[].concat(i)),e.name="image-loader",e}return se(t,n),mt(t,[{key:"init",value:function(r){this.context.imagePool=new zw(this.context,r),this.addRenderingPlugin(new AR)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(Ja);/*!
 * @antv/g-plugin-canvas-renderer
 * @description A G plugin of renderer implementation with Canvas2D API
 * @version 2.2.19
 * @date 2/27/2025, 8:28:07 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var ln=Iq("renderState"),CR=function(){function n(t){yt(this,n),this.removedRBushNodeAABBs=[],this.renderQueue=[],Object.defineProperty(this,ln,{writable:!0,value:{restoreStack:[],prevObject:null,currentContext:new Map}}),this.clearFullScreenLastFrame=!1,this.clearFullScreen=!1,this.vpMatrix=Ne(),this.dprMatrix=Ne(),this.tmpMat4=Ne(),this.vec3a=ge(),this.vec3b=ge(),this.vec3c=ge(),this.vec3d=ge(),this.canvasRendererPluginOptions=t}return mt(n,[{key:"apply",value:function(e,r){var i=this;this.context=e;var a=this.context,s=a.config,o=a.camera,l=a.renderingService,c=a.renderingContext,u=a.rBushRoot,h=a.pathGeneratorFactory,f=s.renderer.getConfig().enableRenderingOptimization;s.renderer.getConfig().enableDirtyCheck=!1,s.renderer.getConfig().enableDirtyRectangleRendering=!1,this.rBush=u,this.pathGeneratorFactory=h;var d=e.contextService,g=c.root.ownerDocument.defaultView,v=function(w){var E=w.target,S=E.rBushNode;S.aabb&&i.removedRBushNodeAABBs.push(S.aabb)},p=function(w){var E=w.target,S=E.rBushNode;S.aabb&&i.removedRBushNodeAABBs.push(S.aabb)};l.hooks.init.tap(n.tag,function(){g.addEventListener(ce.UNMOUNTED,v),g.addEventListener(ce.CULLED,p);var m=d.getDPR(),w=s.width,E=s.height,S=d.getContext();i.clearRect(S,0,0,w*m,E*m,s.background)}),l.hooks.destroy.tap(n.tag,function(){g.removeEventListener(ce.UNMOUNTED,v),g.removeEventListener(ce.CULLED,p),i.renderQueue=[],i.removedRBushNodeAABBs=[],Ei(i,ln)[ln]={restoreStack:[],prevObject:null,currentContext:null}}),l.hooks.beginFrame.tap(n.tag,function(){var m,w=d.getContext(),E=d.getDPR(),S=s.width,O=s.height,k=i.canvasRendererPluginOptions,T=k.dirtyObjectNumThreshold,C=k.dirtyObjectRatioThreshold,P=l.getStats(),N=P.total,L=P.rendered,D=L/N;i.clearFullScreen=i.clearFullScreenLastFrame||!((m=g.context.renderingPlugins[1])!==null&&m!==void 0&&m.isFirstTimeRenderingFinished)||l.disableDirtyRectangleRendering()||L>T&&D>C,w&&(typeof w.resetTransform=="function"?w.resetTransform():w.setTransform(1,0,0,1,0,0),i.clearFullScreen&&i.clearRect(w,0,0,S*E,O*E,s.background))});var y=function(w,E){for(var S=[w];S.length>0;){var O=S.pop();O.isVisible()&&!O.isCulled()&&(f?i.renderDisplayObjectOptimized(O,E,i.context,Ei(i,ln)[ln],r):i.renderDisplayObject(O,E,i.context,Ei(i,ln)[ln],r));for(var k=O.sortable.sorted||O.childNodes,T=k.length-1;T>=0;T--)S.push(k[T])}};l.hooks.endFrame.tap(n.tag,function(){if(c.root.childNodes.length===0){i.clearFullScreenLastFrame=!0;return}f=s.renderer.getConfig().enableRenderingOptimization,Ei(i,ln)[ln]={restoreStack:[],prevObject:null,currentContext:Ei(i,ln)[ln].currentContext},Ei(i,ln)[ln].currentContext.clear(),i.clearFullScreenLastFrame=!1;var m=d.getContext(),w=d.getDPR();if(vs(i.dprMatrix,[w,w,1]),Zn(i.vpMatrix,i.dprMatrix,o.getOrthoMatrix()),i.clearFullScreen)f?(m.save(),y(c.root,m),m.restore()):y(c.root,m),i.removedRBushNodeAABBs=[];else{var E=i.safeMergeAABB.apply(i,[i.mergeDirtyAABBs(i.renderQueue)].concat(Ie(i.removedRBushNodeAABBs.map(function(V){var nt=V.minX,dt=V.minY,Nt=V.maxX,Wt=V.maxY,Kt=new Re;return Kt.setMinMax([nt,dt,0],[Nt,Wt,0]),Kt}))));if(i.removedRBushNodeAABBs=[],Re.isEmpty(E)){i.renderQueue=[];return}var S=i.convertAABB2Rect(E),O=S.x,k=S.y,T=S.width,C=S.height,P=Jn(i.vec3a,[O,k,0],i.vpMatrix),N=Jn(i.vec3b,[O+T,k,0],i.vpMatrix),L=Jn(i.vec3c,[O,k+C,0],i.vpMatrix),D=Jn(i.vec3d,[O+T,k+C,0],i.vpMatrix),G=Math.min(P[0],N[0],D[0],L[0]),H=Math.min(P[1],N[1],D[1],L[1]),W=Math.max(P[0],N[0],D[0],L[0]),q=Math.max(P[1],N[1],D[1],L[1]),z=Math.floor(G),Z=Math.floor(H),at=Math.ceil(W-G),ft=Math.ceil(q-H);m.save(),i.clearRect(m,z,Z,at,ft,s.background),m.beginPath(),m.rect(z,Z,at,ft),m.clip(),m.setTransform(i.vpMatrix[0],i.vpMatrix[1],i.vpMatrix[4],i.vpMatrix[5],i.vpMatrix[12],i.vpMatrix[13]);var ct=s.renderer.getConfig(),Gt=ct.enableDirtyRectangleRenderingDebug;Gt&&g.dispatchEvent(new pn(Lr.DIRTY_RECTANGLE,{dirtyRect:{x:z,y:Z,width:at,height:ft}}));var J=i.searchDirtyObjects(E);J.sort(function(V,nt){return V.sortable.renderOrder-nt.sortable.renderOrder}).forEach(function(V){V&&V.isVisible()&&!V.isCulled()&&i.renderDisplayObject(V,m,i.context,Ei(i,ln)[ln],r)}),m.restore(),i.renderQueue.forEach(function(V){i.saveDirtyAABB(V)}),i.renderQueue=[]}Ei(i,ln)[ln].restoreStack.forEach(function(){m.restore()}),Ei(i,ln)[ln].restoreStack=[]}),l.hooks.render.tap(n.tag,function(m){i.clearFullScreen||i.renderQueue.push(m)})}},{key:"clearRect",value:function(e,r,i,a,s,o){e.clearRect(r,i,a,s),o&&(e.fillStyle=o,e.fillRect(r,i,a,s))}},{key:"renderDisplayObjectOptimized",value:function(e,r,i,a,s){var o=e.nodeName,l=!1,c=!1,u=this.context.styleRendererFactory[o],h=this.pathGeneratorFactory[o],f=e.parsedStyle.clipPath;if(f){l=!a.prevObject||!z1(f.getWorldTransform(),a.prevObject.getWorldTransform()),l&&(this.applyWorldTransform(r,f),a.prevObject=null);var d=this.pathGeneratorFactory[f.nodeName];d&&(r.save(),c=!0,r.beginPath(),d(r,f.parsedStyle),r.closePath(),r.clip())}if(u){l=!a.prevObject||!z1(e.getWorldTransform(),a.prevObject.getWorldTransform()),l&&this.applyWorldTransform(r,e);var g=!a.prevObject;if(!g){var v=a.prevObject.nodeName;o===ot.TEXT?g=v!==ot.TEXT:o===ot.IMAGE?g=v!==ot.IMAGE:g=v===ot.TEXT||v===ot.IMAGE}u.applyStyleToContext(r,e,g,a),a.prevObject=e}h&&(r.beginPath(),h(r,e.parsedStyle),o!==ot.LINE&&o!==ot.PATH&&o!==ot.POLYLINE&&r.closePath()),u&&u.drawToContext(r,e,Ei(this,ln)[ln],this,s),c&&r.restore(),e.renderable.dirty=!1}},{key:"renderDisplayObject",value:function(e,r,i,a,s){var o=e.nodeName,l=a.restoreStack[a.restoreStack.length-1];l&&!(e.compareDocumentPosition(l)&Ke.DOCUMENT_POSITION_CONTAINS)&&(r.restore(),a.restoreStack.pop());var c=this.context.styleRendererFactory[o],u=this.pathGeneratorFactory[o],h=e.parsedStyle.clipPath;if(h){this.applyWorldTransform(r,h);var f=this.pathGeneratorFactory[h.nodeName];f&&(r.save(),a.restoreStack.push(e),r.beginPath(),f(r,h.parsedStyle),r.closePath(),r.clip())}c&&(this.applyWorldTransform(r,e),r.save(),this.applyAttributesToContext(r,e)),u&&(r.beginPath(),u(r,e.parsedStyle),o!==ot.LINE&&o!==ot.PATH&&o!==ot.POLYLINE&&r.closePath()),c&&(c.render(r,e.parsedStyle,e,i,this,s),r.restore()),e.renderable.dirty=!1}},{key:"applyAttributesToContext",value:function(e,r){var i=r.parsedStyle,a=i.stroke,s=i.fill,o=i.opacity,l=i.lineDash,c=i.lineDashOffset;l&&e.setLineDash(l),Ut(c)||(e.lineDashOffset=c),Ut(o)||(e.globalAlpha*=o),!Ut(a)&&!Array.isArray(a)&&!a.isNone&&(e.strokeStyle=r.attributes.stroke),!Ut(s)&&!Array.isArray(s)&&!s.isNone&&(e.fillStyle=r.attributes.fill)}},{key:"convertAABB2Rect",value:function(e){var r=e.getMin(),i=e.getMax(),a=Math.floor(r[0]),s=Math.floor(r[1]),o=Math.ceil(i[0]),l=Math.ceil(i[1]),c=o-a,u=l-s;return{x:a,y:s,width:c,height:u}}},{key:"mergeDirtyAABBs",value:function(e){var r=new Re;return e.forEach(function(i){var a=i.getRenderBounds();r.add(a);var s=i.renderable.dirtyRenderBounds;s&&r.add(s)}),r}},{key:"searchDirtyObjects",value:function(e){var r=e.getMin(),i=ne(r,2),a=i[0],s=i[1],o=e.getMax(),l=ne(o,2),c=l[0],u=l[1],h=this.rBush.search({minX:a,minY:s,maxX:c,maxY:u});return h.map(function(f){var d=f.displayObject;return d})}},{key:"saveDirtyAABB",value:function(e){var r=e.renderable;r.dirtyRenderBounds||(r.dirtyRenderBounds=new Re);var i=e.getRenderBounds();i&&r.dirtyRenderBounds.update(i.center,i.halfExtents)}},{key:"applyWorldTransform",value:function(e,r,i){i?(To(this.tmpMat4,r.getLocalTransform()),Zn(this.tmpMat4,i,this.tmpMat4),Zn(this.tmpMat4,this.vpMatrix,this.tmpMat4)):(To(this.tmpMat4,r.getWorldTransform()),Zn(this.tmpMat4,this.vpMatrix,this.tmpMat4)),e.setTransform(this.tmpMat4[0],this.tmpMat4[1],this.tmpMat4[4],this.tmpMat4[5],this.tmpMat4[12],this.tmpMat4[13])}},{key:"safeMergeAABB",value:function(){for(var e=new Re,r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return i.forEach(function(s){e.add(s)}),e}}])}();CR.tag="CanvasRenderer";function kh(n,t,e,r,i,a,s){var o,l;if(n.image.nodeName==="rect"){var c=n.image.parsedStyle,u=c.width,h=c.height;l=r.contextService.getDPR();var f=r.config.offscreenCanvas;o=a.offscreenCanvasCreator.getOrCreateCanvas(f),o.width=u*l,o.height=h*l;var d=a.offscreenCanvasCreator.getOrCreateContext(f),g={restoreStack:[],prevObject:null,currentContext:new Map};n.image.forEach(function(p){i.renderDisplayObject(p,d,r,g,a)}),g.restoreStack.forEach(function(){d.restore()})}var v=s.getOrCreatePatternSync(t,n,e,o,l,t.getGeometryBounds().min,function(){t.renderable.dirty=!0,r.renderingService.dirtify()});return v}function Ah(n,t,e,r){var i;if(n.type===Ca.LinearGradient||n.type===Ca.RadialGradient){var a=t.getGeometryBounds(),s=a&&a.halfExtents[0]*2||1,o=a&&a.halfExtents[1]*2||1,l=a&&a.min||[0,0];i=r.getOrCreateGradient(ie(ie({type:n.type},n.value),{},{min:l,width:s,height:o}),e)}return i}var Eu=["shadowBlur","shadowOffsetX","shadowOffsetY"],x2=["lineCap","lineJoin","miterLimit"],gn={globalAlpha:1,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",filter:"none",globalCompositeOperation:"source-over",strokeStyle:"#000",strokeOpacity:1,lineWidth:1,lineDash:[],lineDashOffset:0,lineCap:"butt",lineJoin:"miter",miterLimit:10,fillStyle:"#000",fillOpacity:1},E2={};function Je(n,t,e,r){var i=r.has(t)?r.get(t):gn[t];return i!==e&&(t==="lineDash"?n.setLineDash(e):n[t]=e,r.set(t,e)),i}var Bq=function(){function n(t){yt(this,n),this.imagePool=t}return mt(n,[{key:"applyAttributesToContext",value:function(e,r){}},{key:"render",value:function(e,r,i,a,s,o){}},{key:"applyCommonStyleToContext",value:function(e,r,i,a){var s=i?E2:a.prevObject.parsedStyle,o=r.parsedStyle;(i||o.opacity!==s.opacity)&&Je(e,"globalAlpha",Ut(o.opacity)?gn.globalAlpha:o.opacity,a.currentContext),(i||o.blend!==s.blend)&&Je(e,"globalCompositeOperation",Ut(o.blend)?gn.globalCompositeOperation:o.blend,a.currentContext)}},{key:"applyStrokeFillStyleToContext",value:function(e,r,i,a){var s=i?E2:a.prevObject.parsedStyle,o=r.parsedStyle,l=o.lineWidth,c=l===void 0?gn.lineWidth:l,u=o.fill&&!o.fill.isNone,h=o.stroke&&!o.stroke.isNone&&c>0;if(h){if(i||r.attributes.stroke!==a.prevObject.attributes.stroke){var f=!Ut(o.stroke)&&!Array.isArray(o.stroke)&&!o.stroke.isNone?r.attributes.stroke:gn.strokeStyle;Je(e,"strokeStyle",f,a.currentContext)}(i||o.lineWidth!==s.lineWidth)&&Je(e,"lineWidth",Ut(o.lineWidth)?gn.lineWidth:o.lineWidth,a.currentContext),(i||o.lineDash!==s.lineDash)&&Je(e,"lineDash",o.lineDash||gn.lineDash,a.currentContext),(i||o.lineDashOffset!==s.lineDashOffset)&&Je(e,"lineDashOffset",Ut(o.lineDashOffset)?gn.lineDashOffset:o.lineDashOffset,a.currentContext);for(var d=0;d<x2.length;d++){var g=x2[d];(i||o[g]!==s[g])&&Je(e,g,Ut(o[g])?gn[g]:o[g],a.currentContext)}}if(u&&(i||r.attributes.fill!==a.prevObject.attributes.fill)){var v=!Ut(o.fill)&&!Array.isArray(o.fill)&&!o.fill.isNone?r.attributes.fill:gn.fillStyle;Je(e,"fillStyle",v,a.currentContext)}}},{key:"applyStyleToContext",value:function(e,r,i,a){var s=r.nodeName;this.applyCommonStyleToContext(e,r,i,a),s===ot.IMAGE||this.applyStrokeFillStyleToContext(e,r,i,a)}},{key:"applyShadowAndFilterStyleToContext",value:function(e,r,i,a){var s=r.parsedStyle;if(i){Je(e,"shadowColor",s.shadowColor.toString(),a.currentContext);for(var o=0;o<Eu.length;o++){var l=Eu[o];Je(e,l,s[l]||gn[l],a.currentContext)}}s.filter&&s.filter.length&&Je(e,"filter",r.attributes.filter,a.currentContext)}},{key:"clearShadowAndFilterStyleForContext",value:function(e,r,i,a){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(r){Je(e,"shadowColor",gn.shadowColor,a.currentContext);for(var o=0;o<Eu.length;o++){var l=Eu[o];Je(e,l,gn[l],a.currentContext)}}if(i)if(r&&s){var c=e.filter;!Ut(c)&&c.indexOf("drop-shadow")>-1&&Je(e,"filter",c.replace(/drop-shadow\([^)]*\)/,"").trim()||gn.filter,a.currentContext)}else Je(e,"filter",gn.filter,a.currentContext)}},{key:"fillToContext",value:function(e,r,i,a,s){var o=this,l=r.parsedStyle,c=l.fill,u=l.fillRule,h=null;if(Array.isArray(c)&&c.length>0)c.forEach(function(d){var g=Je(e,"fillStyle",Ah(d,r,e,o.imagePool),i.currentContext);h=h??g,u?e.fill(u):e.fill()});else{if(Ls(c)){var f=kh(c,r,e,r.ownerDocument.defaultView.context,a,s,this.imagePool);f&&(e.fillStyle=f,h=!0)}u?e.fill(u):e.fill()}h!==null&&Je(e,"fillStyle",h,i.currentContext)}},{key:"strokeToContext",value:function(e,r,i,a,s){var o=this,l=r.parsedStyle.stroke,c=null;if(Array.isArray(l)&&l.length>0)l.forEach(function(f){var d=Je(e,"strokeStyle",Ah(f,r,e,o.imagePool),i.currentContext);c=c??d,e.stroke()});else{if(Ls(l)){var u=kh(l,r,e,r.ownerDocument.defaultView.context,a,s,this.imagePool);if(u){var h=Je(e,"strokeStyle",u,i.currentContext);c=c??h}}e.stroke()}c!==null&&Je(e,"strokeStyle",c,i.currentContext)}},{key:"drawToContext",value:function(e,r,i,a,s){var o,l=r.nodeName,c=r.parsedStyle,u=c.opacity,h=u===void 0?gn.globalAlpha:u,f=c.fillOpacity,d=f===void 0?gn.fillOpacity:f,g=c.strokeOpacity,v=g===void 0?gn.strokeOpacity:g,p=c.lineWidth,y=p===void 0?gn.lineWidth:p,m=c.fill&&!c.fill.isNone,w=c.stroke&&!c.stroke.isNone&&y>0;if(!(!m&&!w)){var E=!Ut(c.shadowColor)&&c.shadowBlur>0,S=c.shadowType==="inner",O=((o=c.fill)===null||o===void 0?void 0:o.alpha)===0,k=!!(c.filter&&c.filter.length),T=E&&w&&(l===ot.PATH||l===ot.LINE||l===ot.POLYLINE||O||S),C=null;if(m){T||this.applyShadowAndFilterStyleToContext(e,r,E,i);var P=h*d;C=Je(e,"globalAlpha",P,i.currentContext),this.fillToContext(e,r,i,a,s),T||this.clearShadowAndFilterStyleForContext(e,E,k,i)}if(w){var N=!1,L=h*v,D=Je(e,"globalAlpha",L,i.currentContext);if(C=m?C:D,T&&(this.applyShadowAndFilterStyleToContext(e,r,E,i),N=!0,S)){var G=e.globalCompositeOperation;e.globalCompositeOperation="source-atop",this.strokeToContext(e,r,i,a,s),e.globalCompositeOperation=G,this.clearShadowAndFilterStyleForContext(e,E,k,i,!0)}this.strokeToContext(e,r,i,a,s),N&&this.clearShadowAndFilterStyleForContext(e,E,k,i)}C!==null&&Je(e,"globalAlpha",C,i.currentContext)}}}])}(),jw=function(n){function t(){return yt(this,t),ae(this,t,arguments)}return se(t,n),mt(t,[{key:"render",value:function(r,i,a,s,o,l){var c=i.fill,u=i.fillRule,h=i.opacity,f=h===void 0?1:h,d=i.fillOpacity,g=d===void 0?1:d,v=i.stroke,p=i.strokeOpacity,y=p===void 0?1:p,m=i.lineWidth,w=m===void 0?1:m,E=i.lineCap,S=i.lineJoin,O=i.shadowType,k=i.shadowColor,T=i.shadowBlur,C=i.filter,P=i.miterLimit,N=c&&!c.isNone,L=v&&!v.isNone&&w>0,D=(c==null?void 0:c.alpha)===0,G=!!(C&&C.length),H=!Ut(k)&&T>0,W=a.nodeName,q=O==="inner",z=L&&H&&(W===ot.PATH||W===ot.LINE||W===ot.POLYLINE||D||q);N&&(r.globalAlpha=f*g,z||Ch(a,r,H),PR(r,a,c,u,s,o,l,this.imagePool),z||this.clearShadowAndFilter(r,G,H)),L&&(r.globalAlpha=f*y,r.lineWidth=w,Ut(P)||(r.miterLimit=P),Ut(E)||(r.lineCap=E),Ut(S)||(r.lineJoin=S),z&&(q&&(r.globalCompositeOperation="source-atop"),Ch(a,r,!0),q&&(vb(r,a,v,s,o,l,this.imagePool),r.globalCompositeOperation=gn.globalCompositeOperation,this.clearShadowAndFilter(r,G,!0))),vb(r,a,v,s,o,l,this.imagePool))}},{key:"clearShadowAndFilter",value:function(r,i,a){if(a&&(r.shadowColor="transparent",r.shadowBlur=0),i){var s=r.filter;!Ut(s)&&s.indexOf("drop-shadow")>-1&&(r.filter=s.replace(/drop-shadow\([^)]*\)/,"").trim()||"none")}}}])}(Bq);function Ch(n,t,e){var r=n.parsedStyle,i=r.filter,a=r.shadowColor,s=r.shadowBlur,o=r.shadowOffsetX,l=r.shadowOffsetY;i&&i.length&&(t.filter=n.style.filter),e&&(t.shadowColor=a.toString(),t.shadowBlur=s||0,t.shadowOffsetX=o||0,t.shadowOffsetY=l||0)}function PR(n,t,e,r,i,a,s,o){var l=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1;Array.isArray(e)?e.forEach(function(c){n.fillStyle=Ah(c,t,n,o),l||(r?n.fill(r):n.fill())}):(Ls(e)&&(n.fillStyle=kh(e,t,n,i,a,s,o)),l||(r?n.fill(r):n.fill()))}function vb(n,t,e,r,i,a,s){var o=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1;Array.isArray(e)?e.forEach(function(l){n.strokeStyle=Ah(l,t,n,s),o||n.stroke()}):(Ls(e)&&(n.strokeStyle=kh(e,t,n,r,i,a,s)),o||n.stroke())}function zq(n,t){var e=ne(n,4),r=e[0],i=e[1],a=e[2],s=e[3],o=ne(t,4),l=o[0],c=o[1],u=o[2],h=o[3],f=Math.max(r,l),d=Math.max(i,c),g=Math.min(r+a,l+u),v=Math.min(i+s,c+h);return g<=f||v<=d?null:[f,d,g-f,v-d]}function jq(n,t){var e=Jn(ge(),[n[0],n[1],0],t),r=Jn(ge(),[n[0]+n[2],n[1],0],t),i=Jn(ge(),[n[0],n[1]+n[3],0],t),a=Jn(ge(),[n[0]+n[2],n[1]+n[3],0],t);return[Math.min(e[0],r[0],i[0],a[0]),Math.min(e[1],r[1],i[1],a[1]),Math.max(e[0],r[0],i[0],a[0])-Math.min(e[0],r[0],i[0],a[0]),Math.max(e[1],r[1],i[1],a[1])-Math.min(e[1],r[1],i[1],a[1])]}var qq=function(n){function t(){return yt(this,t),ae(this,t,arguments)}return se(t,n),mt(t,[{key:"renderDownSampled",value:function(r,i,a,s){var o=s.src,l=s.imageCache;if(!l.downSampled){this.imagePool.createDownSampledImage(o,a).then(function(){a.ownerDocument&&(a.renderable.dirty=!0,a.ownerDocument.defaultView.context.renderingService.dirtify())}).catch(function(c){console.error(c)});return}r.drawImage(l.downSampled,Math.floor(s.drawRect[0]),Math.floor(s.drawRect[1]),Math.ceil(s.drawRect[2]),Math.ceil(s.drawRect[3]))}},{key:"renderTile",value:function(r,i,a,s){var o=s.src,l=s.imageCache,c=s.imageRect,u=s.drawRect,h=l.size,f=r.getTransform(),d=f.a,g=f.b,v=f.c,p=f.d,y=f.e,m=f.f;if(r.resetTransform(),!(l!=null&&l.gridSize)){this.imagePool.createImageTiles(o,[],function(){a.ownerDocument&&(a.renderable.dirty=!0,a.ownerDocument.defaultView.context.renderingService.dirtify())},a).catch(function(H){console.error(H)});return}for(var w=[h[0]/c[2],h[1]/c[3]],E=[l.tileSize[0]/w[0],l.tileSize[1]/w[1]],S=[Math.floor((u[0]-c[0])/E[0]),Math.ceil((u[0]+u[2]-c[0])/E[0])],O=S[0],k=S[1],T=[Math.floor((u[1]-c[1])/E[1]),Math.ceil((u[1]+u[3]-c[1])/E[1])],C=T[0],P=T[1],N=C;N<=P;N++)for(var L=O;L<=k;L++){var D=l.tiles[N][L];if(D){var G=[Math.floor(c[0]+D.tileX*E[0]),Math.floor(c[1]+D.tileY*E[1]),Math.ceil(E[0]),Math.ceil(E[1])];r.drawImage(D.data,G[0],G[1],G[2],G[3])}}r.setTransform(d,g,v,p,y,m)}},{key:"render",value:function(r,i,a){var s=i.x,o=s===void 0?0:s,l=i.y,c=l===void 0?0:l,u=i.width,h=i.height,f=i.src,d=i.shadowColor,g=i.shadowBlur,v=this.imagePool.getImageSync(f,a),p=v==null?void 0:v.img,y=u,m=h;if(p){y||(y=p.width),m||(m=p.height);var w=!Ut(d)&&g>0;Ch(a,r,w);try{var E=a.ownerDocument.defaultView.getContextService().getDomElement(),S=E.width,O=E.height,k=r.getTransform(),T=k.a,C=k.b,P=k.c,N=k.d,L=k.e,D=k.f,G=MP(T,P,0,0,C,N,0,0,0,0,1,0,L,D,0,1),H=jq([o,c,y,m],G),W=zq([0,0,S,O],H);if(!W)return;if(!a.ownerDocument.defaultView.getConfig().enableLargeImageOptimization){t.renderFull(r,i,a,{image:p,drawRect:[o,c,y,m]});return}var q=H[2]/v.size[0];if(q<(v.downSamplingRate||.5)){this.renderDownSampled(r,i,a,{src:f,imageCache:v,drawRect:[o,c,y,m]});return}if(!zw.isSupportTile){t.renderFull(r,i,a,{image:p,drawRect:[o,c,y,m]});return}this.renderTile(r,i,a,{src:f,imageCache:v,imageRect:H,drawRect:W})}catch{}}}},{key:"drawToContext",value:function(r,i,a,s,o){this.render(r,i.parsedStyle,i)}}],[{key:"renderFull",value:function(r,i,a,s){r.drawImage(s.image,Math.floor(s.drawRect[0]),Math.floor(s.drawRect[1]),Math.ceil(s.drawRect[2]),Math.ceil(s.drawRect[3]))}}])}(jw),$q=function(n){function t(){return yt(this,t),ae(this,t,arguments)}return se(t,n),mt(t,[{key:"render",value:function(r,i,a,s,o,l){a.getBounds();var c=i.lineWidth,u=c===void 0?1:c,h=i.textAlign,f=h===void 0?"start":h,d=i.textBaseline,g=d===void 0?"alphabetic":d,v=i.lineJoin,p=v===void 0?"miter":v,y=i.miterLimit,m=y===void 0?10:y,w=i.letterSpacing,E=w===void 0?0:w,S=i.stroke,O=i.fill,k=i.fillRule,T=i.fillOpacity,C=T===void 0?1:T,P=i.strokeOpacity,N=P===void 0?1:P,L=i.opacity,D=L===void 0?1:L,G=i.metrics,H=i.x,W=H===void 0?0:H,q=i.y,z=q===void 0?0:q,Z=i.dx,at=i.dy,ft=i.shadowColor,ct=i.shadowBlur,Gt=G.font,J=G.lines,V=G.height,nt=G.lineHeight,dt=G.lineMetrics;r.font=Gt,r.lineWidth=u,r.textAlign=f==="middle"?"center":f;var Nt=g;Nt==="alphabetic"&&(Nt="bottom"),r.lineJoin=p,Ut(m)||(r.miterLimit=m);var Wt=z;g==="middle"?Wt+=-V/2-nt/2:g==="bottom"||g==="alphabetic"||g==="ideographic"?Wt+=-V:(g==="top"||g==="hanging")&&(Wt+=-nt);var Kt=W+(Z||0);Wt+=at||0,J.length===1&&(Nt==="bottom"?(Nt="middle",Wt-=.5*V):Nt==="top"&&(Nt="middle",Wt+=.5*V)),r.textBaseline=Nt;var qe=!Ut(ft)&&ct>0;Ch(a,r,qe);for(var U=0;U<J.length;U++){var X=u/2+Kt;Wt+=nt,!Ut(S)&&!S.isNone&&u&&this.drawLetterSpacing(r,a,J[U],dt[U],f,X,Wt,E,O,k,C,S,N,D,!0,s,o,l),Ut(O)||this.drawLetterSpacing(r,a,J[U],dt[U],f,X,Wt,E,O,k,C,S,N,D,!1,s,o,l)}}},{key:"drawLetterSpacing",value:function(r,i,a,s,o,l,c,u,h,f,d,g,v,p,y,m,w,E){if(u===0){y?this.strokeText(r,i,a,l,c,g,v,m,w,E):this.fillText(r,i,a,l,c,h,f,d,p,m,w,E);return}var S=r.textAlign;r.textAlign="left";var O=l;o==="center"||o==="middle"?O=l-s.width/2:(o==="right"||o==="end")&&(O=l-s.width);for(var k=Array.from(a),T=r.measureText(a).width,C=0,P=0;P<k.length;++P){var N=k[P];y?this.strokeText(r,i,N,O,c,g,v,m,w,E):this.fillText(r,i,N,O,c,h,f,d,p,m,w,E),C=r.measureText(a.substring(P+1)).width,O+=T-C+u,T=C}r.textAlign=S}},{key:"fillText",value:function(r,i,a,s,o,l,c,u,h,f,d,g){PR(r,i,l,c,f,d,g,this.imagePool,!0);var v,p=!Ut(u)&&u!==1;p&&(v=r.globalAlpha,r.globalAlpha=u*h),r.fillText(a,s,o),p&&(r.globalAlpha=v)}},{key:"strokeText",value:function(r,i,a,s,o,l,c,u,h,f){vb(r,i,l,u,h,f,this.imagePool,!0);var d,g=!Ut(c)&&c!==1;g&&(d=r.globalAlpha,r.globalAlpha=c),r.strokeText(a,s,o),g&&(r.globalAlpha=d)}},{key:"drawToContext",value:function(r,i,a,s,o){this.render(r,i.parsedStyle,i,i.ownerDocument.defaultView.context,s,o)}}])}(jw),Gq=function(n){function t(){var e,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return yt(this,t),e=ae(this,t),e.name="canvas-renderer",e.options=r,e}return se(t,n),mt(t,[{key:"init",value:function(){var r,i=ie({dirtyObjectNumThreshold:500,dirtyObjectRatioThreshold:.8},this.options),a=this.context.imagePool,s=new jw(a),o=(r={},It(It(It(It(It(It(It(It(It(It(r,ot.CIRCLE,s),ot.ELLIPSE,s),ot.RECT,s),ot.IMAGE,new qq(a)),ot.TEXT,new $q(a)),ot.LINE,s),ot.POLYLINE,s),ot.POLYGON,s),ot.PATH,s),ot.GROUP,void 0),It(It(It(r,ot.HTML,void 0),ot.MESH,void 0),ot.FRAGMENT,void 0));this.context.defaultStyleRendererFactory=o,this.context.styleRendererFactory=o,this.addRenderingPlugin(new CR(i))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins(),delete this.context.defaultStyleRendererFactory,delete this.context.styleRendererFactory}}])}(Ja);/*!
 * @antv/g-plugin-dom-interaction
 * @description A G plugin
 * @version 2.1.21
 * @date 1/23/2025, 8:33:09 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var NR=function(){function n(){yt(this,n)}return mt(n,[{key:"apply",value:function(e,r){var i=this,a=e.renderingService,s=e.renderingContext,o=e.config;this.context=e;var l=s.root.ownerDocument.defaultView,c=function(T){a.hooks.pointerMove.call(T)},u=function(T){a.hooks.pointerUp.call(T)},h=function(T){a.hooks.pointerDown.call(T)},f=function(T){a.hooks.pointerOver.call(T)},d=function(T){a.hooks.pointerOut.call(T)},g=function(T){a.hooks.pointerCancel.call(T)},v=function(T){a.hooks.pointerWheel.call(T)},p=function(T){a.hooks.click.call(T)},y=function(T){r.globalThis.document.addEventListener("pointermove",c,!0),T.addEventListener("pointerdown",h,!0),T.addEventListener("pointerleave",d,!0),T.addEventListener("pointerover",f,!0),r.globalThis.addEventListener("pointerup",u,!0),r.globalThis.addEventListener("pointercancel",g,!0)},m=function(T){T.addEventListener("touchstart",h,!0),T.addEventListener("touchend",u,!0),T.addEventListener("touchmove",c,!0),T.addEventListener("touchcancel",g,!0)},w=function(T){r.globalThis.document.addEventListener("mousemove",c,!0),T.addEventListener("mousedown",h,!0),T.addEventListener("mouseout",d,!0),T.addEventListener("mouseover",f,!0),r.globalThis.addEventListener("mouseup",u,!0)},E=function(T){r.globalThis.document.removeEventListener("pointermove",c,!0),T.removeEventListener("pointerdown",h,!0),T.removeEventListener("pointerleave",d,!0),T.removeEventListener("pointerover",f,!0),r.globalThis.removeEventListener("pointerup",u,!0),r.globalThis.removeEventListener("pointercancel",g,!0)},S=function(T){T.removeEventListener("touchstart",h,!0),T.removeEventListener("touchend",u,!0),T.removeEventListener("touchmove",c,!0),T.removeEventListener("touchcancel",g,!0)},O=function(T){r.globalThis.document.removeEventListener("mousemove",c,!0),T.removeEventListener("mousedown",h,!0),T.removeEventListener("mouseout",d,!0),T.removeEventListener("mouseover",f,!0),r.globalThis.removeEventListener("mouseup",u,!0)};a.hooks.init.tap(n.tag,function(){var k=i.context.contextService.getDomElement();r.globalThis.navigator.msPointerEnabled?(k.style.msContentZooming="none",k.style.msTouchAction="none"):l.supportsPointerEvents&&(k.style.touchAction="none"),l.supportsPointerEvents?y(k):w(k),l.supportsTouchEvents&&m(k),o.useNativeClickEvent&&k.addEventListener("click",p,!0),k.addEventListener("wheel",v,{passive:!0,capture:!0})}),a.hooks.destroy.tap(n.tag,function(){var k=i.context.contextService.getDomElement();r.globalThis.navigator.msPointerEnabled?(k.style.msContentZooming="",k.style.msTouchAction=""):l.supportsPointerEvents&&(k.style.touchAction=""),l.supportsPointerEvents?E(k):O(k),l.supportsTouchEvents&&S(k),o.useNativeClickEvent&&k.removeEventListener("click",p,!0),k.removeEventListener("wheel",v,!0)})}}])}();NR.tag="DOMInteraction";var Wq=function(n){function t(){var e;yt(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=ae(this,t,[].concat(i)),e.name="dom-interaction",e}return se(t,n),mt(t,[{key:"init",value:function(){this.addRenderingPlugin(new NR)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(Ja);/*!
 * @antv/g-plugin-html-renderer
 * @description A G plugin for rendering HTML
 * @version 2.1.21
 * @date 1/23/2025, 8:33:20 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var Vq="g-canvas-camera",RR=function(){function n(){yt(this,n),this.displayObjectHTMLElementMap=new WeakMap}return mt(n,[{key:"joinTransformMatrix",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return"matrix(".concat([e[0],e[1],e[4],e[5],e[12]+r[0],e[13]+r[1]].join(","),")")}},{key:"apply",value:function(e,r){var i=this,a=e.camera,s=e.renderingContext,o=e.renderingService;this.context=e;var l=s.root.ownerDocument.defaultView,c=l.context.eventService.nativeHTMLMap,u=function(y,m){m.style.transform=i.joinTransformMatrix(y.getWorldTransform(),y.getOrigin())},h=function(y){var m=y.target;if(m.nodeName===ot.HTML){i.$camera||(i.$camera=i.createCamera(a));var w=i.getOrCreateEl(m);i.$camera.appendChild(w),Object.keys(m.attributes).forEach(function(E){i.updateAttribute(E,m)}),u(m,w),c.set(w,m)}},f=function(y){var m=y.target;if(m.nodeName===ot.HTML&&i.$camera){var w=i.getOrCreateEl(m);w&&(w.remove(),c.delete(w))}},d=function(y){var m=y.target;if(m.nodeName===ot.HTML){var w=y.attrName;i.updateAttribute(w,m)}},g=function(y){var m=y.target,w=m.nodeName===ot.FRAGMENT?m.childNodes:[m];w.forEach(function(E){if(E.nodeName===ot.HTML){var S=i.getOrCreateEl(E);u(E,S)}})},v=function(){if(i.$camera){var y=i.context.config,m=y.width,w=y.height;i.$camera.parentElement.style.width="".concat(m||0,"px"),i.$camera.parentElement.style.height="".concat(w||0,"px")}};o.hooks.init.tap(n.tag,function(){l.addEventListener(Lr.RESIZE,v),l.addEventListener(ce.MOUNTED,h),l.addEventListener(ce.UNMOUNTED,f),l.addEventListener(ce.ATTR_MODIFIED,d),l.addEventListener(ce.BOUNDS_CHANGED,g)}),o.hooks.endFrame.tap(n.tag,function(){i.$camera&&s.renderReasons.has(So.CAMERA_CHANGED)&&(i.$camera.style.transform=i.joinTransformMatrix(a.getOrthoMatrix()))}),o.hooks.destroy.tap(n.tag,function(){i.$camera&&i.$camera.remove(),l.removeEventListener(Lr.RESIZE,v),l.removeEventListener(ce.MOUNTED,h),l.removeEventListener(ce.UNMOUNTED,f),l.removeEventListener(ce.ATTR_MODIFIED,d),l.removeEventListener(ce.BOUNDS_CHANGED,g)})}},{key:"createCamera",value:function(e){var r=this.context.config,i=r.document,a=r.width,s=r.height,o=this.context.contextService.getDomElement(),l=o.parentNode;if(l){var c=Vq,u=l.querySelector("#".concat(c));if(!u){var h=(i||document).createElement("div");h.style.overflow="hidden",h.style.pointerEvents="none",h.style.position="absolute",h.style.left="0px",h.style.top="0px",h.style.width="".concat(a||0,"px"),h.style.height="".concat(s||0,"px");var f=(i||document).createElement("div");u=f,f.id=c,f.style.position="absolute",f.style.left="".concat(o.offsetLeft||0,"px"),f.style.top="".concat(o.offsetTop||0,"px"),f.style.transformOrigin="left top",f.style.transform=this.joinTransformMatrix(e.getOrthoMatrix()),f.style.pointerEvents="none",f.style.width="100%",f.style.height="100%",h.appendChild(f),l.appendChild(h)}return u}return null}},{key:"getOrCreateEl",value:function(e){var r=this.context.config.document,i=this.displayObjectHTMLElementMap.get(e);return i||(i=(r||document).createElement("div"),e.parsedStyle.$el=i,this.displayObjectHTMLElementMap.set(e,i),e.id&&(i.id=e.id),e.name&&i.setAttribute("name",e.name),e.className&&(i.className=e.className),i.style.position="absolute",i.style["will-change"]="transform",i.style.transform=this.joinTransformMatrix(e.getWorldTransform(),e.getOrigin())),i}},{key:"updateAttribute",value:function(e,r){var i=this.getOrCreateEl(r);switch(e){case"innerHTML":var a=r.parsedStyle.innerHTML;me(a)?i.innerHTML=a:(i.innerHTML="",i.appendChild(a));break;case"x":i.style.left="".concat(r.parsedStyle.x,"px");break;case"y":i.style.top="".concat(r.parsedStyle.y,"px");break;case"transformOrigin":var s=r.parsedStyle.transformOrigin;i.style["transform-origin"]="".concat(s[0].buildCSSText(null,null,"")," ").concat(s[1].buildCSSText(null,null,""));break;case"width":var o=r.parsedStyle.width;i.style.width=Lt(o)?"".concat(o,"px"):o.toString();break;case"height":var l=r.parsedStyle.height;i.style.height=Lt(l)?"".concat(l,"px"):l.toString();break;case"zIndex":var c=r.parsedStyle.zIndex;i.style["z-index"]="".concat(c);break;case"visibility":var u=r.parsedStyle.visibility;i.style.visibility=u;break;case"pointerEvents":var h=r.parsedStyle.pointerEvents,f=h===void 0?"auto":h;i.style.pointerEvents=f;break;case"opacity":var d=r.parsedStyle.opacity;i.style.opacity="".concat(d);break;case"fill":var g=r.parsedStyle.fill,v="";mh(g)?g.isNone?v="transparent":v=r.getAttribute("fill"):Array.isArray(g)?v=r.getAttribute("fill"):Ls(g),i.style.background=v;break;case"stroke":var p=r.parsedStyle.stroke,y="";mh(p)?p.isNone?y="transparent":y=r.getAttribute("stroke"):Array.isArray(p)?y=r.getAttribute("stroke"):Ls(p),i.style["border-color"]=y,i.style["border-style"]="solid";break;case"lineWidth":var m=r.parsedStyle.lineWidth;i.style["border-width"]="".concat(m||0,"px");break;case"lineDash":i.style["border-style"]="dashed";break;case"filter":var w=r.style.filter;i.style.filter=w;break;default:!Ut(r.style[e])&&r.style[e]!==""&&(i.style[e]=r.style[e])}}}])}();RR.tag="HTMLRendering";var Hq=function(n){function t(){var e;yt(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=ae(this,t,[].concat(i)),e.name="html-renderer",e}return se(t,n),mt(t,[{key:"init",value:function(){this.addRenderingPlugin(new RR)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(Ja);/*!
 * @antv/g-canvas
 * @description A renderer implemented by Canvas 2D API
 * @version 2.0.40
 * @date 2/27/2025, 8:29:44 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var Uq=function(){function n(t){yt(this,n),this.renderingContext=t.renderingContext,this.canvasConfig=t.config}return mt(n,[{key:"init",value:function(){var e=this.canvasConfig,r=e.container,i=e.canvas;if(i)this.$canvas=i,r&&i.parentElement!==r&&r.appendChild(i),this.$container=i.parentElement,this.canvasConfig.container=this.$container;else if(r&&(this.$container=me(r)?document.getElementById(r):r,this.$container)){var a=document.createElement("canvas");this.$container.appendChild(a),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=a}this.context=this.$canvas.getContext("2d"),this.resize(this.canvasConfig.width,this.canvasConfig.height)}},{key:"getContext",value:function(){return this.context}},{key:"getDomElement",value:function(){return this.$canvas}},{key:"getDPR",value:function(){return this.dpr}},{key:"getBoundingClientRect",value:function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()}},{key:"destroy",value:function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)}},{key:"resize",value:function(e,r){var i=this.canvasConfig.devicePixelRatio;this.dpr=i,this.$canvas&&(this.$canvas.width=this.dpr*e,this.$canvas.height=this.dpr*r,Sz(this.$canvas,e,r)),this.renderingContext.renderReasons.add(So.CAMERA_CHANGED)}},{key:"applyCursorStyle",value:function(e){this.$container&&this.$container.style&&(this.$container.style.cursor=e)}},{key:"toDataURL",value:function(){var t=Ha(qn().mark(function r(){var i,a,s,o=arguments;return qn().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return i=o.length>0&&o[0]!==void 0?o[0]:{},a=i.type,s=i.encoderOptions,c.abrupt("return",this.context.canvas.toDataURL(a,s));case 3:case"end":return c.stop()}},r,this)}));function e(){return t.apply(this,arguments)}return e}()}])}(),Yq=function(n){function t(){var e;yt(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=ae(this,t,[].concat(i)),e.name="canvas-context-register",e}return se(t,n),mt(t,[{key:"init",value:function(){this.context.ContextService=Uq}},{key:"destroy",value:function(){delete this.context.ContextService}}])}(Ja),Kl=function(n){function t(e){var r;return yt(this,t),r=ae(this,t,[e]),r.registerPlugin(new Yq),r.registerPlugin(new Fq),r.registerPlugin(new gq),r.registerPlugin(new Gq),r.registerPlugin(new Wq),r.registerPlugin(new Rq),r.registerPlugin(new Hq),r}return se(t,n),mt(t)}(S4),Xq=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};class uf extends Qr{constructor(t){super(Object.assign(Object.assign({},t),{style:Object.assign({},uf.defaultStyleProps,t.style)})),this.rootPointerEvent=new xh(null),this.forwardEvents=e=>{const r=this.context.canvas,i=r.context.renderingContext.root.ownerDocument.defaultView;this.normalizeToPointerEvent(e,i).forEach(s=>{const o=this.bootstrapEvent(this.rootPointerEvent,s,i,e);Wl(r.context.eventService,"mappingTable.pointerupoutside",[]),r.context.eventService.mapEvent(o)})}}get eventService(){return this.context.canvas.context.eventService}get events(){return[st.CLICK,st.POINTER_DOWN,st.POINTER_MOVE,st.POINTER_UP,st.POINTER_OVER,st.POINTER_LEAVE]}getDomElement(){return this.getShape("key").getDomElement()}render(t=this.parsedAttributes,e=this){this.drawKeyShape(t,e),this.drawPortShapes(t,e)}getKeyStyle(t){const e=Ns(t,["dx","dy","innerHTML","pointerEvents","cursor"]),{dx:r=0,dy:i=0}=e,a=Xq(e,["dx","dy"]),[s,o]=this.getSize(t);return Object.assign(Object.assign({x:r,y:i},a),{width:s,height:o})}drawKeyShape(t,e){const r=this.getKeyStyle(t),{x:i,y:a,width:s=0,height:o=0}=r,l=this.upsert("key-container",Rn,{x:i,y:a,width:s,height:o,opacity:0},e);return this.upsert("key",gc,r,l)}connectedCallback(){if(!(this.context.canvas.getRenderer("main")instanceof Kl))return;const r=this.getDomElement();this.events.forEach(i=>{r.addEventListener(i,this.forwardEvents)})}attributeChangedCallback(t,e,r){t==="zIndex"&&e!==r&&(this.getDomElement().style.zIndex=r)}destroy(){const t=this.getDomElement();this.events.forEach(e=>{t.removeEventListener(e,this.forwardEvents)}),super.destroy()}normalizeToPointerEvent(t,e){const r=[];if(e.isTouchEvent(t))for(let i=0;i<t.changedTouches.length;i++){const a=t.changedTouches[i];Qt(a.button)&&(a.button=0),Qt(a.buttons)&&(a.buttons=1),Qt(a.isPrimary)&&(a.isPrimary=t.touches.length===1&&t.type==="touchstart"),Qt(a.width)&&(a.width=a.radiusX||1),Qt(a.height)&&(a.height=a.radiusY||1),Qt(a.tiltX)&&(a.tiltX=0),Qt(a.tiltY)&&(a.tiltY=0),Qt(a.pointerType)&&(a.pointerType="touch"),Qt(a.pointerId)&&(a.pointerId=a.identifier||0),Qt(a.pressure)&&(a.pressure=a.force||.5),Qt(a.twist)&&(a.twist=0),Qt(a.tangentialPressure)&&(a.tangentialPressure=0),a.isNormalized=!0,a.type=t.type,r.push(a)}else if(e.isMouseEvent(t)){const i=t;Qt(i.isPrimary)&&(i.isPrimary=!0),Qt(i.width)&&(i.width=1),Qt(i.height)&&(i.height=1),Qt(i.tiltX)&&(i.tiltX=0),Qt(i.tiltY)&&(i.tiltY=0),Qt(i.pointerType)&&(i.pointerType="mouse"),Qt(i.pointerId)&&(i.pointerId=1),Qt(i.pressure)&&(i.pressure=.5),Qt(i.twist)&&(i.twist=0),Qt(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,r.push(i)}else r.push(t);return r}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null}bootstrapEvent(t,e,r,i){t.view=r,t.originalEvent=null,t.nativeEvent=i,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);const{x:a,y:s}=this.getViewportXY(e);t.viewport.x=a,t.viewport.y=s;const[o,l]=this.context.canvas.getCanvasByViewport([a,s]);return t.canvas.x=o,t.canvas.y=l,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=i.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t}getViewportXY(t){let e,r;const{offsetX:i,offsetY:a,clientX:s,clientY:o}=t;if(!Ut(i)&&!Ut(a))e=i,r=a;else{const l=this.eventService.client2Viewport({x:s,y:o});e=l.x,r=l.y}return{x:e,y:r}}onframe(){super.onframe();const{opacity:t}=this.attributes;this.getDomElement().style.opacity=`${t}`}}uf.defaultStyleProps={size:[160,80],halo:!1,icon:!1,label:!1,pointerEvents:"auto"};var S2=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};let LR=class IR extends Qr{constructor(t){super(In({style:IR.defaultStyleProps},t))}getKeyStyle(t){const[e,r]=this.getSize(t),i=super.getKeyStyle(t),{fillOpacity:a,opacity:s=a}=i,o=S2(i,["fillOpacity","opacity"]);return Object.assign(Object.assign({opacity:s},o),{width:e,height:r,x:-e/2,y:-r/2})}getHaloStyle(t){if(t.halo===!1)return!1;const e=this.getShape("key").attributes,{fill:r,stroke:i}=e;S2(e,["fill","stroke"]);const a=yn(this.getGraphicStyle(t),"halo"),s=Number(a.lineWidth),[o,l]=re(this.getSize(t),[s,s]);return Object.assign(Object.assign({},a),{width:o,height:l,fill:"transparent",x:-o/2,y:-l/2})}getIconStyle(t){const e=super.getIconStyle(t),[r,i]=this.getSize(t);return e?Object.assign({width:r*ca,height:i*ca},e):!1}drawKeyShape(t,e){const r=this.upsert("key",Dw,this.getKeyStyle(t),e);return Fw(this),r}drawHaloShape(t,e){this.upsert("halo",Rn,this.getHaloStyle(t),e)}update(t){super.update(t),t&&("x"in t||"y"in t||"z"in t)&&Bw(this)}};LR.defaultStyleProps={size:32};class Kq extends Qr{constructor(t){super(t)}getKeyStyle(t){const[e,r]=this.getSize(t);return Object.assign(Object.assign({},super.getKeyStyle(t)),{width:e,height:r,x:-e/2,y:-r/2})}getIconStyle(t){const e=super.getIconStyle(t),{width:r,height:i}=this.getShape("key").attributes;return e?Object.assign({width:r*ca,height:i*ca},e):!1}drawKeyShape(t,e){return this.upsert("key",Rn,this.getKeyStyle(t),e)}}class Zq extends of{constructor(t){super(t)}getInnerR(t){return t.innerR||this.getOuterR(t)*3/8}getOuterR(t){return Math.min(...this.getSize(t))/2}getPoints(t){return L$(this.getOuterR(t),this.getInnerR(t))}getIconStyle(t){const e=super.getIconStyle(t),r=this.getInnerR(t)*2*ca;return e?Object.assign({width:r,height:r},e):!1}getPortXY(t,e){const{placement:r="top"}=e,i=this.getShape("key").getLocalBounds(),a=I$(this.getOuterR(t),this.getInnerR(t));return Gw(i,r,a,!1)}}class hf extends of{constructor(t){super(In({style:hf.defaultStyleProps},t))}getPoints(t){const{direction:e}=t,[r,i]=this.getSize(t);return D$(r,i,e)}getPortXY(t,e){const{direction:r}=t,{placement:i="top"}=e,a=this.getShape("key").getLocalBounds(),[s,o]=this.getSize(t),l=F$(s,o,r);return Gw(a,i,l,!1)}getIconStyle(t){const{icon:e,iconText:r,iconSrc:i,direction:a}=t;if(e===!1||Ti(r||i))return!1;const s=yn(this.getGraphicStyle(t),"icon"),o=this.getShape("key").getLocalBounds(),[l,c]=t9(o,a),u=e9(o,a)*2*ca;return Object.assign({x:l,y:c,width:u,height:u},s)}}hf.defaultStyleProps={size:40,direction:"up"};var _2=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};class Bo extends Qr{constructor(t){super(In({style:Bo.defaultStyleProps},t)),this.type="combo",this.updateComboPosition(this.parsedAttributes)}getKeySize(t){const{collapsed:e,childrenNode:r=[]}=t;return r.length===0?this.getEmptyKeySize(t):e?this.getCollapsedKeySize(t):this.getExpandedKeySize(t)}getEmptyKeySize(t){const{padding:e,collapsedSize:r}=t,[i,a,s,o]=qi(e);return re(jr(r),[o+a,i+s,0])}getCollapsedKeySize(t){return jr(t.collapsedSize)}getExpandedKeySize(t){const e=this.getContentBBox(t);return[$i(e),Gi(e),0]}getContentBBox(t){const{childrenNode:e=[],padding:r}=t,i=e.map(s=>this.context.element.getElement(s)).filter(Boolean);if(i.length===0){const s=new Re,{x:o=0,y:l=0,size:c}=t,[u,h]=jr(c);return s.setMinMax([o-u/2,l-h/2,0],[o+u/2,l+h/2,0]),s}const a=vc(i.map(s=>s.getBounds()));return r?es(a,r):a}drawCollapsedMarkerShape(t,e){const r=this.getCollapsedMarkerStyle(t);this.upsert("collapsed-marker",SR,r,e),Fw(this)}getCollapsedMarkerStyle(t){if(!t.collapsed||!t.collapsedMarker)return!1;const e=yn(this.getGraphicStyle(t),"collapsedMarker"),{type:r}=e,i=_2(e,["type"]),a=this.getShape("key"),[s,o]=ta(a.getLocalBounds(),"center"),l=Object.assign(Object.assign({},i),{x:s,y:o});if(r){const c=this.getCollapsedMarkerText(r,t);Object.assign(l,{text:c})}return l}getCollapsedMarkerText(t,e){const{childrenData:r=[]}=e,{model:i}=this.context;return t==="descendant-count"?i.getDescendantsData(this.id).length.toString():t==="child-count"?r.length.toString():t==="node-count"?i.getDescendantsData(this.id).filter(a=>i.getElementType(tt(a))==="node").length.toString():zt(t)?t(r):""}getComboPosition(t){const{x:e=0,y:r=0,collapsed:i,childrenData:a=[]}=t;if(a.length===0)return[+e,+r,0];if(i){const{model:s}=this.context,o=s.getDescendantsData(this.id).filter(l=>!s.isCombo(tt(l)));if(o.length>0&&o.some(k9)){const l=o.reduce((c,u)=>re(c,fn(u)),[0,0,0]);return gi(l,o.length)}return[+e,+r,0]}return this.getContentBBox(t).center}getComboStyle(t){const[e,r]=this.getComboPosition(t);return{x:e,y:r,transform:[["translate",e,r]]}}updateComboPosition(t){const e=this.getComboStyle(t);Object.assign(this.style,e);const{x:r,y:i}=e;this.context.model.syncNodeLikeDatum({id:this.id,style:{x:r,y:i}}),Bw(this)}render(t,e=this){super.render(t,e),this.drawCollapsedMarkerShape(t,e)}update(t={}){super.update(t),this.updateComboPosition(this.parsedAttributes)}onframe(){super.onframe(),this.attributes.collapsed||this.updateComboPosition(this.parsedAttributes),this.drawKeyShape(this.parsedAttributes,this)}animate(t,e){const r=super.animate(this.attributes.collapsed?t:t.map(i=>{var{x:a,y:s,z:o,transform:l}=i,c=_2(i,["x","y","z","transform"]);return c}),e);return r&&new Proxy(r,{set:(i,a,s)=>(a==="currentTime"&&Promise.resolve().then(()=>this.onframe()),Reflect.set(i,a,s))})}}Bo.defaultStyleProps={childrenNode:[],droppable:!0,draggable:!0,collapsed:!1,collapsedSize:32,collapsedMarker:!0,collapsedMarkerZIndex:1,collapsedMarkerFontSize:12,collapsedMarkerTextAlign:"center",collapsedMarkerTextBaseline:"middle",collapsedMarkerType:"child-count"};class Jq extends Bo{constructor(t){super(t)}drawKeyShape(t,e){return this.upsert("key",da,this.getKeyStyle(t),e)}getKeyStyle(t){const{collapsed:e}=t,r=super.getKeyStyle(t),[i]=this.getKeySize(t);return Object.assign(Object.assign(Object.assign({},r),e&&yn(r,"collapsed")),{r:i/2})}getCollapsedKeySize(t){const[e,r]=jr(t.collapsedSize),i=Math.max(e,r)/2;return[i*2,i*2,0]}getExpandedKeySize(t){const e=this.getContentBBox(t),[r,i]=ts(e),a=Math.sqrt(Math.pow(r,2)+Math.pow(i,2))/2;return[a*2,a*2,0]}getIntersectPoint(t,e=!1){const r=this.getShape("key").getBounds();return af(t,r,e)}}class Qq extends Bo{constructor(t){super(t)}drawKeyShape(t,e){return this.upsert("key",Rn,this.getKeyStyle(t),e)}getKeyStyle(t){const e=super.getKeyStyle(t),[r,i]=this.getKeySize(t);return Object.assign(Object.assign(Object.assign({},e),t.collapsed&&yn(e,"collapsed")),{width:r,height:i,x:-r/2,y:-i/2})}}const t$={padding:10};function M2(n,t,e,r,i,a){const{padding:s}=Object.assign(t$,a),o=Pa(e,s),l=Pa(r,s),c=[n,...i,t];let u=null;const h=[];for(let f=0,d=c.length;f<d-1;f++){const g=f+1,v=c[f],p=c[g],y=P9(v,p);let m=null;if(f===0)if(g===d-1)if(o.intersects(l))m=yg(v,p,o,l);else if(!_h(v,o)&&!_h(p,l)){const w=ks(v,o),E=ks(p,l);m=T2(w,E,lr(w,E)),m.points.unshift(w),m.points.push(E)}else y||(m=n$(v,p,o,l));else di(p,o)?m=yg(v,p,o,Pa(p,s),u):y||(m=Vu(v,p,o));else g===d-1?di(v,l)?m=yg(v,p,Pa(v,s),l,u):y||(m=DR(v,p,l,u)):y||(m=T2(v,p,u));m?(h.push(...m.points),u=m.direction):u=lr(v,p),g<d-1&&h.push(p)}return h.map(Fs)}const e$={N:"S",S:"N",W:"E",E:"W"},O2={N:-Math.PI/2,S:Math.PI/2,E:0,W:Math.PI};function lr(n,t){const[e,r]=n,[i,a]=t;return e===i?r>a?"N":"S":r===a?e>i?"W":"E":null}function yb(n,t){return t==="N"||t==="S"?Gi(n):$i(n)}function T2(n,t,e){const r=[n[0],t[1]],i=[t[0],n[1]],a=lr(n,r),s=lr(n,i),o=e?e$[e]:null,l=a===e||a!==o&&s!==e?r:i;return{points:[l],direction:lr(l,t)}}function Vu(n,t,e){if(_h(n,e)){const r=Zl(n,t,e);return{points:[r],direction:lr(r,t)}}else{const r=ks(n,e),a=["left","right"].includes(Rl(n,e))?[t[0],r[1]]:[r[0],t[1]];return{points:[a],direction:lr(a,t)}}}function DR(n,t,e,r){const i=_h(t,e)?t:ks(t,e),a=[[i[0],n[1]],[n[0],i[1]]],s=a.filter(l=>Q8(l,e)&&!eR(l,e,!0)),o=s.filter(l=>lr(l,n)!==r);if(o.length>0){const l=o.find(c=>lr(n,c)===r)||o[0];return{points:[l],direction:lr(l,t)}}else{const l=oB(a,s)[0],c=qa(t,l,yb(e,r)/2);return{points:[Zl(c,n,e),c],direction:lr(c,t)}}}function n$(n,t,e,r){let i=Vu(n,t,e);const a=Xl(i.points[0]);if(di(a,r)){i=Vu(t,n,r);const s=Xl(i.points[0]);if(di(s,e)){const o=qa(n,a,yb(e,lr(n,a))/2),l=qa(t,s,yb(r,lr(t,s))/2),c=[(o[0]+l[0])/2,(o[1]+l[1])/2],u=Vu(n,c,e),h=DR(c,t,r,u.direction);i.points=[u.points[0],h.points[0]],i.direction=h.direction}}return i}function yg(n,t,e,r,i){const s=vc([e,r]),o=ze(t,s.center)>ze(n,s.center),[l,c]=o?[t,n]:[n,t],u=Gi(s)+$i(s);let h;if(i){const g=[l[0]+u*Math.cos(O2[i]),l[1]+u*Math.sin(O2[i])];h=qa(ks(g,s),g,.01)}else h=qa(ks(l,s),l,-.01);let f=Zl(h,c,s),d=[nl(h,2),nl(f,2)];if(en(nl(h),nl(f))){const g=Rw(Me(h,l),[1,0,0])+Math.PI/2;f=[c[0]+u*Math.cos(g),c[1]+u*Math.sin(g),0],f=nl(qa(ks(f,s),c,-.01),2);const v=Zl(h,f,s);d=[h,v,f]}return{points:o?d.reverse():d,direction:lr(o?h:f,t)}}function Zl(n,t,e){let r=[n[0],t[1]];return di(r,e)&&(r=[t[0],n[1]]),r}function FR(n,t,e,r,i){let l=typeof t=="number"?t:.5;t==="start"&&(l=0),t==="end"&&(l=.99);const c=jn(n.getPoint(l)),u=jn(n.getPoint(l+.01));let h=t==="start"?"left":t==="end"?"right":"center";if(fR(c,u)||!e){const[y,m]=k2(n,l,r,i);return{transform:[["translate",y,m]],textAlign:h}}let f=Math.atan2(u[1]-c[1],u[0]-c[0]);u[0]<c[0]&&(h=h==="center"?h:h==="left"?"right":"left",r*=-1,f+=Math.PI);const[g,v]=k2(n,l,r,i,f),p=[["translate",g,v],["rotate",f/Math.PI*180]];return{textAlign:h,transform:p}}function r$(n,t,e,r,i){var a,s;const o=((a=n.badge)===null||a===void 0?void 0:a.getGeometryBounds().halfExtents[0])*2||0,l=((s=n.label)===null||s===void 0?void 0:s.getGeometryBounds().halfExtents[0])*2||0;return FR(n.key,e,!0,(l?(l/2+o/2)*(t==="suffix"?1:-1):0)+r,i)}function k2(n,t,e,r,i){const[a,s]=jn(n.getPoint(t));let o=e,l=r;return i&&(o=e*Math.cos(i)-r*Math.sin(i),l=e*Math.sin(i)+r*Math.cos(i)),[a+o,s+l]}function mb(n,t,e,r){if(en(n,t))return n;const i=Me(t,n),a=[n[0]+e*i[0],n[1]+e*i[1]],s=sa(rf(i,!1));return a[0]+=r*s[0],a[1]+=r*s[1],a}function i$(n){return Lt(n)?[n,-n]:n}function a$(n){return Lt(n)?[n,1-n]:n}function s$(n,t,e){return[["M",n[0],n[1]],["Q",e[0],e[1],t[0],t[1]]]}function BR(n,t,e){return[["M",n[0],n[1]],["C",e[0][0],e[0][1],e[1][0],e[1][1],t[0],t[1]]]}function qw(n,t=0,e=!1){const r=n[0],i=n[n.length-1],a=n.slice(1,n.length-1),s=[["M",r[0],r[1]]];return a.forEach((o,l)=>{const c=a[l-1]||r,u=a[l+1]||i;if(!dR(c,o,u)&&t){const[h,f]=o$(c,o,u,t);s.push(["L",h[0],h[1]],["Q",o[0],o[1],f[0],f[1]],["L",f[0],f[1]])}else s.push(["L",o[0],o[1]])}),s.push(["L",i[0],i[1]]),e&&s.push(["Z"]),s}function o$(n,t,e,r){const i=Mh(n,t),a=Mh(e,t),s=Math.min(r,Math.min(i,a)/2),o=[t[0]-s/i*(t[0]-n[0]),t[1]-s/i*(t[1]-n[1])],l=[t[0]-s/a*(t[0]-e[0]),t[1]-s/a*(t[1]-e[1])];return[o,l]}const l$=n=>{const t=Math.PI/2,e=Gi(n)/2,r=$i(n)/2,i=Math.atan2(e,r)/2,a=Math.atan2(r,e)/2;return{top:[-t-a,-t+a],"top-right":[-t+a,-i],"right-top":[-t+a,-i],right:[-i,i],"bottom-right":[i,t-a],"right-bottom":[i,t-a],bottom:[t-a,t+a],"bottom-left":[t+a,Math.PI-i],"left-bottom":[t+a,Math.PI-i],left:[Math.PI-i,Math.PI+i],"top-left":[Math.PI+i,-t-a],"left-top":[Math.PI+i,-t-a]}};function zR(n,t,e,r,i){const a=Pa(n),s=n.getCenter();let o=r&&Ya(r),l=i&&Ya(i);if(!o||!l){const c=l$(a),u=c[t][0],h=c[t][1],[f,d]=ts(a),g=Math.max(f,d),v=re(s,[g*Math.cos(u),g*Math.sin(u),0]),p=re(s,[g*Math.cos(h),g*Math.sin(h),0]);o=wb(n,v),l=wb(n,p),e||([o,l]=[l,o])}return[o,l]}function c$(n,t,e,r,i,a){const s=n.getPorts()[i||a],o=n.getPorts()[a||i];let[l,c]=zR(n,t,e,s,o);const u=u$(n,l,c,r);return s&&(l=Jl(s,u[0])),o&&(c=Jl(o,u[u.length-1])),BR(l,c,u)}function u$(n,t,e,r){const i=n.getCenter();if(en(t,e)){const a=Me(t,i),s=[r*Math.sign(a[0])||r/2,r*Math.sign(a[1])||-r/2,0];return[re(t,s),re(e,Qi(s,[1,-1,1]))]}return[qa(i,t,ze(i,t)+r),qa(i,e,ze(i,e)+r)]}function h$(n,t,e,r,i,a,s){const o=Ww(n),l=o[a||s],c=o[s||a];let[u,h]=zR(n,e,r,l,c);const f=f$(n,u,h,i);return l&&(u=Jl(l,f[0])),c&&(h=Jl(c,f[f.length-1])),qw([u,...f,h],t)}function f$(n,t,e,r){const i=[],a=Pa(n);if(en(t,e))switch(Rl(t,a)){case"left":i.push([t[0]-r,t[1]]),i.push([t[0]-r,t[1]+r]),i.push([t[0],t[1]+r]);break;case"right":i.push([t[0]+r,t[1]]),i.push([t[0]+r,t[1]+r]),i.push([t[0],t[1]+r]);break;case"top":i.push([t[0],t[1]-r]),i.push([t[0]+r,t[1]-r]),i.push([t[0]+r,t[1]]);break;case"bottom":i.push([t[0],t[1]+r]),i.push([t[0]+r,t[1]+r]),i.push([t[0]+r,t[1]]);break}else{const s=Rl(t,a),o=Rl(e,a);if(s===o){const l=s;let c,u;switch(l){case"left":c=Math.min(t[0],e[0])-r,i.push([c,t[1]]),i.push([c,e[1]]);break;case"right":c=Math.max(t[0],e[0])+r,i.push([c,t[1]]),i.push([c,e[1]]);break;case"top":u=Math.min(t[1],e[1])-r,i.push([t[0],u]),i.push([e[0],u]);break;case"bottom":u=Math.max(t[1],e[1])+r,i.push([t[0],u]),i.push([e[0],u]);break}}else{const l=(f,d)=>({left:[d[0]-r,d[1]],right:[d[0]+r,d[1]],top:[d[0],d[1]-r],bottom:[d[0],d[1]+r]})[f],c=l(s,t),u=l(o,e),h=Zl(c,u,a);i.push(c,h,u)}}return i}function bb(n,t){const e=new Set,r=new Set,i=new Set;return n.forEach(a=>{t(a).forEach(o=>{e.add(o),n.includes(o.source)&&n.includes(o.target)?r.add(o):i.add(o)})}),{edges:Array.from(e),internal:Array.from(r),external:Array.from(i)}}function A2(n,t){const e=[];let r=n;for(;r;){e.push(r);const i=t(tt(r));if(i)r=i;else break}if(e.some(i=>{var a;return(a=i.style)===null||a===void 0?void 0:a.collapsed})){const i=e.reverse().findIndex(xr);return e[i]||e.at(-1)}return n}function d$(n,t){return t||(n<4?10:n===4?12:n*2.5)}const g$=(n,t)=>{const e=Math.max(n,t)/2;return[["M",-n/2,0],["A",e,e,0,1,0,2*e-n/2,0],["A",e,e,0,1,0,-n/2,0],["Z"]]},jR=(n,t)=>[["M",-n/2,0],["L",n/2,-t/2],["L",n/2,t/2],["Z"]],p$=(n,t)=>[["M",-n/2,0],["L",0,-t/2],["L",n/2,0],["L",0,t/2],["Z"]],v$=(n,t)=>[["M",-n/2,0],["L",n/2,-t/2],["L",4*n/5-n/2,0],["L",n/2,t/2],["Z"]],y$=(n,t)=>[["M",-n/2,-t/2],["L",n/2,-t/2],["L",n/2,t/2],["L",-n/2,t/2],["Z"]],m$=(n,t)=>{const e=n/2,r=n/7,i=n-r;return[["M",-e,0],["L",0,-t/2],["L",0,t/2],["Z"],["M",i-e,-t/2],["L",i+r-e,-t/2],["L",i+r-e,t/2],["L",i-e,t/2],["Z"]]},b$=(n,t)=>[["M",n/2,-t/2],["L",-n/2,0],["L",n/2,0],["L",-n/2,0],["L",n/2,t/2]],w$=Object.freeze(Object.defineProperty({__proto__:null,circle:g$,diamond:p$,rect:y$,simple:b$,triangle:jR,triangleRect:m$,vee:v$},Symbol.toStringTag,{value:"Module"}));var Su=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};class rs extends _R{constructor(t){super(In({style:rs.defaultStyleProps},t)),this.type="edge"}get sourceNode(){const{sourceNode:t}=this.parsedAttributes;return this.context.element.getElement(t)}get targetNode(){const{targetNode:t}=this.parsedAttributes;return this.context.element.getElement(t)}getKeyStyle(t){const e=this.getGraphicStyle(t),{loop:r}=e,i=Su(e,["loop"]),{sourceNode:a,targetNode:s}=this,l={d:r&&C$(a,s)?this.getLoopPath(t):this.getKeyPath(t)};return Fr.PARSED_STYLE_LIST.forEach(c=>{c in i&&(l[c]=i[c])}),l}getLoopPath(t){const{sourcePort:e,targetPort:r}=t,i=this.sourceNode,a=Pa(i),s=Math.max($i(a),Gi(a)),{placement:o,clockwise:l,dist:c=s}=yn(this.getGraphicStyle(t),"loop");return c$(i,o,l,c,e,r)}getEndpoints(t,e=!0,r=[]){const{sourcePort:i,targetPort:a}=t,{sourceNode:s,targetNode:o}=this,[l,c]=N$(s,o,i,a);if(!e){const d=l?Ya(l):s.getCenter(),g=c?Ya(c):o.getCenter();return[d,g]}const u=typeof r=="function"?r():r,h=L2(l||s,u[0]||c||o),f=L2(c||o,u[u.length-1]||l||s);return[h,f]}getHaloStyle(t){if(t.halo===!1)return!1;const e=this.getKeyStyle(t),r=yn(this.getGraphicStyle(t),"halo");return Object.assign(Object.assign({},e),r)}getLabelStyle(t){if(t.label===!1||!t.labelText)return!1;const e=yn(this.getGraphicStyle(t),"label"),{placement:r,offsetX:i,offsetY:a,autoRotate:s,maxWidth:o}=e,l=Su(e,["placement","offsetX","offsetY","autoRotate","maxWidth"]),c=FR(this.shapeMap.key,r,s,i,a),u=this.shapeMap.key.getLocalBounds(),h=V9([u.min,u.max],o);return Object.assign({wordWrapWidth:h},c,l)}getBadgeStyle(t){if(t.badge===!1||!t.badgeText)return!1;const e=yn(t,"badge"),{offsetX:r,offsetY:i,placement:a}=e,s=Su(e,["offsetX","offsetY","placement"]);return Object.assign(s,r$(this.shapeMap,a,t.labelPlacement,r,i))}drawArrow(t,e){var r;const i=e==="start",s=t[e==="start"?"startArrow":"endArrow"],o=this.shapeMap.key;if(s){const l=this.getArrowStyle(t,i),[c,u,h]=i?["markerStart","markerStartOffset","startArrowOffset"]:["markerEnd","markerEndOffset","endArrowOffset"],f=o.parsedStyle[c];if(f)f.attr(l);else{const d=l.src?pc:Fr,g=new d({style:l});o.style[c]=g}o.style[u]=t[h]||l.width/2+ +l.lineWidth}else{const l=i?"markerStart":"markerEnd";(r=o.style[l])===null||r===void 0||r.destroy(),o.style[l]=null}}getArrowStyle(t,e){const r=this.getShape("key").attributes,i=e?"startArrow":"endArrow",a=yn(this.getGraphicStyle(t),i),{size:s,type:o}=a,l=Su(a,["size","type"]),[c,u]=jr(d$(r.lineWidth,s)),f=(zt(o)?o:w$[o]||jR)(c,u);return Object.assign(Ns(r,["stroke","strokeOpacity","fillOpacity"]),{width:c,height:u},Object.assign({},f&&{d:f,fill:o==="simple"?"":r.stroke}),l)}drawLabelShape(t,e){const r=this.getLabelStyle(t);this.upsert("label",ns,r,e)}drawHaloShape(t,e){const r=this.getHaloStyle(t);this.upsert("halo",Fr,r,e)}drawBadgeShape(t,e){const r=this.getBadgeStyle(t);this.upsert("badge",Ua,r,e)}drawSourceArrow(t){this.drawArrow(t,"start")}drawTargetArrow(t){this.drawArrow(t,"end")}drawKeyShape(t,e){const r=this.getKeyStyle(t);return this.upsert("key",Fr,r,e)}render(t=this.parsedAttributes,e=this){this.drawKeyShape(t,e),this.getShape("key")&&(this.drawSourceArrow(t),this.drawTargetArrow(t),this.drawLabelShape(t,e),this.drawHaloShape(t,e),this.drawBadgeShape(t,e))}onframe(){this.drawKeyShape(this.parsedAttributes,this),this.drawSourceArrow(this.parsedAttributes),this.drawTargetArrow(this.parsedAttributes),this.drawHaloShape(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this),this.drawBadgeShape(this.parsedAttributes,this)}animate(t,e){const r=super.animate(t,e);return r&&new Proxy(r,{set:(i,a,s)=>(a==="currentTime"&&Promise.resolve().then(()=>this.onframe()),Reflect.set(i,a,s))})}}rs.defaultStyleProps={badge:!0,badgeOffsetX:0,badgeOffsetY:0,badgePlacement:"suffix",isBillboard:!0,label:!0,labelAutoRotate:!0,labelIsBillboard:!0,labelMaxWidth:"80%",labelOffsetX:4,labelOffsetY:0,labelPlacement:"center",labelTextBaseline:"middle",labelWordWrap:!1,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloPointerEvents:"none",haloStrokeOpacity:.25,haloZIndex:-1,loop:!0,startArrow:!1,startArrowLineDash:0,startArrowLineJoin:"round",startArrowLineWidth:1,startArrowTransformOrigin:"center",startArrowType:"vee",endArrow:!1,endArrowLineDash:0,endArrowLineJoin:"round",endArrowLineWidth:1,endArrowTransformOrigin:"center",endArrowType:"vee",loopPlacement:"top",loopClockwise:!0};class Ws extends rs{constructor(t){super(In({style:Ws.defaultStyleProps},t))}getKeyPath(t){const[e,r]=this.getEndpoints(t),{controlPoints:i,curvePosition:a,curveOffset:s}=t,o=this.getControlPoints(e,r,a$(a),i$(s),i);return BR(e,r,o)}getControlPoints(t,e,r,i,a){return(a==null?void 0:a.length)===2?a:[mb(t,e,r[0],i[0]),mb(t,e,r[1],i[1])]}}Ws.defaultStyleProps={curvePosition:.5,curveOffset:20};class xc extends Ws{constructor(t){super(In({style:xc.defaultStyleProps},t))}getControlPoints(t,e,r,i){const a=e[0]-t[0];return[[t[0]+a*r[0]+i[0],t[1]],[e[0]-a*r[1]+i[1],e[1]]]}}xc.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};class ff extends Ws{constructor(t){super(In({style:ff.defaultStyleProps},t))}get ref(){return this.context.model.getRootsData()[0]}getEndpoints(t){if(this.sourceNode.id===this.ref.id)return super.getEndpoints(t);const e=fn(this.ref),r=this.sourceNode.getIntersectPoint(e,!0),i=this.targetNode.getIntersectPoint(e);return[r,i]}toRadialCoordinate(t){const e=fn(this.ref),r=ze(t,e),i=cR(Me(t,e));return[r,i]}getControlPoints(t,e,r,i){const[a,s]=this.toRadialCoordinate(t),[o]=this.toRadialCoordinate(e),l=o-a;return[[t[0]+(l*r[0]+i[0])*Math.cos(s),t[1]+(l*r[0]+i[0])*Math.sin(s)],[e[0]-(l*r[1]-i[0])*Math.cos(s),e[1]-(l*r[1]-i[0])*Math.sin(s)]]}}ff.defaultStyleProps={curvePosition:.5,curveOffset:20};class df extends Ws{constructor(t){super(In({style:df.defaultStyleProps},t))}getControlPoints(t,e,r,i){const a=e[1]-t[1];return[[t[0],t[1]+a*r[0]+i[0]],[e[0],e[1]-a*r[1]+i[1]]]}}df.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};let qR=class $R extends rs{constructor(t){super(In({style:$R.defaultStyleProps},t))}getKeyPath(t){const[e,r]=this.getEndpoints(t);return[["M",e[0],e[1]],["L",r[0],r[1]]]}};qR.defaultStyleProps={};const x$={enableObstacleAvoidance:!1,offset:10,maxAllowedDirectionChange:Math.PI/2,maximumLoops:3e3,gridSize:5,startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{right:{stepX:1,stepY:0},left:{stepX:-1,stepY:0},bottom:{stepX:0,stepY:1},top:{stepX:0,stepY:-1}},penalties:{0:0,90:0},distFunc:Mh},Ki=n=>`${Math.round(n[0])}|||${Math.round(n[1])}`;function Es(n,t){const e=r=>Math.round(r/t);return Lt(n)?e(n):n.map(e)}function E$(n,t){const e=Math.abs(n-t);return e>Math.PI?2*Math.PI-e:e}function C2(n,t){const e=t[0]-n[0],r=t[1]-n[1];return!e&&!r?0:Math.atan2(r,e)}function GR(n,t,e,r){const i=C2(n,t),a=e[Ki(n)],o=C2(a||r,n);return E$(o,i)}const S$=(n,t)=>{const{offset:e,gridSize:r}=t,i={};return n.forEach(a=>{if(!a||a.destroyed||!a.isVisible())return;const s=es(a.getRenderBounds(),e);for(let o=Es(s.min[0],r);o<=Es(s.max[0],r);o+=1)for(let l=Es(s.min[1],r);l<=Es(s.max[1],r);l+=1)i[`${o}|||${l}`]=!0}),i};function P2(n,t,e){return Math.min(...t.map(r=>e(n,r)))}function _$(n,t,e){let r=n[0],i=e(n[0],t);for(let a=0;a<n.length;a++){const s=n[a],o=e(s,t);o<i&&(r=s,i=o)}return r}const N2=(n,t,e,r)=>{if(!t)return[n];const{directionMap:i,offset:a}=r,s=es(t.getRenderBounds(),a),o=Object.keys(i).reduce((l,c)=>{if(e.includes(c)){const u=i[c],[h,f]=ts(s),d=[n[0]+u.stepX*h,n[1]+u.stepY*f],g=n9(s);for(let v=0;v<g.length;v++){const p=Lw([n,d],g[v]);p&&eR(p,s)&&l.push(p)}}return l},[]);return di(n,s)||o.push(n),o.map(l=>Es(l,r.gridSize))},M$=(n,t,e,r,i,a,s)=>{const o=[];let l=[a[0]===r[0]?r[0]:n[0]*s,a[1]===r[1]?r[1]:n[1]*s];o.unshift(l);let c=n,u=t[Ki(c)];for(;u;){const d=u,g=c;GR(d,g,t,e)&&(l=[d[0]===g[0]?l[0]:d[0]*s,d[1]===g[1]?l[1]:d[1]*s],o.unshift(l)),u=t[Ki(d)],c=d}const h=i.map(d=>[d[0]*s,d[1]*s]),f=_$(h,l,Mh);return o.unshift(f),o};function O$(n,t,e,r){const i=Fs(n.getCenter()),a=Fs(t.getCenter()),s=Object.assign(x$,r),{gridSize:o}=s,l=s.enableObstacleAvoidance?e:[n,t],c=S$(l,s),u=Es(i,o),h=Es(a,o),f=N2(i,n,s.startDirections,s),d=N2(a,t,s.endDirections,s);f.forEach(T=>delete c[Ki(T)]),d.forEach(T=>delete c[Ki(T)]);const g={},v={},p={},y={},m={},w=new T$;for(let T=0;T<f.length;T++){const C=f[T],P=Ki(C);g[P]=C,y[P]=0,m[P]=P2(C,d,s.distFunc),w.add({id:P,value:m[P]})}const E=d.map(T=>Ki(T));let S=s.maximumLoops,O,k=1/0;for(const[T,C]of Object.entries(g))m[T]<=k&&(k=m[T],O=C);for(;Object.keys(g).length>0&&S>0;){const T=w.minId(!1);if(T)O=g[T];else break;const C=Ki(O);if(E.includes(C))return M$(O,p,u,a,f,h,o);delete g[C],w.remove(C),v[C]=!0;for(const P of Object.values(s.directionMap)){const N=re(O,[P.stepX,P.stepY]),L=Ki(N);if(v[L])continue;const D=GR(O,N,p,u);if(D>s.maxAllowedDirectionChange||c[L])continue;g[L]||(g[L]=N);const G=s.penalties[D],H=s.distFunc(O,N)+(isNaN(G)?o:G),W=y[C]+H,q=y[L];q&&W>=q||(p[L]=O,y[L]=W,m[L]=W+P2(N,d,s.distFunc),w.add({id:L,value:m[L]}))}S-=1}return[]}class T${constructor(){this.arr=[],this.map={},this.arr=[],this.map={}}_innerAdd(t,e){let r=0,i=e-1;for(;i-r>1;){const a=Math.floor((r+i)/2);if(this.arr[a].value>t.value)i=a;else if(this.arr[a].value<t.value)r=a;else{this.arr.splice(a,0,t),this.map[t.id]=!0;return}}this.arr.splice(i,0,t),this.map[t.id]=!0}add(t){delete this.map[t.id];const e=this.arr.length;if(!e||this.arr[e-1].value<t.value){this.arr.push(t),this.map[t.id]=!0;return}this._innerAdd(t,e)}remove(t){this.map[t]&&delete this.map[t]}_clearAndGetMinId(){let t;for(let e=this.arr.length-1;e>=0;e--)this.map[this.arr[e].id]?t=this.arr[e].id:this.arr.splice(e,1);return t}_findFirstId(){for(;this.arr.length;){const t=this.arr.shift();if(this.map[t.id])return t.id}}minId(t){return t?this._clearAndGetMinId():this._findFirstId()}}class gf extends rs{constructor(t){super(In({style:gf.defaultStyleProps},t))}getControlPoints(t){const{router:e}=t,{sourceNode:r,targetNode:i}=this,[a,s]=this.getEndpoints(t,!1);let o=[];if(!e)o=t.controlPoints;else if(e.type==="shortest-path"){const l=this.context.element.getNodes();o=O$(r,i,l,e),o.length||(o=M2(a,s,r,i,t.controlPoints,{padding:e.offset}))}else e.type==="orth"&&(o=M2(a,s,r,i,t.controlPoints,e));return o}getPoints(t){const e=this.getControlPoints(t),[r,i]=this.getEndpoints(t,!0,e);return[r,...e,i]}getKeyPath(t){const e=this.getPoints(t);return qw(e,t.radius)}getLoopPath(t){const{sourcePort:e,targetPort:r,radius:i}=t,a=this.sourceNode,s=Pa(a),o=Math.max($i(s),Gi(s))/4,{placement:l,clockwise:c,dist:u=o}=yn(this.getGraphicStyle(t),"loop");return h$(a,i,l,c,u,e,r)}}gf.defaultStyleProps={radius:0,controlPoints:[],router:!1};class pf extends rs{constructor(t){super(In({style:pf.defaultStyleProps},t))}getKeyPath(t){const{curvePosition:e,curveOffset:r}=t,[i,a]=this.getEndpoints(t),s=t.controlPoint||mb(i,a,e,r);return s$(i,a,s)}}pf.defaultStyleProps={curvePosition:.5,curveOffset:30};var k$=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};function Ec(n){return n instanceof Qr&&n.type==="node"}function WR(n){return n instanceof rs}function $w(n){return n instanceof Bo}function A$(n){return Ec(n)||WR(n)||$w(n)}function C$(n,t){return!n||!t?!1:n===t}const P$={top:[.5,0],right:[1,.5],bottom:[.5,1],left:[0,.5],default:[.5,.5]};function Gw(n,t,e=P$,r=!0){const i=[.5,.5],a=me(t)?sr(e,t.toLocaleLowerCase(),i):t;if(!r&&me(t))return a;const[s,o]=a||i;return[n.min[0]+$i(n)*s,n.min[1]+Gi(n)*o]}function Ww(n){if(!n)return{};const t=n.getPorts();return(n.attributes.ports||[]).forEach((r,i)=>{var a;const{key:s,placement:o}=r;VR(r)&&(t[a=s||i]||(t[a]=ta(n.getShape("key").getBounds(),o)))}),t}function VR(n){const{r:t}=n;return!t||Number(t)===0}function Ya(n){return No(n)?n:n.getPosition()}function N$(n,t,e,r){const i=R2(n,t,e,r),a=R2(t,n,r,e);return[i,a]}function R2(n,t,e,r){const i=Ww(n);if(e)return i[e];const a=Object.values(i);if(a.length===0)return;const s=a.map(c=>Ya(c)),o=R$(t,r),[l]=L9(s,o);return a.find(c=>Ya(c)===l)}function R$(n,t){const e=Ww(n);if(t)return[Ya(e[t])];const r=Object.values(e);return r.length>0?r.map(i=>Ya(i)):[n.getCenter()]}function L2(n,t){return $w(n)||Ec(n)?wb(n,t):Jl(n,t)}function Jl(n,t){if(!n||!t)return[0,0,0];if(No(n))return n;if(n.attributes.linkToCenter)return n.getPosition();const e=No(t)?t:Ec(t)?t.getCenter():t.getPosition();return af(e,n.getBounds())}function wb(n,t){if(!n||!t)return[0,0,0];const e=No(t)?t:Ec(t)?t.getCenter():t.getPosition();return n.getIntersectPoint(e)||n.getCenter()}function I2(n,t="bottom",e=0,r=0,i=!1){const a=t.split("-"),[s,o]=ta(n,t),l=a.includes("left")?"right":a.includes("right")?"left":"center";let c=a.includes("top")?"bottom":a.includes("bottom")?"top":"middle";return i&&(c=c==="top"?"bottom":c==="bottom"?"top":c),{transform:[["translate",s+e,o+r]],textBaseline:c,textAlign:l}}function L$(n,t){return[[0,-n],[t*Math.cos(3*Math.PI/10),-t*Math.sin(3*Math.PI/10)],[n*Math.cos(Math.PI/10),-n*Math.sin(Math.PI/10)],[t*Math.cos(Math.PI/10),t*Math.sin(Math.PI/10)],[n*Math.cos(3*Math.PI/10),n*Math.sin(3*Math.PI/10)],[0,t],[-n*Math.cos(3*Math.PI/10),n*Math.sin(3*Math.PI/10)],[-t*Math.cos(Math.PI/10),t*Math.sin(Math.PI/10)],[-n*Math.cos(Math.PI/10),-n*Math.sin(Math.PI/10)],[-t*Math.cos(3*Math.PI/10),-t*Math.sin(3*Math.PI/10)]]}function I$(n,t){const e={};return e.top=[0,-n],e.left=[-n*Math.cos(Math.PI/10),-n*Math.sin(Math.PI/10)],e["left-bottom"]=[-n*Math.cos(3*Math.PI/10),n*Math.sin(3*Math.PI/10)],e.bottom=[0,t],e["right-bottom"]=[n*Math.cos(3*Math.PI/10),n*Math.sin(3*Math.PI/10)],e.right=e.default=[n*Math.cos(Math.PI/10),-n*Math.sin(Math.PI/10)],e}function D$(n,t,e){const r=t/2,i=n/2,a={up:[[-i,r],[i,r],[0,-r]],left:[[-i,0],[i,r],[i,-r]],right:[[-i,r],[-i,-r],[i,0]],down:[[-i,-r],[i,-r],[0,r]]};return a[e]||a.up}function F$(n,t,e){const r=t/2,i=n/2,a={};return e==="down"?(a.bottom=a.default=[0,r],a.right=[i,-r],a.left=[-i,-r]):e==="left"?(a.top=[i,-r],a.bottom=[i,r],a.left=a.default=[-i,0]):e==="right"?(a.top=[-i,-r],a.bottom=[-i,r],a.right=a.default=[i,0]):(a.left=[-i,r],a.top=a.default=[0,-r],a.right=[i,r]),a}function B$(n,t){return[[0,-t/2],[n/2,0],[0,t/2],[-n/2,0]]}function z$(n){return sr(n,["style","visibility"])!=="hidden"}function j$(n,t){const{zIndex:e,transform:r,transformOrigin:i,visibility:a,cursor:s,clipPath:o,component:l}=t,c=k$(t,["zIndex","transform","transformOrigin","visibility","cursor","clipPath","component"]);Object.assign(n.attributes,c),r&&n.setAttribute("transform",r),Lt(e)&&n.setAttribute("zIndex",e),i&&n.setAttribute("transformOrigin",i),a&&n.setAttribute("visibility",a),s&&n.setAttribute("cursor",s),o&&n.setAttribute("clipPath",o),l&&n.setAttribute("component",l)}function xb(n,t){"update"in n?n.update(t):n.attr(t)}function q$(n){return[[0,n],[n*Math.sqrt(3)/2,n/2],[n*Math.sqrt(3)/2,-n/2],[0,-n],[-n*Math.sqrt(3)/2,-n/2],[-n*Math.sqrt(3)/2,n/2]]}function $$(n){Wl(n,"__to_be_destroyed__",!0)}function vf(n){return sr(n,"__to_be_destroyed__",!1)}var G$=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(r.next(u))}catch(h){s(h)}}function l(u){try{c(r.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((r=r.apply(n,t||[])).next())})};class yf extends _r{constructor(t,e){super(t,Object.assign({},yf.defaultOptions,e)),this.onCollapseExpand=r=>G$(this,void 0,void 0,function*(){if(!this.validate(r))return;const{target:i}=r;if(!A$(i))return;const a=i.id,{model:s,graph:o}=this.context,l=s.getElementDataById(a);if(!l)return!1;const{onCollapse:c,onExpand:u,animation:h,align:f}=this.options;xr(l)?(yield o.expandElement(a,{animation:h,align:f}),u==null||u(a)):(yield o.collapseElement(a,{animation:h,align:f}),c==null||c(a))}),this.bindEvents()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;t.on(`node:${e}`,this.onCollapseExpand),t.on(`combo:${e}`,this.onCollapseExpand)}unbindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;t.off(`node:${e}`,this.onCollapseExpand),t.off(`combo:${e}`,this.onCollapseExpand)}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return zt(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}}yf.defaultOptions={enable:!0,animation:!0,trigger:st.DBLCLICK,align:!0};var _u=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(r.next(u))}catch(h){s(h)}}function l(u){try{c(r.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((r=r.apply(n,t||[])).next())})};const W$="g6-create-edge-assist-edge-id",Mu="g6-create-edge-assist-node-id";class mf extends _r{constructor(t,e){super(t,Object.assign({},mf.defaultOptions,e)),this.drop=r=>_u(this,void 0,void 0,function*(){const{targetType:i}=r;["combo","node"].includes(i)&&this.source?yield this.handleCreateEdge(r):yield this.cancelEdge()}),this.handleCreateEdge=r=>_u(this,void 0,void 0,function*(){var i,a,s;if(!this.validate(r))return;const{graph:o,canvas:l,batch:c,element:u}=this.context,{style:h}=this.options;if(this.source){this.createEdge(r),yield this.cancelEdge();return}c.startBatch(),l.setCursor("crosshair"),this.source=this.getSelectedNodeIDs([r.target.id])[0];const f=o.getElementData(this.source);o.addNodeData([{id:Mu,style:{visibility:"hidden",ports:[{key:"port-1",placement:[.5,.5]}],x:(i=f.style)===null||i===void 0?void 0:i.x,y:(a=f.style)===null||a===void 0?void 0:a.y}}]),o.addEdgeData([{id:W$,source:this.source,target:Mu,style:Object.assign({pointerEvents:"none"},h)}]),yield(s=u.draw({animation:!1}))===null||s===void 0?void 0:s.finished}),this.updateAssistEdge=r=>_u(this,void 0,void 0,function*(){var i;if(!this.source)return;const{model:a,element:s}=this.context;a.translateNodeTo(Mu,[r.canvas.x,r.canvas.y]),yield(i=s.draw({animation:!1,silence:!0}))===null||i===void 0?void 0:i.finished}),this.createEdge=r=>{var i,a;const{graph:s}=this.context,{style:o,onFinish:l,onCreate:c}=this.options;if(((i=r.target)===null||i===void 0?void 0:i.id)===void 0||this.source===void 0)return;const h=(a=this.getSelectedNodeIDs([r.target.id]))===null||a===void 0?void 0:a[0],f=`${this.source}-${h}-${kB()}`,d=c({id:f,source:this.source,target:h,style:o});s.addEdgeData([d]),l(d)},this.cancelEdge=()=>_u(this,void 0,void 0,function*(){var r;if(!this.source)return;const{graph:i,element:a,batch:s}=this.context;i.removeNodeData([Mu]),this.source=void 0,yield(r=a.draw({animation:!1}))===null||r===void 0?void 0:r.finished,s.endBatch()}),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;this.unbindEvents(),e==="click"?(t.on(Kr.CLICK,this.handleCreateEdge),t.on(ws.CLICK,this.handleCreateEdge),t.on(oa.CLICK,this.cancelEdge),t.on(Sh.CLICK,this.cancelEdge)):(t.on(Kr.DRAG_START,this.handleCreateEdge),t.on(ws.DRAG_START,this.handleCreateEdge),t.on(st.POINTER_UP,this.drop)),t.on(st.POINTER_MOVE,this.updateAssistEdge)}getSelectedNodeIDs(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(e=>e.id).concat(t)))}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return zt(e)?e(t):!!e}unbindEvents(){const{graph:t}=this.context;t.off(Kr.CLICK,this.handleCreateEdge),t.off(ws.CLICK,this.handleCreateEdge),t.off(oa.CLICK,this.cancelEdge),t.off(Sh.CLICK,this.cancelEdge),t.off(Kr.DRAG_START,this.handleCreateEdge),t.off(ws.DRAG_START,this.handleCreateEdge),t.off(st.POINTER_UP,this.drop),t.off(st.POINTER_MOVE,this.updateAssistEdge)}destroy(){this.unbindEvents(),super.destroy()}}mf.defaultOptions={animation:!0,enable:!0,style:{},trigger:"drag",onCreate:n=>n,onFinish:()=>{}};var D2=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(r.next(u))}catch(h){s(h)}}function l(u){try{c(r.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((r=r.apply(n,t||[])).next())})};class bf extends _r{constructor(t,e){super(t,Object.assign({},bf.defaultOptions,e)),this.isDragging=!1,this.onDragStart=r=>{this.validate(r)&&(this.isDragging=!0,this.context.canvas.setCursor("grabbing"))},this.onDrag=r=>{var i,a,s,o;if(!this.isDragging||un.isPinching)return;const l=(a=(i=r.movement)===null||i===void 0?void 0:i.x)!==null&&a!==void 0?a:r.dx,c=(o=(s=r.movement)===null||s===void 0?void 0:s.y)!==null&&o!==void 0?o:r.dy;(l|c)!==0&&this.translate([l,c],!1)},this.onDragEnd=()=>{var r,i;this.isDragging=!1,this.context.canvas.setCursor(this.defaultCursor),(i=(r=this.options).onFinish)===null||i===void 0||i.call(r)},this.invokeOnFinish=cc(()=>{var r,i;(i=(r=this.options).onFinish)===null||i===void 0||i.call(r)},300),this.shortcut=new Fo(t.graph),this.bindEvents(),this.defaultCursor=this.context.canvas.getConfig().cursor||"default"}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){const{trigger:t}=this.options;if(hn(t)){const{up:e=[],down:r=[],left:i=[],right:a=[]}=t;this.shortcut.bind(e,s=>this.onTranslate([0,1],s)),this.shortcut.bind(r,s=>this.onTranslate([0,-1],s)),this.shortcut.bind(i,s=>this.onTranslate([1,0],s)),this.shortcut.bind(a,s=>this.onTranslate([-1,0],s))}else{const{graph:e}=this.context;e.on(st.DRAG_START,this.onDragStart),e.on(st.DRAG,this.onDrag),e.on(st.DRAG_END,this.onDragEnd)}}onTranslate(t,e){return D2(this,void 0,void 0,function*(){if(!this.validate(e))return;const{sensitivity:r}=this.options,i=r*-1;yield this.translate(Qi(t,i),this.options.animation),this.invokeOnFinish()})}translate(t,e){return D2(this,void 0,void 0,function*(){t=this.clampByDirection(t),t=this.clampByRange(t),yield this.context.graph.translateBy(t,e)})}clampByDirection([t,e]){const{direction:r}=this.options;return r==="x"?e=0:r==="y"&&(t=0),[t,e]}clampByRange([t,e]){const{viewport:r,canvas:i}=this.context,[a,s]=i.getSize(),[o,l,c,u]=qi(this.options.range),h=[s*o,a*l,s*c,a*u],f=es(Aw(r.getCanvasCenter()),h),d=Me(r.getViewportCenter(),[t,e,0]);if(!di(d,f)){const{min:[g,v],max:[p,y]}=f;(d[0]<g&&t>0||d[0]>p&&t<0)&&(t=0),(d[1]<v&&e>0||d[1]>y&&e<0)&&(e=0)}return[t,e]}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return typeof e=="function"?e(t):!!e}unbindEvents(){this.shortcut.unbindAll();const{graph:t}=this.context;t.off(st.DRAG_START,this.onDragStart),t.off(st.DRAG,this.onDrag),t.off(st.DRAG_END,this.onDragEnd)}destroy(){this.shortcut.destroy(),this.unbindEvents(),this.context.canvas.setCursor(this.defaultCursor),super.destroy()}}bf.defaultOptions={enable:n=>"targetType"in n?n.targetType==="canvas":!0,sensitivity:10,direction:"both",range:1/0};var F2=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(r.next(u))}catch(h){s(h)}}function l(u){try{c(r.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((r=r.apply(n,t||[])).next())})};class Sc extends _r{constructor(t,e){super(t,Object.assign({},Sc.defaultOptions,e)),this.enable=!1,this.enableElements=["node","combo"],this.target=[],this.shadowOrigin=[0,0],this.hiddenEdges=[],this.isDragging=!1,this.onDrop=r=>F2(this,void 0,void 0,function*(){var i;if(this.options.dropEffect!=="link")return;const{model:a,element:s}=this.context,o=r.target.id;this.target.forEach(l=>{const c=a.getParentData(l,Oe);c&&tt(c)===o&&a.refreshComboData(o),a.setParent(l,o,Oe)}),yield(i=s==null?void 0:s.draw({animation:!0}))===null||i===void 0?void 0:i.finished}),this.setCursor=r=>{if(this.isDragging)return;const{type:i}=r,{canvas:a}=this.context,{cursor:s}=this.options;i===st.POINTER_ENTER?a.setCursor((s==null?void 0:s.grab)||"grab"):a.setCursor((s==null?void 0:s.default)||"default")},this.onDragStart=this.onDragStart.bind(this),this.onDrag=this.onDrag.bind(this),this.onDragEnd=this.onDragEnd.bind(this),this.onDrop=this.onDrop.bind(this),this.bindEvents()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){const{graph:t,canvas:e}=this.context,r=e.getLayer().getContextService().$canvas;r&&(r.addEventListener("blur",this.onDragEnd),r.addEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach(i=>{t.on(`${i}:${st.DRAG_START}`,this.onDragStart),t.on(`${i}:${st.DRAG}`,this.onDrag),t.on(`${i}:${st.DRAG_END}`,this.onDragEnd),t.on(`${i}:${st.POINTER_ENTER}`,this.setCursor),t.on(`${i}:${st.POINTER_LEAVE}`,this.setCursor)}),["link"].includes(this.options.dropEffect)&&(t.on(ws.DROP,this.onDrop),t.on(oa.DROP,this.onDrop))}getSelectedNodeIDs(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(e=>e.id).concat(t)))}getDelta(t){const e=this.context.graph.getZoom();return gi([t.dx,t.dy],e)}onDragStart(t){var e;if(this.enable=this.validate(t),!this.enable)return;const{batch:r,canvas:i,graph:a}=this.context;i.setCursor(((e=this.options.cursor)===null||e===void 0?void 0:e.grabbing)||"grabbing"),this.isDragging=!0,r.startBatch();const s=t.target.id;a.getElementState(s).includes(this.options.state)?this.target=this.getSelectedNodeIDs([s]):this.target=[s],this.hideEdge(),this.context.graph.frontElement(this.target),this.options.shadow&&this.createShadow(this.target)}onDrag(t){if(!this.enable)return;const e=this.getDelta(t);this.options.shadow?this.moveShadow(e):this.moveElement(this.target,e)}onDragEnd(){var t,e,r;if(this.enable=!1,this.options.shadow){if(!this.shadow)return;this.shadow.style.visibility="hidden";const{x:s=0,y:o=0}=this.shadow.attributes,[l,c]=Me([+s,+o],this.shadowOrigin);this.moveElement(this.target,[l,c])}this.showEdges(),(e=(t=this.options).onFinish)===null||e===void 0||e.call(t,this.target);const{batch:i,canvas:a}=this.context;i.endBatch(),a.setCursor(((r=this.options.cursor)===null||r===void 0?void 0:r.grab)||"grab"),this.isDragging=!1,this.target=[]}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return zt(e)?e(t):!!e}moveElement(t,e){return F2(this,void 0,void 0,function*(){const{graph:r,model:i}=this.context,{dropEffect:a}=this.options;a==="move"&&t.forEach(s=>i.refreshComboData(s)),r.translateElementBy(Object.fromEntries(t.map(s=>[s,e])),!1)})}moveShadow(t){if(!this.shadow)return;const{x:e=0,y:r=0}=this.shadow.attributes,[i,a]=t;this.shadow.attr({x:+e+i,y:+r+a})}createShadow(t){const e=yn(this.options,"shadow"),r=vc(t.map(c=>this.context.element.getElement(c).getBounds())),[i,a]=r.min;this.shadowOrigin=[i,a];const[s,o]=ts(r),l={width:s,height:o,x:i,y:a};this.shadow?this.shadow.attr(Object.assign(Object.assign(Object.assign({},e),l),{visibility:"visible"})):(this.shadow=new Rn({style:Object.assign(Object.assign(Object.assign({$layer:"transient"},e),l),{pointerEvents:"none"})}),this.context.canvas.appendChild(this.shadow))}showEdges(){this.options.shadow||this.hiddenEdges.length===0||(this.context.graph.showElement(this.hiddenEdges),this.hiddenEdges=[])}hideEdge(){const{hideEdge:t,shadow:e}=this.options;if(t==="none"||e)return;const{graph:r}=this.context;t==="all"?this.hiddenEdges=r.getEdgeData().map(tt):this.hiddenEdges=Array.from(new Set(this.target.map(i=>r.getRelatedEdgesData(i,t).map(tt)).flat())),r.hideElement(this.hiddenEdges)}unbindEvents(){const{graph:t,canvas:e}=this.context,r=e.getLayer().getContextService().$canvas;r&&(r.removeEventListener("blur",this.onDragEnd),r.removeEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach(i=>{t.off(`${i}:${st.DRAG_START}`,this.onDragStart),t.off(`${i}:${st.DRAG}`,this.onDrag),t.off(`${i}:${st.DRAG_END}`,this.onDragEnd),t.off(`${i}:${st.POINTER_ENTER}`,this.setCursor),t.off(`${i}:${st.POINTER_LEAVE}`,this.setCursor)}),t.off(`combo:${st.DROP}`,this.onDrop),t.off(`canvas:${st.DROP}`,this.onDrop)}destroy(){var t;this.unbindEvents(),(t=this.shadow)===null||t===void 0||t.destroy(),super.destroy()}}Sc.defaultOptions={animation:!0,enable:n=>["node","combo"].includes(n.targetType),dropEffect:"move",state:"selected",hideEdge:"none",shadow:!1,shadowZIndex:100,shadowFill:"#F3F9FF",shadowFillOpacity:.5,shadowStroke:"#1890FF",shadowStrokeOpacity:.9,shadowLineDash:[5,5],cursor:{default:"default",grab:"grab",grabbing:"grabbing"}};var V$="*",wf=function(){function n(){this._events={}}return n.prototype.on=function(t,e,r){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:e,once:!!r}),this},n.prototype.once=function(t,e){return this.on(t,e,!0)},n.prototype.emit=function(t){for(var e=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var a=this._events[t]||[],s=this._events[V$]||[],o=function(l){for(var c=l.length,u=0;u<c;u++)if(l[u]){var h=l[u],f=h.callback,d=h.once;d&&(l.splice(u,1),l.length===0&&delete e._events[t],c--,u--),f.apply(e,r)}};o(a),o(s)},n.prototype.off=function(t,e){if(!t)this._events={};else if(!e)delete this._events[t];else{for(var r=this._events[t]||[],i=r.length,a=0;a<i;a++)r[a].callback===e&&(r.splice(a,1),i--,a--);r.length===0&&delete this._events[t]}return this},n.prototype.getEvents=function(){return this._events},n}();function Eb(n,t,e,r){for(;n.length;){const i=n.shift();if(e(i))return!0;t.add(i.id),r(i.id).forEach(s=>{t.has(s.id)||(t.add(s.id),n.push(s))})}return!1}function Ph(n,t,e,r){if(e(n))return!0;t.add(n.id);for(const a of r(n.id))if(!t.has(a.id)&&Ph(a,t,e,r))return!0;return!1}const B2=()=>!0;class H${constructor(t){Ce(this,"graph");Ce(this,"nodeFilter");Ce(this,"edgeFilter");Ce(this,"cacheEnabled");Ce(this,"inEdgesMap",new Map);Ce(this,"outEdgesMap",new Map);Ce(this,"bothEdgesMap",new Map);Ce(this,"allNodesMap",new Map);Ce(this,"allEdgesMap",new Map);Ce(this,"clearCache",()=>{this.inEdgesMap.clear(),this.outEdgesMap.clear(),this.bothEdgesMap.clear(),this.allNodesMap.clear(),this.allEdgesMap.clear()});Ce(this,"refreshCache",()=>{this.clearCache(),this.updateCache(this.graph.getAllNodes().map(t=>t.id))});Ce(this,"updateCache",t=>{const e=new Set;t.forEach(r=>{const i=this.bothEdgesMap.get(r);if(i&&i.forEach(a=>e.add(a.id)),!this.hasNode(r))this.inEdgesMap.delete(r),this.outEdgesMap.delete(r),this.bothEdgesMap.delete(r),this.allNodesMap.delete(r);else{const a=this.graph.getRelatedEdges(r,"in").filter(this.edgeFilter),s=this.graph.getRelatedEdges(r,"out").filter(this.edgeFilter),o=Array.from(new Set([...a,...s]));o.forEach(l=>e.add(l.id)),this.inEdgesMap.set(r,a),this.outEdgesMap.set(r,s),this.bothEdgesMap.set(r,o),this.allNodesMap.set(r,this.graph.getNode(r))}}),e.forEach(r=>{this.hasEdge(r)?this.allEdgesMap.set(r,this.graph.getEdge(r)):this.allEdgesMap.delete(r)})});Ce(this,"handleGraphChanged",t=>{const e=new Set;t.changes.forEach(r=>{switch(r.type){case"NodeAdded":e.add(r.value.id);break;case"NodeDataUpdated":e.add(r.id);break;case"EdgeAdded":e.add(r.value.source),e.add(r.value.target);break;case"EdgeUpdated":(r.propertyName==="source"||r.propertyName==="target")&&(e.add(r.oldValue),e.add(r.newValue));break;case"EdgeDataUpdated":if(t.graph.hasEdge(r.id)){const i=t.graph.getEdge(r.id);e.add(i.source),e.add(i.target)}break;case"EdgeRemoved":e.add(r.value.source),e.add(r.value.target);break;case"NodeRemoved":e.add(r.value.id);break}}),this.updateCache(e)});this.graph=t.graph;const e=t.nodeFilter||B2,r=t.edgeFilter||B2;this.nodeFilter=e,this.edgeFilter=i=>{const{source:a,target:s}=this.graph.getEdgeDetail(i.id);return!e(a)||!e(s)?!1:r(i,a,s)},t.cache==="auto"?(this.cacheEnabled=!0,this.startAutoCache()):t.cache==="manual"?this.cacheEnabled=!0:this.cacheEnabled=!1}startAutoCache(){this.refreshCache(),this.graph.on("changed",this.handleGraphChanged)}stopAutoCache(){this.graph.off("changed",this.handleGraphChanged)}checkNodeExistence(t){this.getNode(t)}hasNode(t){if(!this.graph.hasNode(t))return!1;const e=this.graph.getNode(t);return this.nodeFilter(e)}areNeighbors(t,e){return this.checkNodeExistence(t),this.getNeighbors(e).some(r=>r.id===t)}getNode(t){const e=this.graph.getNode(t);if(!this.nodeFilter(e))throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){return this.checkNodeExistence(t),this.cacheEnabled?e==="in"?this.inEdgesMap.get(t):e==="out"?this.outEdgesMap.get(t):this.bothEdgesMap.get(t):this.graph.getRelatedEdges(t,e).filter(this.edgeFilter)}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const r=this.getRelatedEdges(t,"out").map(i=>this.getNode(i.target));return Array.from(new Set(r))}getPredecessors(t){const r=this.getRelatedEdges(t,"in").map(i=>this.getNode(i.source));return Array.from(new Set(r))}getNeighbors(t){const e=this.getPredecessors(t),r=this.getSuccessors(t);return Array.from(new Set([...e,...r]))}hasEdge(t){if(!this.graph.hasEdge(t))return!1;const e=this.graph.getEdge(t);return this.edgeFilter(e)}getEdge(t){const e=this.graph.getEdge(t);if(!this.edgeFilter(e))throw new Error("Edge not found for id: "+t);return e}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}hasTreeStructure(t){return this.graph.hasTreeStructure(t)}getRoots(t){return this.graph.getRoots(t).filter(this.nodeFilter)}getChildren(t,e){return this.checkNodeExistence(t),this.graph.getChildren(t,e).filter(this.nodeFilter)}getParent(t,e){this.checkNodeExistence(t);const r=this.graph.getParent(t,e);return!r||!this.nodeFilter(r)?null:r}getAllNodes(){return this.cacheEnabled?Array.from(this.allNodesMap.values()):this.graph.getAllNodes().filter(this.nodeFilter)}getAllEdges(){return this.cacheEnabled?Array.from(this.allEdgesMap.values()):this.graph.getAllEdges().filter(this.edgeFilter)}bfs(t,e,r="out"){const i={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];Eb([this.getNode(t)],new Set,e,i)}dfs(t,e,r="out"){const i={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];Ph(this.getNode(t),new Set,e,i)}}let kn=class HR extends wf{constructor(e){super();Ce(this,"nodeMap",new Map);Ce(this,"edgeMap",new Map);Ce(this,"inEdgesMap",new Map);Ce(this,"outEdgesMap",new Map);Ce(this,"bothEdgesMap",new Map);Ce(this,"treeIndices",new Map);Ce(this,"changes",[]);Ce(this,"batchCount",0);Ce(this,"onChanged",()=>{});Ce(this,"batch",e=>{this.batchCount+=1,e(),this.batchCount-=1,this.batchCount||this.commit()});e&&(e.nodes&&this.addNodes(e.nodes),e.edges&&this.addEdges(e.edges),e.tree&&this.addTree(e.tree),e.onChanged&&(this.onChanged=e.onChanged))}commit(){const e=this.changes;this.changes=[];const r={graph:this,changes:e};this.emit("changed",r),this.onChanged(r)}reduceChanges(e){let r=[];return e.forEach(i=>{switch(i.type){case"NodeRemoved":{let a=!1;r=r.filter(s=>{if(s.type==="NodeAdded"){const o=s.value.id===i.value.id;return o&&(a=!0),!o}else{if(s.type==="NodeDataUpdated")return s.id!==i.value.id;if(s.type==="TreeStructureChanged")return s.nodeId!==i.value.id}return!0}),a||r.push(i);break}case"EdgeRemoved":{let a=!1;r=r.filter(s=>{if(s.type==="EdgeAdded"){const o=s.value.id===i.value.id;return o&&(a=!0),!o}else if(s.type==="EdgeDataUpdated"||s.type==="EdgeUpdated")return s.id!==i.value.id;return!0}),a||r.push(i);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const a=r.findIndex(o=>o.type===i.type&&o.id===i.id&&(i.propertyName===void 0||o.propertyName===i.propertyName)),s=r[a];s?i.propertyName!==void 0?s.newValue=i.newValue:(r.splice(a,1),r.push(i)):r.push(i);break}case"TreeStructureDetached":{r=r.filter(a=>a.type==="TreeStructureAttached"||a.type==="TreeStructureChanged"?a.treeKey!==i.treeKey:!0),r.push(i);break}case"TreeStructureChanged":{const a=r.find(s=>s.type==="TreeStructureChanged"&&s.treeKey===i.treeKey&&s.nodeId===i.nodeId);a?a.newParentId=i.newParentId:r.push(i);break}default:r.push(i);break}}),r}checkNodeExistence(e){this.getNode(e)}hasNode(e){return this.nodeMap.has(e)}areNeighbors(e,r){return this.getNeighbors(r).some(i=>i.id===e)}getNode(e){const r=this.nodeMap.get(e);if(!r)throw new Error("Node not found for id: "+e);return r}getRelatedEdges(e,r){if(this.checkNodeExistence(e),r==="in"){const i=this.inEdgesMap.get(e);return Array.from(i)}else if(r==="out"){const i=this.outEdgesMap.get(e);return Array.from(i)}else{const i=this.bothEdgesMap.get(e);return Array.from(i)}}getDegree(e,r){return this.getRelatedEdges(e,r).length}getSuccessors(e){const i=this.getRelatedEdges(e,"out").map(a=>this.getNode(a.target));return Array.from(new Set(i))}getPredecessors(e){const i=this.getRelatedEdges(e,"in").map(a=>this.getNode(a.source));return Array.from(new Set(i))}getNeighbors(e){const r=this.getPredecessors(e),i=this.getSuccessors(e);return Array.from(new Set([...r,...i]))}doAddNode(e){if(this.hasNode(e.id))throw new Error("Node already exists: "+e.id);this.nodeMap.set(e.id,e),this.inEdgesMap.set(e.id,new Set),this.outEdgesMap.set(e.id,new Set),this.bothEdgesMap.set(e.id,new Set),this.treeIndices.forEach(r=>{r.childrenMap.set(e.id,new Set)}),this.changes.push({type:"NodeAdded",value:e})}addNodes(e){this.batch(()=>{for(const r of e)this.doAddNode(r)})}addNode(e){this.addNodes([e])}doRemoveNode(e){const r=this.getNode(e),i=this.bothEdgesMap.get(e);i==null||i.forEach(a=>this.doRemoveEdge(a.id)),this.nodeMap.delete(e),this.treeIndices.forEach(a=>{var o,l;(o=a.childrenMap.get(e))==null||o.forEach(c=>{a.parentMap.delete(c.id)});const s=a.parentMap.get(e);s&&((l=a.childrenMap.get(s.id))==null||l.delete(r)),a.parentMap.delete(e),a.childrenMap.delete(e)}),this.bothEdgesMap.delete(e),this.inEdgesMap.delete(e),this.outEdgesMap.delete(e),this.changes.push({type:"NodeRemoved",value:r})}removeNodes(e){this.batch(()=>{e.forEach(r=>this.doRemoveNode(r))})}removeNode(e){this.removeNodes([e])}updateNodeDataProperty(e,r,i){const a=this.getNode(e);this.batch(()=>{const s=a.data[r],o=i;a.data[r]=o,this.changes.push({type:"NodeDataUpdated",id:e,propertyName:r,oldValue:s,newValue:o})})}mergeNodeData(e,r){this.batch(()=>{Object.entries(r).forEach(([i,a])=>{this.updateNodeDataProperty(e,i,a)})})}updateNodeData(...e){const r=e[0],i=this.getNode(r);if(typeof e[1]=="string"){this.updateNodeDataProperty(r,e[1],e[2]);return}let a;if(typeof e[1]=="function"){const s=e[1];a=s(i.data)}else typeof e[1]=="object"&&(a=e[1]);this.batch(()=>{const s=i.data,o=a;i.data=a,this.changes.push({type:"NodeDataUpdated",id:r,oldValue:s,newValue:o})})}checkEdgeExistence(e){if(!this.hasEdge(e))throw new Error("Edge not found for id: "+e)}hasEdge(e){return this.edgeMap.has(e)}getEdge(e){return this.checkEdgeExistence(e),this.edgeMap.get(e)}getEdgeDetail(e){const r=this.getEdge(e);return{edge:r,source:this.getNode(r.source),target:this.getNode(r.target)}}doAddEdge(e){if(this.hasEdge(e.id))throw new Error("Edge already exists: "+e.id);this.checkNodeExistence(e.source),this.checkNodeExistence(e.target),this.edgeMap.set(e.id,e);const r=this.inEdgesMap.get(e.target),i=this.outEdgesMap.get(e.source),a=this.bothEdgesMap.get(e.source),s=this.bothEdgesMap.get(e.target);r.add(e),i.add(e),a.add(e),s.add(e),this.changes.push({type:"EdgeAdded",value:e})}addEdges(e){this.batch(()=>{for(const r of e)this.doAddEdge(r)})}addEdge(e){this.addEdges([e])}doRemoveEdge(e){const r=this.getEdge(e),i=this.outEdgesMap.get(r.source),a=this.inEdgesMap.get(r.target),s=this.bothEdgesMap.get(r.source),o=this.bothEdgesMap.get(r.target);i.delete(r),a.delete(r),s.delete(r),o.delete(r),this.edgeMap.delete(e),this.changes.push({type:"EdgeRemoved",value:r})}removeEdges(e){this.batch(()=>{e.forEach(r=>this.doRemoveEdge(r))})}removeEdge(e){this.removeEdges([e])}updateEdgeSource(e,r){const i=this.getEdge(e);this.checkNodeExistence(r);const a=i.source,s=r;this.outEdgesMap.get(a).delete(i),this.bothEdgesMap.get(a).delete(i),this.outEdgesMap.get(s).add(i),this.bothEdgesMap.get(s).add(i),i.source=r,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:e,propertyName:"source",oldValue:a,newValue:s})})}updateEdgeTarget(e,r){const i=this.getEdge(e);this.checkNodeExistence(r);const a=i.target,s=r;this.inEdgesMap.get(a).delete(i),this.bothEdgesMap.get(a).delete(i),this.inEdgesMap.get(s).add(i),this.bothEdgesMap.get(s).add(i),i.target=r,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:e,propertyName:"target",oldValue:a,newValue:s})})}updateEdgeDataProperty(e,r,i){const a=this.getEdge(e);this.batch(()=>{const s=a.data[r],o=i;a.data[r]=o,this.changes.push({type:"EdgeDataUpdated",id:e,propertyName:r,oldValue:s,newValue:o})})}updateEdgeData(...e){const r=e[0],i=this.getEdge(r);if(typeof e[1]=="string"){this.updateEdgeDataProperty(r,e[1],e[2]);return}let a;if(typeof e[1]=="function"){const s=e[1];a=s(i.data)}else typeof e[1]=="object"&&(a=e[1]);this.batch(()=>{const s=i.data,o=a;i.data=a,this.changes.push({type:"EdgeDataUpdated",id:r,oldValue:s,newValue:o})})}mergeEdgeData(e,r){this.batch(()=>{Object.entries(r).forEach(([i,a])=>{this.updateEdgeDataProperty(e,i,a)})})}checkTreeExistence(e){if(!this.hasTreeStructure(e))throw new Error("Tree structure not found for treeKey: "+e)}hasTreeStructure(e){return this.treeIndices.has(e)}attachTreeStructure(e){this.treeIndices.has(e)||(this.treeIndices.set(e,{parentMap:new Map,childrenMap:new Map}),this.batch(()=>{this.changes.push({type:"TreeStructureAttached",treeKey:e})}))}detachTreeStructure(e){this.checkTreeExistence(e),this.treeIndices.delete(e),this.batch(()=>{this.changes.push({type:"TreeStructureDetached",treeKey:e})})}addTree(e,r){this.batch(()=>{this.attachTreeStructure(r);const i=[],a=Array.isArray(e)?e:[e];for(;a.length;){const s=a.shift();i.push(s),s.children&&a.push(...s.children)}this.addNodes(i),i.forEach(s=>{var o;(o=s.children)==null||o.forEach(l=>{this.setParent(l.id,s.id,r)})})})}getRoots(e){return this.checkTreeExistence(e),this.getAllNodes().filter(r=>!this.getParent(r.id,e))}getChildren(e,r){this.checkNodeExistence(e),this.checkTreeExistence(r);const a=this.treeIndices.get(r).childrenMap.get(e);return Array.from(a||[])}getParent(e,r){return this.checkNodeExistence(e),this.checkTreeExistence(r),this.treeIndices.get(r).parentMap.get(e)||null}getAncestors(e,r){const i=[];let a=this.getNode(e),s;for(;s=this.getParent(a.id,r);)i.push(s),a=s;return i}setParent(e,r,i){var u,h;this.checkTreeExistence(i);const a=this.treeIndices.get(i);if(!a)return;const s=this.getNode(e),o=a.parentMap.get(e);if((o==null?void 0:o.id)===r)return;if(r==null){o&&((u=a.childrenMap.get(o.id))==null||u.delete(s)),a.parentMap.delete(e);return}const l=this.getNode(r);a.parentMap.set(e,l),o&&((h=a.childrenMap.get(o.id))==null||h.delete(s));let c=a.childrenMap.get(l.id);c||(c=new Set,a.childrenMap.set(l.id,c)),c.add(s),this.batch(()=>{this.changes.push({type:"TreeStructureChanged",treeKey:i,nodeId:e,oldParentId:o==null?void 0:o.id,newParentId:l.id})})}dfsTree(e,r,i){const a=s=>this.getChildren(s,i);return Ph(this.getNode(e),new Set,r,a)}bfsTree(e,r,i){const a=s=>this.getChildren(s,i);return Eb([this.getNode(e)],new Set,r,a)}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(e,r,i="out"){const a={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[i];return Eb([this.getNode(e)],new Set,r,a)}dfs(e,r,i="out"){const a={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[i];return Ph(this.getNode(e),new Set,r,a)}clone(){const e=this.getAllNodes().map(a=>({...a,data:{...a.data}})),r=this.getAllEdges().map(a=>({...a,data:{...a.data}})),i=new HR({nodes:e,edges:r});return this.treeIndices.forEach(({parentMap:a,childrenMap:s},o)=>{const l=new Map;a.forEach((u,h)=>{l.set(h,i.getNode(u.id))});const c=new Map;s.forEach((u,h)=>{c.set(h,new Set(Array.from(u).map(f=>i.getNode(f.id))))}),i.treeIndices.set(o,{parentMap:l,childrenMap:c})}),i}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}createView(e){return new H$({graph:this,...e})}};class xf{constructor(t,e){this.context=t,this.options=e||{}}}var U$=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(r.next(u))}catch(h){s(h)}}function l(u){try{c(r.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((r=r.apply(n,t||[])).next())})},Y$=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};function X$(n){const{type:t}=n;return["compact-box","mindmap","dendrogram","indented"].includes(t)}function K$(n){return!Array.isArray(n)&&(n==null?void 0:n.preLayout)}function Hu(n){const{nodes:t,edges:e}=n,r={nodes:[],edges:[],combos:[]};return t.forEach(i=>{const a=i.data._isCombo?r.combos:r.nodes,{x:s,y:o,z:l=0}=i.data;a==null||a.push({id:i.id,style:{x:s,y:o,z:l}})}),e.forEach(i=>{const{id:a,source:s,target:o,data:{points:l=[],controlPoints:c=l.slice(1,l.length-1)}}=i;r.edges.push({id:a,source:s,target:o,style:Object.assign({},c!=null&&c.length?{controlPoints:c.map(jn)}:{})})}),r}function Z$(n,t){class e extends xf{constructor(i,a){if(super(i,a),this.instance=new n({}),this.id=this.instance.id,"stop"in this.instance&&"tick"in this.instance){const s=this.instance;this.stop=s.stop.bind(s),this.tick=o=>{const l=s.tick(o);return Hu(l)}}}execute(i,a){return U$(this,void 0,void 0,function*(){return Hu(yield this.instance.execute(this.graphData2LayoutModel(i),this.transformOptions(fr({},this.options,a))))})}transformOptions(i){const{onTick:a}=i;return a&&(i.onTick=s=>a(Hu(s))),i}graphData2LayoutModel(i){const{nodes:a=[],edges:s=[],combos:o=[]}=i,l=a.map(d=>{const g=tt(d),{data:v,style:p,combo:y}=d,m=Y$(d,["data","style","combo"]),w={id:g,data:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},v),{data:v}),y?{parentId:y}:{}),{style:p}),m)};return p!=null&&p.x&&Object.assign(w.data,{x:p.x}),p!=null&&p.y&&Object.assign(w.data,{y:p.y}),p!=null&&p.z&&Object.assign(w.data,{z:p.z}),w}),c=new Map(l.map(d=>[d.id,d])),u=s.filter(d=>{const{source:g,target:v}=d;return c.has(g)&&c.has(v)}).map(d=>{const{source:g,target:v,data:p,style:y}=d;return{id:tt(d),source:g,target:v,data:Object.assign({},p),style:Object.assign({},y)}}),h=o.map(d=>({id:tt(d),data:Object.assign({_isCombo:!0},d.data),style:Object.assign({},d.style)})),f=new kn({nodes:[...l,...h],edges:u});return t.model.model.hasTreeStructure(Oe)&&(f.attachTreeStructure(Oe),l.forEach(d=>{const g=t.model.model.getParent(d.id,Oe);g&&f.hasNode(g.id)&&f.setParent(d.id,g.id,Oe)})),f}}return e}function mg(n,t,...e){if(t in n)return n[t](...e);if("instance"in n){const r=n.instance;if(t in r)return r[t](...e)}return null}function z2(n,t){if(t in n)return n[t];if("instance"in n){const e=n.instance;if(t in e)return e[t]}return null}var J$=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(r.next(u))}catch(h){s(h)}}function l(u){try{c(r.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((r=r.apply(n,t||[])).next())})};class Q$ extends Sc{get forceLayoutInstance(){return this.context.layout.getLayoutInstance().find(t=>["d3-force","d3-force-3d"].includes(t==null?void 0:t.id))}validate(t){return this.context.layout?this.forceLayoutInstance?super.validate(t):(ji.warn("DragElementForce only works with d3-force or d3-force-3d layout"),!1):!1}moveElement(t,e){return J$(this,void 0,void 0,function*(){const r=this.forceLayoutInstance;this.context.graph.getNodeData(t).forEach((i,a)=>{const{x:s=0,y:o=0}=i.style||{};r&&mg(r,"setFixedPosition",t[a],[...re([+s,+o],e)])})})}onDragStart(t){if(this.enable=this.validate(t),!this.enable)return;this.target=this.getSelectedNodeIDs([t.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target);const e=this.forceLayoutInstance;e&&z2(e,"simulation").alphaTarget(.3).restart(),this.context.graph.getNodeData(this.target).forEach(r=>{const{x:i=0,y:a=0}=r.style||{};e&&mg(e,"setFixedPosition",tt(r),[+i,+a])})}onDrag(t){if(!this.enable)return;const e=this.getDelta(t);this.moveElement(this.target,e)}onDragEnd(){const t=this.forceLayoutInstance;t&&z2(t,"simulation").alphaTarget(0),!this.options.fixed&&this.context.graph.getNodeData(this.target).forEach(e=>{t&&mg(t,"setFixedPosition",tt(e),[null,null,null])})}}var j2=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(r.next(u))}catch(h){s(h)}}function l(u){try{c(r.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((r=r.apply(n,t||[])).next())})};class Ef extends _r{constructor(t,e){super(t,Object.assign({},Ef.defaultOptions,e)),this.isZoomEvent=r=>!!(r.data&&"scale"in r.data),this.relatedEdgeToUpdate=new Set,this.zoom=this.context.graph.getZoom(),this.fixElementSize=r=>j2(this,void 0,void 0,function*(){if(!this.validate(r))return;const{graph:i}=this.context,{state:a,nodeFilter:s,edgeFilter:o,comboFilter:l}=this.options,c=(a?i.getElementDataByState("node",a):i.getNodeData()).filter(s),u=(a?i.getElementDataByState("edge",a):i.getEdgeData()).filter(o),h=(a?i.getElementDataByState("combo",a):i.getComboData()).filter(l),f=this.isZoomEvent(r)?this.zoom=Math.max(.01,Math.min(r.data.scale,10)):this.zoom,d=[...c,...h];d.length>0&&d.forEach(g=>this.fixNodeLike(g,f)),this.updateRelatedEdges(),u.length>0&&u.forEach(g=>this.fixEdge(g,f))}),this.cachedStyles=new Map,this.getOriginalFieldValue=(r,i,a)=>{var s;const o=this.cachedStyles.get(r)||[],l=((s=o.find(c=>c.shape===i))===null||s===void 0?void 0:s.style)||{};return a in l||(l[a]=i.attributes[a],this.cachedStyles.set(r,[...o.filter(c=>c.shape!==i),{shape:i,style:l}])),l[a]},this.scaleEntireElement=(r,i,a)=>{i.setLocalScale(1/a);const s=this.cachedStyles.get(r)||[];s.push({shape:i}),this.cachedStyles.set(r,s)},this.scaleSpecificShapes=(r,i,a)=>{const s=J9(r);(Array.isArray(a)?a:[a]).forEach(l=>{const{shape:c,fields:u}=l,h=typeof c=="function"?c(s):r.getShape(c);if(h){if(!u){this.scaleEntireElement(r.id,h,i);return}u.forEach(f=>{const d=this.getOriginalFieldValue(r.id,h,f);Lt(d)&&(h.style[f]=d/i)})}})},this.skipIfExceedViewport=r=>{const{viewport:i}=this.context;return!(i!=null&&i.isInViewport(r.getRenderBounds(),!1,30))},this.fixNodeLike=(r,i)=>{const a=tt(r),{element:s,model:o}=this.context,l=s.getElement(a);if(!l||this.skipIfExceedViewport(l))return;o.getRelatedEdgesData(a).forEach(h=>this.relatedEdgeToUpdate.add(tt(h)));const u=this.options[l.type];if(!u){this.scaleEntireElement(a,l,i);return}this.scaleSpecificShapes(l,i,u)},this.fixEdge=(r,i)=>{const a=tt(r),s=this.context.element.getElement(a);if(!s||this.skipIfExceedViewport(s))return;const o=this.options.edge;if(!o){s.style.transformOrigin="center",this.scaleEntireElement(a,s,i);return}this.scaleSpecificShapes(s,i,o)},this.updateRelatedEdges=()=>{const{element:r}=this.context;this.relatedEdgeToUpdate.size>0&&this.relatedEdgeToUpdate.forEach(i=>{const a=r.getElement(i);a==null||a.update({})}),this.relatedEdgeToUpdate.clear()},this.resetTransform=r=>j2(this,void 0,void 0,function*(){var i;!((i=r.data)===null||i===void 0)&&i.firstRender||(this.options.reset?this.restoreCachedStyles():this.fixElementSize({data:{scale:this.zoom}}))}),this.bindEvents()}restoreCachedStyles(){if(this.cachedStyles.size>0){this.cachedStyles.forEach(i=>{i.forEach(({shape:a,style:s})=>{if(Ti(s))a.setLocalScale(1);else{if(this.options.state)return;Object.entries(s).forEach(([o,l])=>a.style[o]=l)}})});const{graph:t,element:e}=this.context,r=Object.keys(Object.fromEntries(this.cachedStyles)).filter(i=>i&&t.getElementType(i)==="node");if(r.length>0){const i=new Set;r.forEach(a=>{t.getRelatedEdgesData(a).forEach(s=>i.add(tt(s)))}),i.forEach(a=>{const s=e==null?void 0:e.getElement(a);s==null||s.update({})})}}}bindEvents(){const{graph:t}=this.context;t.on(Mt.AFTER_DRAW,this.resetTransform),t.on(Mt.AFTER_TRANSFORM,this.fixElementSize)}unbindEvents(){const{graph:t}=this.context;t.off(Mt.AFTER_DRAW,this.resetTransform),t.off(Mt.AFTER_TRANSFORM,this.fixElementSize)}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return zt(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}}Ef.defaultOptions={enable:n=>n.data.scale<1,nodeFilter:()=>!0,edgeFilter:()=>!0,comboFilter:()=>!0,edge:[{shape:"key",fields:["lineWidth"]},{shape:"halo",fields:["lineWidth"]},{shape:"label"}],reset:!1};var tG=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(r.next(u))}catch(h){s(h)}}function l(u){try{c(r.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((r=r.apply(n,t||[])).next())})};class Sf extends _r{constructor(t,e){super(t,Object.assign({},Sf.defaultOptions,e)),this.focus=r=>tG(this,void 0,void 0,function*(){if(!this.validate(r))return;const{graph:i}=this.context;yield i.focusElement(r.target.id,this.options.animation)}),this.bindEvents()}bindEvents(){const{graph:t}=this.context;this.unbindEvents(),Bs.forEach(e=>{t.on(`${e}:${st.CLICK}`,this.focus)})}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return zt(e)?e(t):!!e}unbindEvents(){const{graph:t}=this.context;Bs.forEach(e=>{t.off(`${e}:${st.CLICK}`,this.focus)})}destroy(){this.unbindEvents(),super.destroy()}}Sf.defaultOptions={animation:{easing:"ease-in",duration:500},enable:!0};class _f extends _r{constructor(t,e){super(t,Object.assign({},_f.defaultOptions,e)),this.isFrozen=!1,this.toggleFrozen=r=>{this.isFrozen=r.type==="dragstart"},this.hoverElement=r=>{if(!this.validate(r))return;const i=r.type===st.POINTER_ENTER;this.updateElementsState(r,i);const{onHover:a,onHoverEnd:s}=this.options;i?a==null||a(r):s==null||s(r)},this.updateElementsState=(r,i)=>{if(!this.options.state&&!this.options.inactiveState)return;const{graph:a}=this.context,{state:s,animation:o,inactiveState:l}=this.options,c=this.getActiveIds(r),u={};if(s&&Object.assign(u,this.getElementsState(c,s,i)),l){const h=sR(a.getData(),!0).filter(f=>!c.includes(f));Object.assign(u,this.getElementsState(h,l,i))}a.setElementState(u,o)},this.getElementsState=(r,i,a)=>{const{graph:s}=this.context,o={};return r.forEach(l=>{const c=s.getElementState(l);a?o[l]=c.includes(i)?c:[...c,i]:o[l]=c.filter(u=>u!==i)}),o},this.bindEvents()}bindEvents(){const{graph:t}=this.context;this.unbindEvents(),Bs.forEach(r=>{t.on(`${r}:${st.POINTER_ENTER}`,this.hoverElement),t.on(`${r}:${st.POINTER_LEAVE}`,this.hoverElement)});const e=this.context.canvas.document;e.addEventListener(`${st.DRAG_START}`,this.toggleFrozen),e.addEventListener(`${st.DRAG_END}`,this.toggleFrozen)}getActiveIds(t){const{graph:e}=this.context,{degree:r,direction:i}=this.options,a=t.target.id;return r?yR(e,t.targetType,a,typeof r=="function"?r(t):r,i):[a]}validate(t){if(this.destroyed||this.isFrozen||vf(t.target)||this.context.graph.isCollapsingExpanding)return!1;const{enable:e}=this.options;return zt(e)?e(t):!!e}unbindEvents(){const{graph:t}=this.context;Bs.forEach(r=>{t.off(`${r}:${st.POINTER_ENTER}`,this.hoverElement),t.off(`${r}:${st.POINTER_LEAVE}`,this.hoverElement)});const e=this.context.canvas.document;e.removeEventListener(`${st.DRAG_START}`,this.toggleFrozen),e.removeEventListener(`${st.DRAG_END}`,this.toggleFrozen)}destroy(){this.unbindEvents(),super.destroy()}}_f.defaultOptions={animation:!1,enable:!0,degree:0,direction:"both",state:"active",inactiveState:void 0};class eG extends yc{onPointerDown(t){if(!super.validate(t)||!super.isKeydown()||this.points)return;const{canvas:e}=this.context;this.pathShape=new Fr({id:"g6-lasso-select",style:this.options.style}),e.appendChild(this.pathShape),this.points=[Oh(t)]}onPointerMove(t){var e;if(!this.points)return;const{immediately:r,mode:i}=this.options;this.points.push(Oh(t)),(e=this.pathShape)===null||e===void 0||e.setAttribute("d",U9(this.points)),r&&i==="default"&&this.points.length>2&&super.updateElementsStates(this.points)}onPointerUp(){if(this.points){if(this.points.length<2){this.clearLasso();return}super.updateElementsStates(this.points),this.clearLasso()}}clearLasso(){var t;(t=this.pathShape)===null||t===void 0||t.remove(),this.pathShape=void 0,this.points=void 0}}class Mf extends _r{constructor(t,e){super(t,Object.assign({},Mf.defaultOptions,e)),this.hiddenShapes=[],this.isVisible=!0,this.setElementsVisibility=(r,i,a)=>{r.filter(Boolean).forEach(s=>{i==="hidden"&&!s.isVisible()?this.hiddenShapes.push(s):i==="visible"&&this.hiddenShapes.includes(s)?this.hiddenShapes.splice(this.hiddenShapes.indexOf(s),1):Ds(s,i,a)})},this.filterShapes=(r,i)=>{if(zt(i))return s=>!i(r,s);const a=i==null?void 0:i[r];return s=>s.className?!(a!=null&&a.includes(s.className)):!0},this.hideShapes=r=>{if(!this.validate(r)||!this.isVisible)return;const{element:i}=this.context,{shapes:a={}}=this.options;this.setElementsVisibility(i.getNodes(),"hidden",this.filterShapes("node",a)),this.setElementsVisibility(i.getEdges(),"hidden",this.filterShapes("edge",a)),this.setElementsVisibility(i.getCombos(),"hidden",this.filterShapes("combo",a)),this.isVisible=!1},this.showShapes=cc(r=>{if(!this.validate(r)||this.isVisible)return;const{element:i}=this.context;this.setElementsVisibility(i.getNodes(),"visible"),this.setElementsVisibility(i.getEdges(),"visible"),this.setElementsVisibility(i.getCombos(),"visible"),this.isVisible=!0},this.options.debounce),this.bindEvents()}bindEvents(){const{graph:t}=this.context;t.on(Mt.BEFORE_TRANSFORM,this.hideShapes),t.on(Mt.AFTER_TRANSFORM,this.showShapes)}unbindEvents(){const{graph:t}=this.context;t.off(Mt.BEFORE_TRANSFORM,this.hideShapes),t.off(Mt.AFTER_TRANSFORM,this.showShapes)}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return zt(e)?e(t):!!e}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}}Mf.defaultOptions={enable:!0,debounce:200,shapes:n=>n==="node"};var q2=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(r.next(u))}catch(h){s(h)}}function l(u){try{c(r.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((r=r.apply(n,t||[])).next())})};class Of extends _r{constructor(t,e){super(t,Object.assign({},Of.defaultOptions,e)),this.onWheel=r=>q2(this,void 0,void 0,function*(){this.options.preventDefault&&r.preventDefault();const i=r.deltaX,a=r.deltaY;yield this.scroll([-i,-a],r)}),this.shortcut=new Fo(t.graph),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){var t,e;const{trigger:r}=this.options;if(this.shortcut.unbindAll(),hn(r)){(t=this.graphDom)===null||t===void 0||t.removeEventListener(st.WHEEL,this.onWheel);const{up:i=[],down:a=[],left:s=[],right:o=[]}=r;this.shortcut.bind(i,l=>this.scroll([0,-10],l)),this.shortcut.bind(a,l=>this.scroll([0,10],l)),this.shortcut.bind(s,l=>this.scroll([-10,0],l)),this.shortcut.bind(o,l=>this.scroll([10,0],l))}else(e=this.graphDom)===null||e===void 0||e.addEventListener(st.WHEEL,this.onWheel,{passive:!1})}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}formatDisplacement(t){const{sensitivity:e}=this.options;return t=Qi(t,e),t=this.clampByDirection(t),t=this.clampByRange(t),t}clampByDirection([t,e]){const{direction:r}=this.options;return r==="x"?e=0:r==="y"&&(t=0),[t,e]}clampByRange([t,e]){const{viewport:r,canvas:i}=this.context,[a,s]=i.getSize(),[o,l,c,u]=qi(this.options.range),h=[s*o,a*l,s*c,a*u],f=es(Aw(r.getCanvasCenter()),h),d=Me(r.getViewportCenter(),[t,e,0]);if(!di(d,f)){const{min:[g,v],max:[p,y]}=f;(d[0]<g&&t>0||d[0]>p&&t<0)&&(t=0),(d[1]<v&&e>0||d[1]>y&&e<0)&&(e=0)}return[t,e]}scroll(t,e){return q2(this,void 0,void 0,function*(){if(!this.validate(e))return;const{onFinish:r}=this.options,i=this.context.graph,a=this.formatDisplacement(t);yield i.translateBy(a,!1),r==null||r()})}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return zt(e)?e(t):!!e}destroy(){var t;this.shortcut.destroy(),(t=this.graphDom)===null||t===void 0||t.removeEventListener(st.WHEEL,this.onWheel),super.destroy()}}Of.defaultOptions={enable:!0,sensitivity:1,preventDefault:!0,range:1/0};var $2=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(r.next(u))}catch(h){s(h)}}function l(u){try{c(r.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((r=r.apply(n,t||[])).next())})};class Tf extends _r{constructor(t,e){super(t,Object.assign({},Tf.defaultOptions,e)),this.zoom=(r,i,a)=>$2(this,void 0,void 0,function*(){if(!this.validate(i))return;const{graph:s}=this.context;let o;"viewport"in i&&(o=jn(i.viewport));const{sensitivity:l,onFinish:c}=this.options,u=1+tn(r,-50,50)*l/100,h=s.getZoom();yield s.zoomTo(h*u,a,o),c==null||c()}),this.onReset=()=>$2(this,void 0,void 0,function*(){yield this.context.graph.zoomTo(1,this.options.animation)}),this.preventDefault=r=>{this.options.preventDefault&&r.preventDefault()},this.shortcut=new Fo(t.graph),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){const{trigger:t}=this.options;if(this.shortcut.unbindAll(),Array.isArray(t))if(t.includes(st.PINCH))this.shortcut.bind([st.PINCH],e=>{this.zoom(e.scale,e,!1)});else{const e=this.context.canvas.getContainer();e==null||e.addEventListener(st.WHEEL,this.preventDefault),this.shortcut.bind([...t,st.WHEEL],r=>{const{deltaX:i,deltaY:a}=r;this.zoom(-(a??i),r,!1)})}if(typeof t=="object"){const{zoomIn:e=[],zoomOut:r=[],reset:i=[]}=t;this.shortcut.bind(e,a=>this.zoom(10,a,this.options.animation)),this.shortcut.bind(r,a=>this.zoom(-10,a,this.options.animation)),this.shortcut.bind(i,this.onReset)}}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return zt(e)?e(t):!!e}destroy(){var t;this.shortcut.destroy(),(t=this.context.canvas.getContainer())===null||t===void 0||t.removeEventListener(st.WHEEL,this.preventDefault),super.destroy()}}Tf.defaultOptions={animation:{duration:200},enable:!0,sensitivity:1,trigger:[],preventDefault:!0};var bg,G2;function is(){if(G2)return bg;G2=1;function n(t,e,r,i){return i===void 0&&(i="height"),r==="center"?(t[i]+e[i])/2:t.height}return bg={assign:Object.assign,getHeight:n},bg}var wg,W2;function UR(){if(W2)return wg;W2=1;var n=is(),t=18,e=t*2,r=t,i={getId:function(l){return l.id||l.name},getPreH:function(l){return l.preH||0},getPreV:function(l){return l.preV||0},getHGap:function(l){return l.hgap||r},getVGap:function(l){return l.vgap||r},getChildren:function(l){return l.children},getHeight:function(l){return l.height||e},getWidth:function(l){var c=l.label||" ";return l.width||c.split("").length*t}};function a(o,l){var c=this;if(c.vgap=c.hgap=0,o instanceof a)return o;c.data=o;var u=l.getHGap(o),h=l.getVGap(o);return c.preH=l.getPreH(o),c.preV=l.getPreV(o),c.width=l.getWidth(o),c.height=l.getHeight(o),c.width+=c.preH,c.height+=c.preV,c.id=l.getId(o),c.x=c.y=0,c.depth=0,c.children||(c.children=[]),c.addGap(u,h),c}n.assign(a.prototype,{isRoot:function(){return this.depth===0},isLeaf:function(){return this.children.length===0},addGap:function(l,c){var u=this;u.hgap+=l,u.vgap+=c,u.width+=2*l,u.height+=2*c},eachNode:function(l){for(var c=this,u=[c],h;h=u.shift();)l(h),u=h.children.concat(u)},DFTraverse:function(l){this.eachNode(l)},BFTraverse:function(l){for(var c=this,u=[c],h;h=u.shift();)l(h),u=u.concat(h.children)},getBoundingBox:function(){var l={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode(function(c){l.left=Math.min(l.left,c.x),l.top=Math.min(l.top,c.y),l.width=Math.max(l.width,c.x+c.width),l.height=Math.max(l.height,c.y+c.height)}),l},translate:function(l,c){l===void 0&&(l=0),c===void 0&&(c=0),this.eachNode(function(u){u.x+=l,u.y+=c,u.x+=u.preH,u.y+=u.preV})},right2left:function(){var l=this,c=l.getBoundingBox();l.eachNode(function(u){u.x=u.x-(u.x-c.left)*2-u.width}),l.translate(c.width,0)},bottom2top:function(){var l=this,c=l.getBoundingBox();l.eachNode(function(u){u.y=u.y-(u.y-c.top)*2-u.height}),l.translate(0,c.height)}});function s(o,l,c){l===void 0&&(l={}),l=n.assign({},i,l);var u=new a(o,l),h=[u],f;if(!c&&!o.collapsed){for(;f=h.shift();)if(!f.data.collapsed){var d=l.getChildren(f.data),g=d?d.length:0;if(f.children=new Array(g),d&&g)for(var v=0;v<g;v++){var p=new a(d[v],l);f.children[v]=p,h.push(p),p.parent=f,p.depth=f.depth+1}}}return u}return wg=s,wg}var xg,V2;function kf(){if(V2)return xg;V2=1;var n=UR(),t=function(){function e(i,a){a===void 0&&(a={});var s=this;s.options=a,s.rootNode=n(i,a)}var r=e.prototype;return r.execute=function(){throw new Error("please override this method")},e}();return xg=t,xg}var Eg,H2;function nG(){if(H2)return Eg;H2=1;function n(s,o,l,c){c===void 0&&(c=[]);var u=this;u.w=s||0,u.h=o||0,u.y=l||0,u.x=0,u.c=c||[],u.cs=c.length,u.prelim=0,u.mod=0,u.shift=0,u.change=0,u.tl=null,u.tr=null,u.el=null,u.er=null,u.msel=0,u.mser=0}n.fromNode=function(s,o){if(!s)return null;var l=[];return s.children.forEach(function(c){l.push(n.fromNode(c,o))}),o?new n(s.height,s.width,s.x,l):new n(s.width,s.height,s.y,l)};function t(s,o,l){l?s.y+=o:s.x+=o,s.children.forEach(function(c){t(c,o,l)})}function e(s,o){var l=o?s.y:s.x;return s.children.forEach(function(c){l=Math.min(e(c,o),l)}),l}function r(s,o){var l=e(s,o);t(s,-l,o)}function i(s,o,l){l?o.y=s.x:o.x=s.x,s.c.forEach(function(c,u){i(c,o.children[u],l)})}function a(s,o,l){l===void 0&&(l=0),o?(s.x=l,l+=s.width):(s.y=l,l+=s.height),s.children.forEach(function(c){a(c,o,l)})}return Eg=function(s,o){o===void 0&&(o={});var l=o.isHorizontal;function c(T){if(T.cs===0){u(T);return}c(T.c[0]);for(var C=O(v(T.c[0].el),0,null),P=1;P<T.cs;++P){c(T.c[P]);var N=v(T.c[P].er);h(T,P,C),C=O(N,P,C)}m(T),u(T)}function u(T){T.cs===0?(T.el=T,T.er=T,T.msel=T.mser=0):(T.el=T.c[0].el,T.msel=T.c[0].msel,T.er=T.c[T.cs-1].er,T.mser=T.c[T.cs-1].mser)}function h(T,C,P){for(var N=T.c[C-1],L=N.mod,D=T.c[C],G=D.mod;N!==null&&D!==null;){v(N)>P.low&&(P=P.nxt);var H=L+N.prelim+N.w-(G+D.prelim);H>0&&(G+=H,f(T,C,P.index,H));var W=v(N),q=v(D);W<=q&&(N=g(N),N!==null&&(L+=N.mod)),W>=q&&(D=d(D),D!==null&&(G+=D.mod))}!N&&D?p(T,C,D,G):N&&!D&&y(T,C,N,L)}function f(T,C,P,N){T.c[C].mod+=N,T.c[C].msel+=N,T.c[C].mser+=N,E(T,C,P,N)}function d(T){return T.cs===0?T.tl:T.c[0]}function g(T){return T.cs===0?T.tr:T.c[T.cs-1]}function v(T){return T.y+T.h}function p(T,C,P,N){var L=T.c[0].el;L.tl=P;var D=N-P.mod-T.c[0].msel;L.mod+=D,L.prelim-=D,T.c[0].el=T.c[C].el,T.c[0].msel=T.c[C].msel}function y(T,C,P,N){var L=T.c[C].er;L.tr=P;var D=N-P.mod-T.c[C].mser;L.mod+=D,L.prelim-=D,T.c[C].er=T.c[C-1].er,T.c[C].mser=T.c[C-1].mser}function m(T){T.prelim=(T.c[0].prelim+T.c[0].mod+T.c[T.cs-1].mod+T.c[T.cs-1].prelim+T.c[T.cs-1].w)/2-T.w/2}function w(T,C){C+=T.mod,T.x=T.prelim+C,S(T);for(var P=0;P<T.cs;P++)w(T.c[P],C)}function E(T,C,P,N){if(P!==C-1){var L=C-P;T.c[P+1].shift+=N/L,T.c[C].shift-=N/L,T.c[C].change-=N-N/L}}function S(T){for(var C=0,P=0,N=0;N<T.cs;N++)C+=T.c[N].shift,P+=C+T.c[N].change,T.c[N].mod+=P}function O(T,C,P){for(;P!==null&&T>=P.low;)P=P.nxt;return{low:T,index:C,nxt:P}}a(s,l);var k=n.fromNode(s,l);return c(k),w(k,0),i(k,s,l),r(s,l),s},Eg}var Sg,U2;function YR(){if(U2)return Sg;U2=1;var n=UR();return Sg=function(t,e){for(var r=n(t.data,e,!0),i=n(t.data,e,!0),a=t.children.length,s=Math.round(a/2),o=e.getSide||function(h,f){return f<s?"right":"left"},l=0;l<a;l++){var c=t.children[l],u=o(c,l);u==="right"?i.children.push(c):r.children.push(c)}return r.eachNode(function(h){h.isRoot()||(h.side="left")}),i.eachNode(function(h){h.isRoot()||(h.side="right")}),{left:r,right:i}},Sg}var _g,Y2;function Vw(){if(Y2)return _g;Y2=1;var n=YR(),t=["LR","RL","TB","BT","H","V"],e=["LR","RL","H"],r=function(o){return e.indexOf(o)>-1},i=t[0];_g=function(s,o,l){var c=o.direction||i;if(o.isHorizontal=r(c),t.indexOf(c)===-1)throw new TypeError("Invalid direction: "+c);if(c===t[0])l(s,o);else if(c===t[1])l(s,o),s.right2left();else if(c===t[2])l(s,o);else if(c===t[3])l(s,o),s.bottom2top();else if(c===t[4]||c===t[5]){var u=n(s,o),h=u.left,f=u.right;l(h,o),l(f,o),o.isHorizontal?h.right2left():h.bottom2top(),f.translate(h.x-f.x,h.y-f.y),s.x=h.x,s.y=f.y;var d=s.getBoundingBox();o.isHorizontal?d.top<0&&s.translate(0,-d.top):d.left<0&&s.translate(-d.left,0)}var g=o.fixedRoot;return g===void 0&&(g=!0),g&&s.translate(-(s.x+s.width/2+s.hgap),-(s.y+s.height/2+s.vgap)),a(s,o),s};function a(s,o){if(o.radial){var l=o.isHorizontal?["x","y"]:["y","x"],c=l[0],u=l[1],h={x:1/0,y:1/0},f={x:-1/0,y:-1/0},d=0;s.DFTraverse(function(p){d++;var y=p.x,m=p.y;h.x=Math.min(h.x,y),h.y=Math.min(h.y,m),f.x=Math.max(f.x,y),f.y=Math.max(f.y,m)});var g=f[u]-h[u];if(g===0)return;var v=Math.PI*2/d;s.DFTraverse(function(p){var y=(p[u]-h[u])/g*(Math.PI*2-v)+v,m=p[c]-s[c];p.x=Math.cos(y)*m,p.y=Math.sin(y)*m})}}return _g}var Mg,X2;function rG(){if(X2)return Mg;X2=1;function n(c,u){c.prototype=Object.create(u.prototype),c.prototype.constructor=c,t(c,u)}function t(c,u){return t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(h,f){return h.__proto__=f,h},t(c,u)}var e=kf(),r=nG(),i=Vw(),a=is(),s=function(c){function u(){return c.apply(this,arguments)||this}n(u,c);var h=u.prototype;return h.execute=function(){var d=this;return i(d.rootNode,d.options,r)},u}(e),o={};function l(c,u){return u=a.assign({},o,u),new s(c,u).execute()}return Mg=l,Mg}var Og,K2;function iG(){if(K2)return Og;K2=1;var n=is();function t(i,a){a===void 0&&(a=[]);var s=this;s.x=s.y=0,s.leftChild=s.rightChild=null,s.height=0,s.children=a}var e={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};function r(i,a,s){s?(a.x=i.x,a.y=i.y):(a.x=i.y,a.y=i.x),i.children.forEach(function(o,l){r(o,a.children[l],s)})}return Og=function(i,a){a===void 0&&(a={}),a=n.assign({},e,a);var s=0;function o(f){if(!f)return null;f.width=0,f.depth&&f.depth>s&&(s=f.depth);var d=f.children,g=d.length,v=new t(f.height,[]);return d.forEach(function(p,y){var m=o(p);v.children.push(m),y===0&&(v.leftChild=m),y===g-1&&(v.rightChild=m)}),v.originNode=f,v.isLeaf=f.isLeaf(),v}function l(f){if(f.isLeaf||f.children.length===0)f.drawingDepth=s;else{var d=f.children.map(function(v){return l(v)}),g=Math.min.apply(null,d);f.drawingDepth=g-1}return f.drawingDepth}var c;function u(f){f.x=f.drawingDepth*a.rankSep,f.isLeaf?(f.y=0,c&&(f.y=c.y+c.height+a.nodeSep,f.originNode.parent!==c.originNode.parent&&(f.y+=a.subTreeSep)),c=f):(f.children.forEach(function(d){u(d)}),f.y=(f.leftChild.y+f.rightChild.y)/2)}var h=o(i);return l(h),u(h),r(h,i,a.isHorizontal),i},Og}var Tg,Z2;function aG(){if(Z2)return Tg;Z2=1;function n(c,u){c.prototype=Object.create(u.prototype),c.prototype.constructor=c,t(c,u)}function t(c,u){return t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(h,f){return h.__proto__=f,h},t(c,u)}var e=kf(),r=iG(),i=Vw(),a=is(),s=function(c){function u(){return c.apply(this,arguments)||this}n(u,c);var h=u.prototype;return h.execute=function(){var d=this;return d.rootNode.width=0,i(d.rootNode,d.options,r)},u}(e),o={};function l(c,u){return u=a.assign({},o,u),new s(c,u).execute()}return Tg=l,Tg}var kg,J2;function sG(){if(J2)return kg;J2=1;var n=is();function t(e,r,i,a,s){var o=(typeof i=="function"?i(e):i)*e.depth;if(!a)try{if(e.id===e.parent.children[0].id){e.x+=o,e.y=r?r.y:0;return}}catch{}if(e.x+=o,r){if(e.y=r.y+n.getHeight(r,e,s),r.parent&&e.parent.id!==r.parent.id){var l=r.parent,c=l.y+n.getHeight(l,e,s);e.y=c>e.y?c:e.y}}else e.y=0}return kg=function(e,r,i,a){var s=null;e.eachNode(function(o){t(o,s,r,i,a),s=o})},kg}var Ag,Q2;function oG(){if(Q2)return Ag;Q2=1;function n(h,f){h.prototype=Object.create(f.prototype),h.prototype.constructor=h,t(h,f)}function t(h,f){return t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(d,g){return d.__proto__=g,d},t(h,f)}var e=kf(),r=sG(),i=YR(),a=is(),s=["LR","RL","H"],o=s[0],l=function(h){function f(){return h.apply(this,arguments)||this}n(f,h);var d=f.prototype;return d.execute=function(){var v=this,p=v.options,y=v.rootNode;p.isHorizontal=!0;var m=p.indent,w=m===void 0?20:m,E=p.dropCap,S=E===void 0?!0:E,O=p.direction,k=O===void 0?o:O,T=p.align;if(k&&s.indexOf(k)===-1)throw new TypeError("Invalid direction: "+k);if(k===s[0])r(y,w,S,T);else if(k===s[1])r(y,w,S,T),y.right2left();else if(k===s[2]){var C=i(y,p),P=C.left,N=C.right;r(P,w,S,T),P.right2left(),r(N,w,S,T);var L=P.getBoundingBox();N.translate(L.width,0),y.x=N.x-y.width/2}return y},f}(e),c={};function u(h,f){return f=a.assign({},c,f),new l(h,f).execute()}return Ag=u,Ag}var Cg,tS;function lG(){if(tS)return Cg;tS=1;var n=is();function t(i,a){var s=0;return i.children.length?i.children.forEach(function(o){s+=t(o,a)}):s=i.height,i._subTreeSep=a.getSubTreeSep(i.data),i.totalHeight=Math.max(i.height,s)+2*i._subTreeSep,i.totalHeight}function e(i){var a=i.children,s=a.length;if(s){a.forEach(function(f){e(f)});var o=a[0],l=a[s-1],c=l.y-o.y+l.height,u=0;if(a.forEach(function(f){u+=f.totalHeight}),c>i.height)i.y=o.y+c/2-i.height/2;else if(a.length!==1||i.height>u){var h=i.y+(i.height-c)/2-o.y;a.forEach(function(f){f.translate(0,h)})}else i.y=(o.y+o.height/2+l.y+l.height/2)/2-i.height/2}}var r={getSubTreeSep:function(){return 0}};return Cg=function(i,a){a===void 0&&(a={}),a=n.assign({},r,a),i.parent={x:0,width:0,height:0,y:0},i.BFTraverse(function(s){s.x=s.parent.x+s.parent.width}),i.parent=null,t(i,a),i.startY=0,i.y=i.totalHeight/2-i.height/2,i.eachNode(function(s){var o=s.children,l=o.length;if(l){var c=o[0];if(c.startY=s.startY+s._subTreeSep,l===1)c.y=s.y+s.height/2-c.height/2;else{c.y=c.startY+c.totalHeight/2-c.height/2;for(var u=1;u<l;u++){var h=o[u];h.startY=o[u-1].startY+o[u-1].totalHeight,h.y=h.startY+h.totalHeight/2-h.height/2}}}}),e(i)},Cg}var Pg,eS;function cG(){if(eS)return Pg;eS=1;function n(c,u){c.prototype=Object.create(u.prototype),c.prototype.constructor=c,t(c,u)}function t(c,u){return t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(h,f){return h.__proto__=f,h},t(c,u)}var e=kf(),r=lG(),i=Vw(),a=is(),s=function(c){function u(){return c.apply(this,arguments)||this}n(u,c);var h=u.prototype;return h.execute=function(){var d=this;return i(d.rootNode,d.options,r)},u}(e),o={};function l(c,u){return u=a.assign({},o,u),new s(c,u).execute()}return Pg=l,Pg}var Ng,nS;function uG(){if(nS)return Ng;nS=1;var n={compactBox:rG(),dendrogram:aG(),indented:oG(),mindmap:cG()};return Ng=n,Ng}var Ou=uG();const hG=(n,t)=>{if(n!=="next"&&n!=="prev")return t},rS=n=>{n.prev.next=n.next,n.next.prev=n.prev,delete n.next,delete n.prev};let fG=class{constructor(){const t={};t.prev=t,t.next=t.prev,this.shortcut=t}dequeue(){const t=this.shortcut,e=t.prev;if(e&&e!==t)return rS(e),e}enqueue(t){const e=this.shortcut;t.prev&&t.next&&rS(t),t.next=e.next,e.next.prev=t,e.next=t,t.prev=e}toString(){const t=[],e=this.shortcut;let r=e.prev;for(;r!==e;)t.push(JSON.stringify(r,hG)),r=r==null?void 0:r.prev;return`[${t.join(", ")}]`}};class dG extends fG{}const gG=()=>1,pG=(n,t)=>{var e;if(n.getAllNodes().length<=1)return[];const r=yG(n,t||gG);return(e=vG(r.graph,r.buckets,r.zeroIdx).map(a=>n.getRelatedEdges(a.v,"out").filter(({target:s})=>s===a.w)))===null||e===void 0?void 0:e.flat()},vG=(n,t,e)=>{let r=[];const i=t[t.length-1],a=t[0];let s;for(;n.getAllNodes().length;){for(;s=a.dequeue();)Rg(n,t,e,s);for(;s=i.dequeue();)Rg(n,t,e,s);if(n.getAllNodes().length){for(let o=t.length-2;o>0;--o)if(s=t[o].dequeue(),s){r=r.concat(Rg(n,t,e,s,!0));break}}}return r},Rg=(n,t,e,r,i)=>{var a,s;const o=[];return n.hasNode(r.v)&&((a=n.getRelatedEdges(r.v,"in"))===null||a===void 0||a.forEach(l=>{const c=l.data.weight,u=n.getNode(l.source);i&&o.push({v:l.source,w:l.target,in:0,out:0}),u.data.out===void 0&&(u.data.out=0),u.data.out-=c,Sb(t,e,Object.assign({v:u.id},u.data))}),(s=n.getRelatedEdges(r.v,"out"))===null||s===void 0||s.forEach(l=>{const c=l.data.weight,u=l.target,h=n.getNode(u);h.data.in===void 0&&(h.data.in=0),h.data.in-=c,Sb(t,e,Object.assign({v:h.id},h.data))}),n.removeNode(r.v)),i?o:void 0},yG=(n,t)=>{const e=new kn;let r=0,i=0;n.getAllNodes().forEach(l=>{e.addNode({id:l.id,data:{v:l.id,in:0,out:0}})}),n.getAllEdges().forEach(l=>{const c=e.getRelatedEdges(l.source,"out").find(h=>h.target===l.target),u=(t==null?void 0:t(l))||1;c?e.updateEdgeData(c==null?void 0:c.id,Object.assign(Object.assign({},c.data),{weight:c.data.weight+u})):e.addEdge({id:l.id,source:l.source,target:l.target,data:{weight:u}}),i=Math.max(i,e.getNode(l.source).data.out+=u),r=Math.max(r,e.getNode(l.target).data.in+=u)});const a=[],s=i+r+3;for(let l=0;l<s;l++)a.push(new dG);const o=r+1;return e.getAllNodes().forEach(l=>{Sb(a,o,Object.assign({v:l.id},e.getNode(l.id).data))}),{buckets:a,zeroIdx:o,graph:e}},Sb=(n,t,e)=>{e.out?e.in?n[e.out-e.in+t].enqueue(e):n[n.length-1].enqueue(e):n[0].enqueue(e)},mG=(n,t)=>{const r=pG(n,(i=>a=>a.data.weight||1)());r==null||r.forEach(i=>{const a=i.data;n.removeEdge(i.id),a.forwardName=i.data.name,a.reversed=!0,n.addEdge({id:i.id,source:i.target,target:i.source,data:Object.assign({},a)})})},bG=n=>{n.getAllEdges().forEach(t=>{const e=t.data;if(e.reversed){n.removeEdge(t.id);const r=e.forwardName;delete e.reversed,delete e.forwardName,n.addEdge({id:t.id,source:t.target,target:t.source,data:Object.assign(Object.assign({},e),{forwardName:r})})}})},wG=(n,t)=>Number(n)-Number(t),zo=(n,t,e,r)=>{let i;do i=`${r}${Math.random()}`;while(n.hasNode(i));return e.dummy=t,n.addNode({id:i,data:e}),i},xG=n=>{const t=new kn;return n.getAllNodes().forEach(e=>{t.addNode(Object.assign({},e))}),n.getAllEdges().forEach(e=>{const r=t.getRelatedEdges(e.source,"out").find(i=>i.target===e.target);r?t.updateEdgeData(r==null?void 0:r.id,Object.assign(Object.assign({},r.data),{weight:r.data.weight+e.data.weight||0,minlen:Math.max(r.data.minlen,e.data.minlen||1)})):t.addEdge({id:e.id,source:e.source,target:e.target,data:{weight:e.data.weight||0,minlen:e.data.minlen||1}})}),t},XR=n=>{const t=new kn;return n.getAllNodes().forEach(e=>{n.getChildren(e.id).length||t.addNode(Object.assign({},e))}),n.getAllEdges().forEach(e=>{t.addEdge(e)}),t},EG=(n,t)=>n==null?void 0:n.reduce((e,r,i)=>(e[r]=t[i],e),{}),iS=(n,t)=>{const e=Number(n.x),r=Number(n.y),i=Number(t.x)-e,a=Number(t.y)-r;let s=Number(n.width)/2,o=Number(n.height)/2;if(!i&&!a)return{x:0,y:0};let l,c;return Math.abs(a)*s>Math.abs(i)*o?(a<0&&(o=-o),l=o*i/a,c=o):(i<0&&(s=-s),l=s,c=s*a/i),{x:e+l,y:r+c}},Ql=n=>{const t=[],e=KR(n)+1;for(let r=0;r<e;r++)t.push([]);n.getAllNodes().forEach(r=>{const i=r.data.rank;i!==void 0&&t[i]&&t[i].push(r.id)});for(let r=0;r<e;r++)t[r]=t[r].sort((i,a)=>wG(n.getNode(i).data.order,n.getNode(a).data.order));return t},SG=n=>{const t=n.getAllNodes().filter(r=>r.data.rank!==void 0).map(r=>r.data.rank),e=Math.min(...t);n.getAllNodes().forEach(r=>{r.data.hasOwnProperty("rank")&&e!==1/0&&(r.data.rank-=e)})},_G=(n,t=0)=>{const e=n.getAllNodes(),r=e.filter(o=>o.data.rank!==void 0).map(o=>o.data.rank),i=Math.min(...r),a=[];e.forEach(o=>{const l=(o.data.rank||0)-i;a[l]||(a[l]=[]),a[l].push(o.id)});let s=0;for(let o=0;o<a.length;o++){const l=a[o];l===void 0?o%t!==0&&(s-=1):s&&(l==null||l.forEach(c=>{const u=n.getNode(c);u&&(u.data.rank=u.data.rank||0,u.data.rank+=s)}))}},aS=(n,t,e,r)=>{const i={width:0,height:0};return Lt(e)&&Lt(r)&&(i.rank=e,i.order=r),zo(n,"border",i,t)},KR=n=>{let t;return n.getAllNodes().forEach(e=>{const r=e.data.rank;r!==void 0&&(t===void 0||r>t)&&(t=r)}),t||(t=0),t},MG=(n,t)=>{const e={lhs:[],rhs:[]};return n==null||n.forEach(r=>{t(r)?e.lhs.push(r):e.rhs.push(r)}),e},Hw=(n,t)=>n.reduce((e,r)=>{const i=t(e),a=t(r);return i>a?r:e}),ZR=(n,t,e,r,i,a)=>{r.includes(t.id)||(r.push(t.id),e||a.push(t.id),i(t.id).forEach(s=>ZR(n,s,e,r,i,a)),e&&a.push(t.id))},JR=(n,t,e,r)=>{const i=Array.isArray(t)?t:[t],a=l=>n.getNeighbors(l),s=[],o=[];return i.forEach(l=>{if(n.hasNode(l.id))ZR(n,l,e==="post",o,a,s);else throw new Error(`Graph does not have node: ${l}`)}),s},OG=n=>{const t=e=>{const r=n.getChildren(e),i=n.getNode(e);if(r!=null&&r.length&&r.forEach(a=>t(a.id)),i.data.hasOwnProperty("minRank")){i.data.borderLeft=[],i.data.borderRight=[];for(let a=i.data.minRank,s=i.data.maxRank+1;a<s;a+=1)sS(n,"borderLeft","_bl",e,i,a),sS(n,"borderRight","_br",e,i,a)}};n.getRoots().forEach(e=>t(e.id))},sS=(n,t,e,r,i,a)=>{const s={rank:a,borderType:t,width:0,height:0},o=i.data[t][a-1],l=zo(n,"border",s,e);i.data[t][a]=l,n.setParent(l,r),o&&n.addEdge({id:`e${Math.random()}`,source:o,target:l,data:{weight:1}})},TG=(n,t)=>{const e=t.toLowerCase();(e==="lr"||e==="rl")&&QR(n)},kG=(n,t)=>{const e=t.toLowerCase();(e==="bt"||e==="rl")&&AG(n),(e==="lr"||e==="rl")&&(CG(n),QR(n))},QR=n=>{n.getAllNodes().forEach(t=>{oS(t)}),n.getAllEdges().forEach(t=>{oS(t)})},oS=n=>{const t=n.data.width;n.data.width=n.data.height,n.data.height=t},AG=n=>{n.getAllNodes().forEach(t=>{Lg(t.data)}),n.getAllEdges().forEach(t=>{var e;(e=t.data.points)===null||e===void 0||e.forEach(r=>Lg(r)),t.data.hasOwnProperty("y")&&Lg(t.data)})},Lg=n=>{n!=null&&n.y&&(n.y=-n.y)},CG=n=>{n.getAllNodes().forEach(t=>{Ig(t.data)}),n.getAllEdges().forEach(t=>{var e;(e=t.data.points)===null||e===void 0||e.forEach(r=>Ig(r)),t.data.hasOwnProperty("x")&&Ig(t.data)})},Ig=n=>{const t=n.x;n.x=n.y,n.y=t},PG=n=>{const t=zo(n,"root",{},"_root"),e=NG(n);let r=Math.max(...Object.values(e));Math.abs(r)===1/0&&(r=1);const i=r-1,a=2*i+1;n.getAllEdges().forEach(o=>{o.data.minlen*=a});const s=RG(n)+1;return n.getRoots().forEach(o=>{tL(n,t,a,s,i,e,o.id)}),{nestingRoot:t,nodeRankFactor:a}},tL=(n,t,e,r,i,a,s)=>{const o=n.getChildren(s);if(!(o!=null&&o.length)){s!==t&&n.addEdge({id:`e${Math.random()}`,source:t,target:s,data:{weight:0,minlen:e}});return}const l=aS(n,"_bt"),c=aS(n,"_bb"),u=n.getNode(s);n.setParent(l,s),u.data.borderTop=l,n.setParent(c,s),u.data.borderBottom=c,o==null||o.forEach(h=>{tL(n,t,e,r,i,a,h.id);const f=h.data.borderTop?h.data.borderTop:h.id,d=h.data.borderBottom?h.data.borderBottom:h.id,g=h.data.borderTop?r:2*r,v=f!==d?1:i-a[s]+1;n.addEdge({id:`e${Math.random()}`,source:l,target:f,data:{minlen:v,weight:g,nestingEdge:!0}}),n.addEdge({id:`e${Math.random()}`,source:d,target:c,data:{minlen:v,weight:g,nestingEdge:!0}})}),n.getParent(s)||n.addEdge({id:`e${Math.random()}`,source:t,target:l,data:{weight:0,minlen:i+a[s]}})},NG=n=>{const t={},e=(r,i)=>{const a=n.getChildren(r);a==null||a.forEach(s=>e(s.id,i+1)),t[r]=i};return n.getRoots().forEach(r=>e(r.id,1)),t},RG=n=>{let t=0;return n.getAllEdges().forEach(e=>{t+=e.data.weight}),t},LG=(n,t)=>{t&&n.removeNode(t),n.getAllEdges().forEach(e=>{e.data.nestingEdge&&n.removeEdge(e.id)})},IG="edge",eL="edge-label",DG=(n,t)=>{n.getAllEdges().forEach(e=>FG(n,e,t))},FG=(n,t,e)=>{let r=t.source,i=n.getNode(r).data.rank;const a=t.target,s=n.getNode(a).data.rank,o=t.data.labelRank;if(s===i+1)return;n.removeEdge(t.id);let l,c,u;for(u=0,++i;i<s;++u,++i)t.data.points=[],c={originalEdge:t,width:0,height:0,rank:i},l=zo(n,IG,c,"_d"),i===o&&(c.width=t.data.width,c.height=t.data.height,c.dummy=eL,c.labelpos=t.data.labelpos),n.addEdge({id:`e${Math.random()}`,source:r,target:l,data:{weight:t.data.weight}}),u===0&&e.push(l),r=l;n.addEdge({id:`e${Math.random()}`,source:r,target:a,data:{weight:t.data.weight}})},BG=(n,t)=>{t.forEach(e=>{let r=n.getNode(e);const{data:i}=r,a=i.originalEdge;let s;a&&n.addEdge(a);let o=e;for(;r.data.dummy;)s=n.getSuccessors(o)[0],n.removeNode(o),a.data.points.push({x:r.data.x,y:r.data.y}),r.data.dummy===eL&&(a.data.x=r.data.x,a.data.y=r.data.y,a.data.width=r.data.width,a.data.height=r.data.height),o=s.id,r=n.getNode(o)})},zG=(n,t,e)=>{const r={};let i;e==null||e.forEach(a=>{let s=n.getParent(a),o,l;for(;s;){if(o=n.getParent(s.id),o?(l=r[o.id],r[o.id]=s.id):(l=i,i=s.id),l&&l!==s.id){t.hasNode(l)||t.addNode({id:l,data:{}}),t.hasNode(s.id)||t.addNode({id:s.id,data:{}}),t.hasEdge(`e${l}-${s.id}`)||t.addEdge({id:`e${l}-${s.id}`,source:l,target:s.id,data:{}});return}s=o}})},jG=(n,t,e)=>{const r=qG(n),i=new kn({tree:[{id:r,children:[],data:{}}]});return n.getAllNodes().forEach(a=>{const s=n.getParent(a.id);(a.data.rank===t||a.data.minRank<=t&&t<=a.data.maxRank)&&(i.hasNode(a.id)||i.addNode(Object.assign({},a)),s!=null&&s.id&&!i.hasNode(s==null?void 0:s.id)&&i.addNode(Object.assign({},s)),i.setParent(a.id,(s==null?void 0:s.id)||r),n.getRelatedEdges(a.id,e).forEach(o=>{const l=o.source===a.id?o.target:o.source;i.hasNode(l)||i.addNode(Object.assign({},n.getNode(l)));const c=i.getRelatedEdges(l,"out").find(({target:h})=>h===a.id),u=c!==void 0?c.data.weight:0;c?i.updateEdgeData(c.id,Object.assign(Object.assign({},c.data),{weight:o.data.weight+u})):i.addEdge({id:o.id,source:l,target:a.id,data:{weight:o.data.weight+u}})}),a.data.hasOwnProperty("minRank")&&i.updateNodeData(a.id,Object.assign(Object.assign({},a.data),{borderLeft:a.data.borderLeft[t],borderRight:a.data.borderRight[t]})))}),i},qG=n=>{let t;for(;n.hasNode(t=`_root${Math.random()}`););return t},$G=(n,t,e)=>{const r=EG(e,e.map((u,h)=>h)),a=t.map(u=>{const h=n.getRelatedEdges(u,"out").map(f=>({pos:r[f.target]||0,weight:f.data.weight}));return h==null?void 0:h.sort((f,d)=>f.pos-d.pos)}).flat().filter(u=>u!==void 0);let s=1;for(;s<e.length;)s<<=1;const o=2*s-1;s-=1;const l=Array(o).fill(0,0,o);let c=0;return a==null||a.forEach(u=>{if(u){let h=u.pos+s;l[h]+=u.weight;let f=0;for(;h>0;)h%2&&(f+=l[h+1]),h=h-1>>1,l[h]+=u.weight;c+=u.weight*f}}),c},lS=(n,t)=>{let e=0;for(let r=1;r<(t==null?void 0:t.length);r+=1)e+=$G(n,t[r-1],t[r]);return e},cS=n=>{const t={},e=n.getAllNodes(),r=e.map(c=>{var u;return(u=c.data.rank)!==null&&u!==void 0?u:-1/0}),i=Math.max(...r),a=[];for(let c=0;c<i+1;c++)a.push([]);const s=e.sort((c,u)=>n.getNode(c.id).data.rank-n.getNode(u.id).data.rank),l=s.filter(c=>n.getNode(c.id).data.fixorder!==void 0).sort((c,u)=>n.getNode(c.id).data.fixorder-n.getNode(u.id).data.fixorder);return l==null||l.forEach(c=>{isNaN(n.getNode(c.id).data.rank)||a[n.getNode(c.id).data.rank].push(c.id),t[c.id]=!0}),s==null||s.forEach(c=>n.dfsTree(c.id,u=>{if(t.hasOwnProperty(u.id))return!0;t[u.id]=!0,isNaN(u.data.rank)||a[u.data.rank].push(u.id)})),a},GG=(n,t)=>t.map(e=>{const r=n.getRelatedEdges(e,"in");if(!(r!=null&&r.length))return{v:e};const i={sum:0,weight:0};return r==null||r.forEach(a=>{const s=n.getNode(a.source);i.sum+=a.data.weight*s.data.order,i.weight+=a.data.weight}),{v:e,barycenter:i.sum/i.weight,weight:i.weight}}),WG=(n,t)=>{var e,r,i;const a={};n==null||n.forEach((o,l)=>{a[o.v]={i:l,indegree:0,in:[],out:[],vs:[o.v]};const c=a[o.v];o.barycenter!==void 0&&(c.barycenter=o.barycenter,c.weight=o.weight)}),(e=t.getAllEdges())===null||e===void 0||e.forEach(o=>{const l=a[o.source],c=a[o.target];l!==void 0&&c!==void 0&&(c.indegree++,l.out.push(a[o.target]))});const s=(i=(r=Object.values(a)).filter)===null||i===void 0?void 0:i.call(r,o=>!o.indegree);return VG(s)},VG=n=>{var t,e;const r=[],i=l=>c=>{c.merged||(c.barycenter===void 0||l.barycenter===void 0||c.barycenter>=l.barycenter)&&HG(l,c)},a=l=>c=>{c.in.push(l),--c.indegree===0&&n.push(c)};for(;n!=null&&n.length;){const l=n.pop();r.push(l),(t=l.in.reverse())===null||t===void 0||t.forEach(c=>i(l)(c)),(e=l.out)===null||e===void 0||e.forEach(c=>a(l)(c))}const s=r.filter(l=>!l.merged),o=["vs","i","barycenter","weight"];return s.map(l=>{const c={};return o==null||o.forEach(u=>{l[u]!==void 0&&(c[u]=l[u])}),c})},HG=(n,t)=>{var e;let r=0,i=0;n.weight&&(r+=n.barycenter*n.weight,i+=n.weight),t.weight&&(r+=t.barycenter*t.weight,i+=t.weight),n.vs=(e=t.vs)===null||e===void 0?void 0:e.concat(n.vs),n.barycenter=r/i,n.weight=i,n.i=Math.min(t.i,n.i),t.merged=!0},UG=(n,t,e,r)=>{const i=MG(n,f=>{const d=f.hasOwnProperty("fixorder")&&!isNaN(f.fixorder);return r?!d&&f.hasOwnProperty("barycenter"):d||f.hasOwnProperty("barycenter")}),a=i.lhs,s=i.rhs.sort((f,d)=>-f.i- -d.i),o=[];let l=0,c=0,u=0;a==null||a.sort(YG(!!t,!!e)),u=uS(o,s,u),a==null||a.forEach(f=>{var d;u+=(d=f.vs)===null||d===void 0?void 0:d.length,o.push(f.vs),l+=f.barycenter*f.weight,c+=f.weight,u=uS(o,s,u)});const h={vs:o.flat()};return c&&(h.barycenter=l/c,h.weight=c),h},uS=(n,t,e)=>{let r=e,i;for(;t.length&&(i=t[t.length-1]).i<=r;)t.pop(),n==null||n.push(i.vs),r++;return r},YG=(n,t)=>(e,r)=>{if(e.fixorder!==void 0&&r.fixorder!==void 0)return e.fixorder-r.fixorder;if(e.barycenter<r.barycenter)return-1;if(e.barycenter>r.barycenter)return 1;if(t&&e.order!==void 0&&r.order!==void 0){if(e.order<r.order)return-1;if(e.order>r.order)return 1}return n?r.i-e.i:e.i-r.i},nL=(n,t,e,r,i,a)=>{var s,o,l,c;let u=n.getChildren(t).map(m=>m.id);const h=n.getNode(t),f=h?h.data.borderLeft:void 0,d=h?h.data.borderRight:void 0,g={};f&&(u=u==null?void 0:u.filter(m=>m!==f&&m!==d));const v=GG(n,u||[]);v==null||v.forEach(m=>{var w;if(!((w=n.getChildren(m.v))===null||w===void 0)&&w.length){const E=nL(n,m.v,e,r,a);g[m.v]=E,E.hasOwnProperty("barycenter")&&KG(m,E)}});const p=WG(v,e);XG(p,g),(s=p.filter(m=>m.vs.length>0))===null||s===void 0||s.forEach(m=>{const w=n.getNode(m.vs[0]);w&&(m.fixorder=w.data.fixorder,m.order=w.data.order)});const y=UG(p,r,i,a);if(f&&(y.vs=[f,y.vs,d].flat(),!((o=n.getPredecessors(f))===null||o===void 0)&&o.length)){const m=n.getNode(((l=n.getPredecessors(f))===null||l===void 0?void 0:l[0].id)||""),w=n.getNode(((c=n.getPredecessors(d))===null||c===void 0?void 0:c[0].id)||"");y.hasOwnProperty("barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+m.data.order+w.data.order)/(y.weight+2),y.weight+=2}return y},XG=(n,t)=>{n==null||n.forEach(e=>{var r;const i=(r=e.vs)===null||r===void 0?void 0:r.map(a=>t[a]?t[a].vs:a);e.vs=i.flat()})},KG=(n,t)=>{n.barycenter!==void 0?(n.barycenter=(n.barycenter*n.weight+t.barycenter*t.weight)/(n.weight+t.weight),n.weight+=t.weight):(n.barycenter=t.barycenter,n.weight=t.weight)},ZG=(n,t)=>{const e=KR(n),r=[],i=[];for(let u=1;u<e+1;u++)r.push(u);for(let u=e-1;u>-1;u--)i.push(u);const a=hS(n,r,"in"),s=hS(n,i,"out");let o=cS(n);Dg(n,o);let l=Number.POSITIVE_INFINITY,c;for(let u=0,h=0;h<4;++u,++h){fS(u%2?a:s,u%4>=2,!1,t),o=Ql(n);const f=lS(n,o);f<l&&(h=0,c=Va(o),l=f)}o=cS(n),Dg(n,o);for(let u=0,h=0;h<4;++u,++h){fS(u%2?a:s,u%4>=2,!0,t),o=Ql(n);const f=lS(n,o);f<l&&(h=0,c=Va(o),l=f)}Dg(n,c)},hS=(n,t,e)=>t.map(r=>jG(n,r,e)),fS=(n,t,e,r)=>{const i=new kn;n==null||n.forEach(a=>{var s;const o=a.getRoots()[0].id,l=nL(a,o,i,t,e,r);for(let c=0;c<((s=l.vs)===null||s===void 0?void 0:s.length);c++){const u=a.getNode(l.vs[c]);u&&(u.data.order=c)}zG(a,i,l.vs)})},Dg=(n,t)=>{t==null||t.forEach(e=>{e==null||e.forEach((r,i)=>{n.getNode(r).data.order=i})})},JG=(n,t)=>{const r=n.getAllNodes().filter(s=>{var o;return!(!((o=n.getChildren(s.id))===null||o===void 0)&&o.length)}).map(s=>s.data.rank),i=Math.max(...r),a=[];for(let s=0;s<i+1;s++)a[s]=[];t==null||t.forEach(s=>{const o=n.getNode(s);!o||o.data.dummy||isNaN(o.data.rank)||(o.data.fixorder=a[o.data.rank].length,a[o.data.rank].push(s))})},QG=n=>{const t={};let e=0;const r=i=>{const a=e;n.getChildren(i).forEach(s=>r(s.id)),t[i]={low:a,lim:e++}};return n.getRoots().forEach(i=>r(i.id)),t},tW=(n,t,e,r)=>{var i,a;const s=[],o=[],l=Math.min(t[e].low,t[r].low),c=Math.max(t[e].lim,t[r].lim);let u,h;u=e;do u=(i=n.getParent(u))===null||i===void 0?void 0:i.id,s.push(u);while(u&&(t[u].low>l||c>t[u].lim));for(h=u,u=r;u&&u!==h;)o.push(u),u=(a=n.getParent(u))===null||a===void 0?void 0:a.id;return{lca:h,path:s.concat(o.reverse())}},eW=(n,t)=>{const e=QG(n);t.forEach(r=>{var i,a;let s=r,o=n.getNode(s);const l=o.data.originalEdge;if(!l)return;const c=tW(n,e,l.source,l.target),u=c.path,h=c.lca;let f=0,d=u[f],g=!0;for(;s!==l.target;){if(o=n.getNode(s),g){for(;d!==h&&((i=n.getNode(d))===null||i===void 0?void 0:i.data.maxRank)<o.data.rank;)f++,d=u[f];d===h&&(g=!1)}if(!g){for(;f<u.length-1&&((a=n.getNode(u[f+1]))===null||a===void 0?void 0:a.data.minRank)<=o.data.rank;)f++;d=u[f]}n.hasNode(d)&&n.setParent(s,d),s=n.getSuccessors(s)[0].id}})},nW=(n,t)=>{const e={},r=(i,a)=>{let s=0,o=0;const l=i.length,c=a==null?void 0:a[(a==null?void 0:a.length)-1];return a==null||a.forEach((u,h)=>{var f;const d=iW(n,u),g=d?n.getNode(d.id).data.order:l;(d||u===c)&&((f=a.slice(o,h+1))===null||f===void 0||f.forEach(v=>{var p;(p=n.getPredecessors(v))===null||p===void 0||p.forEach(y=>{var m;const w=n.getNode(y.id),E=w.data.order;(E<s||g<E)&&!(w.data.dummy&&(!((m=n.getNode(v))===null||m===void 0)&&m.data.dummy))&&rL(e,y.id,v)})}),o=h+1,s=g)}),a};return t!=null&&t.length&&t.reduce(r),e},rW=(n,t)=>{const e={};function r(o,l,c,u,h){var f,d;let g;for(let v=l;v<c;v++)g=o[v],!((f=n.getNode(g))===null||f===void 0)&&f.data.dummy&&((d=n.getPredecessors(g))===null||d===void 0||d.forEach(p=>{const y=n.getNode(p.id);y.data.dummy&&(y.data.order<u||y.data.order>h)&&rL(e,p.id,g)}))}function i(o){return JSON.stringify(o.slice(1))}function a(o,l){const c=i(o);l.get(c)||(r(...o),l.set(c,!0))}const s=(o,l)=>{let c=-1,u,h=0;const f=new Map;return l==null||l.forEach((d,g)=>{var v;if(((v=n.getNode(d))===null||v===void 0?void 0:v.data.dummy)==="border"){const p=n.getPredecessors(d)||[];p.length&&(u=n.getNode(p[0].id).data.order,a([l,h,g,c,u],f),h=g,c=u)}a([l,h,l.length,u,o.length],f)}),l};return t!=null&&t.length&&t.reduce(s),e},iW=(n,t)=>{var e,r;if(!((e=n.getNode(t))===null||e===void 0)&&e.data.dummy)return(r=n.getPredecessors(t))===null||r===void 0?void 0:r.find(i=>n.getNode(i.id).data.dummy)},rL=(n,t,e)=>{let r=t,i=e;if(r>i){const s=r;r=i,i=s}let a=n[r];a||(n[r]=a={}),a[i]=!0},aW=(n,t,e)=>{let r=t,i=e;if(r>i){const a=t;r=i,i=a}return!!n[r]},sW=(n,t,e,r)=>{const i={},a={},s={};return t==null||t.forEach(o=>{o==null||o.forEach((l,c)=>{i[l]=l,a[l]=l,s[l]=c})}),t==null||t.forEach(o=>{let l=-1;o==null||o.forEach(c=>{let u=r(c).map(h=>h.id);if(u.length){u=u.sort((f,d)=>s[f]-s[d]);const h=(u.length-1)/2;for(let f=Math.floor(h),d=Math.ceil(h);f<=d;++f){const g=u[f];a[c]===c&&l<s[g]&&!aW(e,c,g)&&(a[g]=c,a[c]=i[c]=i[g],l=s[g])}}})}),{root:i,align:a}},oW=(n,t,e,r,i,a,s)=>{var o;const l={},c=lW(n,t,e,i,a,s),u=s?"borderLeft":"borderRight",h=(g,v)=>{let p=c.getAllNodes(),y=p.pop();const m={};for(;y;)m[y.id]?g(y.id):(m[y.id]=!0,p.push(y),p=p.concat(v(y.id))),y=p.pop()},f=g=>{l[g]=(c.getRelatedEdges(g,"in")||[]).reduce((v,p)=>Math.max(v,(l[p.source]||0)+p.data.weight),0)},d=g=>{const v=(c.getRelatedEdges(g,"out")||[]).reduce((y,m)=>Math.min(y,(l[m.target]||0)-m.data.weight),Number.POSITIVE_INFINITY),p=n.getNode(g);v!==Number.POSITIVE_INFINITY&&p.data.borderType!==u&&(l[g]=Math.max(l[g],v))};return h(f,c.getPredecessors.bind(c)),h(d,c.getSuccessors.bind(c)),(o=Object.values(r))===null||o===void 0||o.forEach(g=>{l[g]=l[e[g]]}),l},lW=(n,t,e,r,i,a)=>{const s=new kn,o=fW(r,i,a);return t==null||t.forEach(l=>{let c;l==null||l.forEach(u=>{const h=e[u];if(s.hasNode(h)||s.addNode({id:h,data:{}}),c){const f=e[c],d=s.getRelatedEdges(f,"out").find(g=>g.target===h);d?s.updateEdgeData(d.id,Object.assign(Object.assign({},d.data),{weight:Math.max(o(n,u,c),d.data.weight||0)})):s.addEdge({id:`e${Math.random()}`,source:f,target:h,data:{weight:Math.max(o(n,u,c),0)}})}c=u})}),s},cW=(n,t)=>Hw(Object.values(t),e=>{var r;let i=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY;return(r=Object.keys(e))===null||r===void 0||r.forEach(s=>{const o=e[s],l=dW(n,s)/2;i=Math.max(o+l,i),a=Math.min(o-l,a)}),i-a});function uW(n,t){const e=Object.values(t),r=Math.min(...e),i=Math.max(...e);["u","d"].forEach(a=>{["l","r"].forEach(s=>{const o=a+s,l=n[o];let c;if(l===t)return;const u=Object.values(l);c=s==="l"?r-Math.min(...u):i-Math.max(...u),c&&(n[o]={},Object.keys(l).forEach(h=>{n[o][h]=l[h]+c}))})})}const hW=(n,t)=>{const e={};return Object.keys(n.ul).forEach(r=>{if(t)e[r]=n[t.toLowerCase()][r];else{const i=Object.values(n).map(a=>a[r]);e[r]=(i[0]+i[1])/2}}),e},fW=(n,t,e)=>(r,i,a)=>{const s=r.getNode(i),o=r.getNode(a);let l=0,c=0;if(l+=s.data.width/2,s.data.hasOwnProperty("labelpos"))switch((s.data.labelpos||"").toLowerCase()){case"l":c=-s.data.width/2;break;case"r":c=s.data.width/2;break}if(c&&(l+=e?c:-c),c=0,l+=(s.data.dummy?t:n)/2,l+=(o.data.dummy?t:n)/2,l+=o.data.width/2,o.data.labelpos)switch((o.data.labelpos||"").toLowerCase()){case"l":c=o.data.width/2;break;case"r":c=-o.data.width/2;break}return c&&(l+=e?c:-c),c=0,l},dW=(n,t)=>n.getNode(t).data.width||0,gW=(n,t)=>{const{ranksep:e=0}=t||{},r=Ql(n);let i=0;r==null||r.forEach(a=>{const s=a.map(l=>n.getNode(l).data.height),o=Math.max(...s,0);a==null||a.forEach(l=>{n.getNode(l).data.y=i+o/2}),i+=o+e})},pW=(n,t)=>{const{align:e,nodesep:r=0,edgesep:i=0}=t||{},a=Ql(n),s=Object.assign(nW(n,a),rW(n,a)),o={};let l=[];["u","d"].forEach(u=>{l=u==="u"?a:Object.values(a).reverse(),["l","r"].forEach(h=>{h==="r"&&(l=l.map(v=>Object.values(v).reverse()));const f=(u==="u"?n.getPredecessors:n.getSuccessors).bind(n),d=sW(n,l,s,f),g=oW(n,l,d.root,d.align,r,i,h==="r");h==="r"&&Object.keys(g).forEach(v=>g[v]=-g[v]),o[u+h]=g})});const c=cW(n,o);return c&&uW(o,c),hW(o,e)},vW=(n,t)=>{var e;const r=XR(n);gW(r,t);const i=pW(r,t);(e=Object.keys(i))===null||e===void 0||e.forEach(a=>{r.getNode(a).data.x=i[a]})},iL=n=>{const t={},e=r=>{var i;const a=n.getNode(r);if(!a)return 0;if(t[r])return a.data.rank;t[r]=!0;let s;return(i=n.getRelatedEdges(r,"out"))===null||i===void 0||i.forEach(o=>{const l=e(o.target),c=o.data.minlen,u=l-c;u&&(s===void 0||u<s)&&(s=u)}),s||(s=0),a.data.rank=s,s};n.getAllNodes().filter(r=>n.getRelatedEdges(r.id,"in").length===0).forEach(r=>e(r.id))},yW=n=>{const t={};let e;const r=s=>{var o;const l=n.getNode(s);if(!l)return 0;if(t[s])return l.data.rank;t[s]=!0;let c;return(o=n.getRelatedEdges(s,"out"))===null||o===void 0||o.forEach(u=>{const h=r(u.target),f=u.data.minlen,d=h-f;d&&(c===void 0||d<c)&&(c=d)}),c||(c=0),(e===void 0||c<e)&&(e=c),l.data.rank=c,c};n.getAllNodes().filter(s=>n.getRelatedEdges(s.id,"in").length===0).forEach(s=>{s&&r(s.id)}),e===void 0&&(e=0);const i={},a=(s,o)=>{var l;const c=n.getNode(s),u=isNaN(c.data.layer)?o:c.data.layer;(c.data.rank===void 0||c.data.rank<u)&&(c.data.rank=u),!i[s]&&(i[s]=!0,(l=n.getRelatedEdges(s,"out"))===null||l===void 0||l.forEach(h=>{a(h.target,u+h.data.minlen)}))};n.getAllNodes().forEach(s=>{const o=s.data;o&&(isNaN(o.layer)?o.rank-=e:a(s.id,o.layer))})},Xa=(n,t)=>n.getNode(t.target).data.rank-n.getNode(t.source).data.rank-t.data.minlen,mW=n=>{const t=new kn({tree:[]}),e=n.getAllNodes()[0],r=n.getAllNodes().length;t.addNode(e);let i,a;for(;bW(t,n)<r;)i=aL(t,n),a=t.hasNode(i.source)?Xa(n,i):-Xa(n,i),sL(t,n,a);return t},bW=(n,t)=>{const e=r=>{t.getRelatedEdges(r,"both").forEach(i=>{const a=i.source,s=r===a?i.target:a;!n.hasNode(s)&&!Xa(t,i)&&(n.addNode({id:s,data:{}}),n.addEdge({id:i.id,source:r,target:s,data:{}}),e(s))})};return n.getAllNodes().forEach(r=>e(r.id)),n.getAllNodes().length},wW=n=>{const t=new kn({tree:[]}),e=n.getAllNodes()[0],r=n.getAllNodes().length;t.addNode(e);let i,a;for(;xW(t,n)<r;)i=aL(t,n),a=t.hasNode(i.source)?Xa(n,i):-Xa(n,i),sL(t,n,a);return t},xW=(n,t)=>{const e=r=>{var i;(i=t.getRelatedEdges(r,"both"))===null||i===void 0||i.forEach(a=>{const s=a.source,o=r===s?a.target:s;!n.hasNode(o)&&(t.getNode(o).data.layer!==void 0||!Xa(t,a))&&(n.addNode({id:o,data:{}}),n.addEdge({id:a.id,source:r,target:o,data:{}}),e(o))})};return n.getAllNodes().forEach(r=>e(r.id)),n.getAllNodes().length},aL=(n,t)=>Hw(t.getAllEdges(),e=>n.hasNode(e.source)!==n.hasNode(e.target)?Xa(t,e):1/0),sL=(n,t,e)=>{n.getAllNodes().forEach(r=>{const i=t.getNode(r.id);i.data.rank||(i.data.rank=0),i.data.rank+=e})},EW=n=>{const t=xG(n);iL(t);const e=mW(t);lL(e),oL(e,t);let r,i;for(;r=MW(e);)i=OW(e,t,r),TW(e,t,r,i)},oL=(n,t)=>{let e=JR(n,n.getAllNodes(),"post");e=e.slice(0,(e==null?void 0:e.length)-1),e.forEach(r=>{SW(n,t,r)})},SW=(n,t,e)=>{const i=n.getNode(e).data.parent,a=n.getRelatedEdges(e,"both").find(s=>s.target===i||s.source===i);a.data.cutvalue=_W(n,t,e)},_W=(n,t,e)=>{const i=n.getNode(e).data.parent;let a=!0,s=t.getRelatedEdges(e,"out").find(l=>l.target===i),o=0;return s||(a=!1,s=t.getRelatedEdges(i,"out").find(l=>l.target===e)),o=s.data.weight,t.getRelatedEdges(e,"both").forEach(l=>{const c=l.source===e,u=c?l.target:l.source;if(u!==i){const h=c===a,f=l.data.weight;if(o+=h?f:-f,AW(n,e,u)){const d=n.getRelatedEdges(e,"both").find(g=>g.source===u||g.target===u).data.cutvalue;o+=h?-d:d}}}),o},lL=(n,t=n.getAllNodes()[0].id)=>{cL(n,{},1,t)},cL=(n,t,e,r,i)=>{var a;const s=e;let o=e;const l=n.getNode(r);return t[r]=!0,(a=n.getNeighbors(r))===null||a===void 0||a.forEach(c=>{t[c.id]||(o=cL(n,t,o,c.id,r))}),l.data.low=s,l.data.lim=o++,i?l.data.parent=i:delete l.data.parent,o},MW=n=>n.getAllEdges().find(t=>t.data.cutvalue<0),OW=(n,t,e)=>{let r=e.source,i=e.target;t.getRelatedEdges(r,"out").find(u=>u.target===i)||(r=e.target,i=e.source);const a=n.getNode(r),s=n.getNode(i);let o=a,l=!1;a.data.lim>s.data.lim&&(o=s,l=!0);const c=t.getAllEdges().filter(u=>l===dS(n.getNode(u.source),o)&&l!==dS(n.getNode(u.target),o));return Hw(c,u=>Xa(t,u))},TW=(n,t,e,r)=>{const i=n.getRelatedEdges(e.source,"both").find(a=>a.source===e.target||a.target===e.target);i&&n.removeEdge(i.id),n.addEdge({id:`e${Math.random()}`,source:r.source,target:r.target,data:{}}),lL(n),oL(n,t),kW(n,t)},kW=(n,t)=>{const e=n.getAllNodes().find(i=>!i.data.parent);let r=JR(n,e,"pre");r=r.slice(1),r.forEach(i=>{const a=n.getNode(i).data.parent;let s=t.getRelatedEdges(i,"out").find(l=>l.target===a),o=!1;!s&&t.hasNode(a)&&(s=t.getRelatedEdges(a,"out").find(l=>l.target===i),o=!0),t.getNode(i).data.rank=(t.hasNode(a)&&t.getNode(a).data.rank||0)+(o?s==null?void 0:s.data.minlen:-(s==null?void 0:s.data.minlen))})},AW=(n,t,e)=>n.getRelatedEdges(t,"both").find(r=>r.source===e||r.target===e),dS=(n,t)=>t.data.low<=n.data.lim&&n.data.lim<=t.data.lim,CW=(n,t)=>{switch(t){case"network-simplex":NW(n);break;case"tight-tree":gS(n);break;case"longest-path":PW(n);break;default:gS(n)}},PW=iL,gS=n=>{yW(n),wW(n)},NW=n=>{EW(n)},RW=(n,t)=>{const{edgeLabelSpace:e,keepNodeOrder:r,prevGraph:i,rankdir:a,ranksep:s}=t;!r&&i&&IW(n,i);const o=qW(n);e&&(t.ranksep=$W(o,{rankdir:a,ranksep:s}));let l;try{l=LW(o,t)}catch(c){if(c.message==="Not possible to find intersection inside of the rectangle"){console.error(`The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:
`,c);return}throw c}return DW(n,o),l},LW=(n,t)=>{const{ranker:e,rankdir:r="tb",nodeOrder:i,keepNodeOrder:a,align:s,nodesep:o=50,edgesep:l=20,ranksep:c=50}=t;ZW(n),mG(n);const{nestingRoot:u,nodeRankFactor:h}=PG(n);CW(XR(n),e),GW(n),_G(n,h),LG(n,u),SG(n),WW(n),VW(n);const f=[];DG(n,f),eW(n,f),OG(n),a&&JG(n,i),ZG(n,a),JW(n),TG(n,r),vW(n,{align:s,nodesep:o,edgesep:l,ranksep:c}),QW(n),KW(n),BG(n,f),YW(n),kG(n,r);const{width:d,height:g}=HW(n);return UW(n),XW(n),bG(n),{width:d,height:g}},IW=(n,t)=>{n.getAllNodes().forEach(e=>{const r=n.getNode(e.id);if(t.hasNode(e.id)){const i=t.getNode(e.id);r.data.fixorder=i.data._order,delete i.data._order}else delete r.data.fixorder})},DW=(n,t)=>{n.getAllNodes().forEach(e=>{var r;const i=n.getNode(e.id);if(i){const a=t.getNode(e.id);i.data.x=a.data.x,i.data.y=a.data.y,i.data._order=a.data.order,i.data._rank=a.data.rank,!((r=t.getChildren(e.id))===null||r===void 0)&&r.length&&(i.data.width=a.data.width,i.data.height=a.data.height)}}),n.getAllEdges().forEach(e=>{const r=n.getEdge(e.id),i=t.getEdge(e.id);r.data.points=i?i.data.points:[],i&&i.data.hasOwnProperty("x")&&(r.data.x=i.data.x,r.data.y=i.data.y)})},FW=["width","height","layer","fixorder"],BW={width:0,height:0},zW=["minlen","weight","width","height","labeloffset"],jW={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Fg=["labelpos"],qW=n=>{const t=new kn({tree:[]});return n.getAllNodes().forEach(e=>{const r=vS(n.getNode(e.id).data),i=Object.assign(Object.assign({},BW),r),a=pS(i,FW);t.hasNode(e.id)||t.addNode({id:e.id,data:Object.assign({},a)});const s=n.hasTreeStructure("combo")?n.getParent(e.id,"combo"):n.getParent(e.id);Ut(s)||(t.hasNode(s.id)||t.addNode(Object.assign({},s)),t.setParent(e.id,s.id))}),n.getAllEdges().forEach(e=>{const r=vS(n.getEdge(e.id).data),i={};Fg==null||Fg.forEach(a=>{r[a]!==void 0&&(i[a]=r[a])}),t.addEdge({id:e.id,source:e.source,target:e.target,data:Object.assign({},jW,pS(r,zW),i)})}),t},$W=(n,t)=>{const{ranksep:e=0,rankdir:r}=t;return n.getAllNodes().forEach(i=>{isNaN(i.data.layer)||i.data.layer||(i.data.layer=0)}),n.getAllEdges().forEach(i=>{var a;i.data.minlen*=2,((a=i.data.labelpos)===null||a===void 0?void 0:a.toLowerCase())!=="c"&&(r==="TB"||r==="BT"?i.data.width+=i.data.labeloffset:i.data.height+=i.data.labeloffset)}),e/2},GW=n=>{n.getAllEdges().forEach(t=>{if(t.data.width&&t.data.height){const e=n.getNode(t.source),r=n.getNode(t.target),i={e:t,rank:(r.data.rank-e.data.rank)/2+e.data.rank};zo(n,"edge-proxy",i,"_ep")}})},WW=n=>{let t=0;return n.getAllNodes().forEach(e=>{var r,i;e.data.borderTop&&(e.data.minRank=(r=n.getNode(e.data.borderTop))===null||r===void 0?void 0:r.data.rank,e.data.maxRank=(i=n.getNode(e.data.borderBottom))===null||i===void 0?void 0:i.data.rank,t=Math.max(t,e.data.maxRank||-1/0))}),t},VW=n=>{n.getAllNodes().forEach(t=>{t.data.dummy==="edge-proxy"&&(n.getEdge(t.data.e.id).data.labelRank=t.data.rank,n.removeNode(t.id))})},HW=(n,t)=>{let e,r=0,i,a=0;const{marginx:s=0,marginy:o=0}={},l=c=>{if(!c.data)return;const u=c.data.x,h=c.data.y,f=c.data.width,d=c.data.height;!isNaN(u)&&!isNaN(f)&&(e===void 0&&(e=u-f/2),e=Math.min(e,u-f/2),r=Math.max(r,u+f/2)),!isNaN(h)&&!isNaN(d)&&(i===void 0&&(i=h-d/2),i=Math.min(i,h-d/2),a=Math.max(a,h+d/2))};return n.getAllNodes().forEach(c=>{l(c)}),n.getAllEdges().forEach(c=>{c!=null&&c.data.hasOwnProperty("x")&&l(c)}),e-=s,i-=o,n.getAllNodes().forEach(c=>{c.data.x-=e,c.data.y-=i}),n.getAllEdges().forEach(c=>{var u;(u=c.data.points)===null||u===void 0||u.forEach(h=>{h.x-=e,h.y-=i}),c.data.hasOwnProperty("x")&&(c.data.x-=e),c.data.hasOwnProperty("y")&&(c.data.y-=i)}),{width:r-e+s,height:a-i+o}},UW=n=>{n.getAllEdges().forEach(t=>{const e=n.getNode(t.source),r=n.getNode(t.target);let i,a;t.data.points?(i=t.data.points[0],a=t.data.points[t.data.points.length-1]):(t.data.points=[],i={x:r.data.x,y:r.data.y},a={x:e.data.x,y:e.data.y}),t.data.points.unshift(iS(e.data,i)),t.data.points.push(iS(r.data,a))})},YW=n=>{n.getAllEdges().forEach(t=>{if(t.data.hasOwnProperty("x"))switch((t.data.labelpos==="l"||t.data.labelpos==="r")&&(t.data.width-=t.data.labeloffset),t.data.labelpos){case"l":t.data.x-=t.data.width/2+t.data.labeloffset;break;case"r":t.data.x+=t.data.width/2+t.data.labeloffset;break}})},XW=n=>{n.getAllEdges().forEach(t=>{var e;t.data.reversed&&((e=t.data.points)===null||e===void 0||e.reverse())})},KW=n=>{n.getAllNodes().forEach(t=>{var e,r,i;if(!((e=n.getChildren(t.id))===null||e===void 0)&&e.length){const a=n.getNode(t.id),s=n.getNode(a.data.borderTop),o=n.getNode(a.data.borderBottom),l=n.getNode(a.data.borderLeft[((r=a.data.borderLeft)===null||r===void 0?void 0:r.length)-1]),c=n.getNode(a.data.borderRight[((i=a.data.borderRight)===null||i===void 0?void 0:i.length)-1]);a.data.width=Math.abs((c==null?void 0:c.data.x)-(l==null?void 0:l.data.x))||10,a.data.height=Math.abs((o==null?void 0:o.data.y)-(s==null?void 0:s.data.y))||10,a.data.x=((l==null?void 0:l.data.x)||0)+a.data.width/2,a.data.y=((s==null?void 0:s.data.y)||0)+a.data.height/2}}),n.getAllNodes().forEach(t=>{t.data.dummy==="border"&&n.removeNode(t.id)})},ZW=n=>{n.getAllEdges().forEach(t=>{if(t.source===t.target){const e=n.getNode(t.source);e.data.selfEdges||(e.data.selfEdges=[]),e.data.selfEdges.push(t),n.removeEdge(t.id)}})},JW=n=>{const t=Ql(n);t==null||t.forEach(e=>{let r=0;e==null||e.forEach((i,a)=>{var s;const o=n.getNode(i);o.data.order=a+r,(s=o.data.selfEdges)===null||s===void 0||s.forEach(l=>{zo(n,"selfedge",{width:l.data.width,height:l.data.height,rank:o.data.rank,order:a+ ++r,e:l},"_se")}),delete o.data.selfEdges})})},QW=n=>{n.getAllNodes().forEach(t=>{const e=n.getNode(t.id);if(e.data.dummy==="selfedge"){const r=n.getNode(e.data.e.source),i=r.data.x+r.data.width/2,a=r.data.y,s=e.data.x-i,o=r.data.height/2;n.hasEdge(e.data.e.id)?n.updateEdgeData(e.data.e.id,e.data.e.data):n.addEdge({id:e.data.e.id,source:e.data.e.source,target:e.data.e.target,data:e.data.e.data}),n.removeNode(t.id),e.data.e.data.points=[{x:i+2*s/3,y:a-o},{x:i+5*s/6,y:a-o},{y:a,x:i+s},{x:i+5*s/6,y:a+o},{x:i+2*s/3,y:a+o}],e.data.e.data.x=e.data.x,e.data.e.data.y=e.data.y}})},pS=(n,t)=>{const e={};return t==null||t.forEach(r=>{n[r]!==void 0&&(e[r]=+n[r])}),e},vS=(n={})=>{const t={};return Object.keys(n).forEach(e=>{t[e.toLowerCase()]=n[e]}),t},ea=Array.isArray,uL=n=>{const t=[],e=n.length;for(let r=0;r<e;r+=1){t[r]=[];for(let i=0;i<e;i+=1)r===i?t[r][i]=0:n[r][i]===0||!n[r][i]?t[r][i]=1/0:t[r][i]=n[r][i]}for(let r=0;r<e;r+=1)for(let i=0;i<e;i+=1)for(let a=0;a<e;a+=1)t[i][a]>t[i][r]+t[r][a]&&(t[i][a]=t[i][r]+t[r][a]);return t},hL=(n,t)=>{const{nodes:e,edges:r}=n,i=[],a={};if(!e)throw new Error("invalid nodes data!");return e&&e.forEach((s,o)=>{a[s.id]=o;const l=[];i.push(l)}),r==null||r.forEach(s=>{const{source:o,target:l}=s,c=a[o],u=a[l];c===void 0||u===void 0||(i[c][u]=1,i[u][c]=1)}),i},tV=(n,t)=>{const e=[];return n.forEach(r=>{const i=[];r.forEach(a=>{i.push(a*t)}),e.push(i)}),e},eV=n=>{let t=1/0,e=1/0,r=-1/0,i=-1/0;return n.forEach(a=>{let s=a.data.size;ea(s)?s.length===1&&(s=[s[0],s[0]]):Lt(s)?s=[s,s]:(s===void 0||isNaN(s))&&(s=[30,30]);const o=[s[0]/2,s[1]/2],l=a.data.x-o[0],c=a.data.x+o[0],u=a.data.y-o[1],h=a.data.y+o[1];t>l&&(t=l),e>u&&(e=u),r<c&&(r=c),i<h&&(i=h)}),{minX:t,minY:e,maxX:r,maxY:i}},yS=(n,t)=>Math.sqrt((n.x-t.x)*(n.x-t.x)+(n.y-t.y)*(n.y-t.y)),_b=(n,t,e,r="TB",i,a={})=>{if(!(t!=null&&t.length))return;const{stopBranchFn:s,stopAllFn:o}=a;for(let l=0;l<t.length;l++){const c=t[l];if(n.hasNode(c.id)&&!(s!=null&&s(c))){if(o!=null&&o(c))return;r==="TB"&&e(c),_b(n,n.getChildren(c.id,i),e,r,i,a),r!=="TB"&&e(c)}}},Mb=n=>{if(n===null)return n;if(n instanceof Date)return new Date(n.getTime());if(n instanceof Array){const t=[];return n.forEach(e=>{t.push(e)}),t.map(e=>Mb(e))}if(typeof n=="object"){const t={};return Object.keys(n).forEach(e=>{t[e]=Mb(n[e])}),t}return n},Br=(n,t)=>{const e=Mb(n);return e.data=e.data||{},t&&(Lt(e.data.x)||(e.data.x=Math.random()*t[0]),Lt(e.data.y)||(e.data.y=Math.random()*t[1])),e};function _c(n){if(!n)return[0,0,0];if(Lt(n))return[n,n,n];if(n.length===0)return[0,0,0];const[t,e=t,r=t]=n;return[t,e,r]}function Cs(n,t){let e;return zt(t)?e=t:Lt(t)?e=()=>t:e=()=>n,e}function Uw(n,t,e=!0){return!t&&t!==0?r=>{const{size:i}=r.data||{};return i?Array.isArray(i)?e?Math.max(...i)||n:i:hn(i)&&i.width&&i.height?e?Math.max(i.width,i.height)||n:[i.width,i.height]:i:n}:zt(t)?t:Lt(t)?()=>t:Array.isArray(t)?()=>e?Math.max(...t)||n:t:hn(t)&&t.width&&t.height?()=>e?Math.max(t.width,t.height)||n:[t.width,t.height]:()=>n}const Yw=(n,t,e=10)=>{let r;const i=typeof t=="function"?t:()=>t||0;return n?Array.isArray(n)?r=s=>n:zt(n)?r=n:r=s=>n:r=s=>{var o,l,c;if(!((o=s.data)===null||o===void 0)&&o.bboxSize)return(l=s.data)===null||l===void 0?void 0:l.bboxSize;if(!((c=s.data)===null||c===void 0)&&c.size){const u=s.data.size;return Array.isArray(u)?u:hn(u)?[u.width,u.height]:u}return e},s=>{const o=r(s),l=i(s);return Math.max(..._c(o))+l}},nV={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,ranker:"tight-tree",controlPoints:!1,radial:!1,focusNode:null};class rV{constructor(t={}){this.options=t,this.id="antv-dagre",this.options=Object.assign(Object.assign({},nV),t)}execute(t,e){return oe(this,void 0,void 0,function*(){return this.genericDagreLayout(!1,t,e)})}assign(t,e){return oe(this,void 0,void 0,function*(){yield this.genericDagreLayout(!0,t,e)})}genericDagreLayout(t,e,r){return oe(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),r),{nodeSize:a,align:s,rankdir:o="TB",ranksep:l,nodesep:c,ranksepFunc:u,nodesepFunc:h,edgeLabelSpace:f,ranker:d,nodeOrder:g,begin:v,controlPoints:p,radial:y,sortByCombo:m,preset:w}=i,E=new kn({tree:[]}),S=Cs(l||50,u),O=Cs(c||50,h);let k=O,T=S;(o==="LR"||o==="RL")&&(k=S,T=O);const C=Uw(10,a,!1),P=e.getAllNodes(),N=e.getAllEdges();P.forEach(z=>{const Z=_c(C(z)),at=T(z),ft=k(z),ct=Z[0]+2*ft,Gt=Z[1]+2*at,J=z.data.layer;Lt(J)?E.addNode({id:z.id,data:{width:ct,height:Gt,layer:J}}):E.addNode({id:z.id,data:{width:ct,height:Gt}})}),m&&(E.attachTreeStructure("combo"),P.forEach(z=>{const{parentId:Z}=z.data;Z!==void 0&&E.hasNode(Z)&&E.setParent(z.id,Z,"combo")})),N.forEach(z=>{E.addEdge({id:z.id,source:z.source,target:z.target,data:{weight:z.data.weight||1}})});let L;w!=null&&w.length&&(L=new kn({nodes:w})),RW(E,{prevGraph:L,edgeLabelSpace:f,keepNodeOrder:!!g,nodeOrder:g||[],acyclicer:"greedy",ranker:d,rankdir:o,nodesep:c,align:s});const D=[0,0];if(v){let z=1/0,Z=1/0;E.getAllNodes().forEach(at=>{z>at.data.x&&(z=at.data.x),Z>at.data.y&&(Z=at.data.y)}),E.getAllEdges().forEach(at=>{var ft;(ft=at.data.points)===null||ft===void 0||ft.forEach(ct=>{z>ct.x&&(z=ct.x),Z>ct.y&&(Z=ct.y)})}),D[0]=v[0]-z,D[1]=v[1]-Z}const G=o==="LR"||o==="RL";if(!y){const z=new Set,at=o==="BT"||o==="RL"?(J,V)=>V-J:(J,V)=>J-V;E.getAllNodes().forEach(J=>{J.data.x=J.data.x+D[0],J.data.y=J.data.y+D[1],z.add(G?J.data.x:J.data.y)});const ft=Array.from(z).sort(at),ct=G?(J,V)=>J.x!==V.x:(J,V)=>J.y!==V.y,Gt=G?(J,V,nt)=>{const dt=Math.max(V.y,nt.y),Nt=Math.min(V.y,nt.y);return J.filter(Wt=>Wt.y<=dt&&Wt.y>=Nt)}:(J,V,nt)=>{const dt=Math.max(V.x,nt.x),Nt=Math.min(V.x,nt.x);return J.filter(Wt=>Wt.x<=dt&&Wt.x>=Nt)};E.getAllEdges().forEach((J,V)=>{var nt;f&&p&&J.data.type!=="loop"&&(J.data.controlPoints=iV((nt=J.data.points)===null||nt===void 0?void 0:nt.map(({x:dt,y:Nt})=>({x:dt+D[0],y:Nt+D[1]})),E.getNode(J.source),E.getNode(J.target),ft,G,ct,Gt))})}let H=[];H=E.getAllNodes().map(z=>Br(z));const W=E.getAllEdges();return t&&(H.forEach(z=>{e.mergeNodeData(z.id,{x:z.data.x,y:z.data.y})}),W.forEach(z=>{e.mergeEdgeData(z.id,{controlPoints:z.data.controlPoints})})),{nodes:H,edges:W}})}}const iV=(n,t,e,r,i,a,s)=>{let o=(n==null?void 0:n.slice(1,n.length-1))||[];if(t&&e){let{x:l,y:c}=t.data,{x:u,y:h}=e.data;if(i&&(l=t.data.y,c=t.data.x,u=e.data.y,h=e.data.x),h!==c&&l!==u){const f=r.indexOf(c),d=r[f+1];if(d){const p=o[0],y=i?{x:(c+d)/2,y:(p==null?void 0:p.y)||u}:{x:(p==null?void 0:p.x)||u,y:(c+d)/2};(!p||a(p,y))&&o.unshift(y)}const g=r.indexOf(h),v=Math.abs(g-f);if(v===1)o=s(o,t.data,e.data),o.length||o.push(i?{x:(c+h)/2,y:l}:{x:l,y:(c+h)/2});else if(v>1){const p=r[g-1];if(p){const y=o[o.length-1],m=i?{x:(h+p)/2,y:(y==null?void 0:y.y)||u}:{x:(y==null?void 0:y.x)||l,y:(h+p)/2};(!y||a(y,m))&&o.push(m)}}}}return o},Vs=(n,t,e)=>{const r=n.getAllNodes(),i=n.getAllEdges();if(!(r!=null&&r.length))return{nodes:[],edges:i};if(r.length===1)return t&&n.mergeNodeData(r[0].id,{x:e[0],y:e[1]}),{nodes:[Object.assign(Object.assign({},r[0]),{data:Object.assign(Object.assign({},r[0].data),{x:e[0],y:e[1]})})],edges:i}},aV={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1};class sV{constructor(t={}){this.options=t,this.id="circular",this.options=Object.assign(Object.assign({},aV),t)}execute(t,e){return oe(this,void 0,void 0,function*(){return this.genericCircularLayout(!1,t,e)})}assign(t,e){return oe(this,void 0,void 0,function*(){yield this.genericCircularLayout(!0,t,e)})}genericCircularLayout(t,e,r){return oe(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),r),{width:a,height:s,center:o,divisions:l,startAngle:c=0,endAngle:u=2*Math.PI,angleRatio:h,ordering:f,clockwise:d,nodeSpacing:g,nodeSize:v}=i,p=e.getAllNodes(),y=e.getAllEdges(),[m,w,E]=lV(a,s,o),S=p==null?void 0:p.length;if(!S||S===1)return Vs(e,t,E);const O=(u-c)/S;let{radius:k,startRadius:T,endRadius:C}=i;if(g){const G=Cs(10,g),H=Uw(10,v);let W=-1/0;p.forEach(z=>{const Z=H(z);W<Z&&(W=Z)});let q=0;p.forEach((z,Z)=>{Z===0?q+=W||10:q+=(G(z)||0)+(W||10)}),k=q/(2*Math.PI)}else!k&&!T&&!C?k=Math.min(w,m)/2:!T&&C?T=C:T&&!C&&(C=T);const P=O*h;let N=[];f==="topology"?N=mS(e,p):f==="topology-directed"?N=mS(e,p,!0):f==="degree"?N=oV(e,p):N=p.map(G=>Br(G));const L=Math.ceil(S/l);for(let G=0;G<S;++G){let H=k;!H&&T!==null&&C!==null&&(H=T+G*(C-T)/(S-1)),H||(H=10+G*100/(S-1));let W=c+G%L*P+2*Math.PI/l*Math.floor(G/L);d||(W=u-G%L*P-2*Math.PI/l*Math.floor(G/L)),N[G].data.x=E[0]+Math.cos(W)*H,N[G].data.y=E[1]+Math.sin(W)*H}return t&&N.forEach(G=>{e.mergeNodeData(G.id,{x:G.data.x,y:G.data.y})}),{nodes:N,edges:y}})}}const mS=(n,t,e=!1)=>{const r=[Br(t[0])],i={},a=t.length;i[t[0].id]=!0;let s=0;return t.forEach((o,l)=>{if(l!==0)if((l===a-1||n.getDegree(o.id,"both")!==n.getDegree(t[l+1].id,"both")||n.areNeighbors(r[s].id,o.id))&&!i[o.id])r.push(Br(o)),i[o.id]=!0,s++;else{const c=e?n.getSuccessors(r[s].id):n.getNeighbors(r[s].id);let u=!1;for(let f=0;f<c.length;f++){const d=c[f];if(n.getDegree(d.id)===n.getDegree(o.id)&&!i[d.id]){r.push(Br(d)),i[d.id]=!0,u=!0;break}}let h=0;for(;!u&&(i[t[h].id]||(r.push(Br(t[h])),i[t[h].id]=!0,u=!0),h++,h!==a););}}),r};function oV(n,t){const e=[];return t.forEach((r,i)=>{e.push(Br(r))}),e.sort((r,i)=>n.getDegree(r.id,"both")-n.getDegree(i.id,"both")),e}const lV=(n,t,e)=>{let r=n,i=t,a=e;return!r&&typeof window<"u"&&(r=window.innerWidth),!i&&typeof window<"u"&&(i=window.innerHeight),a||(a=[r/2,i/2]),[r,i,a]},cV={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:3/2*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"};class Ob{constructor(t={}){this.options=t,this.id="concentric",this.options=Object.assign(Object.assign({},cV),t)}execute(t,e){return oe(this,void 0,void 0,function*(){return this.genericConcentricLayout(!1,t,e)})}assign(t,e){return oe(this,void 0,void 0,function*(){yield this.genericConcentricLayout(!0,t,e)})}genericConcentricLayout(t,e,r){return oe(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),r),{center:a,width:s,height:o,sortBy:l,maxLevelDiff:c,sweep:u,clockwise:h,equidistant:f,preventOverlap:d,startAngle:g=3/2*Math.PI,nodeSize:v,nodeSpacing:p}=i,y=e.getAllNodes(),m=e.getAllEdges(),w=!s&&typeof window<"u"?window.innerWidth:s,E=!o&&typeof window<"u"?window.innerHeight:o,S=a||[w/2,E/2];if(!(y!=null&&y.length)||y.length===1)return Vs(e,t,S);const O=[];let k,T=0;ea(v)?k=Math.max(v[0],v[1]):zt(v)?(k=-1/0,y.forEach(z=>{const Z=Math.max(..._c(v(z)));Z>k&&(k=Z)})):k=v,ea(p)?T=Math.max(p[0],p[1]):Lt(p)&&(T=p),y.forEach(z=>{const Z=Br(z);O.push(Z);let at=k;const{data:ft}=Z;ea(ft.size)?at=Math.max(ft.size[0],ft.size[1]):Lt(ft.size)?at=ft.size:hn(ft.size)&&(at=Math.max(ft.size.width,ft.size.height)),k=Math.max(k,at),zt(p)&&(T=Math.max(p(z),T))});const C={};O.forEach((z,Z)=>{C[z.id]=Z});let P=l;(!me(P)||O[0].data[P]===void 0)&&(P="degree"),P==="degree"?O.sort((z,Z)=>e.getDegree(Z.id,"both")-e.getDegree(z.id,"both")):O.sort((z,Z)=>Z.data[P]-z.data[P]);const N=O[0],L=(c||(P==="degree"?e.getDegree(N.id,"both"):N.data[P]))/4,D=[{nodes:[]}];let G=D[0];O.forEach(z=>{if(G.nodes.length>0){const Z=Math.abs(P==="degree"?e.getDegree(G.nodes[0].id,"both")-e.getDegree(z.id,"both"):G.nodes[0].data[P]-z.data[P]);L&&Z>=L&&(G={nodes:[]},D.push(G))}G.nodes.push(z)});let H=k+T;if(!d){const z=D.length>0&&D[0].nodes.length>1,at=(Math.min(w,E)/2-H)/(D.length+(z?1:0));H=Math.min(H,at)}let W=0;if(D.forEach(z=>{const Z=u===void 0?2*Math.PI-2*Math.PI/z.nodes.length:u;if(z.dTheta=Z/Math.max(1,z.nodes.length-1),z.nodes.length>1&&d){const at=Math.cos(z.dTheta)-Math.cos(0),ft=Math.sin(z.dTheta)-Math.sin(0),ct=Math.sqrt(H*H/(at*at+ft*ft));W=Math.max(ct,W)}z.r=W,W+=H}),f){let z=0,Z=0;for(let at=0;at<D.length;at++){const ct=(D[at].r||0)-Z;z=Math.max(z,ct)}Z=0,D.forEach((at,ft)=>{ft===0&&(Z=at.r||0),at.r=Z,Z+=z})}return D.forEach(z=>{const Z=z.dTheta||0,at=z.r||0;z.nodes.forEach((ft,ct)=>{const Gt=g+(h?1:-1)*Z*ct;ft.data.x=S[0]+at*Math.cos(Gt),ft.data.y=S[1]+at*Math.sin(Gt)})}),t&&O.forEach(z=>e.mergeNodeData(z.id,{x:z.data.x,y:z.data.y})),{nodes:O,edges:m}})}}function uV(n){const t=+this._x.call(null,n),e=+this._y.call(null,n);return fL(this.cover(t,e),t,e,n)}function fL(n,t,e,r){if(isNaN(t)||isNaN(e))return n;var i,a=n._root,s={data:r},o=n._x0,l=n._y0,c=n._x1,u=n._y1,h,f,d,g,v,p,y,m;if(!a)return n._root=s,n;for(;a.length;)if((v=t>=(h=(o+c)/2))?o=h:c=h,(p=e>=(f=(l+u)/2))?l=f:u=f,i=a,!(a=a[y=p<<1|v]))return i[y]=s,n;if(d=+n._x.call(null,a.data),g=+n._y.call(null,a.data),t===d&&e===g)return s.next=a,i?i[y]=s:n._root=s,n;do i=i?i[y]=new Array(4):n._root=new Array(4),(v=t>=(h=(o+c)/2))?o=h:c=h,(p=e>=(f=(l+u)/2))?l=f:u=f;while((y=p<<1|v)===(m=(g>=f)<<1|d>=h));return i[m]=a,i[y]=s,n}function hV(n){var t,e,r=n.length,i,a,s=new Array(r),o=new Array(r),l=1/0,c=1/0,u=-1/0,h=-1/0;for(e=0;e<r;++e)isNaN(i=+this._x.call(null,t=n[e]))||isNaN(a=+this._y.call(null,t))||(s[e]=i,o[e]=a,i<l&&(l=i),i>u&&(u=i),a<c&&(c=a),a>h&&(h=a));if(l>u||c>h)return this;for(this.cover(l,c).cover(u,h),e=0;e<r;++e)fL(this,s[e],o[e],n[e]);return this}function fV(n,t){if(isNaN(n=+n)||isNaN(t=+t))return this;var e=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(e))i=(e=Math.floor(n))+1,a=(r=Math.floor(t))+1;else{for(var s=i-e||1,o=this._root,l,c;e>n||n>=i||r>t||t>=a;)switch(c=(t<r)<<1|n<e,l=new Array(4),l[c]=o,o=l,s*=2,c){case 0:i=e+s,a=r+s;break;case 1:e=i-s,a=r+s;break;case 2:i=e+s,r=a-s;break;case 3:e=i-s,r=a-s;break}this._root&&this._root.length&&(this._root=o)}return this._x0=e,this._y0=r,this._x1=i,this._y1=a,this}function dV(){var n=[];return this.visit(function(t){if(!t.length)do n.push(t.data);while(t=t.next)}),n}function gV(n){return arguments.length?this.cover(+n[0][0],+n[0][1]).cover(+n[1][0],+n[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function or(n,t,e,r,i){this.node=n,this.x0=t,this.y0=e,this.x1=r,this.y1=i}function pV(n,t,e){var r,i=this._x0,a=this._y0,s,o,l,c,u=this._x1,h=this._y1,f=[],d=this._root,g,v;for(d&&f.push(new or(d,i,a,u,h)),e==null?e=1/0:(i=n-e,a=t-e,u=n+e,h=t+e,e*=e);g=f.pop();)if(!(!(d=g.node)||(s=g.x0)>u||(o=g.y0)>h||(l=g.x1)<i||(c=g.y1)<a))if(d.length){var p=(s+l)/2,y=(o+c)/2;f.push(new or(d[3],p,y,l,c),new or(d[2],s,y,p,c),new or(d[1],p,o,l,y),new or(d[0],s,o,p,y)),(v=(t>=y)<<1|n>=p)&&(g=f[f.length-1],f[f.length-1]=f[f.length-1-v],f[f.length-1-v]=g)}else{var m=n-+this._x.call(null,d.data),w=t-+this._y.call(null,d.data),E=m*m+w*w;if(E<e){var S=Math.sqrt(e=E);i=n-S,a=t-S,u=n+S,h=t+S,r=d.data}}return r}function vV(n){if(isNaN(u=+this._x.call(null,n))||isNaN(h=+this._y.call(null,n)))return this;var t,e=this._root,r,i,a,s=this._x0,o=this._y0,l=this._x1,c=this._y1,u,h,f,d,g,v,p,y;if(!e)return this;if(e.length)for(;;){if((g=u>=(f=(s+l)/2))?s=f:l=f,(v=h>=(d=(o+c)/2))?o=d:c=d,t=e,!(e=e[p=v<<1|g]))return this;if(!e.length)break;(t[p+1&3]||t[p+2&3]||t[p+3&3])&&(r=t,y=p)}for(;e.data!==n;)if(i=e,!(e=e.next))return this;return(a=e.next)&&delete e.next,i?(a?i.next=a:delete i.next,this):t?(a?t[p]=a:delete t[p],(e=t[0]||t[1]||t[2]||t[3])&&e===(t[3]||t[2]||t[1]||t[0])&&!e.length&&(r?r[y]=e:this._root=e),this):(this._root=a,this)}function yV(n){for(var t=0,e=n.length;t<e;++t)this.remove(n[t]);return this}function mV(){return this._root}function bV(){var n=0;return this.visit(function(t){if(!t.length)do++n;while(t=t.next)}),n}function wV(n){var t=[],e,r=this._root,i,a,s,o,l;for(r&&t.push(new or(r,this._x0,this._y0,this._x1,this._y1));e=t.pop();)if(!n(r=e.node,a=e.x0,s=e.y0,o=e.x1,l=e.y1)&&r.length){var c=(a+o)/2,u=(s+l)/2;(i=r[3])&&t.push(new or(i,c,u,o,l)),(i=r[2])&&t.push(new or(i,a,u,c,l)),(i=r[1])&&t.push(new or(i,c,s,o,u)),(i=r[0])&&t.push(new or(i,a,s,c,u))}return this}function xV(n){var t=[],e=[],r;for(this._root&&t.push(new or(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var a,s=r.x0,o=r.y0,l=r.x1,c=r.y1,u=(s+l)/2,h=(o+c)/2;(a=i[0])&&t.push(new or(a,s,o,u,h)),(a=i[1])&&t.push(new or(a,u,o,l,h)),(a=i[2])&&t.push(new or(a,s,h,u,c)),(a=i[3])&&t.push(new or(a,u,h,l,c))}e.push(r)}for(;r=e.pop();)n(r.node,r.x0,r.y0,r.x1,r.y1);return this}function EV(n){return n[0]}function SV(n){return arguments.length?(this._x=n,this):this._x}function _V(n){return n[1]}function MV(n){return arguments.length?(this._y=n,this):this._y}function Af(n,t,e){var r=new Xw(t??EV,e??_V,NaN,NaN,NaN,NaN);return n==null?r:r.addAll(n)}function Xw(n,t,e,r,i,a){this._x=n,this._y=t,this._x0=e,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function bS(n){for(var t={data:n.data},e=t;n=n.next;)e=e.next={data:n.data};return t}var dr=Af.prototype=Xw.prototype;dr.copy=function(){var n=new Xw(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,e,r;if(!t)return n;if(!t.length)return n._root=bS(t),n;for(e=[{source:t,target:n._root=new Array(4)}];t=e.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?e.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=bS(r));return n};dr.add=uV;dr.addAll=hV;dr.cover=fV;dr.data=dV;dr.extent=gV;dr.find=pV;dr.remove=vV;dr.removeAll=yV;dr.root=mV;dr.size=bV;dr.visit=wV;dr.visitAfter=xV;dr.x=SV;dr.y=MV;function OV(n){const t=+this._x.call(null,n),e=+this._y.call(null,n),r=+this._z.call(null,n);return dL(this.cover(t,e,r),t,e,r,n)}function dL(n,t,e,r,i){if(isNaN(t)||isNaN(e)||isNaN(r))return n;var a,s=n._root,o={data:i},l=n._x0,c=n._y0,u=n._z0,h=n._x1,f=n._y1,d=n._z1,g,v,p,y,m,w,E,S,O,k,T;if(!s)return n._root=o,n;for(;s.length;)if((E=t>=(g=(l+h)/2))?l=g:h=g,(S=e>=(v=(c+f)/2))?c=v:f=v,(O=r>=(p=(u+d)/2))?u=p:d=p,a=s,!(s=s[k=O<<2|S<<1|E]))return a[k]=o,n;if(y=+n._x.call(null,s.data),m=+n._y.call(null,s.data),w=+n._z.call(null,s.data),t===y&&e===m&&r===w)return o.next=s,a?a[k]=o:n._root=o,n;do a=a?a[k]=new Array(8):n._root=new Array(8),(E=t>=(g=(l+h)/2))?l=g:h=g,(S=e>=(v=(c+f)/2))?c=v:f=v,(O=r>=(p=(u+d)/2))?u=p:d=p;while((k=O<<2|S<<1|E)===(T=(w>=p)<<2|(m>=v)<<1|y>=g));return a[T]=s,a[k]=o,n}function TV(n){Array.isArray(n)||(n=Array.from(n));const t=n.length,e=new Float64Array(t),r=new Float64Array(t),i=new Float64Array(t);let a=1/0,s=1/0,o=1/0,l=-1/0,c=-1/0,u=-1/0;for(let h=0,f,d,g,v;h<t;++h)isNaN(d=+this._x.call(null,f=n[h]))||isNaN(g=+this._y.call(null,f))||isNaN(v=+this._z.call(null,f))||(e[h]=d,r[h]=g,i[h]=v,d<a&&(a=d),d>l&&(l=d),g<s&&(s=g),g>c&&(c=g),v<o&&(o=v),v>u&&(u=v));if(a>l||s>c||o>u)return this;this.cover(a,s,o).cover(l,c,u);for(let h=0;h<t;++h)dL(this,e[h],r[h],i[h],n[h]);return this}function kV(n,t,e){if(isNaN(n=+n)||isNaN(t=+t)||isNaN(e=+e))return this;var r=this._x0,i=this._y0,a=this._z0,s=this._x1,o=this._y1,l=this._z1;if(isNaN(r))s=(r=Math.floor(n))+1,o=(i=Math.floor(t))+1,l=(a=Math.floor(e))+1;else{for(var c=s-r||1,u=this._root,h,f;r>n||n>=s||i>t||t>=o||a>e||e>=l;)switch(f=(e<a)<<2|(t<i)<<1|n<r,h=new Array(8),h[f]=u,u=h,c*=2,f){case 0:s=r+c,o=i+c,l=a+c;break;case 1:r=s-c,o=i+c,l=a+c;break;case 2:s=r+c,i=o-c,l=a+c;break;case 3:r=s-c,i=o-c,l=a+c;break;case 4:s=r+c,o=i+c,a=l-c;break;case 5:r=s-c,o=i+c,a=l-c;break;case 6:s=r+c,i=o-c,a=l-c;break;case 7:r=s-c,i=o-c,a=l-c;break}this._root&&this._root.length&&(this._root=u)}return this._x0=r,this._y0=i,this._z0=a,this._x1=s,this._y1=o,this._z1=l,this}function AV(){var n=[];return this.visit(function(t){if(!t.length)do n.push(t.data);while(t=t.next)}),n}function CV(n){return arguments.length?this.cover(+n[0][0],+n[0][1],+n[0][2]).cover(+n[1][0],+n[1][1],+n[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function Le(n,t,e,r,i,a,s){this.node=n,this.x0=t,this.y0=e,this.z0=r,this.x1=i,this.y1=a,this.z1=s}function PV(n,t,e,r){var i,a=this._x0,s=this._y0,o=this._z0,l,c,u,h,f,d,g=this._x1,v=this._y1,p=this._z1,y=[],m=this._root,w,E;for(m&&y.push(new Le(m,a,s,o,g,v,p)),r==null?r=1/0:(a=n-r,s=t-r,o=e-r,g=n+r,v=t+r,p=e+r,r*=r);w=y.pop();)if(!(!(m=w.node)||(l=w.x0)>g||(c=w.y0)>v||(u=w.z0)>p||(h=w.x1)<a||(f=w.y1)<s||(d=w.z1)<o))if(m.length){var S=(l+h)/2,O=(c+f)/2,k=(u+d)/2;y.push(new Le(m[7],S,O,k,h,f,d),new Le(m[6],l,O,k,S,f,d),new Le(m[5],S,c,k,h,O,d),new Le(m[4],l,c,k,S,O,d),new Le(m[3],S,O,u,h,f,k),new Le(m[2],l,O,u,S,f,k),new Le(m[1],S,c,u,h,O,k),new Le(m[0],l,c,u,S,O,k)),(E=(e>=k)<<2|(t>=O)<<1|n>=S)&&(w=y[y.length-1],y[y.length-1]=y[y.length-1-E],y[y.length-1-E]=w)}else{var T=n-+this._x.call(null,m.data),C=t-+this._y.call(null,m.data),P=e-+this._z.call(null,m.data),N=T*T+C*C+P*P;if(N<r){var L=Math.sqrt(r=N);a=n-L,s=t-L,o=e-L,g=n+L,v=t+L,p=e+L,i=m.data}}return i}const NV=(n,t,e,r,i,a)=>Math.sqrt((n-r)**2+(t-i)**2+(e-a)**2);function RV(n,t,e,r){const i=[],a=n-r,s=t-r,o=e-r,l=n+r,c=t+r,u=e+r;return this.visit((h,f,d,g,v,p,y)=>{if(!h.length)do{const m=h.data;NV(n,t,e,this._x(m),this._y(m),this._z(m))<=r&&i.push(m)}while(h=h.next);return f>l||d>c||g>u||v<a||p<s||y<o}),i}function LV(n){if(isNaN(f=+this._x.call(null,n))||isNaN(d=+this._y.call(null,n))||isNaN(g=+this._z.call(null,n)))return this;var t,e=this._root,r,i,a,s=this._x0,o=this._y0,l=this._z0,c=this._x1,u=this._y1,h=this._z1,f,d,g,v,p,y,m,w,E,S,O;if(!e)return this;if(e.length)for(;;){if((m=f>=(v=(s+c)/2))?s=v:c=v,(w=d>=(p=(o+u)/2))?o=p:u=p,(E=g>=(y=(l+h)/2))?l=y:h=y,t=e,!(e=e[S=E<<2|w<<1|m]))return this;if(!e.length)break;(t[S+1&7]||t[S+2&7]||t[S+3&7]||t[S+4&7]||t[S+5&7]||t[S+6&7]||t[S+7&7])&&(r=t,O=S)}for(;e.data!==n;)if(i=e,!(e=e.next))return this;return(a=e.next)&&delete e.next,i?(a?i.next=a:delete i.next,this):t?(a?t[S]=a:delete t[S],(e=t[0]||t[1]||t[2]||t[3]||t[4]||t[5]||t[6]||t[7])&&e===(t[7]||t[6]||t[5]||t[4]||t[3]||t[2]||t[1]||t[0])&&!e.length&&(r?r[O]=e:this._root=e),this):(this._root=a,this)}function IV(n){for(var t=0,e=n.length;t<e;++t)this.remove(n[t]);return this}function DV(){return this._root}function FV(){var n=0;return this.visit(function(t){if(!t.length)do++n;while(t=t.next)}),n}function BV(n){var t=[],e,r=this._root,i,a,s,o,l,c,u;for(r&&t.push(new Le(r,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=t.pop();)if(!n(r=e.node,a=e.x0,s=e.y0,o=e.z0,l=e.x1,c=e.y1,u=e.z1)&&r.length){var h=(a+l)/2,f=(s+c)/2,d=(o+u)/2;(i=r[7])&&t.push(new Le(i,h,f,d,l,c,u)),(i=r[6])&&t.push(new Le(i,a,f,d,h,c,u)),(i=r[5])&&t.push(new Le(i,h,s,d,l,f,u)),(i=r[4])&&t.push(new Le(i,a,s,d,h,f,u)),(i=r[3])&&t.push(new Le(i,h,f,o,l,c,d)),(i=r[2])&&t.push(new Le(i,a,f,o,h,c,d)),(i=r[1])&&t.push(new Le(i,h,s,o,l,f,d)),(i=r[0])&&t.push(new Le(i,a,s,o,h,f,d))}return this}function zV(n){var t=[],e=[],r;for(this._root&&t.push(new Le(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));r=t.pop();){var i=r.node;if(i.length){var a,s=r.x0,o=r.y0,l=r.z0,c=r.x1,u=r.y1,h=r.z1,f=(s+c)/2,d=(o+u)/2,g=(l+h)/2;(a=i[0])&&t.push(new Le(a,s,o,l,f,d,g)),(a=i[1])&&t.push(new Le(a,f,o,l,c,d,g)),(a=i[2])&&t.push(new Le(a,s,d,l,f,u,g)),(a=i[3])&&t.push(new Le(a,f,d,l,c,u,g)),(a=i[4])&&t.push(new Le(a,s,o,g,f,d,h)),(a=i[5])&&t.push(new Le(a,f,o,g,c,d,h)),(a=i[6])&&t.push(new Le(a,s,d,g,f,u,h)),(a=i[7])&&t.push(new Le(a,f,d,g,c,u,h))}e.push(r)}for(;r=e.pop();)n(r.node,r.x0,r.y0,r.z0,r.x1,r.y1,r.z1);return this}function jV(n){return n[0]}function qV(n){return arguments.length?(this._x=n,this):this._x}function $V(n){return n[1]}function GV(n){return arguments.length?(this._y=n,this):this._y}function WV(n){return n[2]}function VV(n){return arguments.length?(this._z=n,this):this._z}function gL(n,t,e,r){var i=new Kw(t??jV,e??$V,r??WV,NaN,NaN,NaN,NaN,NaN,NaN);return n==null?i:i.addAll(n)}function Kw(n,t,e,r,i,a,s,o,l){this._x=n,this._y=t,this._z=e,this._x0=r,this._y0=i,this._z0=a,this._x1=s,this._y1=o,this._z1=l,this._root=void 0}function wS(n){for(var t={data:n.data},e=t;n=n.next;)e=e.next={data:n.data};return t}var Gn=gL.prototype=Kw.prototype;Gn.copy=function(){var n=new Kw(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),t=this._root,e,r;if(!t)return n;if(!t.length)return n._root=wS(t),n;for(e=[{source:t,target:n._root=new Array(8)}];t=e.pop();)for(var i=0;i<8;++i)(r=t.source[i])&&(r.length?e.push({source:r,target:t.target[i]=new Array(8)}):t.target[i]=wS(r));return n};Gn.add=OV;Gn.addAll=TV;Gn.cover=kV;Gn.data=AV;Gn.extent=CV;Gn.find=PV;Gn.findAllWithinRadius=RV;Gn.remove=LV;Gn.removeAll=IV;Gn.root=DV;Gn.size=FV;Gn.visit=BV;Gn.visitAfter=zV;Gn.x=qV;Gn.y=GV;Gn.z=VV;const HV=.81,Bg=.1;function UV(n,t,e,r,i=2){const a=t/e,s=n.getAllNodes(),o=s.map((u,h)=>{const{nodeStrength:f,x:d,y:g,z:v,size:p}=u.data;return{x:d,y:g,z:v,size:p,index:h,id:u.id,vx:0,vy:0,vz:0,weight:a*f}}),l=(i===2?Af(o,u=>u.x,u=>u.y):gL(o,u=>u.x,u=>u.y,u=>u.z)).visitAfter(YV),c=new Map;return o.forEach(u=>{c.set(u.id,u),KV(u,l,i)}),o.map((u,h)=>{const{id:f,data:d}=s[h],{mass:g=1}=d;r[f]={x:u.vx/g,y:u.vy/g,z:u.vz/g}}),r}function YV(n){let t=0,e=0,r=0,i=0,a=0;const s=n.length;if(s){for(let o=0;o<s;o++){const l=n[o];l&&l.weight&&(t+=l.weight,e+=l.x*l.weight,r+=l.y*l.weight,i+=l.z*l.weight,a+=l.size*l.weight)}n.x=e/t,n.y=r/t,n.z=i/t,n.size=a/t,n.weight=t}else{const o=n;n.x=o.data.x,n.y=o.data.y,n.z=o.data.z,n.size=o.data.size,n.weight=o.data.weight}}const XV=(n,t,e,r,i,a,s)=>{var o;if(((o=n.data)===null||o===void 0?void 0:o.id)===a.id)return;const l=[e,r,i][s-1],c=a.x-n.x||Bg,u=a.y-n.y||Bg,h=a.z-n.z||Bg,f=[c,u,h],d=l-t;let g=0;for(let y=0;y<s;y++)g+=f[y]*f[y];const p=Math.sqrt(g)*g;if(d*d*HV<g){const y=n.weight/p;return a.vx+=c*y,a.vy+=u*y,a.vz+=h*y,!0}if(n.length)return!1;if(n.data!==a){const y=n.data.weight/p;a.vx+=c*y,a.vy+=u*y,a.vz+=h*y}};function KV(n,t,e){t.visit((r,i,a,s,o)=>XV(r,i,a,s,o,n,e))}const ZV={dimensions:2,maxIteration:500,gravity:10,factor:1,edgeStrength:50,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:200,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"};class pL{constructor(t={}){this.options=t,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=Object.assign(Object.assign({},ZV),t)}execute(t,e){return oe(this,void 0,void 0,function*(){return this.genericForceLayout(!1,t,e)})}assign(t,e){return oe(this,void 0,void 0,function*(){yield this.genericForceLayout(!0,t,e)})}stop(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval),this.running=!1}tick(t=this.options.maxIteration||1){if(this.lastResult)return this.lastResult;for(let r=0;(this.judgingDistance>this.lastOptions.minMovement||r<1)&&r<t;r++)this.runOneStep(this.lastCalcGraph,this.lastGraph,r,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);const e={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&e.nodes.forEach(r=>this.lastGraph.mergeNodeData(r.id,{x:r.data.x,y:r.data.y,z:this.options.dimensions===3?r.data.z:void 0})),e}genericForceLayout(t,e,r){return oe(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),r),a=e.getAllNodes(),s=e.getAllEdges(),o=this.formatOptions(i,e),{dimensions:l,width:c,height:u,nodeSize:h,getMass:f,nodeStrength:d,edgeStrength:g,linkDistance:v}=o,p=a.map((T,C)=>Object.assign(Object.assign({},T),{data:Object.assign(Object.assign({},T.data),{x:Lt(T.data.x)?T.data.x:Math.random()*c,y:Lt(T.data.y)?T.data.y:Math.random()*u,z:Lt(T.data.z)?T.data.z:Math.random()*Math.sqrt(c*u),size:h(T)||30,mass:f(T),nodeStrength:d(T)})})),y=s.map(T=>Object.assign(Object.assign({},T),{data:Object.assign(Object.assign({},T.data),{edgeStrength:g(T),linkDistance:v(T,e.getNode(T.source),e.getNode(T.target))})}));if(!(a!=null&&a.length))return this.lastResult={nodes:[],edges:s},{nodes:[],edges:s};const m={};a.forEach((T,C)=>{m[T.id]={x:0,y:0,z:0}});const w=new kn({nodes:p,edges:y});this.formatCentripetal(o,w);const{maxIteration:E,minMovement:S,onTick:O}=o;if(this.lastLayoutNodes=p,this.lastLayoutEdges=y,this.lastAssign=t,this.lastGraph=e,this.lastCalcGraph=w,this.lastOptions=o,this.lastVelMap=m,typeof window>"u")return;let k=0;return new Promise(T=>{this.timeInterval=window.setInterval(()=>{(!a||!this.running)&&T({nodes:zg(e,p),edges:s}),this.runOneStep(w,e,k,m,o),this.updatePosition(e,w,m,o),t&&p.forEach(C=>e.mergeNodeData(C.id,{x:C.data.x,y:C.data.y,z:l===3?C.data.z:void 0})),O==null||O({nodes:zg(e,p),edges:s}),k++,(k>=E||this.judgingDistance<S)&&(window.clearInterval(this.timeInterval),T({nodes:zg(e,p),edges:s}))},0),this.running=!0})})}formatOptions(t,e){const r=Object.assign({},t),{width:i,height:a,getMass:s}=t;r.width=!i&&typeof window<"u"?window.innerWidth:i,r.height=!a&&typeof window<"u"?window.innerHeight:a,t.center||(r.center=[r.width/2,r.height/2]),s||(r.getMass=l=>{let c=1;Lt(l==null?void 0:l.data.mass)&&(c=l==null?void 0:l.data.mass);const u=e.getDegree(l.id,"both");return!u||u<5?c:u*5*c}),r.nodeSize=Yw(t.nodeSize,t.nodeSpacing);const o=t.linkDistance?Cs(1,t.linkDistance):l=>1+r.nodeSize(e.getNode(l.source))+r.nodeSize(e.getNode(l.target));return r.linkDistance=o,r.nodeStrength=Cs(1,t.nodeStrength),r.edgeStrength=Cs(1,t.edgeStrength),r}formatCentripetal(t,e){const{dimensions:r,centripetalOptions:i,center:a,clusterNodeStrength:s,leafCluster:o,clustering:l,nodeClusterBy:c}=t,u=e.getAllNodes(),h=i||{leaf:2,single:2,others:1,center:y=>({x:a[0],y:a[1],z:r===3?a[2]:void 0})};typeof s!="function"&&(t.clusterNodeStrength=y=>s);let f,d;if(o&&c&&(f=xS(e,c),d=Array.from(new Set(u==null?void 0:u.map(y=>y.data[c])))||[],t.centripetalOptions=Object.assign(h,{single:100,leaf:y=>{const{siblingLeaves:m,sameTypeLeaves:w}=f[y.id]||{};return(w==null?void 0:w.length)===(m==null?void 0:m.length)||(d==null?void 0:d.length)===1?1:t.clusterNodeStrength(y)},others:1,center:y=>{const m=e.getDegree(y.id,"both");if(!m)return{x:100,y:100,z:0};let w;if(m===1){const{sameTypeLeaves:E=[]}=f[y.id]||{};E.length===1?w=void 0:E.length>1&&(w=ES(E))}else w=void 0;return{x:w==null?void 0:w.x,y:w==null?void 0:w.y,z:w==null?void 0:w.z}}})),l&&c){f||(f=xS(e,c)),d||(d=Array.from(new Set(u.map(m=>m.data[c])))),d=d.filter(m=>m!==void 0);const y={};d.forEach(m=>{const w=u.filter(E=>E.data[c]===m).map(E=>e.getNode(E.id));y[m]=ES(w)}),t.centripetalOptions=Object.assign(h,{single:m=>t.clusterNodeStrength(m),leaf:m=>t.clusterNodeStrength(m),others:m=>t.clusterNodeStrength(m),center:m=>{const w=y[m.data[c]];return{x:w==null?void 0:w.x,y:w==null?void 0:w.y,z:w==null?void 0:w.z}}})}const{leaf:g,single:v,others:p}=t.centripetalOptions||{};g&&typeof g!="function"&&(t.centripetalOptions.leaf=()=>g),v&&typeof v!="function"&&(t.centripetalOptions.single=()=>v),p&&typeof p!="function"&&(t.centripetalOptions.others=()=>p)}runOneStep(t,e,r,i,a){const s={},o=t.getAllNodes(),l=t.getAllEdges();if(!(o!=null&&o.length))return;const{monitor:c}=a;if(this.calRepulsive(t,s,a),l&&this.calAttractive(t,s,a),this.calGravity(t,e,s,a),this.updateVelocity(t,s,i,a),c){const u=this.calTotalEnergy(s,o);c({energy:u,nodes:e.getAllNodes(),edges:e.getAllEdges(),iterations:r})}}calTotalEnergy(t,e){if(!(e!=null&&e.length))return 0;let r=0;return e.forEach((i,a)=>{const s=t[i.id].x,o=t[i.id].y,l=this.options.dimensions===3?t[i.id].z:0,c=s*s+o*o+l*l,{mass:u=1}=i.data;r+=u*c*.5}),r}calRepulsive(t,e,r){const{dimensions:i,factor:a,coulombDisScale:s}=r;UV(t,a,s*s,e,i)}calAttractive(t,e,r){const{dimensions:i,nodeSize:a}=r;t.getAllEdges().forEach((s,o)=>{const{source:l,target:c}=s,u=t.getNode(l),h=t.getNode(c);if(!u||!h)return;let f=h.data.x-u.data.x,d=h.data.y-u.data.y,g=i===3?h.data.z-u.data.z:0;!f&&!d&&(f=Math.random()*.01,d=Math.random()*.01,i===3&&!g&&(g=Math.random()*.01));const v=Math.sqrt(f*f+d*d+g*g);if(v<a(u)+a(h))return;const p=f/v,y=d/v,m=g/v,{linkDistance:w=200,edgeStrength:E=200}=s.data||{},O=(w-v)*E,k=u.data.mass||1,T=h.data.mass||1,C=1/k,P=1/T,N=p*O,L=y*O,D=m*O;e[l].x-=N*C,e[l].y-=L*C,e[l].z-=D*C,e[c].x+=N*P,e[c].y+=L*P,e[c].z+=D*P})}calGravity(t,e,r,i){const{getCenter:a}=i,s=t.getAllNodes(),o=e.getAllNodes(),l=e.getAllEdges(),{width:c,height:u,center:h,gravity:f,centripetalOptions:d}=i;s&&s.forEach(g=>{const{id:v,data:p}=g,{mass:y,x:m,y:w,z:E}=p,S=e.getNode(v);let O=0,k=0,T=0,C=f;const P=t.getDegree(v,"in"),N=t.getDegree(v,"out"),L=t.getDegree(v,"both"),D=a==null?void 0:a(S,L);if(D){const[G,H,W]=D;O=m-G,k=w-H,C=W}else O=m-h[0],k=w-h[1],T=E-h[2];if(C&&(r[v].x-=C*O/y,r[v].y-=C*k/y,r[v].z-=C*T/y),d){const{leaf:G,single:H,others:W,center:q}=d,{x:z,y:Z,z:at,centerStrength:ft}=(q==null?void 0:q(S,o,l,c,u))||{x:0,y:0,z:0,centerStrength:0};if(!Lt(z)||!Lt(Z))return;const ct=(m-z)/y,Gt=(w-Z)/y,J=(E-at)/y;if(ft&&(r[v].x-=ft*ct,r[v].y-=ft*Gt,r[v].z-=ft*J),L===0){const nt=H(S);if(!nt)return;r[v].x-=nt*ct,r[v].y-=nt*Gt,r[v].z-=nt*J;return}if(P===0||N===0){const nt=G(S,o,l);if(!nt)return;r[v].x-=nt*ct,r[v].y-=nt*Gt,r[v].z-=nt*J;return}const V=W(S);if(!V)return;r[v].x-=V*ct,r[v].y-=V*Gt,r[v].z-=V*J}})}updateVelocity(t,e,r,i){const{damping:a,maxSpeed:s,interval:o,dimensions:l}=i,c=t.getAllNodes();c!=null&&c.length&&c.forEach(u=>{const{id:h}=u;let f=(r[h].x+e[h].x*o)*a||.01,d=(r[h].y+e[h].y*o)*a||.01,g=l===3?(r[h].z+e[h].z*o)*a||.01:0;const v=Math.sqrt(f*f+d*d+g*g);if(v>s){const p=s/v;f=p*f,d=p*d,g=p*g}r[h]={x:f,y:d,z:g}})}updatePosition(t,e,r,i){const{distanceThresholdMode:a,interval:s,dimensions:o}=i,l=e.getAllNodes();if(!(l!=null&&l.length)){this.judgingDistance=0;return}let c=0;a==="max"?this.judgingDistance=-1/0:a==="min"&&(this.judgingDistance=1/0),l.forEach(u=>{const{id:h}=u,f=t.getNode(h);if(Lt(f.data.fx)&&Lt(f.data.fy)){e.mergeNodeData(h,{x:f.data.fx,y:f.data.fy,z:o===3?f.data.fz:void 0});return}const d=r[h].x*s,g=r[h].y*s,v=o===3?r[h].z*s:0;e.mergeNodeData(h,{x:u.data.x+d,y:u.data.y+g,z:u.data.z+v});const p=Math.sqrt(d*d+g*g+v*v);switch(a){case"max":this.judgingDistance<p&&(this.judgingDistance=p);break;case"min":this.judgingDistance>p&&(this.judgingDistance=p);break;default:c=c+p;break}}),(!a||a==="mean")&&(this.judgingDistance=c/l.length)}}const xS=(n,t)=>{const e=n.getAllNodes();if(!(e!=null&&e.length))return{};const r={};return e.forEach((i,a)=>{n.getDegree(i.id,"both")===1&&(r[i.id]=JV(n,"leaf",i,t))}),r},JV=(n,t,e,r)=>{const i=n.getDegree(e.id,"in"),a=n.getDegree(e.id,"out");let s=e,o=[];i===0?(s=n.getSuccessors(e.id)[0],o=n.getNeighbors(s.id)):a===0&&(s=n.getPredecessors(e.id)[0],o=n.getNeighbors(s.id)),o=o.filter(c=>n.getDegree(c.id,"in")===0||n.getDegree(c.id,"out")===0);const l=QV(n,t,r,e,o);return{coreNode:s,siblingLeaves:o,sameTypeLeaves:l}},QV=(n,t,e,r,i)=>{const a=r.data[e]||"";let s=(i==null?void 0:i.filter(o=>o.data[e]===a))||[];return s=s.filter(o=>n.getDegree(o.id,"in")===0||n.getDegree(o.id,"out")===0),s},ES=n=>{const t={x:0,y:0};n.forEach(r=>{const{x:i,y:a}=r.data;t.x+=i||0,t.y+=a||0});const e=n.length||1;return{x:t.x/e,y:t.y/e}},zg=(n,t)=>t.map(e=>{const{id:r,data:i}=e,a=n.getNode(r);return Object.assign(Object.assign({},a),{data:Object.assign(Object.assign({},a.data),{x:i.x,y:i.y,z:i.z})})});var fe={};const t7=Object.prototype.toString;function tc(n){const t=t7.call(n);return t.endsWith("Array]")&&!t.includes("Big")}const e7=Object.freeze(Object.defineProperty({__proto__:null,isAnyArray:tc},Symbol.toStringTag,{value:"Module"})),n7=xP(e7);function r7(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!tc(n))throw new TypeError("input must be an array");if(n.length===0)throw new TypeError("input must not be empty");var e=t.fromIndex,r=e===void 0?0:e,i=t.toIndex,a=i===void 0?n.length:i;if(r<0||r>=n.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(a<=r||a>n.length||!Number.isInteger(a))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=n[r],o=r+1;o<a;o++)n[o]>s&&(s=n[o]);return s}function i7(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!tc(n))throw new TypeError("input must be an array");if(n.length===0)throw new TypeError("input must not be empty");var e=t.fromIndex,r=e===void 0?0:e,i=t.toIndex,a=i===void 0?n.length:i;if(r<0||r>=n.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(a<=r||a>n.length||!Number.isInteger(a))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=n[r],o=r+1;o<a;o++)n[o]<s&&(s=n[o]);return s}function a7(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(tc(n)){if(n.length===0)throw new TypeError("input must not be empty")}else throw new TypeError("input must be an array");var e;if(t.output!==void 0){if(!tc(t.output))throw new TypeError("output option must be an array if specified");e=t.output}else e=new Array(n.length);var r=i7(n),i=r7(n);if(r===i)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var a=t.min,s=a===void 0?t.autoMinMax?r:0:a,o=t.max,l=o===void 0?t.autoMinMax?i:1:o;if(s>=l)throw new RangeError("min option must be smaller than max option");for(var c=(l-s)/(i-r),u=0;u<n.length;u++)e[u]=(n[u]-r)*c+s;return e}const s7=Object.freeze(Object.defineProperty({__proto__:null,default:a7},Symbol.toStringTag,{value:"Module"})),o7=xP(s7);var SS;function l7(){var Yo,Tb,Hn;if(SS)return fe;SS=1,Object.defineProperty(fe,"__esModule",{value:!0});var n=n7,t=o7;const e=" ".repeat(2),r=" ".repeat(4);function i(){return a(this)}function a(R,M={}){const{maxRows:x=15,maxColumns:b=10,maxNumSize:_=8,padMinus:A="auto"}=M;return`${R.constructor.name} {
${e}[
${r}${s(R,x,b,_,A)}
${e}]
${e}rows: ${R.rows}
${e}columns: ${R.columns}
}`}function s(R,M,x,b,_){const{rows:A,columns:I}=R,F=Math.min(A,M),B=Math.min(I,x),j=[];if(_==="auto"){_=!1;t:for(let et=0;et<F;et++)for(let Y=0;Y<B;Y++)if(R.get(et,Y)<0){_=!0;break t}}for(let et=0;et<F;et++){let Y=[];for(let ht=0;ht<B;ht++)Y.push(o(R.get(et,ht),b,_));j.push(`${Y.join(" ")}`)}return B!==I&&(j[j.length-1]+=` ... ${I-x} more columns`),F!==A&&j.push(`... ${A-M} more rows`),j.join(`
${r}`)}function o(R,M,x){return(R>=0&&x?` ${l(R,M-1)}`:l(R,M)).padEnd(M)}function l(R,M){let x=R.toString();if(x.length<=M)return x;let b=R.toFixed(M);if(b.length>M&&(b=R.toFixed(Math.max(0,M-(b.length-M)))),b.length<=M&&!b.startsWith("0.000")&&!b.startsWith("-0.000"))return b;let _=R.toExponential(M);return _.length>M&&(_=R.toExponential(Math.max(0,M-(_.length-M)))),_.slice(0)}function c(R,M){R.prototype.add=function(b){return typeof b=="number"?this.addS(b):this.addM(b)},R.prototype.addS=function(b){for(let _=0;_<this.rows;_++)for(let A=0;A<this.columns;A++)this.set(_,A,this.get(_,A)+b);return this},R.prototype.addM=function(b){if(b=M.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let _=0;_<this.rows;_++)for(let A=0;A<this.columns;A++)this.set(_,A,this.get(_,A)+b.get(_,A));return this},R.add=function(b,_){return new M(b).add(_)},R.prototype.sub=function(b){return typeof b=="number"?this.subS(b):this.subM(b)},R.prototype.subS=function(b){for(let _=0;_<this.rows;_++)for(let A=0;A<this.columns;A++)this.set(_,A,this.get(_,A)-b);return this},R.prototype.subM=function(b){if(b=M.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let _=0;_<this.rows;_++)for(let A=0;A<this.columns;A++)this.set(_,A,this.get(_,A)-b.get(_,A));return this},R.sub=function(b,_){return new M(b).sub(_)},R.prototype.subtract=R.prototype.sub,R.prototype.subtractS=R.prototype.subS,R.prototype.subtractM=R.prototype.subM,R.subtract=R.sub,R.prototype.mul=function(b){return typeof b=="number"?this.mulS(b):this.mulM(b)},R.prototype.mulS=function(b){for(let _=0;_<this.rows;_++)for(let A=0;A<this.columns;A++)this.set(_,A,this.get(_,A)*b);return this},R.prototype.mulM=function(b){if(b=M.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let _=0;_<this.rows;_++)for(let A=0;A<this.columns;A++)this.set(_,A,this.get(_,A)*b.get(_,A));return this},R.mul=function(b,_){return new M(b).mul(_)},R.prototype.multiply=R.prototype.mul,R.prototype.multiplyS=R.prototype.mulS,R.prototype.multiplyM=R.prototype.mulM,R.multiply=R.mul,R.prototype.div=function(b){return typeof b=="number"?this.divS(b):this.divM(b)},R.prototype.divS=function(b){for(let _=0;_<this.rows;_++)for(let A=0;A<this.columns;A++)this.set(_,A,this.get(_,A)/b);return this},R.prototype.divM=function(b){if(b=M.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let _=0;_<this.rows;_++)for(let A=0;A<this.columns;A++)this.set(_,A,this.get(_,A)/b.get(_,A));return this},R.div=function(b,_){return new M(b).div(_)},R.prototype.divide=R.prototype.div,R.prototype.divideS=R.prototype.divS,R.prototype.divideM=R.prototype.divM,R.divide=R.div,R.prototype.mod=function(b){return typeof b=="number"?this.modS(b):this.modM(b)},R.prototype.modS=function(b){for(let _=0;_<this.rows;_++)for(let A=0;A<this.columns;A++)this.set(_,A,this.get(_,A)%b);return this},R.prototype.modM=function(b){if(b=M.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let _=0;_<this.rows;_++)for(let A=0;A<this.columns;A++)this.set(_,A,this.get(_,A)%b.get(_,A));return this},R.mod=function(b,_){return new M(b).mod(_)},R.prototype.modulus=R.prototype.mod,R.prototype.modulusS=R.prototype.modS,R.prototype.modulusM=R.prototype.modM,R.modulus=R.mod,R.prototype.and=function(b){return typeof b=="number"?this.andS(b):this.andM(b)},R.prototype.andS=function(b){for(let _=0;_<this.rows;_++)for(let A=0;A<this.columns;A++)this.set(_,A,this.get(_,A)&b);return this},R.prototype.andM=function(b){if(b=M.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let _=0;_<this.rows;_++)for(let A=0;A<this.columns;A++)this.set(_,A,this.get(_,A)&b.get(_,A));return this},R.and=function(b,_){return new M(b).and(_)},R.prototype.or=function(b){return typeof b=="number"?this.orS(b):this.orM(b)},R.prototype.orS=function(b){for(let _=0;_<this.rows;_++)for(let A=0;A<this.columns;A++)this.set(_,A,this.get(_,A)|b);return this},R.prototype.orM=function(b){if(b=M.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let _=0;_<this.rows;_++)for(let A=0;A<this.columns;A++)this.set(_,A,this.get(_,A)|b.get(_,A));return this},R.or=function(b,_){return new M(b).or(_)},R.prototype.xor=function(b){return typeof b=="number"?this.xorS(b):this.xorM(b)},R.prototype.xorS=function(b){for(let _=0;_<this.rows;_++)for(let A=0;A<this.columns;A++)this.set(_,A,this.get(_,A)^b);return this},R.prototype.xorM=function(b){if(b=M.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let _=0;_<this.rows;_++)for(let A=0;A<this.columns;A++)this.set(_,A,this.get(_,A)^b.get(_,A));return this},R.xor=function(b,_){return new M(b).xor(_)},R.prototype.leftShift=function(b){return typeof b=="number"?this.leftShiftS(b):this.leftShiftM(b)},R.prototype.leftShiftS=function(b){for(let _=0;_<this.rows;_++)for(let A=0;A<this.columns;A++)this.set(_,A,this.get(_,A)<<b);return this},R.prototype.leftShiftM=function(b){if(b=M.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let _=0;_<this.rows;_++)for(let A=0;A<this.columns;A++)this.set(_,A,this.get(_,A)<<b.get(_,A));return this},R.leftShift=function(b,_){return new M(b).leftShift(_)},R.prototype.signPropagatingRightShift=function(b){return typeof b=="number"?this.signPropagatingRightShiftS(b):this.signPropagatingRightShiftM(b)},R.prototype.signPropagatingRightShiftS=function(b){for(let _=0;_<this.rows;_++)for(let A=0;A<this.columns;A++)this.set(_,A,this.get(_,A)>>b);return this},R.prototype.signPropagatingRightShiftM=function(b){if(b=M.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let _=0;_<this.rows;_++)for(let A=0;A<this.columns;A++)this.set(_,A,this.get(_,A)>>b.get(_,A));return this},R.signPropagatingRightShift=function(b,_){return new M(b).signPropagatingRightShift(_)},R.prototype.rightShift=function(b){return typeof b=="number"?this.rightShiftS(b):this.rightShiftM(b)},R.prototype.rightShiftS=function(b){for(let _=0;_<this.rows;_++)for(let A=0;A<this.columns;A++)this.set(_,A,this.get(_,A)>>>b);return this},R.prototype.rightShiftM=function(b){if(b=M.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let _=0;_<this.rows;_++)for(let A=0;A<this.columns;A++)this.set(_,A,this.get(_,A)>>>b.get(_,A));return this},R.rightShift=function(b,_){return new M(b).rightShift(_)},R.prototype.zeroFillRightShift=R.prototype.rightShift,R.prototype.zeroFillRightShiftS=R.prototype.rightShiftS,R.prototype.zeroFillRightShiftM=R.prototype.rightShiftM,R.zeroFillRightShift=R.rightShift,R.prototype.not=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,~this.get(b,_));return this},R.not=function(b){return new M(b).not()},R.prototype.abs=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.abs(this.get(b,_)));return this},R.abs=function(b){return new M(b).abs()},R.prototype.acos=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.acos(this.get(b,_)));return this},R.acos=function(b){return new M(b).acos()},R.prototype.acosh=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.acosh(this.get(b,_)));return this},R.acosh=function(b){return new M(b).acosh()},R.prototype.asin=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.asin(this.get(b,_)));return this},R.asin=function(b){return new M(b).asin()},R.prototype.asinh=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.asinh(this.get(b,_)));return this},R.asinh=function(b){return new M(b).asinh()},R.prototype.atan=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.atan(this.get(b,_)));return this},R.atan=function(b){return new M(b).atan()},R.prototype.atanh=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.atanh(this.get(b,_)));return this},R.atanh=function(b){return new M(b).atanh()},R.prototype.cbrt=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.cbrt(this.get(b,_)));return this},R.cbrt=function(b){return new M(b).cbrt()},R.prototype.ceil=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.ceil(this.get(b,_)));return this},R.ceil=function(b){return new M(b).ceil()},R.prototype.clz32=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.clz32(this.get(b,_)));return this},R.clz32=function(b){return new M(b).clz32()},R.prototype.cos=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.cos(this.get(b,_)));return this},R.cos=function(b){return new M(b).cos()},R.prototype.cosh=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.cosh(this.get(b,_)));return this},R.cosh=function(b){return new M(b).cosh()},R.prototype.exp=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.exp(this.get(b,_)));return this},R.exp=function(b){return new M(b).exp()},R.prototype.expm1=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.expm1(this.get(b,_)));return this},R.expm1=function(b){return new M(b).expm1()},R.prototype.floor=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.floor(this.get(b,_)));return this},R.floor=function(b){return new M(b).floor()},R.prototype.fround=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.fround(this.get(b,_)));return this},R.fround=function(b){return new M(b).fround()},R.prototype.log=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.log(this.get(b,_)));return this},R.log=function(b){return new M(b).log()},R.prototype.log1p=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.log1p(this.get(b,_)));return this},R.log1p=function(b){return new M(b).log1p()},R.prototype.log10=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.log10(this.get(b,_)));return this},R.log10=function(b){return new M(b).log10()},R.prototype.log2=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.log2(this.get(b,_)));return this},R.log2=function(b){return new M(b).log2()},R.prototype.round=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.round(this.get(b,_)));return this},R.round=function(b){return new M(b).round()},R.prototype.sign=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.sign(this.get(b,_)));return this},R.sign=function(b){return new M(b).sign()},R.prototype.sin=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.sin(this.get(b,_)));return this},R.sin=function(b){return new M(b).sin()},R.prototype.sinh=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.sinh(this.get(b,_)));return this},R.sinh=function(b){return new M(b).sinh()},R.prototype.sqrt=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.sqrt(this.get(b,_)));return this},R.sqrt=function(b){return new M(b).sqrt()},R.prototype.tan=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.tan(this.get(b,_)));return this},R.tan=function(b){return new M(b).tan()},R.prototype.tanh=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.tanh(this.get(b,_)));return this},R.tanh=function(b){return new M(b).tanh()},R.prototype.trunc=function(){for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.set(b,_,Math.trunc(this.get(b,_)));return this},R.trunc=function(b){return new M(b).trunc()},R.pow=function(b,_){return new M(b).pow(_)},R.prototype.pow=function(b){return typeof b=="number"?this.powS(b):this.powM(b)},R.prototype.powS=function(b){for(let _=0;_<this.rows;_++)for(let A=0;A<this.columns;A++)this.set(_,A,this.get(_,A)**b);return this},R.prototype.powM=function(b){if(b=M.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let _=0;_<this.rows;_++)for(let A=0;A<this.columns;A++)this.set(_,A,this.get(_,A)**b.get(_,A));return this}}function u(R,M,x){let b=x?R.rows:R.rows-1;if(M<0||M>b)throw new RangeError("Row index out of range")}function h(R,M,x){let b=x?R.columns:R.columns-1;if(M<0||M>b)throw new RangeError("Column index out of range")}function f(R,M){if(M.to1DArray&&(M=M.to1DArray()),M.length!==R.columns)throw new RangeError("vector size must be the same as the number of columns");return M}function d(R,M){if(M.to1DArray&&(M=M.to1DArray()),M.length!==R.rows)throw new RangeError("vector size must be the same as the number of rows");return M}function g(R,M){if(!n.isAnyArray(M))throw new TypeError("row indices must be an array");for(let x=0;x<M.length;x++)if(M[x]<0||M[x]>=R.rows)throw new RangeError("row indices are out of range")}function v(R,M){if(!n.isAnyArray(M))throw new TypeError("column indices must be an array");for(let x=0;x<M.length;x++)if(M[x]<0||M[x]>=R.columns)throw new RangeError("column indices are out of range")}function p(R,M,x,b,_){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(m("startRow",M),m("endRow",x),m("startColumn",b),m("endColumn",_),M>x||b>_||M<0||M>=R.rows||x<0||x>=R.rows||b<0||b>=R.columns||_<0||_>=R.columns)throw new RangeError("Submatrix indices are out of range")}function y(R,M=0){let x=[];for(let b=0;b<R;b++)x.push(M);return x}function m(R,M){if(typeof M!="number")throw new TypeError(`${R} must be a number`)}function w(R){if(R.isEmpty())throw new Error("Empty matrix has no elements to index")}function E(R){let M=y(R.rows);for(let x=0;x<R.rows;++x)for(let b=0;b<R.columns;++b)M[x]+=R.get(x,b);return M}function S(R){let M=y(R.columns);for(let x=0;x<R.rows;++x)for(let b=0;b<R.columns;++b)M[b]+=R.get(x,b);return M}function O(R){let M=0;for(let x=0;x<R.rows;x++)for(let b=0;b<R.columns;b++)M+=R.get(x,b);return M}function k(R){let M=y(R.rows,1);for(let x=0;x<R.rows;++x)for(let b=0;b<R.columns;++b)M[x]*=R.get(x,b);return M}function T(R){let M=y(R.columns,1);for(let x=0;x<R.rows;++x)for(let b=0;b<R.columns;++b)M[b]*=R.get(x,b);return M}function C(R){let M=1;for(let x=0;x<R.rows;x++)for(let b=0;b<R.columns;b++)M*=R.get(x,b);return M}function P(R,M,x){const b=R.rows,_=R.columns,A=[];for(let I=0;I<b;I++){let F=0,B=0,j=0;for(let et=0;et<_;et++)j=R.get(I,et)-x[I],F+=j,B+=j*j;M?A.push((B-F*F/_)/(_-1)):A.push((B-F*F/_)/_)}return A}function N(R,M,x){const b=R.rows,_=R.columns,A=[];for(let I=0;I<_;I++){let F=0,B=0,j=0;for(let et=0;et<b;et++)j=R.get(et,I)-x[I],F+=j,B+=j*j;M?A.push((B-F*F/b)/(b-1)):A.push((B-F*F/b)/b)}return A}function L(R,M,x){const b=R.rows,_=R.columns,A=b*_;let I=0,F=0,B=0;for(let j=0;j<b;j++)for(let et=0;et<_;et++)B=R.get(j,et)-x,I+=B,F+=B*B;return M?(F-I*I/A)/(A-1):(F-I*I/A)/A}function D(R,M){for(let x=0;x<R.rows;x++)for(let b=0;b<R.columns;b++)R.set(x,b,R.get(x,b)-M[x])}function G(R,M){for(let x=0;x<R.rows;x++)for(let b=0;b<R.columns;b++)R.set(x,b,R.get(x,b)-M[b])}function H(R,M){for(let x=0;x<R.rows;x++)for(let b=0;b<R.columns;b++)R.set(x,b,R.get(x,b)-M)}function W(R){const M=[];for(let x=0;x<R.rows;x++){let b=0;for(let _=0;_<R.columns;_++)b+=R.get(x,_)**2/(R.columns-1);M.push(Math.sqrt(b))}return M}function q(R,M){for(let x=0;x<R.rows;x++)for(let b=0;b<R.columns;b++)R.set(x,b,R.get(x,b)/M[x])}function z(R){const M=[];for(let x=0;x<R.columns;x++){let b=0;for(let _=0;_<R.rows;_++)b+=R.get(_,x)**2/(R.rows-1);M.push(Math.sqrt(b))}return M}function Z(R,M){for(let x=0;x<R.rows;x++)for(let b=0;b<R.columns;b++)R.set(x,b,R.get(x,b)/M[b])}function at(R){const M=R.size-1;let x=0;for(let b=0;b<R.columns;b++)for(let _=0;_<R.rows;_++)x+=R.get(_,b)**2/M;return Math.sqrt(x)}function ft(R,M){for(let x=0;x<R.rows;x++)for(let b=0;b<R.columns;b++)R.set(x,b,R.get(x,b)/M)}class ct{static from1DArray(M,x,b){if(M*x!==b.length)throw new RangeError("data length does not match given dimensions");let A=new V(M,x);for(let I=0;I<M;I++)for(let F=0;F<x;F++)A.set(I,F,b[I*x+F]);return A}static rowVector(M){let x=new V(1,M.length);for(let b=0;b<M.length;b++)x.set(0,b,M[b]);return x}static columnVector(M){let x=new V(M.length,1);for(let b=0;b<M.length;b++)x.set(b,0,M[b]);return x}static zeros(M,x){return new V(M,x)}static ones(M,x){return new V(M,x).fill(1)}static rand(M,x,b={}){if(typeof b!="object")throw new TypeError("options must be an object");const{random:_=Math.random}=b;let A=new V(M,x);for(let I=0;I<M;I++)for(let F=0;F<x;F++)A.set(I,F,_());return A}static randInt(M,x,b={}){if(typeof b!="object")throw new TypeError("options must be an object");const{min:_=0,max:A=1e3,random:I=Math.random}=b;if(!Number.isInteger(_))throw new TypeError("min must be an integer");if(!Number.isInteger(A))throw new TypeError("max must be an integer");if(_>=A)throw new RangeError("min must be smaller than max");let F=A-_,B=new V(M,x);for(let j=0;j<M;j++)for(let et=0;et<x;et++){let Y=_+Math.round(I()*F);B.set(j,et,Y)}return B}static eye(M,x,b){x===void 0&&(x=M),b===void 0&&(b=1);let _=Math.min(M,x),A=this.zeros(M,x);for(let I=0;I<_;I++)A.set(I,I,b);return A}static diag(M,x,b){let _=M.length;x===void 0&&(x=_),b===void 0&&(b=x);let A=Math.min(_,x,b),I=this.zeros(x,b);for(let F=0;F<A;F++)I.set(F,F,M[F]);return I}static min(M,x){M=this.checkMatrix(M),x=this.checkMatrix(x);let b=M.rows,_=M.columns,A=new V(b,_);for(let I=0;I<b;I++)for(let F=0;F<_;F++)A.set(I,F,Math.min(M.get(I,F),x.get(I,F)));return A}static max(M,x){M=this.checkMatrix(M),x=this.checkMatrix(x);let b=M.rows,_=M.columns,A=new this(b,_);for(let I=0;I<b;I++)for(let F=0;F<_;F++)A.set(I,F,Math.max(M.get(I,F),x.get(I,F)));return A}static checkMatrix(M){return ct.isMatrix(M)?M:new V(M)}static isMatrix(M){return M!=null&&M.klass==="Matrix"}get size(){return this.rows*this.columns}apply(M){if(typeof M!="function")throw new TypeError("callback must be a function");for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)M.call(this,x,b);return this}to1DArray(){let M=[];for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)M.push(this.get(x,b));return M}to2DArray(){let M=[];for(let x=0;x<this.rows;x++){M.push([]);for(let b=0;b<this.columns;b++)M[x].push(this.get(x,b))}return M}toJSON(){return this.to2DArray()}isRowVector(){return this.rows===1}isColumnVector(){return this.columns===1}isVector(){return this.rows===1||this.columns===1}isSquare(){return this.rows===this.columns}isEmpty(){return this.rows===0||this.columns===0}isSymmetric(){if(this.isSquare()){for(let M=0;M<this.rows;M++)for(let x=0;x<=M;x++)if(this.get(M,x)!==this.get(x,M))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let M=0;M<this.rows;M++)if(this.get(M,M)!==0)return!1;return!0}isEchelonForm(){let M=0,x=0,b=-1,_=!0,A=!1;for(;M<this.rows&&_;){for(x=0,A=!1;x<this.columns&&A===!1;)this.get(M,x)===0?x++:this.get(M,x)===1&&x>b?(A=!0,b=x):(_=!1,A=!0);M++}return _}isReducedEchelonForm(){let M=0,x=0,b=-1,_=!0,A=!1;for(;M<this.rows&&_;){for(x=0,A=!1;x<this.columns&&A===!1;)this.get(M,x)===0?x++:this.get(M,x)===1&&x>b?(A=!0,b=x):(_=!1,A=!0);for(let I=x+1;I<this.rows;I++)this.get(M,I)!==0&&(_=!1);M++}return _}echelonForm(){let M=this.clone(),x=0,b=0;for(;x<M.rows&&b<M.columns;){let _=x;for(let A=x;A<M.rows;A++)M.get(A,b)>M.get(_,b)&&(_=A);if(M.get(_,b)===0)b++;else{M.swapRows(x,_);let A=M.get(x,b);for(let I=b;I<M.columns;I++)M.set(x,I,M.get(x,I)/A);for(let I=x+1;I<M.rows;I++){let F=M.get(I,b)/M.get(x,b);M.set(I,b,0);for(let B=b+1;B<M.columns;B++)M.set(I,B,M.get(I,B)-M.get(x,B)*F)}x++,b++}}return M}reducedEchelonForm(){let M=this.echelonForm(),x=M.columns,b=M.rows,_=b-1;for(;_>=0;)if(M.maxRow(_)===0)_--;else{let A=0,I=!1;for(;A<b&&I===!1;)M.get(_,A)===1?I=!0:A++;for(let F=0;F<_;F++){let B=M.get(F,A);for(let j=A;j<x;j++){let et=M.get(F,j)-B*M.get(_,j);M.set(F,j,et)}}_--}return M}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(M={}){if(typeof M!="object")throw new TypeError("options must be an object");const{rows:x=1,columns:b=1}=M;if(!Number.isInteger(x)||x<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(b)||b<=0)throw new TypeError("columns must be a positive integer");let _=new V(this.rows*x,this.columns*b);for(let A=0;A<x;A++)for(let I=0;I<b;I++)_.setSubMatrix(this,this.rows*A,this.columns*I);return _}fill(M){for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)this.set(x,b,M);return this}neg(){return this.mulS(-1)}getRow(M){u(this,M);let x=[];for(let b=0;b<this.columns;b++)x.push(this.get(M,b));return x}getRowVector(M){return V.rowVector(this.getRow(M))}setRow(M,x){u(this,M),x=f(this,x);for(let b=0;b<this.columns;b++)this.set(M,b,x[b]);return this}swapRows(M,x){u(this,M),u(this,x);for(let b=0;b<this.columns;b++){let _=this.get(M,b);this.set(M,b,this.get(x,b)),this.set(x,b,_)}return this}getColumn(M){h(this,M);let x=[];for(let b=0;b<this.rows;b++)x.push(this.get(b,M));return x}getColumnVector(M){return V.columnVector(this.getColumn(M))}setColumn(M,x){h(this,M),x=d(this,x);for(let b=0;b<this.rows;b++)this.set(b,M,x[b]);return this}swapColumns(M,x){h(this,M),h(this,x);for(let b=0;b<this.rows;b++){let _=this.get(b,M);this.set(b,M,this.get(b,x)),this.set(b,x,_)}return this}addRowVector(M){M=f(this,M);for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)this.set(x,b,this.get(x,b)+M[b]);return this}subRowVector(M){M=f(this,M);for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)this.set(x,b,this.get(x,b)-M[b]);return this}mulRowVector(M){M=f(this,M);for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)this.set(x,b,this.get(x,b)*M[b]);return this}divRowVector(M){M=f(this,M);for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)this.set(x,b,this.get(x,b)/M[b]);return this}addColumnVector(M){M=d(this,M);for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)this.set(x,b,this.get(x,b)+M[x]);return this}subColumnVector(M){M=d(this,M);for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)this.set(x,b,this.get(x,b)-M[x]);return this}mulColumnVector(M){M=d(this,M);for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)this.set(x,b,this.get(x,b)*M[x]);return this}divColumnVector(M){M=d(this,M);for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)this.set(x,b,this.get(x,b)/M[x]);return this}mulRow(M,x){u(this,M);for(let b=0;b<this.columns;b++)this.set(M,b,this.get(M,b)*x);return this}mulColumn(M,x){h(this,M);for(let b=0;b<this.rows;b++)this.set(b,M,this.get(b,M)*x);return this}max(M){if(this.isEmpty())return NaN;switch(M){case"row":{const x=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.get(b,_)>x[b]&&(x[b]=this.get(b,_));return x}case"column":{const x=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.get(b,_)>x[_]&&(x[_]=this.get(b,_));return x}case void 0:{let x=this.get(0,0);for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.get(b,_)>x&&(x=this.get(b,_));return x}default:throw new Error(`invalid option: ${M}`)}}maxIndex(){w(this);let M=this.get(0,0),x=[0,0];for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.get(b,_)>M&&(M=this.get(b,_),x[0]=b,x[1]=_);return x}min(M){if(this.isEmpty())return NaN;switch(M){case"row":{const x=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.get(b,_)<x[b]&&(x[b]=this.get(b,_));return x}case"column":{const x=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.get(b,_)<x[_]&&(x[_]=this.get(b,_));return x}case void 0:{let x=this.get(0,0);for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.get(b,_)<x&&(x=this.get(b,_));return x}default:throw new Error(`invalid option: ${M}`)}}minIndex(){w(this);let M=this.get(0,0),x=[0,0];for(let b=0;b<this.rows;b++)for(let _=0;_<this.columns;_++)this.get(b,_)<M&&(M=this.get(b,_),x[0]=b,x[1]=_);return x}maxRow(M){if(u(this,M),this.isEmpty())return NaN;let x=this.get(M,0);for(let b=1;b<this.columns;b++)this.get(M,b)>x&&(x=this.get(M,b));return x}maxRowIndex(M){u(this,M),w(this);let x=this.get(M,0),b=[M,0];for(let _=1;_<this.columns;_++)this.get(M,_)>x&&(x=this.get(M,_),b[1]=_);return b}minRow(M){if(u(this,M),this.isEmpty())return NaN;let x=this.get(M,0);for(let b=1;b<this.columns;b++)this.get(M,b)<x&&(x=this.get(M,b));return x}minRowIndex(M){u(this,M),w(this);let x=this.get(M,0),b=[M,0];for(let _=1;_<this.columns;_++)this.get(M,_)<x&&(x=this.get(M,_),b[1]=_);return b}maxColumn(M){if(h(this,M),this.isEmpty())return NaN;let x=this.get(0,M);for(let b=1;b<this.rows;b++)this.get(b,M)>x&&(x=this.get(b,M));return x}maxColumnIndex(M){h(this,M),w(this);let x=this.get(0,M),b=[0,M];for(let _=1;_<this.rows;_++)this.get(_,M)>x&&(x=this.get(_,M),b[0]=_);return b}minColumn(M){if(h(this,M),this.isEmpty())return NaN;let x=this.get(0,M);for(let b=1;b<this.rows;b++)this.get(b,M)<x&&(x=this.get(b,M));return x}minColumnIndex(M){h(this,M),w(this);let x=this.get(0,M),b=[0,M];for(let _=1;_<this.rows;_++)this.get(_,M)<x&&(x=this.get(_,M),b[0]=_);return b}diag(){let M=Math.min(this.rows,this.columns),x=[];for(let b=0;b<M;b++)x.push(this.get(b,b));return x}norm(M="frobenius"){switch(M){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${M}`)}}cumulativeSum(){let M=0;for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)M+=this.get(x,b),this.set(x,b,M);return this}dot(M){ct.isMatrix(M)&&(M=M.to1DArray());let x=this.to1DArray();if(x.length!==M.length)throw new RangeError("vectors do not have the same size");let b=0;for(let _=0;_<x.length;_++)b+=x[_]*M[_];return b}mmul(M){M=V.checkMatrix(M);let x=this.rows,b=this.columns,_=M.columns,A=new V(x,_),I=new Float64Array(b);for(let F=0;F<_;F++){for(let B=0;B<b;B++)I[B]=M.get(B,F);for(let B=0;B<x;B++){let j=0;for(let et=0;et<b;et++)j+=this.get(B,et)*I[et];A.set(B,F,j)}}return A}mpow(M){if(!this.isSquare())throw new RangeError("Matrix must be square");if(!Number.isInteger(M)||M<0)throw new RangeError("Exponent must be a non-negative integer");let x=V.eye(this.rows),b=this;for(let _=M;_>=1;_/=2)(_&1)!==0&&(x=x.mmul(b)),b=b.mmul(b);return x}strassen2x2(M){M=V.checkMatrix(M);let x=new V(2,2);const b=this.get(0,0),_=M.get(0,0),A=this.get(0,1),I=M.get(0,1),F=this.get(1,0),B=M.get(1,0),j=this.get(1,1),et=M.get(1,1),Y=(b+j)*(_+et),ht=(F+j)*_,Tt=b*(I-et),it=j*(B-_),gt=(b+A)*et,Dt=(F-b)*(_+I),K=(A-j)*(B+et),Ot=Y+it-gt+K,qt=Tt+gt,Jt=ht+it,ee=Y-ht+Tt+Dt;return x.set(0,0,Ot),x.set(0,1,qt),x.set(1,0,Jt),x.set(1,1,ee),x}strassen3x3(M){M=V.checkMatrix(M);let x=new V(3,3);const b=this.get(0,0),_=this.get(0,1),A=this.get(0,2),I=this.get(1,0),F=this.get(1,1),B=this.get(1,2),j=this.get(2,0),et=this.get(2,1),Y=this.get(2,2),ht=M.get(0,0),Tt=M.get(0,1),it=M.get(0,2),gt=M.get(1,0),Dt=M.get(1,1),K=M.get(1,2),Ot=M.get(2,0),qt=M.get(2,1),Jt=M.get(2,2),ee=(b+_+A-I-F-et-Y)*Dt,Ue=(b-I)*(-Tt+Dt),Ht=F*(-ht+Tt+gt-Dt-K-Ot+Jt),Yt=(-b+I+F)*(ht-Tt+Dt),Ae=(I+F)*(-ht+Tt),Q=b*ht,Et=(-b+j+et)*(ht-it+K),Ft=(-b+j)*(it-K),St=(j+et)*(-ht+it),Ye=(b+_+A-F-B-j-et)*K,we=et*(-ht+it+gt-Dt-K-Ot+qt),$e=(-A+et+Y)*(Dt+Ot-qt),Xe=(A-Y)*(Dt-qt),Dn=A*Ot,ni=(et+Y)*(-Ot+qt),En=(-A+F+B)*(K+Ot-Jt),bi=(A-B)*(K-Jt),Vi=(F+B)*(-Ot+Jt),ve=_*gt,Fn=B*qt,Or=I*it,Tr=j*Tt,Sn=Y*Jt,kI=Q+Dn+ve,AI=ee+Yt+Ae+Q+$e+Dn+ni,CI=Q+Et+St+Ye+Dn+En+Vi,PI=Ue+Ht+Yt+Q+Dn+En+bi,NI=Ue+Yt+Ae+Q+Fn,RI=Dn+En+bi+Vi+Or,LI=Q+Et+Ft+we+$e+Xe+Dn,II=$e+Xe+Dn+ni+Tr,DI=Q+Et+Ft+St+Sn;return x.set(0,0,kI),x.set(0,1,AI),x.set(0,2,CI),x.set(1,0,PI),x.set(1,1,NI),x.set(1,2,RI),x.set(2,0,LI),x.set(2,1,II),x.set(2,2,DI),x}mmulStrassen(M){M=V.checkMatrix(M);let x=this.clone(),b=x.rows,_=x.columns,A=M.rows,I=M.columns;_!==A&&console.warn(`Multiplying ${b} x ${_} and ${A} x ${I} matrix: dimensions do not match.`);function F(Y,ht,Tt){let it=Y.rows,gt=Y.columns;if(it===ht&&gt===Tt)return Y;{let Dt=ct.zeros(ht,Tt);return Dt=Dt.setSubMatrix(Y,0,0),Dt}}let B=Math.max(b,A),j=Math.max(_,I);x=F(x,B,j),M=F(M,B,j);function et(Y,ht,Tt,it){if(Tt<=512||it<=512)return Y.mmul(ht);Tt%2===1&&it%2===1?(Y=F(Y,Tt+1,it+1),ht=F(ht,Tt+1,it+1)):Tt%2===1?(Y=F(Y,Tt+1,it),ht=F(ht,Tt+1,it)):it%2===1&&(Y=F(Y,Tt,it+1),ht=F(ht,Tt,it+1));let gt=parseInt(Y.rows/2,10),Dt=parseInt(Y.columns/2,10),K=Y.subMatrix(0,gt-1,0,Dt-1),Ot=ht.subMatrix(0,gt-1,0,Dt-1),qt=Y.subMatrix(0,gt-1,Dt,Y.columns-1),Jt=ht.subMatrix(0,gt-1,Dt,ht.columns-1),ee=Y.subMatrix(gt,Y.rows-1,0,Dt-1),Ue=ht.subMatrix(gt,ht.rows-1,0,Dt-1),Ht=Y.subMatrix(gt,Y.rows-1,Dt,Y.columns-1),Yt=ht.subMatrix(gt,ht.rows-1,Dt,ht.columns-1),Ae=et(ct.add(K,Ht),ct.add(Ot,Yt),gt,Dt),Q=et(ct.add(ee,Ht),Ot,gt,Dt),Et=et(K,ct.sub(Jt,Yt),gt,Dt),Ft=et(Ht,ct.sub(Ue,Ot),gt,Dt),St=et(ct.add(K,qt),Yt,gt,Dt),Ye=et(ct.sub(ee,K),ct.add(Ot,Jt),gt,Dt),we=et(ct.sub(qt,Ht),ct.add(Ue,Yt),gt,Dt),$e=ct.add(Ae,Ft);$e.sub(St),$e.add(we);let Xe=ct.add(Et,St),Dn=ct.add(Q,Ft),ni=ct.sub(Ae,Q);ni.add(Et),ni.add(Ye);let En=ct.zeros(2*$e.rows,2*$e.columns);return En=En.setSubMatrix($e,0,0),En=En.setSubMatrix(Xe,$e.rows,0),En=En.setSubMatrix(Dn,0,$e.columns),En=En.setSubMatrix(ni,$e.rows,$e.columns),En.subMatrix(0,Tt-1,0,it-1)}return et(x,M,B,j)}scaleRows(M={}){if(typeof M!="object")throw new TypeError("options must be an object");const{min:x=0,max:b=1}=M;if(!Number.isFinite(x))throw new TypeError("min must be a number");if(!Number.isFinite(b))throw new TypeError("max must be a number");if(x>=b)throw new RangeError("min must be smaller than max");let _=new V(this.rows,this.columns);for(let A=0;A<this.rows;A++){const I=this.getRow(A);I.length>0&&t(I,{min:x,max:b,output:I}),_.setRow(A,I)}return _}scaleColumns(M={}){if(typeof M!="object")throw new TypeError("options must be an object");const{min:x=0,max:b=1}=M;if(!Number.isFinite(x))throw new TypeError("min must be a number");if(!Number.isFinite(b))throw new TypeError("max must be a number");if(x>=b)throw new RangeError("min must be smaller than max");let _=new V(this.rows,this.columns);for(let A=0;A<this.columns;A++){const I=this.getColumn(A);I.length&&t(I,{min:x,max:b,output:I}),_.setColumn(A,I)}return _}flipRows(){const M=Math.ceil(this.columns/2);for(let x=0;x<this.rows;x++)for(let b=0;b<M;b++){let _=this.get(x,b),A=this.get(x,this.columns-1-b);this.set(x,b,A),this.set(x,this.columns-1-b,_)}return this}flipColumns(){const M=Math.ceil(this.rows/2);for(let x=0;x<this.columns;x++)for(let b=0;b<M;b++){let _=this.get(b,x),A=this.get(this.rows-1-b,x);this.set(b,x,A),this.set(this.rows-1-b,x,_)}return this}kroneckerProduct(M){M=V.checkMatrix(M);let x=this.rows,b=this.columns,_=M.rows,A=M.columns,I=new V(x*_,b*A);for(let F=0;F<x;F++)for(let B=0;B<b;B++)for(let j=0;j<_;j++)for(let et=0;et<A;et++)I.set(_*F+j,A*B+et,this.get(F,B)*M.get(j,et));return I}kroneckerSum(M){if(M=V.checkMatrix(M),!this.isSquare()||!M.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let x=this.rows,b=M.rows,_=this.kroneckerProduct(V.eye(b,b)),A=V.eye(x,x).kroneckerProduct(M);return _.add(A)}transpose(){let M=new V(this.columns,this.rows);for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)M.set(b,x,this.get(x,b));return M}sortRows(M=Gt){for(let x=0;x<this.rows;x++)this.setRow(x,this.getRow(x).sort(M));return this}sortColumns(M=Gt){for(let x=0;x<this.columns;x++)this.setColumn(x,this.getColumn(x).sort(M));return this}subMatrix(M,x,b,_){p(this,M,x,b,_);let A=new V(x-M+1,_-b+1);for(let I=M;I<=x;I++)for(let F=b;F<=_;F++)A.set(I-M,F-b,this.get(I,F));return A}subMatrixRow(M,x,b){if(x===void 0&&(x=0),b===void 0&&(b=this.columns-1),x>b||x<0||x>=this.columns||b<0||b>=this.columns)throw new RangeError("Argument out of range");let _=new V(M.length,b-x+1);for(let A=0;A<M.length;A++)for(let I=x;I<=b;I++){if(M[A]<0||M[A]>=this.rows)throw new RangeError(`Row index out of range: ${M[A]}`);_.set(A,I-x,this.get(M[A],I))}return _}subMatrixColumn(M,x,b){if(x===void 0&&(x=0),b===void 0&&(b=this.rows-1),x>b||x<0||x>=this.rows||b<0||b>=this.rows)throw new RangeError("Argument out of range");let _=new V(b-x+1,M.length);for(let A=0;A<M.length;A++)for(let I=x;I<=b;I++){if(M[A]<0||M[A]>=this.columns)throw new RangeError(`Column index out of range: ${M[A]}`);_.set(I-x,A,this.get(I,M[A]))}return _}setSubMatrix(M,x,b){if(M=V.checkMatrix(M),M.isEmpty())return this;let _=x+M.rows-1,A=b+M.columns-1;p(this,x,_,b,A);for(let I=0;I<M.rows;I++)for(let F=0;F<M.columns;F++)this.set(x+I,b+F,M.get(I,F));return this}selection(M,x){g(this,M),v(this,x);let b=new V(M.length,x.length);for(let _=0;_<M.length;_++){let A=M[_];for(let I=0;I<x.length;I++){let F=x[I];b.set(_,I,this.get(A,F))}}return b}trace(){let M=Math.min(this.rows,this.columns),x=0;for(let b=0;b<M;b++)x+=this.get(b,b);return x}clone(){return this.constructor.copy(this,new V(this.rows,this.columns))}static copy(M,x){for(const[b,_,A]of M.entries())x.set(b,_,A);return x}sum(M){switch(M){case"row":return E(this);case"column":return S(this);case void 0:return O(this);default:throw new Error(`invalid option: ${M}`)}}product(M){switch(M){case"row":return k(this);case"column":return T(this);case void 0:return C(this);default:throw new Error(`invalid option: ${M}`)}}mean(M){const x=this.sum(M);switch(M){case"row":{for(let b=0;b<this.rows;b++)x[b]/=this.columns;return x}case"column":{for(let b=0;b<this.columns;b++)x[b]/=this.rows;return x}case void 0:return x/this.size;default:throw new Error(`invalid option: ${M}`)}}variance(M,x={}){if(typeof M=="object"&&(x=M,M=void 0),typeof x!="object")throw new TypeError("options must be an object");const{unbiased:b=!0,mean:_=this.mean(M)}=x;if(typeof b!="boolean")throw new TypeError("unbiased must be a boolean");switch(M){case"row":{if(!n.isAnyArray(_))throw new TypeError("mean must be an array");return P(this,b,_)}case"column":{if(!n.isAnyArray(_))throw new TypeError("mean must be an array");return N(this,b,_)}case void 0:{if(typeof _!="number")throw new TypeError("mean must be a number");return L(this,b,_)}default:throw new Error(`invalid option: ${M}`)}}standardDeviation(M,x){typeof M=="object"&&(x=M,M=void 0);const b=this.variance(M,x);if(M===void 0)return Math.sqrt(b);for(let _=0;_<b.length;_++)b[_]=Math.sqrt(b[_]);return b}center(M,x={}){if(typeof M=="object"&&(x=M,M=void 0),typeof x!="object")throw new TypeError("options must be an object");const{center:b=this.mean(M)}=x;switch(M){case"row":{if(!n.isAnyArray(b))throw new TypeError("center must be an array");return D(this,b),this}case"column":{if(!n.isAnyArray(b))throw new TypeError("center must be an array");return G(this,b),this}case void 0:{if(typeof b!="number")throw new TypeError("center must be a number");return H(this,b),this}default:throw new Error(`invalid option: ${M}`)}}scale(M,x={}){if(typeof M=="object"&&(x=M,M=void 0),typeof x!="object")throw new TypeError("options must be an object");let b=x.scale;switch(M){case"row":{if(b===void 0)b=W(this);else if(!n.isAnyArray(b))throw new TypeError("scale must be an array");return q(this,b),this}case"column":{if(b===void 0)b=z(this);else if(!n.isAnyArray(b))throw new TypeError("scale must be an array");return Z(this,b),this}case void 0:{if(b===void 0)b=at(this);else if(typeof b!="number")throw new TypeError("scale must be a number");return ft(this,b),this}default:throw new Error(`invalid option: ${M}`)}}toString(M){return a(this,M)}[Symbol.iterator](){return this.entries()}*entries(){for(let M=0;M<this.rows;M++)for(let x=0;x<this.columns;x++)yield[M,x,this.get(M,x)]}*values(){for(let M=0;M<this.rows;M++)for(let x=0;x<this.columns;x++)yield this.get(M,x)}}ct.prototype.klass="Matrix",typeof Symbol<"u"&&(ct.prototype[Symbol.for("nodejs.util.inspect.custom")]=i);function Gt(R,M){return R-M}function J(R){return R.every(M=>typeof M=="number")}ct.random=ct.rand,ct.randomInt=ct.randInt,ct.diagonal=ct.diag,ct.prototype.diagonal=ct.prototype.diag,ct.identity=ct.eye,ct.prototype.negate=ct.prototype.neg,ct.prototype.tensorProduct=ct.prototype.kroneckerProduct;const Lc=class Lc extends ct{constructor(x,b){super();kd(this,Yo);Ce(this,"data");if(Lc.isMatrix(x))Ad(this,Yo,Tb).call(this,x.rows,x.columns),Lc.copy(x,this);else if(Number.isInteger(x)&&x>=0)Ad(this,Yo,Tb).call(this,x,b);else if(n.isAnyArray(x)){const _=x;if(x=_.length,b=x?_[0].length:0,typeof b!="number")throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let A=0;A<x;A++){if(_[A].length!==b)throw new RangeError("Inconsistent array dimensions");if(!J(_[A]))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(_[A]))}this.rows=x,this.columns=b}else throw new TypeError("First argument must be a positive number or an array")}set(x,b,_){return this.data[x][b]=_,this}get(x,b){return this.data[x][b]}removeRow(x){return u(this,x),this.data.splice(x,1),this.rows-=1,this}addRow(x,b){return b===void 0&&(b=x,x=this.rows),u(this,x,!0),b=Float64Array.from(f(this,b)),this.data.splice(x,0,b),this.rows+=1,this}removeColumn(x){h(this,x);for(let b=0;b<this.rows;b++){const _=new Float64Array(this.columns-1);for(let A=0;A<x;A++)_[A]=this.data[b][A];for(let A=x+1;A<this.columns;A++)_[A-1]=this.data[b][A];this.data[b]=_}return this.columns-=1,this}addColumn(x,b){typeof b>"u"&&(b=x,x=this.columns),h(this,x,!0),b=d(this,b);for(let _=0;_<this.rows;_++){const A=new Float64Array(this.columns+1);let I=0;for(;I<x;I++)A[I]=this.data[_][I];for(A[I++]=b[_];I<this.columns+1;I++)A[I]=this.data[_][I-1];this.data[_]=A}return this.columns+=1,this}};Yo=new WeakSet,Tb=function(x,b){if(this.data=[],Number.isInteger(b)&&b>=0)for(let _=0;_<x;_++)this.data.push(new Float64Array(b));else throw new TypeError("nColumns must be a positive integer");this.rows=x,this.columns=b};let V=Lc;c(ct,V);const Ic=class Ic extends ct{constructor(x){super();kd(this,Hn);if(V.isMatrix(x)){if(!x.isSymmetric())throw new TypeError("not symmetric data");Dc(this,Hn,V.copy(x,new V(x.rows,x.rows)))}else if(Number.isInteger(x)&&x>=0)Dc(this,Hn,new V(x,x));else if(Dc(this,Hn,new V(x)),!this.isSymmetric())throw new TypeError("not symmetric data")}get size(){return ri(this,Hn).size}get rows(){return ri(this,Hn).rows}get columns(){return ri(this,Hn).columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(x){return V.isMatrix(x)&&x.klassType==="SymmetricMatrix"}static zeros(x){return new this(x)}static ones(x){return new this(x).fill(1)}clone(){const x=new Ic(this.diagonalSize);for(const[b,_,A]of this.upperRightEntries())x.set(b,_,A);return x}toMatrix(){return new V(this)}get(x,b){return ri(this,Hn).get(x,b)}set(x,b,_){return ri(this,Hn).set(x,b,_),ri(this,Hn).set(b,x,_),this}removeCross(x){return ri(this,Hn).removeRow(x),ri(this,Hn).removeColumn(x),this}addCross(x,b){b===void 0&&(b=x,x=this.diagonalSize);const _=b.slice();return _.splice(x,1),ri(this,Hn).addRow(x,_),ri(this,Hn).addColumn(x,b),this}applyMask(x){if(x.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const b=[];for(const[_,A]of x.entries())A||b.push(_);b.reverse();for(const _ of b)this.removeCross(_);return this}toCompact(){const{diagonalSize:x}=this,b=new Array(x*(x+1)/2);for(let _=0,A=0,I=0;I<b.length;I++)b[I]=this.get(A,_),++_>=x&&(_=++A);return b}static fromCompact(x){const b=x.length,_=(Math.sqrt(8*b+1)-1)/2;if(!Number.isInteger(_))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(x)}`);const A=new Ic(_);for(let I=0,F=0,B=0;B<b;B++)A.set(I,F,x[B]),++I>=_&&(I=++F);return A}*upperRightEntries(){for(let x=0,b=0;x<this.diagonalSize;void 0){const _=this.get(x,b);yield[x,b,_],++b>=this.diagonalSize&&(b=++x)}}*upperRightValues(){for(let x=0,b=0;x<this.diagonalSize;void 0)yield this.get(x,b),++b>=this.diagonalSize&&(b=++x)}};Hn=new WeakMap;let nt=Ic;nt.prototype.klassType="SymmetricMatrix";class dt extends nt{static isDistanceMatrix(M){return nt.isSymmetricMatrix(M)&&M.klassSubType==="DistanceMatrix"}constructor(M){if(super(M),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(M,x,b){return M===x&&(b=0),super.set(M,x,b)}addCross(M,x){return x===void 0&&(x=M,M=this.diagonalSize),x=x.slice(),x[M]=0,super.addCross(M,x)}toSymmetricMatrix(){return new nt(this)}clone(){const M=new dt(this.diagonalSize);for(const[x,b,_]of this.upperRightEntries())x!==b&&M.set(x,b,_);return M}toCompact(){const{diagonalSize:M}=this,x=(M-1)*M/2,b=new Array(x);for(let _=1,A=0,I=0;I<b.length;I++)b[I]=this.get(A,_),++_>=M&&(_=++A+1);return b}static fromCompact(M){const x=M.length;if(x===0)return new this(0);const b=(Math.sqrt(8*x+1)+1)/2;if(!Number.isInteger(b))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(M)}`);const _=new this(b);for(let A=1,I=0,F=0;F<x;F++)_.set(A,I,M[F]),++A>=b&&(A=++I+1);return _}}dt.prototype.klassSubType="DistanceMatrix";class Nt extends ct{constructor(M,x,b){super(),this.matrix=M,this.rows=x,this.columns=b}}class Wt extends Nt{constructor(M,x){h(M,x),super(M,M.rows,1),this.column=x}set(M,x,b){return this.matrix.set(M,this.column,b),this}get(M){return this.matrix.get(M,this.column)}}class Kt extends Nt{constructor(M,x){v(M,x),super(M,M.rows,x.length),this.columnIndices=x}set(M,x,b){return this.matrix.set(M,this.columnIndices[x],b),this}get(M,x){return this.matrix.get(M,this.columnIndices[x])}}class qe extends Nt{constructor(M){super(M,M.rows,M.columns)}set(M,x,b){return this.matrix.set(M,this.columns-x-1,b),this}get(M,x){return this.matrix.get(M,this.columns-x-1)}}class U extends Nt{constructor(M){super(M,M.rows,M.columns)}set(M,x,b){return this.matrix.set(this.rows-M-1,x,b),this}get(M,x){return this.matrix.get(this.rows-M-1,x)}}class X extends Nt{constructor(M,x){u(M,x),super(M,1,M.columns),this.row=x}set(M,x,b){return this.matrix.set(this.row,x,b),this}get(M,x){return this.matrix.get(this.row,x)}}class rt extends Nt{constructor(M,x){g(M,x),super(M,x.length,M.columns),this.rowIndices=x}set(M,x,b){return this.matrix.set(this.rowIndices[M],x,b),this}get(M,x){return this.matrix.get(this.rowIndices[M],x)}}class lt extends Nt{constructor(M,x,b){g(M,x),v(M,b),super(M,x.length,b.length),this.rowIndices=x,this.columnIndices=b}set(M,x,b){return this.matrix.set(this.rowIndices[M],this.columnIndices[x],b),this}get(M,x){return this.matrix.get(this.rowIndices[M],this.columnIndices[x])}}class vt extends Nt{constructor(M,x,b,_,A){p(M,x,b,_,A),super(M,b-x+1,A-_+1),this.startRow=x,this.startColumn=_}set(M,x,b){return this.matrix.set(this.startRow+M,this.startColumn+x,b),this}get(M,x){return this.matrix.get(this.startRow+M,this.startColumn+x)}}class ut extends Nt{constructor(M){super(M,M.columns,M.rows)}set(M,x,b){return this.matrix.set(x,M,b),this}get(M,x){return this.matrix.get(x,M)}}class Pt extends ct{constructor(M,x={}){const{rows:b=1}=x;if(M.length%b!==0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=b,this.columns=M.length/b,this.data=M}set(M,x,b){let _=this._calculateIndex(M,x);return this.data[_]=b,this}get(M,x){let b=this._calculateIndex(M,x);return this.data[b]}_calculateIndex(M,x){return M*this.columns+x}}class xt extends ct{constructor(M){super(),this.data=M,this.rows=M.length,this.columns=M[0].length}set(M,x,b){return this.data[M][x]=b,this}get(M,x){return this.data[M][x]}}function At(R,M){if(n.isAnyArray(R))return R[0]&&n.isAnyArray(R[0])?new xt(R):new Pt(R,M);throw new Error("the argument is not an array")}class wt{constructor(M){M=xt.checkMatrix(M);let x=M.clone(),b=x.rows,_=x.columns,A=new Float64Array(b),I=1,F,B,j,et,Y,ht,Tt,it,gt;for(F=0;F<b;F++)A[F]=F;for(it=new Float64Array(b),B=0;B<_;B++){for(F=0;F<b;F++)it[F]=x.get(F,B);for(F=0;F<b;F++){for(gt=Math.min(F,B),Y=0,j=0;j<gt;j++)Y+=x.get(F,j)*it[j];it[F]-=Y,x.set(F,B,it[F])}for(et=B,F=B+1;F<b;F++)Math.abs(it[F])>Math.abs(it[et])&&(et=F);if(et!==B){for(j=0;j<_;j++)ht=x.get(et,j),x.set(et,j,x.get(B,j)),x.set(B,j,ht);Tt=A[et],A[et]=A[B],A[B]=Tt,I=-I}if(B<b&&x.get(B,B)!==0)for(F=B+1;F<b;F++)x.set(F,B,x.get(F,B)/x.get(B,B))}this.LU=x,this.pivotVector=A,this.pivotSign=I}isSingular(){let M=this.LU,x=M.columns;for(let b=0;b<x;b++)if(M.get(b,b)===0)return!0;return!1}solve(M){M=V.checkMatrix(M);let x=this.LU;if(x.rows!==M.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let _=M.columns,A=M.subMatrixRow(this.pivotVector,0,_-1),I=x.columns,F,B,j;for(j=0;j<I;j++)for(F=j+1;F<I;F++)for(B=0;B<_;B++)A.set(F,B,A.get(F,B)-A.get(j,B)*x.get(F,j));for(j=I-1;j>=0;j--){for(B=0;B<_;B++)A.set(j,B,A.get(j,B)/x.get(j,j));for(F=0;F<j;F++)for(B=0;B<_;B++)A.set(F,B,A.get(F,B)-A.get(j,B)*x.get(F,j))}return A}get determinant(){let M=this.LU;if(!M.isSquare())throw new Error("Matrix must be square");let x=this.pivotSign,b=M.columns;for(let _=0;_<b;_++)x*=M.get(_,_);return x}get lowerTriangularMatrix(){let M=this.LU,x=M.rows,b=M.columns,_=new V(x,b);for(let A=0;A<x;A++)for(let I=0;I<b;I++)A>I?_.set(A,I,M.get(A,I)):A===I?_.set(A,I,1):_.set(A,I,0);return _}get upperTriangularMatrix(){let M=this.LU,x=M.rows,b=M.columns,_=new V(x,b);for(let A=0;A<x;A++)for(let I=0;I<b;I++)A<=I?_.set(A,I,M.get(A,I)):_.set(A,I,0);return _}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function Bt(R,M){let x=0;return Math.abs(R)>Math.abs(M)?(x=M/R,Math.abs(R)*Math.sqrt(1+x*x)):M!==0?(x=R/M,Math.abs(M)*Math.sqrt(1+x*x)):0}class _t{constructor(M){M=xt.checkMatrix(M);let x=M.clone(),b=M.rows,_=M.columns,A=new Float64Array(_),I,F,B,j;for(B=0;B<_;B++){let et=0;for(I=B;I<b;I++)et=Bt(et,x.get(I,B));if(et!==0){for(x.get(B,B)<0&&(et=-et),I=B;I<b;I++)x.set(I,B,x.get(I,B)/et);for(x.set(B,B,x.get(B,B)+1),F=B+1;F<_;F++){for(j=0,I=B;I<b;I++)j+=x.get(I,B)*x.get(I,F);for(j=-j/x.get(B,B),I=B;I<b;I++)x.set(I,F,x.get(I,F)+j*x.get(I,B))}}A[B]=-et}this.QR=x,this.Rdiag=A}solve(M){M=V.checkMatrix(M);let x=this.QR,b=x.rows;if(M.rows!==b)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let _=M.columns,A=M.clone(),I=x.columns,F,B,j,et;for(j=0;j<I;j++)for(B=0;B<_;B++){for(et=0,F=j;F<b;F++)et+=x.get(F,j)*A.get(F,B);for(et=-et/x.get(j,j),F=j;F<b;F++)A.set(F,B,A.get(F,B)+et*x.get(F,j))}for(j=I-1;j>=0;j--){for(B=0;B<_;B++)A.set(j,B,A.get(j,B)/this.Rdiag[j]);for(F=0;F<j;F++)for(B=0;B<_;B++)A.set(F,B,A.get(F,B)-A.get(j,B)*x.get(F,j))}return A.subMatrix(0,I-1,0,_-1)}isFullRank(){let M=this.QR.columns;for(let x=0;x<M;x++)if(this.Rdiag[x]===0)return!1;return!0}get upperTriangularMatrix(){let M=this.QR,x=M.columns,b=new V(x,x),_,A;for(_=0;_<x;_++)for(A=0;A<x;A++)_<A?b.set(_,A,M.get(_,A)):_===A?b.set(_,A,this.Rdiag[_]):b.set(_,A,0);return b}get orthogonalMatrix(){let M=this.QR,x=M.rows,b=M.columns,_=new V(x,b),A,I,F,B;for(F=b-1;F>=0;F--){for(A=0;A<x;A++)_.set(A,F,0);for(_.set(F,F,1),I=F;I<b;I++)if(M.get(F,F)!==0){for(B=0,A=F;A<x;A++)B+=M.get(A,F)*_.get(A,I);for(B=-B/M.get(F,F),A=F;A<x;A++)_.set(A,I,_.get(A,I)+B*M.get(A,F))}}return _}}class $t{constructor(M,x={}){if(M=xt.checkMatrix(M),M.isEmpty())throw new Error("Matrix must be non-empty");let b=M.rows,_=M.columns;const{computeLeftSingularVectors:A=!0,computeRightSingularVectors:I=!0,autoTranspose:F=!1}=x;let B=!!A,j=!!I,et=!1,Y;if(b<_)if(!F)Y=M.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{Y=M.transpose(),b=Y.rows,_=Y.columns,et=!0;let Q=B;B=j,j=Q}else Y=M.clone();let ht=Math.min(b,_),Tt=Math.min(b+1,_),it=new Float64Array(Tt),gt=new V(b,ht),Dt=new V(_,_),K=new Float64Array(_),Ot=new Float64Array(b),qt=new Float64Array(Tt);for(let Q=0;Q<Tt;Q++)qt[Q]=Q;let Jt=Math.min(b-1,_),ee=Math.max(0,Math.min(_-2,b)),Ue=Math.max(Jt,ee);for(let Q=0;Q<Ue;Q++){if(Q<Jt){it[Q]=0;for(let Et=Q;Et<b;Et++)it[Q]=Bt(it[Q],Y.get(Et,Q));if(it[Q]!==0){Y.get(Q,Q)<0&&(it[Q]=-it[Q]);for(let Et=Q;Et<b;Et++)Y.set(Et,Q,Y.get(Et,Q)/it[Q]);Y.set(Q,Q,Y.get(Q,Q)+1)}it[Q]=-it[Q]}for(let Et=Q+1;Et<_;Et++){if(Q<Jt&&it[Q]!==0){let Ft=0;for(let St=Q;St<b;St++)Ft+=Y.get(St,Q)*Y.get(St,Et);Ft=-Ft/Y.get(Q,Q);for(let St=Q;St<b;St++)Y.set(St,Et,Y.get(St,Et)+Ft*Y.get(St,Q))}K[Et]=Y.get(Q,Et)}if(B&&Q<Jt)for(let Et=Q;Et<b;Et++)gt.set(Et,Q,Y.get(Et,Q));if(Q<ee){K[Q]=0;for(let Et=Q+1;Et<_;Et++)K[Q]=Bt(K[Q],K[Et]);if(K[Q]!==0){K[Q+1]<0&&(K[Q]=0-K[Q]);for(let Et=Q+1;Et<_;Et++)K[Et]/=K[Q];K[Q+1]+=1}if(K[Q]=-K[Q],Q+1<b&&K[Q]!==0){for(let Et=Q+1;Et<b;Et++)Ot[Et]=0;for(let Et=Q+1;Et<b;Et++)for(let Ft=Q+1;Ft<_;Ft++)Ot[Et]+=K[Ft]*Y.get(Et,Ft);for(let Et=Q+1;Et<_;Et++){let Ft=-K[Et]/K[Q+1];for(let St=Q+1;St<b;St++)Y.set(St,Et,Y.get(St,Et)+Ft*Ot[St])}}if(j)for(let Et=Q+1;Et<_;Et++)Dt.set(Et,Q,K[Et])}}let Ht=Math.min(_,b+1);if(Jt<_&&(it[Jt]=Y.get(Jt,Jt)),b<Ht&&(it[Ht-1]=0),ee+1<Ht&&(K[ee]=Y.get(ee,Ht-1)),K[Ht-1]=0,B){for(let Q=Jt;Q<ht;Q++){for(let Et=0;Et<b;Et++)gt.set(Et,Q,0);gt.set(Q,Q,1)}for(let Q=Jt-1;Q>=0;Q--)if(it[Q]!==0){for(let Et=Q+1;Et<ht;Et++){let Ft=0;for(let St=Q;St<b;St++)Ft+=gt.get(St,Q)*gt.get(St,Et);Ft=-Ft/gt.get(Q,Q);for(let St=Q;St<b;St++)gt.set(St,Et,gt.get(St,Et)+Ft*gt.get(St,Q))}for(let Et=Q;Et<b;Et++)gt.set(Et,Q,-gt.get(Et,Q));gt.set(Q,Q,1+gt.get(Q,Q));for(let Et=0;Et<Q-1;Et++)gt.set(Et,Q,0)}else{for(let Et=0;Et<b;Et++)gt.set(Et,Q,0);gt.set(Q,Q,1)}}if(j)for(let Q=_-1;Q>=0;Q--){if(Q<ee&&K[Q]!==0)for(let Et=Q+1;Et<_;Et++){let Ft=0;for(let St=Q+1;St<_;St++)Ft+=Dt.get(St,Q)*Dt.get(St,Et);Ft=-Ft/Dt.get(Q+1,Q);for(let St=Q+1;St<_;St++)Dt.set(St,Et,Dt.get(St,Et)+Ft*Dt.get(St,Q))}for(let Et=0;Et<_;Et++)Dt.set(Et,Q,0);Dt.set(Q,Q,1)}let Yt=Ht-1,Ae=Number.EPSILON;for(;Ht>0;){let Q,Et;for(Q=Ht-2;Q>=-1&&Q!==-1;Q--){const Ft=Number.MIN_VALUE+Ae*Math.abs(it[Q]+Math.abs(it[Q+1]));if(Math.abs(K[Q])<=Ft||Number.isNaN(K[Q])){K[Q]=0;break}}if(Q===Ht-2)Et=4;else{let Ft;for(Ft=Ht-1;Ft>=Q&&Ft!==Q;Ft--){let St=(Ft!==Ht?Math.abs(K[Ft]):0)+(Ft!==Q+1?Math.abs(K[Ft-1]):0);if(Math.abs(it[Ft])<=Ae*St){it[Ft]=0;break}}Ft===Q?Et=3:Ft===Ht-1?Et=1:(Et=2,Q=Ft)}switch(Q++,Et){case 1:{let Ft=K[Ht-2];K[Ht-2]=0;for(let St=Ht-2;St>=Q;St--){let Ye=Bt(it[St],Ft),we=it[St]/Ye,$e=Ft/Ye;if(it[St]=Ye,St!==Q&&(Ft=-$e*K[St-1],K[St-1]=we*K[St-1]),j)for(let Xe=0;Xe<_;Xe++)Ye=we*Dt.get(Xe,St)+$e*Dt.get(Xe,Ht-1),Dt.set(Xe,Ht-1,-$e*Dt.get(Xe,St)+we*Dt.get(Xe,Ht-1)),Dt.set(Xe,St,Ye)}break}case 2:{let Ft=K[Q-1];K[Q-1]=0;for(let St=Q;St<Ht;St++){let Ye=Bt(it[St],Ft),we=it[St]/Ye,$e=Ft/Ye;if(it[St]=Ye,Ft=-$e*K[St],K[St]=we*K[St],B)for(let Xe=0;Xe<b;Xe++)Ye=we*gt.get(Xe,St)+$e*gt.get(Xe,Q-1),gt.set(Xe,Q-1,-$e*gt.get(Xe,St)+we*gt.get(Xe,Q-1)),gt.set(Xe,St,Ye)}break}case 3:{const Ft=Math.max(Math.abs(it[Ht-1]),Math.abs(it[Ht-2]),Math.abs(K[Ht-2]),Math.abs(it[Q]),Math.abs(K[Q])),St=it[Ht-1]/Ft,Ye=it[Ht-2]/Ft,we=K[Ht-2]/Ft,$e=it[Q]/Ft,Xe=K[Q]/Ft,Dn=((Ye+St)*(Ye-St)+we*we)/2,ni=St*we*(St*we);let En=0;(Dn!==0||ni!==0)&&(Dn<0?En=0-Math.sqrt(Dn*Dn+ni):En=Math.sqrt(Dn*Dn+ni),En=ni/(Dn+En));let bi=($e+St)*($e-St)+En,Vi=$e*Xe;for(let ve=Q;ve<Ht-1;ve++){let Fn=Bt(bi,Vi);Fn===0&&(Fn=Number.MIN_VALUE);let Or=bi/Fn,Tr=Vi/Fn;if(ve!==Q&&(K[ve-1]=Fn),bi=Or*it[ve]+Tr*K[ve],K[ve]=Or*K[ve]-Tr*it[ve],Vi=Tr*it[ve+1],it[ve+1]=Or*it[ve+1],j)for(let Sn=0;Sn<_;Sn++)Fn=Or*Dt.get(Sn,ve)+Tr*Dt.get(Sn,ve+1),Dt.set(Sn,ve+1,-Tr*Dt.get(Sn,ve)+Or*Dt.get(Sn,ve+1)),Dt.set(Sn,ve,Fn);if(Fn=Bt(bi,Vi),Fn===0&&(Fn=Number.MIN_VALUE),Or=bi/Fn,Tr=Vi/Fn,it[ve]=Fn,bi=Or*K[ve]+Tr*it[ve+1],it[ve+1]=-Tr*K[ve]+Or*it[ve+1],Vi=Tr*K[ve+1],K[ve+1]=Or*K[ve+1],B&&ve<b-1)for(let Sn=0;Sn<b;Sn++)Fn=Or*gt.get(Sn,ve)+Tr*gt.get(Sn,ve+1),gt.set(Sn,ve+1,-Tr*gt.get(Sn,ve)+Or*gt.get(Sn,ve+1)),gt.set(Sn,ve,Fn)}K[Ht-2]=bi;break}case 4:{if(it[Q]<=0&&(it[Q]=it[Q]<0?-it[Q]:0,j))for(let Ft=0;Ft<=Yt;Ft++)Dt.set(Ft,Q,-Dt.get(Ft,Q));for(;Q<Yt&&!(it[Q]>=it[Q+1]);){let Ft=it[Q];if(it[Q]=it[Q+1],it[Q+1]=Ft,j&&Q<_-1)for(let St=0;St<_;St++)Ft=Dt.get(St,Q+1),Dt.set(St,Q+1,Dt.get(St,Q)),Dt.set(St,Q,Ft);if(B&&Q<b-1)for(let St=0;St<b;St++)Ft=gt.get(St,Q+1),gt.set(St,Q+1,gt.get(St,Q)),gt.set(St,Q,Ft);Q++}Ht--;break}}}if(et){let Q=Dt;Dt=gt,gt=Q}this.m=b,this.n=_,this.s=it,this.U=gt,this.V=Dt}solve(M){let x=M,b=this.threshold,_=this.s.length,A=V.zeros(_,_);for(let ht=0;ht<_;ht++)Math.abs(this.s[ht])<=b?A.set(ht,ht,0):A.set(ht,ht,1/this.s[ht]);let I=this.U,F=this.rightSingularVectors,B=F.mmul(A),j=F.rows,et=I.rows,Y=V.zeros(j,et);for(let ht=0;ht<j;ht++)for(let Tt=0;Tt<et;Tt++){let it=0;for(let gt=0;gt<_;gt++)it+=B.get(ht,gt)*I.get(Tt,gt);Y.set(ht,Tt,it)}return Y.mmul(x)}solveForDiagonal(M){return this.solve(V.diag(M))}inverse(){let M=this.V,x=this.threshold,b=M.rows,_=M.columns,A=new V(b,this.s.length);for(let et=0;et<b;et++)for(let Y=0;Y<_;Y++)Math.abs(this.s[Y])>x&&A.set(et,Y,M.get(et,Y)/this.s[Y]);let I=this.U,F=I.rows,B=I.columns,j=new V(b,F);for(let et=0;et<b;et++)for(let Y=0;Y<F;Y++){let ht=0;for(let Tt=0;Tt<B;Tt++)ht+=A.get(et,Tt)*I.get(Y,Tt);j.set(et,Y,ht)}return j}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let M=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,x=0,b=this.s;for(let _=0,A=b.length;_<A;_++)b[_]>M&&x++;return x}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return V.diag(this.s)}}function Vt(R,M=!1){return R=xt.checkMatrix(R),M?new $t(R).inverse():Zt(R,V.eye(R.rows))}function Zt(R,M,x=!1){return R=xt.checkMatrix(R),M=xt.checkMatrix(M),x?new $t(R).solve(M):R.isSquare()?new wt(R).solve(M):new _t(R).solve(M)}function pe(R){if(R=V.checkMatrix(R),R.isSquare()){if(R.columns===0)return 1;let M,x,b,_;if(R.columns===2)return M=R.get(0,0),x=R.get(0,1),b=R.get(1,0),_=R.get(1,1),M*_-x*b;if(R.columns===3){let A,I,F;return A=new lt(R,[1,2],[1,2]),I=new lt(R,[1,2],[0,2]),F=new lt(R,[1,2],[0,1]),M=R.get(0,0),x=R.get(0,1),b=R.get(0,2),M*pe(A)-x*pe(I)+b*pe(F)}else return new wt(R).determinant}else throw Error("determinant can only be calculated for a square matrix")}function ue(R,M){let x=[];for(let b=0;b<R;b++)b!==M&&x.push(b);return x}function dn(R,M,x,b=1e-9,_=1e-9){if(R>_)return new Array(M.rows+1).fill(0);{let A=M.addRow(x,[0]);for(let I=0;I<A.rows;I++)Math.abs(A.get(I,0))<b&&A.set(I,0,0);return A.to1DArray()}}function on(R,M={}){const{thresholdValue:x=1e-9,thresholdError:b=1e-9}=M;R=V.checkMatrix(R);let _=R.rows,A=new V(_,_);for(let I=0;I<_;I++){let F=V.columnVector(R.getRow(I)),B=R.subMatrixRow(ue(_,I)).transpose(),et=new $t(B).solve(F),Y=V.sub(F,B.mmul(et)).abs().max();A.setRow(I,dn(Y,et,I,x,b))}return A}function gr(R,M=Number.EPSILON){if(R=V.checkMatrix(R),R.isEmpty())return R.transpose();let x=new $t(R,{autoTranspose:!0}),b=x.leftSingularVectors,_=x.rightSingularVectors,A=x.diagonal;for(let I=0;I<A.length;I++)Math.abs(A[I])>M?A[I]=1/A[I]:A[I]=0;return _.mmul(V.diag(A).mmul(b.transpose()))}function Qn(R,M=R,x={}){R=new V(R);let b=!1;if(typeof M=="object"&&!V.isMatrix(M)&&!n.isAnyArray(M)?(x=M,M=R,b=!0):M=new V(M),R.rows!==M.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:_=!0}=x;_&&(R=R.center("column"),b||(M=M.center("column")));const A=R.transpose().mmul(M);for(let I=0;I<A.rows;I++)for(let F=0;F<A.columns;F++)A.set(I,F,A.get(I,F)*(1/(R.rows-1)));return A}function Vn(R,M=R,x={}){R=new V(R);let b=!1;if(typeof M=="object"&&!V.isMatrix(M)&&!n.isAnyArray(M)?(x=M,M=R,b=!0):M=new V(M),R.rows!==M.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:_=!0,scale:A=!0}=x;_&&(R.center("column"),b||M.center("column")),A&&(R.scale("column"),b||M.scale("column"));const I=R.standardDeviation("column",{unbiased:!0}),F=b?I:M.standardDeviation("column",{unbiased:!0}),B=R.transpose().mmul(M);for(let j=0;j<B.rows;j++)for(let et=0;et<B.columns;et++)B.set(j,et,B.get(j,et)*(1/(I[j]*F[et]))*(1/(R.rows-1)));return B}class Mr{constructor(M,x={}){const{assumeSymmetric:b=!1}=x;if(M=xt.checkMatrix(M),!M.isSquare())throw new Error("Matrix is not a square matrix");if(M.isEmpty())throw new Error("Matrix must be non-empty");let _=M.columns,A=new V(_,_),I=new Float64Array(_),F=new Float64Array(_),B=M,j,et,Y=!1;if(b?Y=!0:Y=M.isSymmetric(),Y){for(j=0;j<_;j++)for(et=0;et<_;et++)A.set(j,et,B.get(j,et));tr(_,F,I,A),Gr(_,F,I,A)}else{let ht=new V(_,_),Tt=new Float64Array(_);for(et=0;et<_;et++)for(j=0;j<_;j++)ht.set(j,et,B.get(j,et));Nc(_,ht,Tt,A),TI(_,F,I,A,ht)}this.n=_,this.e=F,this.d=I,this.V=A}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let M=this.n,x=this.e,b=this.d,_=new V(M,M),A,I;for(A=0;A<M;A++){for(I=0;I<M;I++)_.set(A,I,0);_.set(A,A,b[A]),x[A]>0?_.set(A,A+1,x[A]):x[A]<0&&_.set(A,A-1,x[A])}return _}}function tr(R,M,x,b){let _,A,I,F,B,j,et,Y;for(B=0;B<R;B++)x[B]=b.get(R-1,B);for(F=R-1;F>0;F--){for(Y=0,I=0,j=0;j<F;j++)Y=Y+Math.abs(x[j]);if(Y===0)for(M[F]=x[F-1],B=0;B<F;B++)x[B]=b.get(F-1,B),b.set(F,B,0),b.set(B,F,0);else{for(j=0;j<F;j++)x[j]/=Y,I+=x[j]*x[j];for(_=x[F-1],A=Math.sqrt(I),_>0&&(A=-A),M[F]=Y*A,I=I-_*A,x[F-1]=_-A,B=0;B<F;B++)M[B]=0;for(B=0;B<F;B++){for(_=x[B],b.set(B,F,_),A=M[B]+b.get(B,B)*_,j=B+1;j<=F-1;j++)A+=b.get(j,B)*x[j],M[j]+=b.get(j,B)*_;M[B]=A}for(_=0,B=0;B<F;B++)M[B]/=I,_+=M[B]*x[B];for(et=_/(I+I),B=0;B<F;B++)M[B]-=et*x[B];for(B=0;B<F;B++){for(_=x[B],A=M[B],j=B;j<=F-1;j++)b.set(j,B,b.get(j,B)-(_*M[j]+A*x[j]));x[B]=b.get(F-1,B),b.set(F,B,0)}}x[F]=I}for(F=0;F<R-1;F++){if(b.set(R-1,F,b.get(F,F)),b.set(F,F,1),I=x[F+1],I!==0){for(j=0;j<=F;j++)x[j]=b.get(j,F+1)/I;for(B=0;B<=F;B++){for(A=0,j=0;j<=F;j++)A+=b.get(j,F+1)*b.get(j,B);for(j=0;j<=F;j++)b.set(j,B,b.get(j,B)-A*x[j])}}for(j=0;j<=F;j++)b.set(j,F+1,0)}for(B=0;B<R;B++)x[B]=b.get(R-1,B),b.set(R-1,B,0);b.set(R-1,R-1,1),M[0]=0}function Gr(R,M,x,b){let _,A,I,F,B,j,et,Y,ht,Tt,it,gt,Dt,K,Ot,qt;for(I=1;I<R;I++)M[I-1]=M[I];M[R-1]=0;let Jt=0,ee=0,Ue=Number.EPSILON;for(j=0;j<R;j++){for(ee=Math.max(ee,Math.abs(x[j])+Math.abs(M[j])),et=j;et<R&&!(Math.abs(M[et])<=Ue*ee);)et++;if(et>j)do{for(_=x[j],Y=(x[j+1]-_)/(2*M[j]),ht=Bt(Y,1),Y<0&&(ht=-ht),x[j]=M[j]/(Y+ht),x[j+1]=M[j]*(Y+ht),Tt=x[j+1],A=_-x[j],I=j+2;I<R;I++)x[I]-=A;for(Jt=Jt+A,Y=x[et],it=1,gt=it,Dt=it,K=M[j+1],Ot=0,qt=0,I=et-1;I>=j;I--)for(Dt=gt,gt=it,qt=Ot,_=it*M[I],A=it*Y,ht=Bt(Y,M[I]),M[I+1]=Ot*ht,Ot=M[I]/ht,it=Y/ht,Y=it*x[I]-Ot*_,x[I+1]=A+Ot*(it*_+Ot*x[I]),B=0;B<R;B++)A=b.get(B,I+1),b.set(B,I+1,Ot*b.get(B,I)+it*A),b.set(B,I,it*b.get(B,I)-Ot*A);Y=-Ot*qt*Dt*K*M[j]/Tt,M[j]=Ot*Y,x[j]=it*Y}while(Math.abs(M[j])>Ue*ee);x[j]=x[j]+Jt,M[j]=0}for(I=0;I<R-1;I++){for(B=I,Y=x[I],F=I+1;F<R;F++)x[F]<Y&&(B=F,Y=x[F]);if(B!==I)for(x[B]=x[I],x[I]=Y,F=0;F<R;F++)Y=b.get(F,I),b.set(F,I,b.get(F,B)),b.set(F,B,Y)}}function Nc(R,M,x,b){let _=0,A=R-1,I,F,B,j,et,Y,ht;for(Y=_+1;Y<=A-1;Y++){for(ht=0,j=Y;j<=A;j++)ht=ht+Math.abs(M.get(j,Y-1));if(ht!==0){for(B=0,j=A;j>=Y;j--)x[j]=M.get(j,Y-1)/ht,B+=x[j]*x[j];for(F=Math.sqrt(B),x[Y]>0&&(F=-F),B=B-x[Y]*F,x[Y]=x[Y]-F,et=Y;et<R;et++){for(I=0,j=A;j>=Y;j--)I+=x[j]*M.get(j,et);for(I=I/B,j=Y;j<=A;j++)M.set(j,et,M.get(j,et)-I*x[j])}for(j=0;j<=A;j++){for(I=0,et=A;et>=Y;et--)I+=x[et]*M.get(j,et);for(I=I/B,et=Y;et<=A;et++)M.set(j,et,M.get(j,et)-I*x[et])}x[Y]=ht*x[Y],M.set(Y,Y-1,ht*F)}}for(j=0;j<R;j++)for(et=0;et<R;et++)b.set(j,et,j===et?1:0);for(Y=A-1;Y>=_+1;Y--)if(M.get(Y,Y-1)!==0){for(j=Y+1;j<=A;j++)x[j]=M.get(j,Y-1);for(et=Y;et<=A;et++){for(F=0,j=Y;j<=A;j++)F+=x[j]*b.get(j,et);for(F=F/x[Y]/M.get(Y,Y-1),j=Y;j<=A;j++)b.set(j,et,b.get(j,et)+F*x[j])}}}function TI(R,M,x,b,_){let A=R-1,I=0,F=R-1,B=Number.EPSILON,j=0,et=0,Y=0,ht=0,Tt=0,it=0,gt=0,Dt=0,K,Ot,qt,Jt,ee,Ue,Ht,Yt,Ae,Q,Et,Ft,St,Ye,we;for(K=0;K<R;K++)for((K<I||K>F)&&(x[K]=_.get(K,K),M[K]=0),Ot=Math.max(K-1,0);Ot<R;Ot++)et=et+Math.abs(_.get(K,Ot));for(;A>=I;){for(Jt=A;Jt>I&&(it=Math.abs(_.get(Jt-1,Jt-1))+Math.abs(_.get(Jt,Jt)),it===0&&(it=et),!(Math.abs(_.get(Jt,Jt-1))<B*it));)Jt--;if(Jt===A)_.set(A,A,_.get(A,A)+j),x[A]=_.get(A,A),M[A]=0,A--,Dt=0;else if(Jt===A-1){if(Ht=_.get(A,A-1)*_.get(A-1,A),Y=(_.get(A-1,A-1)-_.get(A,A))/2,ht=Y*Y+Ht,gt=Math.sqrt(Math.abs(ht)),_.set(A,A,_.get(A,A)+j),_.set(A-1,A-1,_.get(A-1,A-1)+j),Yt=_.get(A,A),ht>=0){for(gt=Y>=0?Y+gt:Y-gt,x[A-1]=Yt+gt,x[A]=x[A-1],gt!==0&&(x[A]=Yt-Ht/gt),M[A-1]=0,M[A]=0,Yt=_.get(A,A-1),it=Math.abs(Yt)+Math.abs(gt),Y=Yt/it,ht=gt/it,Tt=Math.sqrt(Y*Y+ht*ht),Y=Y/Tt,ht=ht/Tt,Ot=A-1;Ot<R;Ot++)gt=_.get(A-1,Ot),_.set(A-1,Ot,ht*gt+Y*_.get(A,Ot)),_.set(A,Ot,ht*_.get(A,Ot)-Y*gt);for(K=0;K<=A;K++)gt=_.get(K,A-1),_.set(K,A-1,ht*gt+Y*_.get(K,A)),_.set(K,A,ht*_.get(K,A)-Y*gt);for(K=I;K<=F;K++)gt=b.get(K,A-1),b.set(K,A-1,ht*gt+Y*b.get(K,A)),b.set(K,A,ht*b.get(K,A)-Y*gt)}else x[A-1]=Yt+Y,x[A]=Yt+Y,M[A-1]=gt,M[A]=-gt;A=A-2,Dt=0}else{if(Yt=_.get(A,A),Ae=0,Ht=0,Jt<A&&(Ae=_.get(A-1,A-1),Ht=_.get(A,A-1)*_.get(A-1,A)),Dt===10){for(j+=Yt,K=I;K<=A;K++)_.set(K,K,_.get(K,K)-Yt);it=Math.abs(_.get(A,A-1))+Math.abs(_.get(A-1,A-2)),Yt=Ae=.75*it,Ht=-.4375*it*it}if(Dt===30&&(it=(Ae-Yt)/2,it=it*it+Ht,it>0)){for(it=Math.sqrt(it),Ae<Yt&&(it=-it),it=Yt-Ht/((Ae-Yt)/2+it),K=I;K<=A;K++)_.set(K,K,_.get(K,K)-it);j+=it,Yt=Ae=Ht=.964}for(Dt=Dt+1,ee=A-2;ee>=Jt&&(gt=_.get(ee,ee),Tt=Yt-gt,it=Ae-gt,Y=(Tt*it-Ht)/_.get(ee+1,ee)+_.get(ee,ee+1),ht=_.get(ee+1,ee+1)-gt-Tt-it,Tt=_.get(ee+2,ee+1),it=Math.abs(Y)+Math.abs(ht)+Math.abs(Tt),Y=Y/it,ht=ht/it,Tt=Tt/it,!(ee===Jt||Math.abs(_.get(ee,ee-1))*(Math.abs(ht)+Math.abs(Tt))<B*(Math.abs(Y)*(Math.abs(_.get(ee-1,ee-1))+Math.abs(gt)+Math.abs(_.get(ee+1,ee+1))))));)ee--;for(K=ee+2;K<=A;K++)_.set(K,K-2,0),K>ee+2&&_.set(K,K-3,0);for(qt=ee;qt<=A-1&&(Ye=qt!==A-1,qt!==ee&&(Y=_.get(qt,qt-1),ht=_.get(qt+1,qt-1),Tt=Ye?_.get(qt+2,qt-1):0,Yt=Math.abs(Y)+Math.abs(ht)+Math.abs(Tt),Yt!==0&&(Y=Y/Yt,ht=ht/Yt,Tt=Tt/Yt)),Yt!==0);qt++)if(it=Math.sqrt(Y*Y+ht*ht+Tt*Tt),Y<0&&(it=-it),it!==0){for(qt!==ee?_.set(qt,qt-1,-it*Yt):Jt!==ee&&_.set(qt,qt-1,-_.get(qt,qt-1)),Y=Y+it,Yt=Y/it,Ae=ht/it,gt=Tt/it,ht=ht/Y,Tt=Tt/Y,Ot=qt;Ot<R;Ot++)Y=_.get(qt,Ot)+ht*_.get(qt+1,Ot),Ye&&(Y=Y+Tt*_.get(qt+2,Ot),_.set(qt+2,Ot,_.get(qt+2,Ot)-Y*gt)),_.set(qt,Ot,_.get(qt,Ot)-Y*Yt),_.set(qt+1,Ot,_.get(qt+1,Ot)-Y*Ae);for(K=0;K<=Math.min(A,qt+3);K++)Y=Yt*_.get(K,qt)+Ae*_.get(K,qt+1),Ye&&(Y=Y+gt*_.get(K,qt+2),_.set(K,qt+2,_.get(K,qt+2)-Y*Tt)),_.set(K,qt,_.get(K,qt)-Y),_.set(K,qt+1,_.get(K,qt+1)-Y*ht);for(K=I;K<=F;K++)Y=Yt*b.get(K,qt)+Ae*b.get(K,qt+1),Ye&&(Y=Y+gt*b.get(K,qt+2),b.set(K,qt+2,b.get(K,qt+2)-Y*Tt)),b.set(K,qt,b.get(K,qt)-Y),b.set(K,qt+1,b.get(K,qt+1)-Y*ht)}}}if(et!==0){for(A=R-1;A>=0;A--)if(Y=x[A],ht=M[A],ht===0)for(Jt=A,_.set(A,A,1),K=A-1;K>=0;K--){for(Ht=_.get(K,K)-Y,Tt=0,Ot=Jt;Ot<=A;Ot++)Tt=Tt+_.get(K,Ot)*_.get(Ot,A);if(M[K]<0)gt=Ht,it=Tt;else if(Jt=K,M[K]===0?_.set(K,A,Ht!==0?-Tt/Ht:-Tt/(B*et)):(Yt=_.get(K,K+1),Ae=_.get(K+1,K),ht=(x[K]-Y)*(x[K]-Y)+M[K]*M[K],Ue=(Yt*it-gt*Tt)/ht,_.set(K,A,Ue),_.set(K+1,A,Math.abs(Yt)>Math.abs(gt)?(-Tt-Ht*Ue)/Yt:(-it-Ae*Ue)/gt)),Ue=Math.abs(_.get(K,A)),B*Ue*Ue>1)for(Ot=K;Ot<=A;Ot++)_.set(Ot,A,_.get(Ot,A)/Ue)}else if(ht<0)for(Jt=A-1,Math.abs(_.get(A,A-1))>Math.abs(_.get(A-1,A))?(_.set(A-1,A-1,ht/_.get(A,A-1)),_.set(A-1,A,-(_.get(A,A)-Y)/_.get(A,A-1))):(we=Rc(0,-_.get(A-1,A),_.get(A-1,A-1)-Y,ht),_.set(A-1,A-1,we[0]),_.set(A-1,A,we[1])),_.set(A,A-1,0),_.set(A,A,1),K=A-2;K>=0;K--){for(Q=0,Et=0,Ot=Jt;Ot<=A;Ot++)Q=Q+_.get(K,Ot)*_.get(Ot,A-1),Et=Et+_.get(K,Ot)*_.get(Ot,A);if(Ht=_.get(K,K)-Y,M[K]<0)gt=Ht,Tt=Q,it=Et;else if(Jt=K,M[K]===0?(we=Rc(-Q,-Et,Ht,ht),_.set(K,A-1,we[0]),_.set(K,A,we[1])):(Yt=_.get(K,K+1),Ae=_.get(K+1,K),Ft=(x[K]-Y)*(x[K]-Y)+M[K]*M[K]-ht*ht,St=(x[K]-Y)*2*ht,Ft===0&&St===0&&(Ft=B*et*(Math.abs(Ht)+Math.abs(ht)+Math.abs(Yt)+Math.abs(Ae)+Math.abs(gt))),we=Rc(Yt*Tt-gt*Q+ht*Et,Yt*it-gt*Et-ht*Q,Ft,St),_.set(K,A-1,we[0]),_.set(K,A,we[1]),Math.abs(Yt)>Math.abs(gt)+Math.abs(ht)?(_.set(K+1,A-1,(-Q-Ht*_.get(K,A-1)+ht*_.get(K,A))/Yt),_.set(K+1,A,(-Et-Ht*_.get(K,A)-ht*_.get(K,A-1))/Yt)):(we=Rc(-Tt-Ae*_.get(K,A-1),-it-Ae*_.get(K,A),gt,ht),_.set(K+1,A-1,we[0]),_.set(K+1,A,we[1]))),Ue=Math.max(Math.abs(_.get(K,A-1)),Math.abs(_.get(K,A))),B*Ue*Ue>1)for(Ot=K;Ot<=A;Ot++)_.set(Ot,A-1,_.get(Ot,A-1)/Ue),_.set(Ot,A,_.get(Ot,A)/Ue)}for(K=0;K<R;K++)if(K<I||K>F)for(Ot=K;Ot<R;Ot++)b.set(K,Ot,_.get(K,Ot));for(Ot=R-1;Ot>=I;Ot--)for(K=I;K<=F;K++){for(gt=0,qt=I;qt<=Math.min(Ot,F);qt++)gt=gt+b.get(K,qt)*_.get(qt,Ot);b.set(K,Ot,gt)}}}function Rc(R,M,x,b){let _,A;return Math.abs(x)>Math.abs(b)?(_=b/x,A=x+_*b,[(R+_*M)/A,(M-_*R)/A]):(_=x/b,A=b+_*x,[(_*R+M)/A,(_*M-R)/A])}class Rx{constructor(M){if(M=xt.checkMatrix(M),!M.isSymmetric())throw new Error("Matrix is not symmetric");let x=M,b=x.rows,_=new V(b,b),A=!0,I,F,B;for(F=0;F<b;F++){let j=0;for(B=0;B<F;B++){let et=0;for(I=0;I<B;I++)et+=_.get(B,I)*_.get(F,I);et=(x.get(F,B)-et)/_.get(B,B),_.set(F,B,et),j=j+et*et}for(j=x.get(F,F)-j,A&&(A=j>0),_.set(F,F,Math.sqrt(Math.max(j,0))),B=F+1;B<b;B++)_.set(F,B,0)}this.L=_,this.positiveDefinite=A}isPositiveDefinite(){return this.positiveDefinite}solve(M){M=xt.checkMatrix(M);let x=this.L,b=x.rows;if(M.rows!==b)throw new Error("Matrix dimensions do not match");if(this.isPositiveDefinite()===!1)throw new Error("Matrix is not positive definite");let _=M.columns,A=M.clone(),I,F,B;for(B=0;B<b;B++)for(F=0;F<_;F++){for(I=0;I<B;I++)A.set(B,F,A.get(B,F)-A.get(I,F)*x.get(B,I));A.set(B,F,A.get(B,F)/x.get(B,B))}for(B=b-1;B>=0;B--)for(F=0;F<_;F++){for(I=B+1;I<b;I++)A.set(B,F,A.get(B,F)-A.get(I,F)*x.get(I,B));A.set(B,F,A.get(B,F)/x.get(B,B))}return A}get lowerTriangularMatrix(){return this.L}}class Lx{constructor(M,x={}){M=xt.checkMatrix(M);let{Y:b}=x;const{scaleScores:_=!1,maxIterations:A=1e3,terminationCriteria:I=1e-10}=x;let F;if(b){if(n.isAnyArray(b)&&typeof b[0]=="number"?b=V.columnVector(b):b=xt.checkMatrix(b),b.rows!==M.rows)throw new Error("Y should have the same number of rows as X");F=b.getColumnVector(0)}else F=M.getColumnVector(0);let B=1,j,et,Y,ht;for(let Tt=0;Tt<A&&B>I;Tt++)Y=M.transpose().mmul(F).div(F.transpose().mmul(F).get(0,0)),Y=Y.div(Y.norm()),j=M.mmul(Y).div(Y.transpose().mmul(Y).get(0,0)),Tt>0&&(B=j.clone().sub(ht).pow(2).sum()),ht=j.clone(),b?(et=b.transpose().mmul(j).div(j.transpose().mmul(j).get(0,0)),et=et.div(et.norm()),F=b.mmul(et).div(et.transpose().mmul(et).get(0,0))):F=j;if(b){let Tt=M.transpose().mmul(j).div(j.transpose().mmul(j).get(0,0));Tt=Tt.div(Tt.norm());let it=M.clone().sub(j.clone().mmul(Tt.transpose())),gt=F.transpose().mmul(j).div(j.transpose().mmul(j).get(0,0)),Dt=b.clone().sub(j.clone().mulS(gt.get(0,0)).mmul(et.transpose()));this.t=j,this.p=Tt.transpose(),this.w=Y.transpose(),this.q=et,this.u=F,this.s=j.transpose().mmul(j),this.xResidual=it,this.yResidual=Dt,this.betas=gt}else this.w=Y.transpose(),this.s=j.transpose().mmul(j).sqrt(),_?this.t=j.clone().div(this.s.get(0,0)):this.t=j,this.xResidual=M.sub(j.mmul(Y.transpose()))}}return fe.AbstractMatrix=ct,fe.CHO=Rx,fe.CholeskyDecomposition=Rx,fe.DistanceMatrix=dt,fe.EVD=Mr,fe.EigenvalueDecomposition=Mr,fe.LU=wt,fe.LuDecomposition=wt,fe.Matrix=V,fe.MatrixColumnSelectionView=Kt,fe.MatrixColumnView=Wt,fe.MatrixFlipColumnView=qe,fe.MatrixFlipRowView=U,fe.MatrixRowSelectionView=rt,fe.MatrixRowView=X,fe.MatrixSelectionView=lt,fe.MatrixSubView=vt,fe.MatrixTransposeView=ut,fe.NIPALS=Lx,fe.Nipals=Lx,fe.QR=_t,fe.QrDecomposition=_t,fe.SVD=$t,fe.SingularValueDecomposition=$t,fe.SymmetricMatrix=nt,fe.WrapperMatrix1D=Pt,fe.WrapperMatrix2D=xt,fe.correlation=Vn,fe.covariance=Qn,fe.default=V,fe.determinant=pe,fe.inverse=Vt,fe.linearDependencies=on,fe.pseudoInverse=gr,fe.solve=Zt,fe.wrap=At,fe}var Cf=l7();const _S=lc(Cf),La=Cf.Matrix,vL=Cf.SingularValueDecomposition;_S.Matrix?_S.Matrix:Cf.Matrix;const c7={center:[0,0],linkDistance:50};class yL{constructor(t={}){this.options=t,this.id="mds",this.options=Object.assign(Object.assign({},c7),t)}execute(t,e){return oe(this,void 0,void 0,function*(){return this.genericMDSLayout(!1,t,e)})}assign(t,e){return oe(this,void 0,void 0,function*(){yield this.genericMDSLayout(!0,t,e)})}genericMDSLayout(t,e,r){return oe(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),r),{center:a=[0,0],linkDistance:s=50}=i,o=e.getAllNodes(),l=e.getAllEdges();if(!(o!=null&&o.length)||o.length===1)return Vs(e,t,a);const c=hL({nodes:o,edges:l}),u=uL(c);u7(u);const h=tV(u,s),f=h7(h),d=[];return f.forEach((v,p)=>{const y=Br(o[p]);y.data.x=v[0]+a[0],y.data.y=v[1]+a[1],d.push(y)}),t&&d.forEach(v=>e.mergeNodeData(v.id,{x:v.data.x,y:v.data.y})),{nodes:d,edges:l}})}}const u7=n=>{let t=-999999;n.forEach(e=>{e.forEach(r=>{r!==1/0&&t<r&&(t=r)})}),n.forEach((e,r)=>{e.forEach((i,a)=>{i===1/0&&(n[r][a]=t)})})},h7=n=>{const e=La.mul(La.pow(n,2),-.5),r=e.mean("row"),i=e.mean("column"),a=e.mean();e.add(a).subRowVector(r).subColumnVector(i);const s=new vL(e),o=La.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map(l=>La.mul([l],[o]).toJSON()[0].splice(0,2))};function kb(n){return!!n.tick&&!!n.stop}const f7={gForce:!0,force2:!0,d3force:!0,fruchterman:!0,forceAtlas2:!0,force:!0,"graphin-force":!0},d7={center:[0,0],comboPadding:10,treeKey:"combo"};class g7{constructor(t={}){this.options=t,this.id="comboCombined",this.options=Object.assign(Object.assign({},d7),t)}execute(t,e){return oe(this,void 0,void 0,function*(){return this.genericComboCombinedLayout(!1,t,e)})}assign(t,e){return oe(this,void 0,void 0,function*(){yield this.genericComboCombinedLayout(!0,t,e)})}genericComboCombinedLayout(t,e,r){return oe(this,void 0,void 0,function*(){const i=this.initVals(Object.assign(Object.assign({},this.options),r)),{center:a,treeKey:s,outerLayout:o}=i,l=e.getAllNodes().filter(T=>!T.data._isCombo),c=e.getAllNodes().filter(T=>T.data._isCombo),u=e.getAllEdges(),h=l==null?void 0:l.length;if(!h||h===1)return Vs(e,t,a);const f=[],d=new Map;l.forEach(T=>{d.set(T.id,T)});const g=new Map;c.forEach(T=>{g.set(T.id,T)});const v=new Map,p=this.getInnerGraphs(e,s,d,g,u,i,v);yield Promise.all(p);const y=new Map,m=[],w=new Map;let E=!0;e.getRoots(s).forEach(T=>{const C=v.get(T.id),P=g.get(T.id)||d.get(T.id),N={id:T.id,data:Object.assign(Object.assign({},T.data),{x:C.data.x||P.data.x,y:C.data.y||P.data.y,fx:C.data.fx||P.data.fx,fy:C.data.fy||P.data.fy,mass:C.data.mass||P.data.mass,size:C.data.size})};m.push(N),y.set(T.id,!0),!isNaN(N.data.x)&&N.data.x!==0&&!isNaN(N.data.y)&&N.data.y!==0?E=!1:(N.data.x=Math.random()*100,N.data.y=Math.random()*100),_b(e,[T],L=>{L.id!==T.id&&w.set(L.id,T.id)},"TB",s)});const S=[];u.forEach(T=>{const C=w.get(T.source)||T.source,P=w.get(T.target)||T.target;C!==P&&y.has(C)&&y.has(P)&&S.push({id:T.id,source:C,target:P,data:{}})});let O;if(m!=null&&m.length){if(m.length===1)m[0].data.x=a[0],m[0].data.y=a[1];else{const T=new kn({nodes:m,edges:S}),C=o||new pL;E&&f7[C.id]&&(yield(m.length<100?new yL:new Ob).assign(T));const P=Object.assign({center:a,kg:5,preventOverlap:!0,animate:!1},C.id==="force"?{gravity:1,factor:4,linkDistance:(N,L,D)=>{const G=Math.max(...L.data.size)||32,H=Math.max(...D.data.size)||32;return G/2+H/2+200}}:{});O=yield MS(C,T,P)}v.forEach(T=>{var C;const P=O.nodes.find(D=>D.id===T.id);if(P){const{x:D,y:G}=P.data;T.data.visited=!0,T.data.x=D,T.data.y=G,f.push({id:T.id,data:{x:D,y:G}})}const{x:N,y:L}=T.data;(C=T.data.nodes)===null||C===void 0||C.forEach(D=>{f.push({id:D.id,data:{x:D.data.x+N,y:D.data.y+L}})})}),v.forEach(({data:T})=>{const{x:C,y:P,visited:N,nodes:L}=T;L==null||L.forEach(D=>{if(!N){const G=f.find(H=>H.id===D.id);G.data.x+=C||0,G.data.y+=P||0}})})}return t&&f.forEach(T=>{e.mergeNodeData(T.id,{x:T.data.x,y:T.data.y})}),{nodes:f,edges:u}})}initVals(t){const e=Object.assign({},t),{nodeSize:r,spacing:i,comboPadding:a}=t;let s,o;if(Lt(i)?o=()=>i:zt(i)?o=i:o=()=>0,e.spacing=o,!r)s=c=>{const u=o(c);return c.size?ea(c.size)?((c.size[0]>c.size[1]?c.size[0]:c.size[1])+u)/2:hn(c.size)?((c.size.width>c.size.height?c.size.width:c.size.height)+u)/2:(c.size+u)/2:32+u/2};else if(zt(r))s=c=>{const u=r(c),h=o(c);return ea(c.size)?((c.size[0]>c.size[1]?c.size[0]:c.size[1])+h)/2:((u||32)+h)/2};else if(ea(r)){const u=(r[0]>r[1]?r[0]:r[1])/2;s=h=>u+o(h)/2}else{const c=r/2;s=u=>c+o(u)/2}e.nodeSize=s;let l;return Lt(a)?l=()=>a:ea(a)?l=()=>Math.max.apply(null,a):zt(a)?l=a:l=()=>0,e.comboPadding=l,e}getInnerGraphs(t,e,r,i,a,s,o){const{nodeSize:l,comboPadding:c,spacing:u,innerLayout:h}=s,f=h||new Ob({}),d={center:[0,0],preventOverlap:!0,nodeSpacing:u},g=[],v=p=>{let y=(c==null?void 0:c(p))||10;return ea(y)&&(y=Math.max(...y)),{size:y?[y*2,y*2]:[30,30],padding:y}};return t.getRoots(e).forEach(p=>{o.set(p.id,{id:p.id,data:{nodes:[],size:v(p).size}});let y=Promise.resolve();_b(t,[p],m=>{var w;if(!m.data._isCombo)return;const{size:E,padding:S}=v(m);if(!(!((w=t.getChildren(m.id,e))===null||w===void 0)&&w.length))o.set(m.id,{id:m.id,data:Object.assign(Object.assign({},m.data),{size:E})});else{const O=o.get(m.id);o.set(m.id,{id:m.id,data:Object.assign({nodes:[]},O==null?void 0:O.data)});const k=new Map,T=t.getChildren(m.id,e).map(N=>{if(N.data._isCombo)return o.has(N.id)||o.set(N.id,{id:N.id,data:Object.assign({},N.data)}),k.set(N.id,!0),o.get(N.id);const L=r.get(N.id)||i.get(N.id);return k.set(N.id,!0),{id:N.id,data:Object.assign(Object.assign({},L.data),N.data)}}),C={nodes:T,edges:a.filter(N=>k.has(N.source)&&k.has(N.target))};let P=1/0;T.forEach(N=>{var L;let{size:D}=N.data;D||(D=((L=o.get(N.id))===null||L===void 0?void 0:L.data.size)||(l==null?void 0:l(N))||[30,30]),Lt(D)&&(D=[D,D]);const[G,H]=D;P>G&&(P=G),P>H&&(P=H),N.data.size=D}),y=y.then(()=>oe(this,void 0,void 0,function*(){const N=new kn(C);yield MS(f,N,d,!0);const{minX:L,minY:D,maxX:G,maxY:H}=eV(T),W={x:(G+L)/2,y:(H+D)/2};C.nodes.forEach(z=>{z.data.x-=W.x,z.data.y-=W.y});const q=[Math.max(G-L,P)+S*2,Math.max(H-D,P)+S*2];o.get(m.id).data.size=q,o.get(m.id).data.nodes=T}))}return!0},"BT",e),g.push(y)}),g}}function MS(n,t,e,r){var i;return oe(this,void 0,void 0,function*(){return kb(n)?(n.execute(t,e),n.stop(),n.tick((i=e.iterations)!==null&&i!==void 0?i:300)):r?yield n.assign(t,e):yield n.execute(t,e)})}function p7(n,t){var e,r=1;n==null&&(n=0),t==null&&(t=0);function i(){var a,s=e.length,o,l=0,c=0;for(a=0;a<s;++a)o=e[a],l+=o.x,c+=o.y;for(l=(l/s-n)*r,c=(c/s-t)*r,a=0;a<s;++a)o=e[a],o.x-=l,o.y-=c}return i.initialize=function(a){e=a},i.x=function(a){return arguments.length?(n=+a,i):n},i.y=function(a){return arguments.length?(t=+a,i):t},i.strength=function(a){return arguments.length?(r=+a,i):r},i}function On(n){return function(){return n}}function Ia(n){return(n()-.5)*1e-6}function v7(n){return n.x+n.vx}function y7(n){return n.y+n.vy}function m7(n){var t,e,r,i=1,a=1;typeof n!="function"&&(n=On(n==null?1:+n));function s(){for(var c,u=t.length,h,f,d,g,v,p,y=0;y<a;++y)for(h=Af(t,v7,y7).visitAfter(o),c=0;c<u;++c)f=t[c],v=e[f.index],p=v*v,d=f.x+f.vx,g=f.y+f.vy,h.visit(m);function m(w,E,S,O,k){var T=w.data,C=w.r,P=v+C;if(T){if(T.index>f.index){var N=d-T.x-T.vx,L=g-T.y-T.vy,D=N*N+L*L;D<P*P&&(N===0&&(N=Ia(r),D+=N*N),L===0&&(L=Ia(r),D+=L*L),D=(P-(D=Math.sqrt(D)))/D*i,f.vx+=(N*=D)*(P=(C*=C)/(p+C)),f.vy+=(L*=D)*P,T.vx-=N*(P=1-P),T.vy-=L*P)}return}return E>d+P||O<d-P||S>g+P||k<g-P}}function o(c){if(c.data)return c.r=e[c.data.index];for(var u=c.r=0;u<4;++u)c[u]&&c[u].r>c.r&&(c.r=c[u].r)}function l(){if(t){var c,u=t.length,h;for(e=new Array(u),c=0;c<u;++c)h=t[c],e[h.index]=+n(h,c,t)}}return s.initialize=function(c,u){t=c,r=u,l()},s.iterations=function(c){return arguments.length?(a=+c,s):a},s.strength=function(c){return arguments.length?(i=+c,s):i},s.radius=function(c){return arguments.length?(n=typeof c=="function"?c:On(+c),l(),s):n},s}function b7(n){return n.index}function OS(n,t){var e=n.get(t);if(!e)throw new Error("node not found: "+t);return e}function w7(n){var t=b7,e=h,r,i=On(30),a,s,o,l,c,u=1;n==null&&(n=[]);function h(p){return 1/Math.min(o[p.source.index],o[p.target.index])}function f(p){for(var y=0,m=n.length;y<u;++y)for(var w=0,E,S,O,k,T,C,P;w<m;++w)E=n[w],S=E.source,O=E.target,k=O.x+O.vx-S.x-S.vx||Ia(c),T=O.y+O.vy-S.y-S.vy||Ia(c),C=Math.sqrt(k*k+T*T),C=(C-a[w])/C*p*r[w],k*=C,T*=C,O.vx-=k*(P=l[w]),O.vy-=T*P,S.vx+=k*(P=1-P),S.vy+=T*P}function d(){if(s){var p,y=s.length,m=n.length,w=new Map(s.map((S,O)=>[t(S,O,s),S])),E;for(p=0,o=new Array(y);p<m;++p)E=n[p],E.index=p,typeof E.source!="object"&&(E.source=OS(w,E.source)),typeof E.target!="object"&&(E.target=OS(w,E.target)),o[E.source.index]=(o[E.source.index]||0)+1,o[E.target.index]=(o[E.target.index]||0)+1;for(p=0,l=new Array(m);p<m;++p)E=n[p],l[p]=o[E.source.index]/(o[E.source.index]+o[E.target.index]);r=new Array(m),g(),a=new Array(m),v()}}function g(){if(s)for(var p=0,y=n.length;p<y;++p)r[p]=+e(n[p],p,n)}function v(){if(s)for(var p=0,y=n.length;p<y;++p)a[p]=+i(n[p],p,n)}return f.initialize=function(p,y){s=p,c=y,d()},f.links=function(p){return arguments.length?(n=p,d(),f):n},f.id=function(p){return arguments.length?(t=p,f):t},f.iterations=function(p){return arguments.length?(u=+p,f):u},f.strength=function(p){return arguments.length?(e=typeof p=="function"?p:On(+p),g(),f):e},f.distance=function(p){return arguments.length?(i=typeof p=="function"?p:On(+p),v(),f):i},f}var x7={value:()=>{}};function mL(){for(var n=0,t=arguments.length,e={},r;n<t;++n){if(!(r=arguments[n]+"")||r in e||/[\s.]/.test(r))throw new Error("illegal type: "+r);e[r]=[]}return new Uu(e)}function Uu(n){this._=n}function E7(n,t){return n.trim().split(/^|\s+/).map(function(e){var r="",i=e.indexOf(".");if(i>=0&&(r=e.slice(i+1),e=e.slice(0,i)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:r}})}Uu.prototype=mL.prototype={constructor:Uu,on:function(n,t){var e=this._,r=E7(n+"",e),i,a=-1,s=r.length;if(arguments.length<2){for(;++a<s;)if((i=(n=r[a]).type)&&(i=S7(e[i],n.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++a<s;)if(i=(n=r[a]).type)e[i]=TS(e[i],n.name,t);else if(t==null)for(i in e)e[i]=TS(e[i],n.name,null);return this},copy:function(){var n={},t=this._;for(var e in t)n[e]=t[e].slice();return new Uu(n)},call:function(n,t){if((i=arguments.length-2)>0)for(var e=new Array(i),r=0,i,a;r<i;++r)e[r]=arguments[r+2];if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(a=this._[n],r=0,i=a.length;r<i;++r)a[r].value.apply(t,e)},apply:function(n,t,e){if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(var r=this._[n],i=0,a=r.length;i<a;++i)r[i].value.apply(t,e)}};function S7(n,t){for(var e=0,r=n.length,i;e<r;++e)if((i=n[e]).name===t)return i.value}function TS(n,t,e){for(var r=0,i=n.length;r<i;++r)if(n[r].name===t){n[r]=x7,n=n.slice(0,r).concat(n.slice(r+1));break}return e!=null&&n.push({name:t,value:e}),n}var Ro=0,dl=0,rl=0,bL=1e3,Nh,gl,Rh=0,zs=0,Pf=0,ec=typeof performance=="object"&&performance.now?performance:Date,wL=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(n){setTimeout(n,17)};function xL(){return zs||(wL(_7),zs=ec.now()+Pf)}function _7(){zs=0}function Ab(){this._call=this._time=this._next=null}Ab.prototype=EL.prototype={constructor:Ab,restart:function(n,t,e){if(typeof n!="function")throw new TypeError("callback is not a function");e=(e==null?xL():+e)+(t==null?0:+t),!this._next&&gl!==this&&(gl?gl._next=this:Nh=this,gl=this),this._call=n,this._time=e,Cb()},stop:function(){this._call&&(this._call=null,this._time=1/0,Cb())}};function EL(n,t,e){var r=new Ab;return r.restart(n,t,e),r}function M7(){xL(),++Ro;for(var n=Nh,t;n;)(t=zs-n._time)>=0&&n._call.call(void 0,t),n=n._next;--Ro}function kS(){zs=(Rh=ec.now())+Pf,Ro=dl=0;try{M7()}finally{Ro=0,T7(),zs=0}}function O7(){var n=ec.now(),t=n-Rh;t>bL&&(Pf-=t,Rh=n)}function T7(){for(var n,t=Nh,e,r=1/0;t;)t._call?(r>t._time&&(r=t._time),n=t,t=t._next):(e=t._next,t._next=null,t=n?n._next=e:Nh=e);gl=n,Cb(r)}function Cb(n){if(!Ro){dl&&(dl=clearTimeout(dl));var t=n-zs;t>24?(n<1/0&&(dl=setTimeout(kS,n-ec.now()-Pf)),rl&&(rl=clearInterval(rl))):(rl||(Rh=ec.now(),rl=setInterval(O7,bL)),Ro=1,wL(kS))}}const k7=1664525,A7=1013904223,AS=4294967296;function C7(){let n=1;return()=>(n=(k7*n+A7)%AS)/AS}function P7(n){return n.x}function N7(n){return n.y}var R7=10,L7=Math.PI*(3-Math.sqrt(5));function I7(n){var t,e=1,r=.001,i=1-Math.pow(r,1/300),a=0,s=.6,o=new Map,l=EL(h),c=mL("tick","end"),u=C7();n==null&&(n=[]);function h(){f(),c.call("tick",t),e<r&&(l.stop(),c.call("end",t))}function f(v){var p,y=n.length,m;v===void 0&&(v=1);for(var w=0;w<v;++w)for(e+=(a-e)*i,o.forEach(function(E){E(e)}),p=0;p<y;++p)m=n[p],m.fx==null?m.x+=m.vx*=s:(m.x=m.fx,m.vx=0),m.fy==null?m.y+=m.vy*=s:(m.y=m.fy,m.vy=0);return t}function d(){for(var v=0,p=n.length,y;v<p;++v){if(y=n[v],y.index=v,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var m=R7*Math.sqrt(.5+v),w=v*L7;y.x=m*Math.cos(w),y.y=m*Math.sin(w)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function g(v){return v.initialize&&v.initialize(n,u),v}return d(),t={tick:f,restart:function(){return l.restart(h),t},stop:function(){return l.stop(),t},nodes:function(v){return arguments.length?(n=v,d(),o.forEach(g),t):n},alpha:function(v){return arguments.length?(e=+v,t):e},alphaMin:function(v){return arguments.length?(r=+v,t):r},alphaDecay:function(v){return arguments.length?(i=+v,t):+i},alphaTarget:function(v){return arguments.length?(a=+v,t):a},velocityDecay:function(v){return arguments.length?(s=1-v,t):1-s},randomSource:function(v){return arguments.length?(u=v,o.forEach(g),t):u},force:function(v,p){return arguments.length>1?(p==null?o.delete(v):o.set(v,g(p)),t):o.get(v)},find:function(v,p,y){var m=0,w=n.length,E,S,O,k,T;for(y==null?y=1/0:y*=y,m=0;m<w;++m)k=n[m],E=v-k.x,S=p-k.y,O=E*E+S*S,O<y&&(T=k,y=O);return T},on:function(v,p){return arguments.length>1?(c.on(v,p),t):c.on(v)}}}function D7(){var n,t,e,r,i=On(-30),a,s=1,o=1/0,l=.81;function c(d){var g,v=n.length,p=Af(n,P7,N7).visitAfter(h);for(r=d,g=0;g<v;++g)t=n[g],p.visit(f)}function u(){if(n){var d,g=n.length,v;for(a=new Array(g),d=0;d<g;++d)v=n[d],a[v.index]=+i(v,d,n)}}function h(d){var g=0,v,p,y=0,m,w,E;if(d.length){for(m=w=E=0;E<4;++E)(v=d[E])&&(p=Math.abs(v.value))&&(g+=v.value,y+=p,m+=p*v.x,w+=p*v.y);d.x=m/y,d.y=w/y}else{v=d,v.x=v.data.x,v.y=v.data.y;do g+=a[v.data.index];while(v=v.next)}d.value=g}function f(d,g,v,p){if(!d.value)return!0;var y=d.x-t.x,m=d.y-t.y,w=p-g,E=y*y+m*m;if(w*w/l<E)return E<o&&(y===0&&(y=Ia(e),E+=y*y),m===0&&(m=Ia(e),E+=m*m),E<s&&(E=Math.sqrt(s*E)),t.vx+=y*d.value*r/E,t.vy+=m*d.value*r/E),!0;if(d.length||E>=o)return;(d.data!==t||d.next)&&(y===0&&(y=Ia(e),E+=y*y),m===0&&(m=Ia(e),E+=m*m),E<s&&(E=Math.sqrt(s*E)));do d.data!==t&&(w=a[d.data.index]*r/E,t.vx+=y*w,t.vy+=m*w);while(d=d.next)}return c.initialize=function(d,g){n=d,e=g,u()},c.strength=function(d){return arguments.length?(i=typeof d=="function"?d:On(+d),u(),c):i},c.distanceMin=function(d){return arguments.length?(s=d*d,c):Math.sqrt(s)},c.distanceMax=function(d){return arguments.length?(o=d*d,c):Math.sqrt(o)},c.theta=function(d){return arguments.length?(l=d*d,c):Math.sqrt(l)},c}function F7(n,t,e){var r,i=On(.1),a,s;typeof n!="function"&&(n=On(+n)),t==null&&(t=0),e==null&&(e=0);function o(c){for(var u=0,h=r.length;u<h;++u){var f=r[u],d=f.x-t||1e-6,g=f.y-e||1e-6,v=Math.sqrt(d*d+g*g),p=(s[u]-v)*a[u]*c/v;f.vx+=d*p,f.vy+=g*p}}function l(){if(r){var c,u=r.length;for(a=new Array(u),s=new Array(u),c=0;c<u;++c)s[c]=+n(r[c],c,r),a[c]=isNaN(s[c])?0:+i(r[c],c,r)}}return o.initialize=function(c){r=c,l()},o.strength=function(c){return arguments.length?(i=typeof c=="function"?c:On(+c),l(),o):i},o.radius=function(c){return arguments.length?(n=typeof c=="function"?c:On(+c),l(),o):n},o.x=function(c){return arguments.length?(t=+c,o):t},o.y=function(c){return arguments.length?(e=+c,o):e},o}function B7(n){var t=On(.1),e,r,i;typeof n!="function"&&(n=On(n==null?0:+n));function a(o){for(var l=0,c=e.length,u;l<c;++l)u=e[l],u.vx+=(i[l]-u.x)*r[l]*o}function s(){if(e){var o,l=e.length;for(r=new Array(l),i=new Array(l),o=0;o<l;++o)r[o]=isNaN(i[o]=+n(e[o],o,e))?0:+t(e[o],o,e)}}return a.initialize=function(o){e=o,s()},a.strength=function(o){return arguments.length?(t=typeof o=="function"?o:On(+o),s(),a):t},a.x=function(o){return arguments.length?(n=typeof o=="function"?o:On(+o),s(),a):n},a}function z7(n){var t=On(.1),e,r,i;typeof n!="function"&&(n=On(n==null?0:+n));function a(o){for(var l=0,c=e.length,u;l<c;++l)u=e[l],u.vy+=(i[l]-u.y)*r[l]*o}function s(){if(e){var o,l=e.length;for(r=new Array(l),i=new Array(l),o=0;o<l;++o)r[o]=isNaN(i[o]=+n(e[o],o,e))?0:+t(e[o],o,e)}}return a.initialize=function(o){e=o,s()},a.strength=function(o){return arguments.length?(t=typeof o=="function"?o:On(+o),s(),a):t},a.y=function(o){return arguments.length?(n=typeof o=="function"?o:On(+o),s(),a):n},a}class j7{constructor(t){this.id="d3-force",this.config={inputNodeAttrs:["x","y","vx","vy","fx","fy"],outputNodeAttrs:["x","y","vx","vy"],simulationAttrs:["alpha","alphaMin","alphaDecay","alphaTarget","velocityDecay","randomSource"]},this.forceMap={link:w7,manyBody:D7,center:p7,collide:m7,radial:F7,x:B7,y:z7},this.options={link:{id:e=>e.id},manyBody:{},center:{x:0,y:0}},this.context={options:{},assign:!1,nodes:[],edges:[]},fr(this.options,t),this.options.forceSimulation&&(this.simulation=this.options.forceSimulation)}execute(t,e){return oe(this,void 0,void 0,function*(){return this.genericLayout(!1,t,e)})}assign(t,e){return oe(this,void 0,void 0,function*(){yield this.genericLayout(!0,t,e)})}stop(){this.simulation.stop()}tick(t){return this.simulation.tick(t),this.getResult()}restart(){this.simulation.restart()}setFixedPosition(t,e){const r=this.context.nodes.find(i=>i.id===t);r&&e.forEach((i,a)=>{if(typeof i=="number"||i===null){const s=["fx","fy","fz"][a];r[s]=i}})}getOptions(t){var e,r;const i=fr({},this.options,t);return i.collide&&((e=i.collide)===null||e===void 0?void 0:e.radius)===void 0&&(i.collide=i.collide||{},i.collide.radius=(r=i.nodeSize)!==null&&r!==void 0?r:10),i.iterations===void 0&&(i.link&&i.link.iterations===void 0&&(i.iterations=i.link.iterations),i.collide&&i.collide.iterations===void 0&&(i.iterations=i.collide.iterations)),this.context.options=i,i}genericLayout(t,e,r){var i;return oe(this,void 0,void 0,function*(){const a=this.getOptions(r),s=e.getAllNodes().map(({id:u,data:h})=>Object.assign(Object.assign({id:u},h),Ns(h.data,this.config.inputNodeAttrs))),o=e.getAllEdges().map(u=>Object.assign({},u));Object.assign(this.context,{assign:t,nodes:s,edges:o,graph:e});const l=new Promise(u=>{this.resolver=u}),c=this.setSimulation(a);return c.nodes(s),(i=c.force("link"))===null||i===void 0||i.links(o),l})}getResult(){const{assign:t,nodes:e,edges:r,graph:i}=this.context,a=e.map(o=>({id:o.id,data:Object.assign(Object.assign({},o.data),Ns(o,this.config.outputNodeAttrs))})),s=r.map(({id:o,source:l,target:c,data:u})=>({id:o,source:typeof l=="object"?l.id:l,target:typeof c=="object"?c.id:c,data:u}));return t&&a.forEach(o=>i.mergeNodeData(o.id,o.data)),{nodes:a,edges:s}}initSimulation(){return I7()}setSimulation(t){const e=this.simulation||this.options.forceSimulation||this.initSimulation();return this.simulation||(this.simulation=e.on("tick",()=>{var r;return(r=t.onTick)===null||r===void 0?void 0:r.call(t,this.getResult())}).on("end",()=>{var r;return(r=this.resolver)===null||r===void 0?void 0:r.call(this,this.getResult())})),CS(e,this.config.simulationAttrs.map(r=>[r,t[r]])),Object.entries(this.forceMap).forEach(([r,i])=>{const a=r;if(t[r]){let s=e.force(a);s||(s=i(),e.force(a,s)),CS(s,Object.entries(t[a]))}else e.force(a,null)}),e}}const CS=(n,t)=>t.reduce((e,[r,i])=>!e[r]||i===void 0?e:e[r].call(n,i),n);function Zw(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var jg,PS;function q7(){if(PS)return jg;PS=1;function n(){this.__data__=[],this.size=0}return jg=n,jg}var qg,NS;function jo(){if(NS)return qg;NS=1;function n(t,e){return t===e||t!==t&&e!==e}return qg=n,qg}var $g,RS;function Nf(){if(RS)return $g;RS=1;var n=jo();function t(e,r){for(var i=e.length;i--;)if(n(e[i][0],r))return i;return-1}return $g=t,$g}var Gg,LS;function $7(){if(LS)return Gg;LS=1;var n=Nf(),t=Array.prototype,e=t.splice;function r(i){var a=this.__data__,s=n(a,i);if(s<0)return!1;var o=a.length-1;return s==o?a.pop():e.call(a,s,1),--this.size,!0}return Gg=r,Gg}var Wg,IS;function G7(){if(IS)return Wg;IS=1;var n=Nf();function t(e){var r=this.__data__,i=n(r,e);return i<0?void 0:r[i][1]}return Wg=t,Wg}var Vg,DS;function W7(){if(DS)return Vg;DS=1;var n=Nf();function t(e){return n(this.__data__,e)>-1}return Vg=t,Vg}var Hg,FS;function V7(){if(FS)return Hg;FS=1;var n=Nf();function t(e,r){var i=this.__data__,a=n(i,e);return a<0?(++this.size,i.push([e,r])):i[a][1]=r,this}return Hg=t,Hg}var Ug,BS;function Rf(){if(BS)return Ug;BS=1;var n=q7(),t=$7(),e=G7(),r=W7(),i=V7();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var c=s[o];this.set(c[0],c[1])}}return a.prototype.clear=n,a.prototype.delete=t,a.prototype.get=e,a.prototype.has=r,a.prototype.set=i,Ug=a,Ug}var Yg,zS;function H7(){if(zS)return Yg;zS=1;var n=Rf();function t(){this.__data__=new n,this.size=0}return Yg=t,Yg}var Xg,jS;function U7(){if(jS)return Xg;jS=1;function n(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}return Xg=n,Xg}var Kg,qS;function Y7(){if(qS)return Kg;qS=1;function n(t){return this.__data__.get(t)}return Kg=n,Kg}var Zg,$S;function X7(){if($S)return Zg;$S=1;function n(t){return this.__data__.has(t)}return Zg=n,Zg}var Jg,GS;function SL(){if(GS)return Jg;GS=1;var n=typeof jc=="object"&&jc&&jc.Object===Object&&jc;return Jg=n,Jg}var Qg,WS;function vi(){if(WS)return Qg;WS=1;var n=SL(),t=typeof self=="object"&&self&&self.Object===Object&&self,e=n||t||Function("return this")();return Qg=e,Qg}var tp,VS;function qo(){if(VS)return tp;VS=1;var n=vi(),t=n.Symbol;return tp=t,tp}var ep,HS;function K7(){if(HS)return ep;HS=1;var n=qo(),t=Object.prototype,e=t.hasOwnProperty,r=t.toString,i=n?n.toStringTag:void 0;function a(s){var o=e.call(s,i),l=s[i];try{s[i]=void 0;var c=!0}catch{}var u=r.call(s);return c&&(o?s[i]=l:delete s[i]),u}return ep=a,ep}var np,US;function Z7(){if(US)return np;US=1;var n=Object.prototype,t=n.toString;function e(r){return t.call(r)}return np=e,np}var rp,YS;function Hs(){if(YS)return rp;YS=1;var n=qo(),t=K7(),e=Z7(),r="[object Null]",i="[object Undefined]",a=n?n.toStringTag:void 0;function s(o){return o==null?o===void 0?i:r:a&&a in Object(o)?t(o):e(o)}return rp=s,rp}var ip,XS;function ti(){if(XS)return ip;XS=1;function n(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}return ip=n,ip}var ap,KS;function Mc(){if(KS)return ap;KS=1;var n=Hs(),t=ti(),e="[object AsyncFunction]",r="[object Function]",i="[object GeneratorFunction]",a="[object Proxy]";function s(o){if(!t(o))return!1;var l=n(o);return l==r||l==i||l==e||l==a}return ap=s,ap}var sp,ZS;function J7(){if(ZS)return sp;ZS=1;var n=vi(),t=n["__core-js_shared__"];return sp=t,sp}var op,JS;function Q7(){if(JS)return op;JS=1;var n=J7(),t=function(){var r=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function e(r){return!!t&&t in r}return op=e,op}var lp,QS;function _L(){if(QS)return lp;QS=1;var n=Function.prototype,t=n.toString;function e(r){if(r!=null){try{return t.call(r)}catch{}try{return r+""}catch{}}return""}return lp=e,lp}var cp,t_;function tH(){if(t_)return cp;t_=1;var n=Mc(),t=Q7(),e=ti(),r=_L(),i=/[\\^$.*+?()[\]{}|]/g,a=/^\[object .+?Constructor\]$/,s=Function.prototype,o=Object.prototype,l=s.toString,c=o.hasOwnProperty,u=RegExp("^"+l.call(c).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function h(f){if(!e(f)||t(f))return!1;var d=n(f)?u:a;return d.test(r(f))}return cp=h,cp}var up,e_;function eH(){if(e_)return up;e_=1;function n(t,e){return t==null?void 0:t[e]}return up=n,up}var hp,n_;function Us(){if(n_)return hp;n_=1;var n=tH(),t=eH();function e(r,i){var a=t(r,i);return n(a)?a:void 0}return hp=e,hp}var fp,r_;function Jw(){if(r_)return fp;r_=1;var n=Us(),t=vi(),e=n(t,"Map");return fp=e,fp}var dp,i_;function Lf(){if(i_)return dp;i_=1;var n=Us(),t=n(Object,"create");return dp=t,dp}var gp,a_;function nH(){if(a_)return gp;a_=1;var n=Lf();function t(){this.__data__=n?n(null):{},this.size=0}return gp=t,gp}var pp,s_;function rH(){if(s_)return pp;s_=1;function n(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}return pp=n,pp}var vp,o_;function iH(){if(o_)return vp;o_=1;var n=Lf(),t="__lodash_hash_undefined__",e=Object.prototype,r=e.hasOwnProperty;function i(a){var s=this.__data__;if(n){var o=s[a];return o===t?void 0:o}return r.call(s,a)?s[a]:void 0}return vp=i,vp}var yp,l_;function aH(){if(l_)return yp;l_=1;var n=Lf(),t=Object.prototype,e=t.hasOwnProperty;function r(i){var a=this.__data__;return n?a[i]!==void 0:e.call(a,i)}return yp=r,yp}var mp,c_;function sH(){if(c_)return mp;c_=1;var n=Lf(),t="__lodash_hash_undefined__";function e(r,i){var a=this.__data__;return this.size+=this.has(r)?0:1,a[r]=n&&i===void 0?t:i,this}return mp=e,mp}var bp,u_;function oH(){if(u_)return bp;u_=1;var n=nH(),t=rH(),e=iH(),r=aH(),i=sH();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var c=s[o];this.set(c[0],c[1])}}return a.prototype.clear=n,a.prototype.delete=t,a.prototype.get=e,a.prototype.has=r,a.prototype.set=i,bp=a,bp}var wp,h_;function lH(){if(h_)return wp;h_=1;var n=oH(),t=Rf(),e=Jw();function r(){this.size=0,this.__data__={hash:new n,map:new(e||t),string:new n}}return wp=r,wp}var xp,f_;function cH(){if(f_)return xp;f_=1;function n(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}return xp=n,xp}var Ep,d_;function If(){if(d_)return Ep;d_=1;var n=cH();function t(e,r){var i=e.__data__;return n(r)?i[typeof r=="string"?"string":"hash"]:i.map}return Ep=t,Ep}var Sp,g_;function uH(){if(g_)return Sp;g_=1;var n=If();function t(e){var r=n(this,e).delete(e);return this.size-=r?1:0,r}return Sp=t,Sp}var _p,p_;function hH(){if(p_)return _p;p_=1;var n=If();function t(e){return n(this,e).get(e)}return _p=t,_p}var Mp,v_;function fH(){if(v_)return Mp;v_=1;var n=If();function t(e){return n(this,e).has(e)}return Mp=t,Mp}var Op,y_;function dH(){if(y_)return Op;y_=1;var n=If();function t(e,r){var i=n(this,e),a=i.size;return i.set(e,r),this.size+=i.size==a?0:1,this}return Op=t,Op}var Tp,m_;function Qw(){if(m_)return Tp;m_=1;var n=lH(),t=uH(),e=hH(),r=fH(),i=dH();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var c=s[o];this.set(c[0],c[1])}}return a.prototype.clear=n,a.prototype.delete=t,a.prototype.get=e,a.prototype.has=r,a.prototype.set=i,Tp=a,Tp}var kp,b_;function gH(){if(b_)return kp;b_=1;var n=Rf(),t=Jw(),e=Qw(),r=200;function i(a,s){var o=this.__data__;if(o instanceof n){var l=o.__data__;if(!t||l.length<r-1)return l.push([a,s]),this.size=++o.size,this;o=this.__data__=new e(l)}return o.set(a,s),this.size=o.size,this}return kp=i,kp}var Ap,w_;function Df(){if(w_)return Ap;w_=1;var n=Rf(),t=H7(),e=U7(),r=Y7(),i=X7(),a=gH();function s(o){var l=this.__data__=new n(o);this.size=l.size}return s.prototype.clear=t,s.prototype.delete=e,s.prototype.get=r,s.prototype.has=i,s.prototype.set=a,Ap=s,Ap}var Cp,x_;function tx(){if(x_)return Cp;x_=1;function n(t,e){for(var r=-1,i=t==null?0:t.length;++r<i&&e(t[r],r,t)!==!1;);return t}return Cp=n,Cp}var Pp,E_;function ML(){if(E_)return Pp;E_=1;var n=Us(),t=function(){try{var e=n(Object,"defineProperty");return e({},"",{}),e}catch{}}();return Pp=t,Pp}var Np,S_;function Ff(){if(S_)return Np;S_=1;var n=ML();function t(e,r,i){r=="__proto__"&&n?n(e,r,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[r]=i}return Np=t,Np}var Rp,__;function Bf(){if(__)return Rp;__=1;var n=Ff(),t=jo(),e=Object.prototype,r=e.hasOwnProperty;function i(a,s,o){var l=a[s];(!(r.call(a,s)&&t(l,o))||o===void 0&&!(s in a))&&n(a,s,o)}return Rp=i,Rp}var Lp,M_;function Oc(){if(M_)return Lp;M_=1;var n=Bf(),t=Ff();function e(r,i,a,s){var o=!a;a||(a={});for(var l=-1,c=i.length;++l<c;){var u=i[l],h=s?s(a[u],r[u],u,a,r):void 0;h===void 0&&(h=r[u]),o?t(a,u,h):n(a,u,h)}return a}return Lp=e,Lp}var Ip,O_;function pH(){if(O_)return Ip;O_=1;function n(t,e){for(var r=-1,i=Array(t);++r<t;)i[r]=e(r);return i}return Ip=n,Ip}var Dp,T_;function Wi(){if(T_)return Dp;T_=1;function n(t){return t!=null&&typeof t=="object"}return Dp=n,Dp}var Fp,k_;function vH(){if(k_)return Fp;k_=1;var n=Hs(),t=Wi(),e="[object Arguments]";function r(i){return t(i)&&n(i)==e}return Fp=r,Fp}var Bp,A_;function Tc(){if(A_)return Bp;A_=1;var n=vH(),t=Wi(),e=Object.prototype,r=e.hasOwnProperty,i=e.propertyIsEnumerable,a=n(function(){return arguments}())?n:function(s){return t(s)&&r.call(s,"callee")&&!i.call(s,"callee")};return Bp=a,Bp}var zp,C_;function xn(){if(C_)return zp;C_=1;var n=Array.isArray;return zp=n,zp}var pl={exports:{}},jp,P_;function yH(){if(P_)return jp;P_=1;function n(){return!1}return jp=n,jp}pl.exports;var N_;function $o(){return N_||(N_=1,function(n,t){var e=vi(),r=yH(),i=t&&!t.nodeType&&t,a=i&&!0&&n&&!n.nodeType&&n,s=a&&a.exports===i,o=s?e.Buffer:void 0,l=o?o.isBuffer:void 0,c=l||r;n.exports=c}(pl,pl.exports)),pl.exports}var qp,R_;function zf(){if(R_)return qp;R_=1;var n=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function e(r,i){var a=typeof r;return i=i??n,!!i&&(a=="number"||a!="symbol"&&t.test(r))&&r>-1&&r%1==0&&r<i}return qp=e,qp}var $p,L_;function ex(){if(L_)return $p;L_=1;var n=9007199254740991;function t(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=n}return $p=t,$p}var Gp,I_;function mH(){if(I_)return Gp;I_=1;var n=Hs(),t=ex(),e=Wi(),r="[object Arguments]",i="[object Array]",a="[object Boolean]",s="[object Date]",o="[object Error]",l="[object Function]",c="[object Map]",u="[object Number]",h="[object Object]",f="[object RegExp]",d="[object Set]",g="[object String]",v="[object WeakMap]",p="[object ArrayBuffer]",y="[object DataView]",m="[object Float32Array]",w="[object Float64Array]",E="[object Int8Array]",S="[object Int16Array]",O="[object Int32Array]",k="[object Uint8Array]",T="[object Uint8ClampedArray]",C="[object Uint16Array]",P="[object Uint32Array]",N={};N[m]=N[w]=N[E]=N[S]=N[O]=N[k]=N[T]=N[C]=N[P]=!0,N[r]=N[i]=N[p]=N[a]=N[y]=N[s]=N[o]=N[l]=N[c]=N[u]=N[h]=N[f]=N[d]=N[g]=N[v]=!1;function L(D){return e(D)&&t(D.length)&&!!N[n(D)]}return Gp=L,Gp}var Wp,D_;function jf(){if(D_)return Wp;D_=1;function n(t){return function(e){return t(e)}}return Wp=n,Wp}var vl={exports:{}};vl.exports;var F_;function nx(){return F_||(F_=1,function(n,t){var e=SL(),r=t&&!t.nodeType&&t,i=r&&!0&&n&&!n.nodeType&&n,a=i&&i.exports===r,s=a&&e.process,o=function(){try{var l=i&&i.require&&i.require("util").types;return l||s&&s.binding&&s.binding("util")}catch{}}();n.exports=o}(vl,vl.exports)),vl.exports}var Vp,B_;function kc(){if(B_)return Vp;B_=1;var n=mH(),t=jf(),e=nx(),r=e&&e.isTypedArray,i=r?t(r):n;return Vp=i,Vp}var Hp,z_;function OL(){if(z_)return Hp;z_=1;var n=pH(),t=Tc(),e=xn(),r=$o(),i=zf(),a=kc(),s=Object.prototype,o=s.hasOwnProperty;function l(c,u){var h=e(c),f=!h&&t(c),d=!h&&!f&&r(c),g=!h&&!f&&!d&&a(c),v=h||f||d||g,p=v?n(c.length,String):[],y=p.length;for(var m in c)(u||o.call(c,m))&&!(v&&(m=="length"||d&&(m=="offset"||m=="parent")||g&&(m=="buffer"||m=="byteLength"||m=="byteOffset")||i(m,y)))&&p.push(m);return p}return Hp=l,Hp}var Up,j_;function qf(){if(j_)return Up;j_=1;var n=Object.prototype;function t(e){var r=e&&e.constructor,i=typeof r=="function"&&r.prototype||n;return e===i}return Up=t,Up}var Yp,q_;function TL(){if(q_)return Yp;q_=1;function n(t,e){return function(r){return t(e(r))}}return Yp=n,Yp}var Xp,$_;function bH(){if($_)return Xp;$_=1;var n=TL(),t=n(Object.keys,Object);return Xp=t,Xp}var Kp,G_;function rx(){if(G_)return Kp;G_=1;var n=qf(),t=bH(),e=Object.prototype,r=e.hasOwnProperty;function i(a){if(!n(a))return t(a);var s=[];for(var o in Object(a))r.call(a,o)&&o!="constructor"&&s.push(o);return s}return Kp=i,Kp}var Zp,W_;function ga(){if(W_)return Zp;W_=1;var n=Mc(),t=ex();function e(r){return r!=null&&t(r.length)&&!n(r)}return Zp=e,Zp}var Jp,V_;function as(){if(V_)return Jp;V_=1;var n=OL(),t=rx(),e=ga();function r(i){return e(i)?n(i):t(i)}return Jp=r,Jp}var Qp,H_;function wH(){if(H_)return Qp;H_=1;var n=Oc(),t=as();function e(r,i){return r&&n(i,t(i),r)}return Qp=e,Qp}var tv,U_;function xH(){if(U_)return tv;U_=1;function n(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}return tv=n,tv}var ev,Y_;function EH(){if(Y_)return ev;Y_=1;var n=ti(),t=qf(),e=xH(),r=Object.prototype,i=r.hasOwnProperty;function a(s){if(!n(s))return e(s);var o=t(s),l=[];for(var c in s)c=="constructor"&&(o||!i.call(s,c))||l.push(c);return l}return ev=a,ev}var nv,X_;function Ys(){if(X_)return nv;X_=1;var n=OL(),t=EH(),e=ga();function r(i){return e(i)?n(i,!0):t(i)}return nv=r,nv}var rv,K_;function SH(){if(K_)return rv;K_=1;var n=Oc(),t=Ys();function e(r,i){return r&&n(i,t(i),r)}return rv=e,rv}var yl={exports:{}};yl.exports;var Z_;function kL(){return Z_||(Z_=1,function(n,t){var e=vi(),r=t&&!t.nodeType&&t,i=r&&!0&&n&&!n.nodeType&&n,a=i&&i.exports===r,s=a?e.Buffer:void 0,o=s?s.allocUnsafe:void 0;function l(c,u){if(u)return c.slice();var h=c.length,f=o?o(h):new c.constructor(h);return c.copy(f),f}n.exports=l}(yl,yl.exports)),yl.exports}var iv,J_;function AL(){if(J_)return iv;J_=1;function n(t,e){var r=-1,i=t.length;for(e||(e=Array(i));++r<i;)e[r]=t[r];return e}return iv=n,iv}var av,Q_;function CL(){if(Q_)return av;Q_=1;function n(t,e){for(var r=-1,i=t==null?0:t.length,a=0,s=[];++r<i;){var o=t[r];e(o,r,t)&&(s[a++]=o)}return s}return av=n,av}var sv,tM;function PL(){if(tM)return sv;tM=1;function n(){return[]}return sv=n,sv}var ov,eM;function ix(){if(eM)return ov;eM=1;var n=CL(),t=PL(),e=Object.prototype,r=e.propertyIsEnumerable,i=Object.getOwnPropertySymbols,a=i?function(s){return s==null?[]:(s=Object(s),n(i(s),function(o){return r.call(s,o)}))}:t;return ov=a,ov}var lv,nM;function _H(){if(nM)return lv;nM=1;var n=Oc(),t=ix();function e(r,i){return n(r,t(r),i)}return lv=e,lv}var cv,rM;function ax(){if(rM)return cv;rM=1;function n(t,e){for(var r=-1,i=e.length,a=t.length;++r<i;)t[a+r]=e[r];return t}return cv=n,cv}var uv,iM;function $f(){if(iM)return uv;iM=1;var n=TL(),t=n(Object.getPrototypeOf,Object);return uv=t,uv}var hv,aM;function NL(){if(aM)return hv;aM=1;var n=ax(),t=$f(),e=ix(),r=PL(),i=Object.getOwnPropertySymbols,a=i?function(s){for(var o=[];s;)n(o,e(s)),s=t(s);return o}:r;return hv=a,hv}var fv,sM;function MH(){if(sM)return fv;sM=1;var n=Oc(),t=NL();function e(r,i){return n(r,t(r),i)}return fv=e,fv}var dv,oM;function RL(){if(oM)return dv;oM=1;var n=ax(),t=xn();function e(r,i,a){var s=i(r);return t(r)?s:n(s,a(r))}return dv=e,dv}var gv,lM;function LL(){if(lM)return gv;lM=1;var n=RL(),t=ix(),e=as();function r(i){return n(i,e,t)}return gv=r,gv}var pv,cM;function OH(){if(cM)return pv;cM=1;var n=RL(),t=NL(),e=Ys();function r(i){return n(i,e,t)}return pv=r,pv}var vv,uM;function TH(){if(uM)return vv;uM=1;var n=Us(),t=vi(),e=n(t,"DataView");return vv=e,vv}var yv,hM;function kH(){if(hM)return yv;hM=1;var n=Us(),t=vi(),e=n(t,"Promise");return yv=e,yv}var mv,fM;function IL(){if(fM)return mv;fM=1;var n=Us(),t=vi(),e=n(t,"Set");return mv=e,mv}var bv,dM;function AH(){if(dM)return bv;dM=1;var n=Us(),t=vi(),e=n(t,"WeakMap");return bv=e,bv}var wv,gM;function Go(){if(gM)return wv;gM=1;var n=TH(),t=Jw(),e=kH(),r=IL(),i=AH(),a=Hs(),s=_L(),o="[object Map]",l="[object Object]",c="[object Promise]",u="[object Set]",h="[object WeakMap]",f="[object DataView]",d=s(n),g=s(t),v=s(e),p=s(r),y=s(i),m=a;return(n&&m(new n(new ArrayBuffer(1)))!=f||t&&m(new t)!=o||e&&m(e.resolve())!=c||r&&m(new r)!=u||i&&m(new i)!=h)&&(m=function(w){var E=a(w),S=E==l?w.constructor:void 0,O=S?s(S):"";if(O)switch(O){case d:return f;case g:return o;case v:return c;case p:return u;case y:return h}return E}),wv=m,wv}var xv,pM;function CH(){if(pM)return xv;pM=1;var n=Object.prototype,t=n.hasOwnProperty;function e(r){var i=r.length,a=new r.constructor(i);return i&&typeof r[0]=="string"&&t.call(r,"index")&&(a.index=r.index,a.input=r.input),a}return xv=e,xv}var Ev,vM;function DL(){if(vM)return Ev;vM=1;var n=vi(),t=n.Uint8Array;return Ev=t,Ev}var Sv,yM;function sx(){if(yM)return Sv;yM=1;var n=DL();function t(e){var r=new e.constructor(e.byteLength);return new n(r).set(new n(e)),r}return Sv=t,Sv}var _v,mM;function PH(){if(mM)return _v;mM=1;var n=sx();function t(e,r){var i=r?n(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)}return _v=t,_v}var Mv,bM;function NH(){if(bM)return Mv;bM=1;var n=/\w*$/;function t(e){var r=new e.constructor(e.source,n.exec(e));return r.lastIndex=e.lastIndex,r}return Mv=t,Mv}var Ov,wM;function RH(){if(wM)return Ov;wM=1;var n=qo(),t=n?n.prototype:void 0,e=t?t.valueOf:void 0;function r(i){return e?Object(e.call(i)):{}}return Ov=r,Ov}var Tv,xM;function FL(){if(xM)return Tv;xM=1;var n=sx();function t(e,r){var i=r?n(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}return Tv=t,Tv}var kv,EM;function LH(){if(EM)return kv;EM=1;var n=sx(),t=PH(),e=NH(),r=RH(),i=FL(),a="[object Boolean]",s="[object Date]",o="[object Map]",l="[object Number]",c="[object RegExp]",u="[object Set]",h="[object String]",f="[object Symbol]",d="[object ArrayBuffer]",g="[object DataView]",v="[object Float32Array]",p="[object Float64Array]",y="[object Int8Array]",m="[object Int16Array]",w="[object Int32Array]",E="[object Uint8Array]",S="[object Uint8ClampedArray]",O="[object Uint16Array]",k="[object Uint32Array]";function T(C,P,N){var L=C.constructor;switch(P){case d:return n(C);case a:case s:return new L(+C);case g:return t(C,N);case v:case p:case y:case m:case w:case E:case S:case O:case k:return i(C,N);case o:return new L;case l:case h:return new L(C);case c:return e(C);case u:return new L;case f:return r(C)}}return kv=T,kv}var Av,SM;function BL(){if(SM)return Av;SM=1;var n=ti(),t=Object.create,e=function(){function r(){}return function(i){if(!n(i))return{};if(t)return t(i);r.prototype=i;var a=new r;return r.prototype=void 0,a}}();return Av=e,Av}var Cv,_M;function zL(){if(_M)return Cv;_M=1;var n=BL(),t=$f(),e=qf();function r(i){return typeof i.constructor=="function"&&!e(i)?n(t(i)):{}}return Cv=r,Cv}var Pv,MM;function IH(){if(MM)return Pv;MM=1;var n=Go(),t=Wi(),e="[object Map]";function r(i){return t(i)&&n(i)==e}return Pv=r,Pv}var Nv,OM;function DH(){if(OM)return Nv;OM=1;var n=IH(),t=jf(),e=nx(),r=e&&e.isMap,i=r?t(r):n;return Nv=i,Nv}var Rv,TM;function FH(){if(TM)return Rv;TM=1;var n=Go(),t=Wi(),e="[object Set]";function r(i){return t(i)&&n(i)==e}return Rv=r,Rv}var Lv,kM;function BH(){if(kM)return Lv;kM=1;var n=FH(),t=jf(),e=nx(),r=e&&e.isSet,i=r?t(r):n;return Lv=i,Lv}var Iv,AM;function jL(){if(AM)return Iv;AM=1;var n=Df(),t=tx(),e=Bf(),r=wH(),i=SH(),a=kL(),s=AL(),o=_H(),l=MH(),c=LL(),u=OH(),h=Go(),f=CH(),d=LH(),g=zL(),v=xn(),p=$o(),y=DH(),m=ti(),w=BH(),E=as(),S=Ys(),O=1,k=2,T=4,C="[object Arguments]",P="[object Array]",N="[object Boolean]",L="[object Date]",D="[object Error]",G="[object Function]",H="[object GeneratorFunction]",W="[object Map]",q="[object Number]",z="[object Object]",Z="[object RegExp]",at="[object Set]",ft="[object String]",ct="[object Symbol]",Gt="[object WeakMap]",J="[object ArrayBuffer]",V="[object DataView]",nt="[object Float32Array]",dt="[object Float64Array]",Nt="[object Int8Array]",Wt="[object Int16Array]",Kt="[object Int32Array]",qe="[object Uint8Array]",U="[object Uint8ClampedArray]",X="[object Uint16Array]",rt="[object Uint32Array]",lt={};lt[C]=lt[P]=lt[J]=lt[V]=lt[N]=lt[L]=lt[nt]=lt[dt]=lt[Nt]=lt[Wt]=lt[Kt]=lt[W]=lt[q]=lt[z]=lt[Z]=lt[at]=lt[ft]=lt[ct]=lt[qe]=lt[U]=lt[X]=lt[rt]=!0,lt[D]=lt[G]=lt[Gt]=!1;function vt(ut,Pt,xt,At,wt,Bt){var _t,$t=Pt&O,Vt=Pt&k,Zt=Pt&T;if(xt&&(_t=wt?xt(ut,At,wt,Bt):xt(ut)),_t!==void 0)return _t;if(!m(ut))return ut;var pe=v(ut);if(pe){if(_t=f(ut),!$t)return s(ut,_t)}else{var ue=h(ut),dn=ue==G||ue==H;if(p(ut))return a(ut,$t);if(ue==z||ue==C||dn&&!wt){if(_t=Vt||dn?{}:g(ut),!$t)return Vt?l(ut,i(_t,ut)):o(ut,r(_t,ut))}else{if(!lt[ue])return wt?ut:{};_t=d(ut,ue,$t)}}Bt||(Bt=new n);var on=Bt.get(ut);if(on)return on;Bt.set(ut,_t),w(ut)?ut.forEach(function(Vn){_t.add(vt(Vn,Pt,xt,Vn,ut,Bt))}):y(ut)&&ut.forEach(function(Vn,Mr){_t.set(Mr,vt(Vn,Pt,xt,Mr,ut,Bt))});var gr=Zt?Vt?u:c:Vt?S:E,Qn=pe?void 0:gr(ut);return t(Qn||ut,function(Vn,Mr){Qn&&(Mr=Vn,Vn=ut[Mr]),e(_t,Mr,vt(Vn,Pt,xt,Mr,ut,Bt))}),_t}return Iv=vt,Iv}var Dv,CM;function zH(){if(CM)return Dv;CM=1;var n=jL(),t=4;function e(r){return n(r,t)}return Dv=e,Dv}var Fv,PM;function ox(){if(PM)return Fv;PM=1;function n(t){return function(){return t}}return Fv=n,Fv}var Bv,NM;function jH(){if(NM)return Bv;NM=1;function n(t){return function(e,r,i){for(var a=-1,s=Object(e),o=i(e),l=o.length;l--;){var c=o[t?l:++a];if(r(s[c],c,s)===!1)break}return e}}return Bv=n,Bv}var zv,RM;function lx(){if(RM)return zv;RM=1;var n=jH(),t=n();return zv=t,zv}var jv,LM;function cx(){if(LM)return jv;LM=1;var n=lx(),t=as();function e(r,i){return r&&n(r,i,t)}return jv=e,jv}var qv,IM;function qH(){if(IM)return qv;IM=1;var n=ga();function t(e,r){return function(i,a){if(i==null)return i;if(!n(i))return e(i,a);for(var s=i.length,o=r?s:-1,l=Object(i);(r?o--:++o<s)&&a(l[o],o,l)!==!1;);return i}}return qv=t,qv}var $v,DM;function Gf(){if(DM)return $v;DM=1;var n=cx(),t=qH(),e=t(n);return $v=e,$v}var Gv,FM;function Xs(){if(FM)return Gv;FM=1;function n(t){return t}return Gv=n,Gv}var Wv,BM;function qL(){if(BM)return Wv;BM=1;var n=Xs();function t(e){return typeof e=="function"?e:n}return Wv=t,Wv}var Vv,zM;function $L(){if(zM)return Vv;zM=1;var n=tx(),t=Gf(),e=qL(),r=xn();function i(a,s){var o=r(a)?n:t;return o(a,e(s))}return Vv=i,Vv}var Hv,jM;function GL(){return jM||(jM=1,Hv=$L()),Hv}var Uv,qM;function $H(){if(qM)return Uv;qM=1;var n=Gf();function t(e,r){var i=[];return n(e,function(a,s,o){r(a,s,o)&&i.push(a)}),i}return Uv=t,Uv}var Yv,$M;function GH(){if($M)return Yv;$M=1;var n="__lodash_hash_undefined__";function t(e){return this.__data__.set(e,n),this}return Yv=t,Yv}var Xv,GM;function WH(){if(GM)return Xv;GM=1;function n(t){return this.__data__.has(t)}return Xv=n,Xv}var Kv,WM;function WL(){if(WM)return Kv;WM=1;var n=Qw(),t=GH(),e=WH();function r(i){var a=-1,s=i==null?0:i.length;for(this.__data__=new n;++a<s;)this.add(i[a])}return r.prototype.add=r.prototype.push=t,r.prototype.has=e,Kv=r,Kv}var Zv,VM;function VH(){if(VM)return Zv;VM=1;function n(t,e){for(var r=-1,i=t==null?0:t.length;++r<i;)if(e(t[r],r,t))return!0;return!1}return Zv=n,Zv}var Jv,HM;function VL(){if(HM)return Jv;HM=1;function n(t,e){return t.has(e)}return Jv=n,Jv}var Qv,UM;function HL(){if(UM)return Qv;UM=1;var n=WL(),t=VH(),e=VL(),r=1,i=2;function a(s,o,l,c,u,h){var f=l&r,d=s.length,g=o.length;if(d!=g&&!(f&&g>d))return!1;var v=h.get(s),p=h.get(o);if(v&&p)return v==o&&p==s;var y=-1,m=!0,w=l&i?new n:void 0;for(h.set(s,o),h.set(o,s);++y<d;){var E=s[y],S=o[y];if(c)var O=f?c(S,E,y,o,s,h):c(E,S,y,s,o,h);if(O!==void 0){if(O)continue;m=!1;break}if(w){if(!t(o,function(k,T){if(!e(w,T)&&(E===k||u(E,k,l,c,h)))return w.push(T)})){m=!1;break}}else if(!(E===S||u(E,S,l,c,h))){m=!1;break}}return h.delete(s),h.delete(o),m}return Qv=a,Qv}var t0,YM;function HH(){if(YM)return t0;YM=1;function n(t){var e=-1,r=Array(t.size);return t.forEach(function(i,a){r[++e]=[a,i]}),r}return t0=n,t0}var e0,XM;function ux(){if(XM)return e0;XM=1;function n(t){var e=-1,r=Array(t.size);return t.forEach(function(i){r[++e]=i}),r}return e0=n,e0}var n0,KM;function UH(){if(KM)return n0;KM=1;var n=qo(),t=DL(),e=jo(),r=HL(),i=HH(),a=ux(),s=1,o=2,l="[object Boolean]",c="[object Date]",u="[object Error]",h="[object Map]",f="[object Number]",d="[object RegExp]",g="[object Set]",v="[object String]",p="[object Symbol]",y="[object ArrayBuffer]",m="[object DataView]",w=n?n.prototype:void 0,E=w?w.valueOf:void 0;function S(O,k,T,C,P,N,L){switch(T){case m:if(O.byteLength!=k.byteLength||O.byteOffset!=k.byteOffset)return!1;O=O.buffer,k=k.buffer;case y:return!(O.byteLength!=k.byteLength||!N(new t(O),new t(k)));case l:case c:case f:return e(+O,+k);case u:return O.name==k.name&&O.message==k.message;case d:case v:return O==k+"";case h:var D=i;case g:var G=C&s;if(D||(D=a),O.size!=k.size&&!G)return!1;var H=L.get(O);if(H)return H==k;C|=o,L.set(O,k);var W=r(D(O),D(k),C,P,N,L);return L.delete(O),W;case p:if(E)return E.call(O)==E.call(k)}return!1}return n0=S,n0}var r0,ZM;function YH(){if(ZM)return r0;ZM=1;var n=LL(),t=1,e=Object.prototype,r=e.hasOwnProperty;function i(a,s,o,l,c,u){var h=o&t,f=n(a),d=f.length,g=n(s),v=g.length;if(d!=v&&!h)return!1;for(var p=d;p--;){var y=f[p];if(!(h?y in s:r.call(s,y)))return!1}var m=u.get(a),w=u.get(s);if(m&&w)return m==s&&w==a;var E=!0;u.set(a,s),u.set(s,a);for(var S=h;++p<d;){y=f[p];var O=a[y],k=s[y];if(l)var T=h?l(k,O,y,s,a,u):l(O,k,y,a,s,u);if(!(T===void 0?O===k||c(O,k,o,l,u):T)){E=!1;break}S||(S=y=="constructor")}if(E&&!S){var C=a.constructor,P=s.constructor;C!=P&&"constructor"in a&&"constructor"in s&&!(typeof C=="function"&&C instanceof C&&typeof P=="function"&&P instanceof P)&&(E=!1)}return u.delete(a),u.delete(s),E}return r0=i,r0}var i0,JM;function XH(){if(JM)return i0;JM=1;var n=Df(),t=HL(),e=UH(),r=YH(),i=Go(),a=xn(),s=$o(),o=kc(),l=1,c="[object Arguments]",u="[object Array]",h="[object Object]",f=Object.prototype,d=f.hasOwnProperty;function g(v,p,y,m,w,E){var S=a(v),O=a(p),k=S?u:i(v),T=O?u:i(p);k=k==c?h:k,T=T==c?h:T;var C=k==h,P=T==h,N=k==T;if(N&&s(v)){if(!s(p))return!1;S=!0,C=!1}if(N&&!C)return E||(E=new n),S||o(v)?t(v,p,y,m,w,E):e(v,p,k,y,m,w,E);if(!(y&l)){var L=C&&d.call(v,"__wrapped__"),D=P&&d.call(p,"__wrapped__");if(L||D){var G=L?v.value():v,H=D?p.value():p;return E||(E=new n),w(G,H,y,m,E)}}return N?(E||(E=new n),r(v,p,y,m,w,E)):!1}return i0=g,i0}var a0,QM;function UL(){if(QM)return a0;QM=1;var n=XH(),t=Wi();function e(r,i,a,s,o){return r===i?!0:r==null||i==null||!t(r)&&!t(i)?r!==r&&i!==i:n(r,i,a,s,e,o)}return a0=e,a0}var s0,tO;function KH(){if(tO)return s0;tO=1;var n=Df(),t=UL(),e=1,r=2;function i(a,s,o,l){var c=o.length,u=c,h=!l;if(a==null)return!u;for(a=Object(a);c--;){var f=o[c];if(h&&f[2]?f[1]!==a[f[0]]:!(f[0]in a))return!1}for(;++c<u;){f=o[c];var d=f[0],g=a[d],v=f[1];if(h&&f[2]){if(g===void 0&&!(d in a))return!1}else{var p=new n;if(l)var y=l(g,v,d,a,s,p);if(!(y===void 0?t(v,g,e|r,l,p):y))return!1}}return!0}return s0=i,s0}var o0,eO;function YL(){if(eO)return o0;eO=1;var n=ti();function t(e){return e===e&&!n(e)}return o0=t,o0}var l0,nO;function ZH(){if(nO)return l0;nO=1;var n=YL(),t=as();function e(r){for(var i=t(r),a=i.length;a--;){var s=i[a],o=r[s];i[a]=[s,o,n(o)]}return i}return l0=e,l0}var c0,rO;function XL(){if(rO)return c0;rO=1;function n(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}return c0=n,c0}var u0,iO;function JH(){if(iO)return u0;iO=1;var n=KH(),t=ZH(),e=XL();function r(i){var a=t(i);return a.length==1&&a[0][2]?e(a[0][0],a[0][1]):function(s){return s===i||n(s,i,a)}}return u0=r,u0}var h0,aO;function Wo(){if(aO)return h0;aO=1;var n=Hs(),t=Wi(),e="[object Symbol]";function r(i){return typeof i=="symbol"||t(i)&&n(i)==e}return h0=r,h0}var f0,sO;function hx(){if(sO)return f0;sO=1;var n=xn(),t=Wo(),e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;function i(a,s){if(n(a))return!1;var o=typeof a;return o=="number"||o=="symbol"||o=="boolean"||a==null||t(a)?!0:r.test(a)||!e.test(a)||s!=null&&a in Object(s)}return f0=i,f0}var d0,oO;function QH(){if(oO)return d0;oO=1;var n=Qw(),t="Expected a function";function e(r,i){if(typeof r!="function"||i!=null&&typeof i!="function")throw new TypeError(t);var a=function(){var s=arguments,o=i?i.apply(this,s):s[0],l=a.cache;if(l.has(o))return l.get(o);var c=r.apply(this,s);return a.cache=l.set(o,c)||l,c};return a.cache=new(e.Cache||n),a}return e.Cache=n,d0=e,d0}var g0,lO;function tU(){if(lO)return g0;lO=1;var n=QH(),t=500;function e(r){var i=n(r,function(s){return a.size===t&&a.clear(),s}),a=i.cache;return i}return g0=e,g0}var p0,cO;function eU(){if(cO)return p0;cO=1;var n=tU(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,e=/\\(\\)?/g,r=n(function(i){var a=[];return i.charCodeAt(0)===46&&a.push(""),i.replace(t,function(s,o,l,c){a.push(l?c.replace(e,"$1"):o||s)}),a});return p0=r,p0}var v0,uO;function Wf(){if(uO)return v0;uO=1;function n(t,e){for(var r=-1,i=t==null?0:t.length,a=Array(i);++r<i;)a[r]=e(t[r],r,t);return a}return v0=n,v0}var y0,hO;function nU(){if(hO)return y0;hO=1;var n=qo(),t=Wf(),e=xn(),r=Wo(),i=n?n.prototype:void 0,a=i?i.toString:void 0;function s(o){if(typeof o=="string")return o;if(e(o))return t(o,s)+"";if(r(o))return a?a.call(o):"";var l=o+"";return l=="0"&&1/o==-1/0?"-0":l}return y0=s,y0}var m0,fO;function KL(){if(fO)return m0;fO=1;var n=nU();function t(e){return e==null?"":n(e)}return m0=t,m0}var b0,dO;function Vf(){if(dO)return b0;dO=1;var n=xn(),t=hx(),e=eU(),r=KL();function i(a,s){return n(a)?a:t(a,s)?[a]:e(r(a))}return b0=i,b0}var w0,gO;function Ac(){if(gO)return w0;gO=1;var n=Wo();function t(e){if(typeof e=="string"||n(e))return e;var r=e+"";return r=="0"&&1/e==-1/0?"-0":r}return w0=t,w0}var x0,pO;function Hf(){if(pO)return x0;pO=1;var n=Vf(),t=Ac();function e(r,i){i=n(i,r);for(var a=0,s=i.length;r!=null&&a<s;)r=r[t(i[a++])];return a&&a==s?r:void 0}return x0=e,x0}var E0,vO;function rU(){if(vO)return E0;vO=1;var n=Hf();function t(e,r,i){var a=e==null?void 0:n(e,r);return a===void 0?i:a}return E0=t,E0}var S0,yO;function iU(){if(yO)return S0;yO=1;function n(t,e){return t!=null&&e in Object(t)}return S0=n,S0}var _0,mO;function ZL(){if(mO)return _0;mO=1;var n=Vf(),t=Tc(),e=xn(),r=zf(),i=ex(),a=Ac();function s(o,l,c){l=n(l,o);for(var u=-1,h=l.length,f=!1;++u<h;){var d=a(l[u]);if(!(f=o!=null&&c(o,d)))break;o=o[d]}return f||++u!=h?f:(h=o==null?0:o.length,!!h&&i(h)&&r(d,h)&&(e(o)||t(o)))}return _0=s,_0}var M0,bO;function JL(){if(bO)return M0;bO=1;var n=iU(),t=ZL();function e(r,i){return r!=null&&t(r,i,n)}return M0=e,M0}var O0,wO;function aU(){if(wO)return O0;wO=1;var n=UL(),t=rU(),e=JL(),r=hx(),i=YL(),a=XL(),s=Ac(),o=1,l=2;function c(u,h){return r(u)&&i(h)?a(s(u),h):function(f){var d=t(f,u);return d===void 0&&d===h?e(f,u):n(h,d,o|l)}}return O0=c,O0}var T0,xO;function QL(){if(xO)return T0;xO=1;function n(t){return function(e){return e==null?void 0:e[t]}}return T0=n,T0}var k0,EO;function sU(){if(EO)return k0;EO=1;var n=Hf();function t(e){return function(r){return n(r,e)}}return k0=t,k0}var A0,SO;function oU(){if(SO)return A0;SO=1;var n=QL(),t=sU(),e=hx(),r=Ac();function i(a){return e(a)?n(r(a)):t(a)}return A0=i,A0}var C0,_O;function pa(){if(_O)return C0;_O=1;var n=JH(),t=aU(),e=Xs(),r=xn(),i=oU();function a(s){return typeof s=="function"?s:s==null?e:typeof s=="object"?r(s)?t(s[0],s[1]):n(s):i(s)}return C0=a,C0}var P0,MO;function t3(){if(MO)return P0;MO=1;var n=CL(),t=$H(),e=pa(),r=xn();function i(a,s){var o=r(a)?n:t;return o(a,e(s,3))}return P0=i,P0}var N0,OO;function lU(){if(OO)return N0;OO=1;var n=Object.prototype,t=n.hasOwnProperty;function e(r,i){return r!=null&&t.call(r,i)}return N0=e,N0}var R0,TO;function e3(){if(TO)return R0;TO=1;var n=lU(),t=ZL();function e(r,i){return r!=null&&t(r,i,n)}return R0=e,R0}var L0,kO;function cU(){if(kO)return L0;kO=1;var n=rx(),t=Go(),e=Tc(),r=xn(),i=ga(),a=$o(),s=qf(),o=kc(),l="[object Map]",c="[object Set]",u=Object.prototype,h=u.hasOwnProperty;function f(d){if(d==null)return!0;if(i(d)&&(r(d)||typeof d=="string"||typeof d.splice=="function"||a(d)||o(d)||e(d)))return!d.length;var g=t(d);if(g==l||g==c)return!d.size;if(s(d))return!n(d).length;for(var v in d)if(h.call(d,v))return!1;return!0}return L0=f,L0}var I0,AO;function n3(){if(AO)return I0;AO=1;function n(t){return t===void 0}return I0=n,I0}var D0,CO;function r3(){if(CO)return D0;CO=1;var n=Gf(),t=ga();function e(r,i){var a=-1,s=t(r)?Array(r.length):[];return n(r,function(o,l,c){s[++a]=i(o,l,c)}),s}return D0=e,D0}var F0,PO;function i3(){if(PO)return F0;PO=1;var n=Wf(),t=pa(),e=r3(),r=xn();function i(a,s){var o=r(a)?n:e;return o(a,t(s,3))}return F0=i,F0}var B0,NO;function uU(){if(NO)return B0;NO=1;function n(t,e,r,i){var a=-1,s=t==null?0:t.length;for(i&&s&&(r=t[++a]);++a<s;)r=e(r,t[a],a,t);return r}return B0=n,B0}var z0,RO;function hU(){if(RO)return z0;RO=1;function n(t,e,r,i,a){return a(t,function(s,o,l){r=i?(i=!1,s):e(r,s,o,l)}),r}return z0=n,z0}var j0,LO;function a3(){if(LO)return j0;LO=1;var n=uU(),t=Gf(),e=pa(),r=hU(),i=xn();function a(s,o,l){var c=i(s)?n:r,u=arguments.length<3;return c(s,e(o,4),l,u,t)}return j0=a,j0}var q0,IO;function fU(){if(IO)return q0;IO=1;var n=Hs(),t=xn(),e=Wi(),r="[object String]";function i(a){return typeof a=="string"||!t(a)&&e(a)&&n(a)==r}return q0=i,q0}var $0,DO;function dU(){if(DO)return $0;DO=1;var n=QL(),t=n("length");return $0=t,$0}var G0,FO;function gU(){if(FO)return G0;FO=1;var n="\\ud800-\\udfff",t="\\u0300-\\u036f",e="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",i=t+e+r,a="\\ufe0e\\ufe0f",s="\\u200d",o=RegExp("["+s+n+i+a+"]");function l(c){return o.test(c)}return G0=l,G0}var W0,BO;function pU(){if(BO)return W0;BO=1;var n="\\ud800-\\udfff",t="\\u0300-\\u036f",e="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",i=t+e+r,a="\\ufe0e\\ufe0f",s="["+n+"]",o="["+i+"]",l="\\ud83c[\\udffb-\\udfff]",c="(?:"+o+"|"+l+")",u="[^"+n+"]",h="(?:\\ud83c[\\udde6-\\uddff]){2}",f="[\\ud800-\\udbff][\\udc00-\\udfff]",d="\\u200d",g=c+"?",v="["+a+"]?",p="(?:"+d+"(?:"+[u,h,f].join("|")+")"+v+g+")*",y=v+g+p,m="(?:"+[u+o+"?",o,h,f,s].join("|")+")",w=RegExp(l+"(?="+l+")|"+m+y,"g");function E(S){for(var O=w.lastIndex=0;w.test(S);)++O;return O}return W0=E,W0}var V0,zO;function vU(){if(zO)return V0;zO=1;var n=dU(),t=gU(),e=pU();function r(i){return t(i)?e(i):n(i)}return V0=r,V0}var H0,jO;function yU(){if(jO)return H0;jO=1;var n=rx(),t=Go(),e=ga(),r=fU(),i=vU(),a="[object Map]",s="[object Set]";function o(l){if(l==null)return 0;if(e(l))return r(l)?i(l):l.length;var c=t(l);return c==a||c==s?l.size:n(l).length}return H0=o,H0}var U0,qO;function mU(){if(qO)return U0;qO=1;var n=tx(),t=BL(),e=cx(),r=pa(),i=$f(),a=xn(),s=$o(),o=Mc(),l=ti(),c=kc();function u(h,f,d){var g=a(h),v=g||s(h)||c(h);if(f=r(f,4),d==null){var p=h&&h.constructor;v?d=g?new p:[]:l(h)?d=o(p)?t(i(h)):{}:d={}}return(v?n:e)(h,function(y,m,w){return f(d,y,m,w)}),d}return U0=u,U0}var Y0,$O;function bU(){if($O)return Y0;$O=1;var n=qo(),t=Tc(),e=xn(),r=n?n.isConcatSpreadable:void 0;function i(a){return e(a)||t(a)||!!(r&&a&&a[r])}return Y0=i,Y0}var X0,GO;function fx(){if(GO)return X0;GO=1;var n=ax(),t=bU();function e(r,i,a,s,o){var l=-1,c=r.length;for(a||(a=t),o||(o=[]);++l<c;){var u=r[l];i>0&&a(u)?i>1?e(u,i-1,a,s,o):n(o,u):s||(o[o.length]=u)}return o}return X0=e,X0}var K0,WO;function wU(){if(WO)return K0;WO=1;function n(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}return K0=n,K0}var Z0,VO;function s3(){if(VO)return Z0;VO=1;var n=wU(),t=Math.max;function e(r,i,a){return i=t(i===void 0?r.length-1:i,0),function(){for(var s=arguments,o=-1,l=t(s.length-i,0),c=Array(l);++o<l;)c[o]=s[i+o];o=-1;for(var u=Array(i+1);++o<i;)u[o]=s[o];return u[i]=a(c),n(r,this,u)}}return Z0=e,Z0}var J0,HO;function xU(){if(HO)return J0;HO=1;var n=ox(),t=ML(),e=Xs(),r=t?function(i,a){return t(i,"toString",{configurable:!0,enumerable:!1,value:n(a),writable:!0})}:e;return J0=r,J0}var Q0,UO;function EU(){if(UO)return Q0;UO=1;var n=800,t=16,e=Date.now;function r(i){var a=0,s=0;return function(){var o=e(),l=t-(o-s);if(s=o,l>0){if(++a>=n)return arguments[0]}else a=0;return i.apply(void 0,arguments)}}return Q0=r,Q0}var ty,YO;function o3(){if(YO)return ty;YO=1;var n=xU(),t=EU(),e=t(n);return ty=e,ty}var ey,XO;function Uf(){if(XO)return ey;XO=1;var n=Xs(),t=s3(),e=o3();function r(i,a){return e(t(i,a,n),i+"")}return ey=r,ey}var ny,KO;function l3(){if(KO)return ny;KO=1;function n(t,e,r,i){for(var a=t.length,s=r+(i?1:-1);i?s--:++s<a;)if(e(t[s],s,t))return s;return-1}return ny=n,ny}var ry,ZO;function SU(){if(ZO)return ry;ZO=1;function n(t){return t!==t}return ry=n,ry}var iy,JO;function _U(){if(JO)return iy;JO=1;function n(t,e,r){for(var i=r-1,a=t.length;++i<a;)if(t[i]===e)return i;return-1}return iy=n,iy}var ay,QO;function MU(){if(QO)return ay;QO=1;var n=l3(),t=SU(),e=_U();function r(i,a,s){return a===a?e(i,a,s):n(i,t,s)}return ay=r,ay}var sy,tT;function OU(){if(tT)return sy;tT=1;var n=MU();function t(e,r){var i=e==null?0:e.length;return!!i&&n(e,r,0)>-1}return sy=t,sy}var oy,eT;function TU(){if(eT)return oy;eT=1;function n(t,e,r){for(var i=-1,a=t==null?0:t.length;++i<a;)if(r(e,t[i]))return!0;return!1}return oy=n,oy}var ly,nT;function kU(){if(nT)return ly;nT=1;function n(){}return ly=n,ly}var cy,rT;function AU(){if(rT)return cy;rT=1;var n=IL(),t=kU(),e=ux(),r=1/0,i=n&&1/e(new n([,-0]))[1]==r?function(a){return new n(a)}:t;return cy=i,cy}var uy,iT;function CU(){if(iT)return uy;iT=1;var n=WL(),t=OU(),e=TU(),r=VL(),i=AU(),a=ux(),s=200;function o(l,c,u){var h=-1,f=t,d=l.length,g=!0,v=[],p=v;if(u)g=!1,f=e;else if(d>=s){var y=c?null:i(l);if(y)return a(y);g=!1,f=r,p=new n}else p=c?[]:v;t:for(;++h<d;){var m=l[h],w=c?c(m):m;if(m=u||m!==0?m:0,g&&w===w){for(var E=p.length;E--;)if(p[E]===w)continue t;c&&p.push(w),v.push(m)}else f(p,w,u)||(p!==v&&p.push(w),v.push(m))}return v}return uy=o,uy}var hy,aT;function c3(){if(aT)return hy;aT=1;var n=ga(),t=Wi();function e(r){return t(r)&&n(r)}return hy=e,hy}var fy,sT;function PU(){if(sT)return fy;sT=1;var n=fx(),t=Uf(),e=CU(),r=c3(),i=t(function(a){return e(n(a,1,r,!0))});return fy=i,fy}var dy,oT;function NU(){if(oT)return dy;oT=1;var n=Wf();function t(e,r){return n(r,function(i){return e[i]})}return dy=t,dy}var gy,lT;function u3(){if(lT)return gy;lT=1;var n=NU(),t=as();function e(r){return r==null?[]:n(r,t(r))}return gy=e,gy}var py,cT;function ei(){if(cT)return py;cT=1;var n;if(typeof Zw=="function")try{n={clone:zH(),constant:ox(),each:GL(),filter:t3(),has:e3(),isArray:xn(),isEmpty:cU(),isFunction:Mc(),isUndefined:n3(),keys:as(),map:i3(),reduce:a3(),size:yU(),transform:mU(),union:PU(),values:u3()}}catch{}return n||(n=window._),py=n,py}var vy,uT;function dx(){if(uT)return vy;uT=1;var n=ei();vy=i;var t="\0",e="\0",r="";function i(u){this._isDirected=n.has(u,"directed")?u.directed:!0,this._isMultigraph=n.has(u,"multigraph")?u.multigraph:!1,this._isCompound=n.has(u,"compound")?u.compound:!1,this._label=void 0,this._defaultNodeLabelFn=n.constant(void 0),this._defaultEdgeLabelFn=n.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[e]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}i.prototype._nodeCount=0,i.prototype._edgeCount=0,i.prototype.isDirected=function(){return this._isDirected},i.prototype.isMultigraph=function(){return this._isMultigraph},i.prototype.isCompound=function(){return this._isCompound},i.prototype.setGraph=function(u){return this._label=u,this},i.prototype.graph=function(){return this._label},i.prototype.setDefaultNodeLabel=function(u){return n.isFunction(u)||(u=n.constant(u)),this._defaultNodeLabelFn=u,this},i.prototype.nodeCount=function(){return this._nodeCount},i.prototype.nodes=function(){return n.keys(this._nodes)},i.prototype.sources=function(){var u=this;return n.filter(this.nodes(),function(h){return n.isEmpty(u._in[h])})},i.prototype.sinks=function(){var u=this;return n.filter(this.nodes(),function(h){return n.isEmpty(u._out[h])})},i.prototype.setNodes=function(u,h){var f=arguments,d=this;return n.each(u,function(g){f.length>1?d.setNode(g,h):d.setNode(g)}),this},i.prototype.setNode=function(u,h){return n.has(this._nodes,u)?(arguments.length>1&&(this._nodes[u]=h),this):(this._nodes[u]=arguments.length>1?h:this._defaultNodeLabelFn(u),this._isCompound&&(this._parent[u]=e,this._children[u]={},this._children[e][u]=!0),this._in[u]={},this._preds[u]={},this._out[u]={},this._sucs[u]={},++this._nodeCount,this)},i.prototype.node=function(u){return this._nodes[u]},i.prototype.hasNode=function(u){return n.has(this._nodes,u)},i.prototype.removeNode=function(u){var h=this;if(n.has(this._nodes,u)){var f=function(d){h.removeEdge(h._edgeObjs[d])};delete this._nodes[u],this._isCompound&&(this._removeFromParentsChildList(u),delete this._parent[u],n.each(this.children(u),function(d){h.setParent(d)}),delete this._children[u]),n.each(n.keys(this._in[u]),f),delete this._in[u],delete this._preds[u],n.each(n.keys(this._out[u]),f),delete this._out[u],delete this._sucs[u],--this._nodeCount}return this},i.prototype.setParent=function(u,h){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(n.isUndefined(h))h=e;else{h+="";for(var f=h;!n.isUndefined(f);f=this.parent(f))if(f===u)throw new Error("Setting "+h+" as parent of "+u+" would create a cycle");this.setNode(h)}return this.setNode(u),this._removeFromParentsChildList(u),this._parent[u]=h,this._children[h][u]=!0,this},i.prototype._removeFromParentsChildList=function(u){delete this._children[this._parent[u]][u]},i.prototype.parent=function(u){if(this._isCompound){var h=this._parent[u];if(h!==e)return h}},i.prototype.children=function(u){if(n.isUndefined(u)&&(u=e),this._isCompound){var h=this._children[u];if(h)return n.keys(h)}else{if(u===e)return this.nodes();if(this.hasNode(u))return[]}},i.prototype.predecessors=function(u){var h=this._preds[u];if(h)return n.keys(h)},i.prototype.successors=function(u){var h=this._sucs[u];if(h)return n.keys(h)},i.prototype.neighbors=function(u){var h=this.predecessors(u);if(h)return n.union(h,this.successors(u))},i.prototype.isLeaf=function(u){var h;return this.isDirected()?h=this.successors(u):h=this.neighbors(u),h.length===0},i.prototype.filterNodes=function(u){var h=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});h.setGraph(this.graph());var f=this;n.each(this._nodes,function(v,p){u(p)&&h.setNode(p,v)}),n.each(this._edgeObjs,function(v){h.hasNode(v.v)&&h.hasNode(v.w)&&h.setEdge(v,f.edge(v))});var d={};function g(v){var p=f.parent(v);return p===void 0||h.hasNode(p)?(d[v]=p,p):p in d?d[p]:g(p)}return this._isCompound&&n.each(h.nodes(),function(v){h.setParent(v,g(v))}),h},i.prototype.setDefaultEdgeLabel=function(u){return n.isFunction(u)||(u=n.constant(u)),this._defaultEdgeLabelFn=u,this},i.prototype.edgeCount=function(){return this._edgeCount},i.prototype.edges=function(){return n.values(this._edgeObjs)},i.prototype.setPath=function(u,h){var f=this,d=arguments;return n.reduce(u,function(g,v){return d.length>1?f.setEdge(g,v,h):f.setEdge(g,v),v}),this},i.prototype.setEdge=function(){var u,h,f,d,g=!1,v=arguments[0];typeof v=="object"&&v!==null&&"v"in v?(u=v.v,h=v.w,f=v.name,arguments.length===2&&(d=arguments[1],g=!0)):(u=v,h=arguments[1],f=arguments[3],arguments.length>2&&(d=arguments[2],g=!0)),u=""+u,h=""+h,n.isUndefined(f)||(f=""+f);var p=o(this._isDirected,u,h,f);if(n.has(this._edgeLabels,p))return g&&(this._edgeLabels[p]=d),this;if(!n.isUndefined(f)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(u),this.setNode(h),this._edgeLabels[p]=g?d:this._defaultEdgeLabelFn(u,h,f);var y=l(this._isDirected,u,h,f);return u=y.v,h=y.w,Object.freeze(y),this._edgeObjs[p]=y,a(this._preds[h],u),a(this._sucs[u],h),this._in[h][p]=y,this._out[u][p]=y,this._edgeCount++,this},i.prototype.edge=function(u,h,f){var d=arguments.length===1?c(this._isDirected,arguments[0]):o(this._isDirected,u,h,f);return this._edgeLabels[d]},i.prototype.hasEdge=function(u,h,f){var d=arguments.length===1?c(this._isDirected,arguments[0]):o(this._isDirected,u,h,f);return n.has(this._edgeLabels,d)},i.prototype.removeEdge=function(u,h,f){var d=arguments.length===1?c(this._isDirected,arguments[0]):o(this._isDirected,u,h,f),g=this._edgeObjs[d];return g&&(u=g.v,h=g.w,delete this._edgeLabels[d],delete this._edgeObjs[d],s(this._preds[h],u),s(this._sucs[u],h),delete this._in[h][d],delete this._out[u][d],this._edgeCount--),this},i.prototype.inEdges=function(u,h){var f=this._in[u];if(f){var d=n.values(f);return h?n.filter(d,function(g){return g.v===h}):d}},i.prototype.outEdges=function(u,h){var f=this._out[u];if(f){var d=n.values(f);return h?n.filter(d,function(g){return g.w===h}):d}},i.prototype.nodeEdges=function(u,h){var f=this.inEdges(u,h);if(f)return f.concat(this.outEdges(u,h))};function a(u,h){u[h]?u[h]++:u[h]=1}function s(u,h){--u[h]||delete u[h]}function o(u,h,f,d){var g=""+h,v=""+f;if(!u&&g>v){var p=g;g=v,v=p}return g+r+v+r+(n.isUndefined(d)?t:d)}function l(u,h,f,d){var g=""+h,v=""+f;if(!u&&g>v){var p=g;g=v,v=p}var y={v:g,w:v};return d&&(y.name=d),y}function c(u,h){return o(u,h.v,h.w,h.name)}return vy}var yy,hT;function RU(){return hT||(hT=1,yy="2.1.8"),yy}var my,fT;function LU(){return fT||(fT=1,my={Graph:dx(),version:RU()}),my}var by,dT;function IU(){if(dT)return by;dT=1;var n=ei(),t=dx();by={write:e,read:a};function e(s){var o={options:{directed:s.isDirected(),multigraph:s.isMultigraph(),compound:s.isCompound()},nodes:r(s),edges:i(s)};return n.isUndefined(s.graph())||(o.value=n.clone(s.graph())),o}function r(s){return n.map(s.nodes(),function(o){var l=s.node(o),c=s.parent(o),u={v:o};return n.isUndefined(l)||(u.value=l),n.isUndefined(c)||(u.parent=c),u})}function i(s){return n.map(s.edges(),function(o){var l=s.edge(o),c={v:o.v,w:o.w};return n.isUndefined(o.name)||(c.name=o.name),n.isUndefined(l)||(c.value=l),c})}function a(s){var o=new t(s.options).setGraph(s.value);return n.each(s.nodes,function(l){o.setNode(l.v,l.value),l.parent&&o.setParent(l.v,l.parent)}),n.each(s.edges,function(l){o.setEdge({v:l.v,w:l.w,name:l.name},l.value)}),o}return by}var wy,gT;function DU(){if(gT)return wy;gT=1;var n=ei();wy=t;function t(e){var r={},i=[],a;function s(o){n.has(r,o)||(r[o]=!0,a.push(o),n.each(e.successors(o),s),n.each(e.predecessors(o),s))}return n.each(e.nodes(),function(o){a=[],s(o),a.length&&i.push(a)}),i}return wy}var xy,pT;function h3(){if(pT)return xy;pT=1;var n=ei();xy=t;function t(){this._arr=[],this._keyIndices={}}return t.prototype.size=function(){return this._arr.length},t.prototype.keys=function(){return this._arr.map(function(e){return e.key})},t.prototype.has=function(e){return n.has(this._keyIndices,e)},t.prototype.priority=function(e){var r=this._keyIndices[e];if(r!==void 0)return this._arr[r].priority},t.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},t.prototype.add=function(e,r){var i=this._keyIndices;if(e=String(e),!n.has(i,e)){var a=this._arr,s=a.length;return i[e]=s,a.push({key:e,priority:r}),this._decrease(s),!0}return!1},t.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key},t.prototype.decrease=function(e,r){var i=this._keyIndices[e];if(r>this._arr[i].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[i].priority+" New: "+r);this._arr[i].priority=r,this._decrease(i)},t.prototype._heapify=function(e){var r=this._arr,i=2*e,a=i+1,s=e;i<r.length&&(s=r[i].priority<r[s].priority?i:s,a<r.length&&(s=r[a].priority<r[s].priority?a:s),s!==e&&(this._swap(e,s),this._heapify(s)))},t.prototype._decrease=function(e){for(var r=this._arr,i=r[e].priority,a;e!==0&&(a=e>>1,!(r[a].priority<i));)this._swap(e,a),e=a},t.prototype._swap=function(e,r){var i=this._arr,a=this._keyIndices,s=i[e],o=i[r];i[e]=o,i[r]=s,a[o.key]=e,a[s.key]=r},xy}var Ey,vT;function f3(){if(vT)return Ey;vT=1;var n=ei(),t=h3();Ey=r;var e=n.constant(1);function r(a,s,o,l){return i(a,String(s),o||e,l||function(c){return a.outEdges(c)})}function i(a,s,o,l){var c={},u=new t,h,f,d=function(g){var v=g.v!==h?g.v:g.w,p=c[v],y=o(g),m=f.distance+y;if(y<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+g+" Weight: "+y);m<p.distance&&(p.distance=m,p.predecessor=h,u.decrease(v,m))};for(a.nodes().forEach(function(g){var v=g===s?0:Number.POSITIVE_INFINITY;c[g]={distance:v},u.add(g,v)});u.size()>0&&(h=u.removeMin(),f=c[h],f.distance!==Number.POSITIVE_INFINITY);)l(h).forEach(d);return c}return Ey}var Sy,yT;function FU(){if(yT)return Sy;yT=1;var n=f3(),t=ei();Sy=e;function e(r,i,a){return t.transform(r.nodes(),function(s,o){s[o]=n(r,o,i,a)},{})}return Sy}var _y,mT;function d3(){if(mT)return _y;mT=1;var n=ei();_y=t;function t(e){var r=0,i=[],a={},s=[];function o(l){var c=a[l]={onStack:!0,lowlink:r,index:r++};if(i.push(l),e.successors(l).forEach(function(f){n.has(a,f)?a[f].onStack&&(c.lowlink=Math.min(c.lowlink,a[f].index)):(o(f),c.lowlink=Math.min(c.lowlink,a[f].lowlink))}),c.lowlink===c.index){var u=[],h;do h=i.pop(),a[h].onStack=!1,u.push(h);while(l!==h);s.push(u)}}return e.nodes().forEach(function(l){n.has(a,l)||o(l)}),s}return _y}var My,bT;function BU(){if(bT)return My;bT=1;var n=ei(),t=d3();My=e;function e(r){return n.filter(t(r),function(i){return i.length>1||i.length===1&&r.hasEdge(i[0],i[0])})}return My}var Oy,wT;function zU(){if(wT)return Oy;wT=1;var n=ei();Oy=e;var t=n.constant(1);function e(i,a,s){return r(i,a||t,s||function(o){return i.outEdges(o)})}function r(i,a,s){var o={},l=i.nodes();return l.forEach(function(c){o[c]={},o[c][c]={distance:0},l.forEach(function(u){c!==u&&(o[c][u]={distance:Number.POSITIVE_INFINITY})}),s(c).forEach(function(u){var h=u.v===c?u.w:u.v,f=a(u);o[c][h]={distance:f,predecessor:c}})}),l.forEach(function(c){var u=o[c];l.forEach(function(h){var f=o[h];l.forEach(function(d){var g=f[c],v=u[d],p=f[d],y=g.distance+v.distance;y<p.distance&&(p.distance=y,p.predecessor=v.predecessor)})})}),o}return Oy}var Ty,xT;function g3(){if(xT)return Ty;xT=1;var n=ei();Ty=t,t.CycleException=e;function t(r){var i={},a={},s=[];function o(l){if(n.has(a,l))throw new e;n.has(i,l)||(a[l]=!0,i[l]=!0,n.each(r.predecessors(l),o),delete a[l],s.push(l))}if(n.each(r.sinks(),o),n.size(i)!==r.nodeCount())throw new e;return s}function e(){}return e.prototype=new Error,Ty}var ky,ET;function jU(){if(ET)return ky;ET=1;var n=g3();ky=t;function t(e){try{n(e)}catch(r){if(r instanceof n.CycleException)return!1;throw r}return!0}return ky}var Ay,ST;function p3(){if(ST)return Ay;ST=1;var n=ei();Ay=t;function t(r,i,a){n.isArray(i)||(i=[i]);var s=(r.isDirected()?r.successors:r.neighbors).bind(r),o=[],l={};return n.each(i,function(c){if(!r.hasNode(c))throw new Error("Graph does not have node: "+c);e(r,c,a==="post",l,s,o)}),o}function e(r,i,a,s,o,l){n.has(s,i)||(s[i]=!0,a||l.push(i),n.each(o(i),function(c){e(r,c,a,s,o,l)}),a&&l.push(i))}return Ay}var Cy,_T;function qU(){if(_T)return Cy;_T=1;var n=p3();Cy=t;function t(e,r){return n(e,r,"post")}return Cy}var Py,MT;function $U(){if(MT)return Py;MT=1;var n=p3();Py=t;function t(e,r){return n(e,r,"pre")}return Py}var Ny,OT;function GU(){if(OT)return Ny;OT=1;var n=ei(),t=dx(),e=h3();Ny=r;function r(i,a){var s=new t,o={},l=new e,c;function u(f){var d=f.v===c?f.w:f.v,g=l.priority(d);if(g!==void 0){var v=a(f);v<g&&(o[d]=c,l.decrease(d,v))}}if(i.nodeCount()===0)return s;n.each(i.nodes(),function(f){l.add(f,Number.POSITIVE_INFINITY),s.setNode(f)}),l.decrease(i.nodes()[0],0);for(var h=!1;l.size()>0;){if(c=l.removeMin(),n.has(o,c))s.setEdge(c,o[c]);else{if(h)throw new Error("Input graph is not connected: "+i);h=!0}i.nodeEdges(c).forEach(u)}return s}return Ny}var Ry,TT;function WU(){return TT||(TT=1,Ry={components:DU(),dijkstra:f3(),dijkstraAll:FU(),findCycles:BU(),floydWarshall:zU(),isAcyclic:jU(),postorder:qU(),preorder:$U(),prim:GU(),tarjan:d3(),topsort:g3()}),Ry}var Ly,kT;function VU(){if(kT)return Ly;kT=1;var n=LU();return Ly={Graph:n.Graph,json:IU(),alg:WU(),version:n.version},Ly}var Iy,AT;function pi(){if(AT)return Iy;AT=1;var n;if(typeof Zw=="function")try{n=VU()}catch{}return n||(n=window.graphlib),Iy=n,Iy}var Dy,CT;function HU(){if(CT)return Dy;CT=1;var n=jL(),t=1,e=4;function r(i){return n(i,t|e)}return Dy=r,Dy}var Fy,PT;function Yf(){if(PT)return Fy;PT=1;var n=jo(),t=ga(),e=zf(),r=ti();function i(a,s,o){if(!r(o))return!1;var l=typeof s;return(l=="number"?t(o)&&e(s,o.length):l=="string"&&s in o)?n(o[s],a):!1}return Fy=i,Fy}var By,NT;function UU(){if(NT)return By;NT=1;var n=Uf(),t=jo(),e=Yf(),r=Ys(),i=Object.prototype,a=i.hasOwnProperty,s=n(function(o,l){o=Object(o);var c=-1,u=l.length,h=u>2?l[2]:void 0;for(h&&e(l[0],l[1],h)&&(u=1);++c<u;)for(var f=l[c],d=r(f),g=-1,v=d.length;++g<v;){var p=d[g],y=o[p];(y===void 0||t(y,i[p])&&!a.call(o,p))&&(o[p]=f[p])}return o});return By=s,By}var zy,RT;function YU(){if(RT)return zy;RT=1;var n=pa(),t=ga(),e=as();function r(i){return function(a,s,o){var l=Object(a);if(!t(a)){var c=n(s,3);a=e(a),s=function(h){return c(l[h],h,l)}}var u=i(a,s,o);return u>-1?l[c?a[u]:u]:void 0}}return zy=r,zy}var jy,LT;function XU(){if(LT)return jy;LT=1;var n=/\s/;function t(e){for(var r=e.length;r--&&n.test(e.charAt(r)););return r}return jy=t,jy}var qy,IT;function KU(){if(IT)return qy;IT=1;var n=XU(),t=/^\s+/;function e(r){return r&&r.slice(0,n(r)+1).replace(t,"")}return qy=e,qy}var $y,DT;function ZU(){if(DT)return $y;DT=1;var n=KU(),t=ti(),e=Wo(),r=NaN,i=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,s=/^0o[0-7]+$/i,o=parseInt;function l(c){if(typeof c=="number")return c;if(e(c))return r;if(t(c)){var u=typeof c.valueOf=="function"?c.valueOf():c;c=t(u)?u+"":u}if(typeof c!="string")return c===0?c:+c;c=n(c);var h=a.test(c);return h||s.test(c)?o(c.slice(2),h?2:8):i.test(c)?r:+c}return $y=l,$y}var Gy,FT;function v3(){if(FT)return Gy;FT=1;var n=ZU(),t=1/0,e=17976931348623157e292;function r(i){if(!i)return i===0?i:0;if(i=n(i),i===t||i===-1/0){var a=i<0?-1:1;return a*e}return i===i?i:0}return Gy=r,Gy}var Wy,BT;function JU(){if(BT)return Wy;BT=1;var n=v3();function t(e){var r=n(e),i=r%1;return r===r?i?r-i:r:0}return Wy=t,Wy}var Vy,zT;function QU(){if(zT)return Vy;zT=1;var n=l3(),t=pa(),e=JU(),r=Math.max;function i(a,s,o){var l=a==null?0:a.length;if(!l)return-1;var c=o==null?0:e(o);return c<0&&(c=r(l+c,0)),n(a,t(s,3),c)}return Vy=i,Vy}var Hy,jT;function tY(){if(jT)return Hy;jT=1;var n=YU(),t=QU(),e=n(t);return Hy=e,Hy}var Uy,qT;function y3(){if(qT)return Uy;qT=1;var n=fx();function t(e){var r=e==null?0:e.length;return r?n(e,1):[]}return Uy=t,Uy}var Yy,$T;function eY(){if($T)return Yy;$T=1;var n=lx(),t=qL(),e=Ys();function r(i,a){return i==null?i:n(i,t(a),e)}return Yy=r,Yy}var Xy,GT;function nY(){if(GT)return Xy;GT=1;function n(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}return Xy=n,Xy}var Ky,WT;function rY(){if(WT)return Ky;WT=1;var n=Ff(),t=cx(),e=pa();function r(i,a){var s={};return a=e(a,3),t(i,function(o,l,c){n(s,l,a(o,l,c))}),s}return Ky=r,Ky}var Zy,VT;function gx(){if(VT)return Zy;VT=1;var n=Wo();function t(e,r,i){for(var a=-1,s=e.length;++a<s;){var o=e[a],l=r(o);if(l!=null&&(c===void 0?l===l&&!n(l):i(l,c)))var c=l,u=o}return u}return Zy=t,Zy}var Jy,HT;function iY(){if(HT)return Jy;HT=1;function n(t,e){return t>e}return Jy=n,Jy}var Qy,UT;function aY(){if(UT)return Qy;UT=1;var n=gx(),t=iY(),e=Xs();function r(i){return i&&i.length?n(i,e,t):void 0}return Qy=r,Qy}var tm,YT;function m3(){if(YT)return tm;YT=1;var n=Ff(),t=jo();function e(r,i,a){(a!==void 0&&!t(r[i],a)||a===void 0&&!(i in r))&&n(r,i,a)}return tm=e,tm}var em,XT;function sY(){if(XT)return em;XT=1;var n=Hs(),t=$f(),e=Wi(),r="[object Object]",i=Function.prototype,a=Object.prototype,s=i.toString,o=a.hasOwnProperty,l=s.call(Object);function c(u){if(!e(u)||n(u)!=r)return!1;var h=t(u);if(h===null)return!0;var f=o.call(h,"constructor")&&h.constructor;return typeof f=="function"&&f instanceof f&&s.call(f)==l}return em=c,em}var nm,KT;function b3(){if(KT)return nm;KT=1;function n(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}return nm=n,nm}var rm,ZT;function oY(){if(ZT)return rm;ZT=1;var n=Oc(),t=Ys();function e(r){return n(r,t(r))}return rm=e,rm}var im,JT;function lY(){if(JT)return im;JT=1;var n=m3(),t=kL(),e=FL(),r=AL(),i=zL(),a=Tc(),s=xn(),o=c3(),l=$o(),c=Mc(),u=ti(),h=sY(),f=kc(),d=b3(),g=oY();function v(p,y,m,w,E,S,O){var k=d(p,m),T=d(y,m),C=O.get(T);if(C){n(p,m,C);return}var P=S?S(k,T,m+"",p,y,O):void 0,N=P===void 0;if(N){var L=s(T),D=!L&&l(T),G=!L&&!D&&f(T);P=T,L||D||G?s(k)?P=k:o(k)?P=r(k):D?(N=!1,P=t(T,!0)):G?(N=!1,P=e(T,!0)):P=[]:h(T)||a(T)?(P=k,a(k)?P=g(k):(!u(k)||c(k))&&(P=i(T))):N=!1}N&&(O.set(T,P),E(P,T,w,S,O),O.delete(T)),n(p,m,P)}return im=v,im}var am,QT;function cY(){if(QT)return am;QT=1;var n=Df(),t=m3(),e=lx(),r=lY(),i=ti(),a=Ys(),s=b3();function o(l,c,u,h,f){l!==c&&e(c,function(d,g){if(f||(f=new n),i(d))r(l,c,g,u,o,h,f);else{var v=h?h(s(l,g),d,g+"",l,c,f):void 0;v===void 0&&(v=d),t(l,g,v)}},a)}return am=o,am}var sm,tk;function uY(){if(tk)return sm;tk=1;var n=Uf(),t=Yf();function e(r){return n(function(i,a){var s=-1,o=a.length,l=o>1?a[o-1]:void 0,c=o>2?a[2]:void 0;for(l=r.length>3&&typeof l=="function"?(o--,l):void 0,c&&t(a[0],a[1],c)&&(l=o<3?void 0:l,o=1),i=Object(i);++s<o;){var u=a[s];u&&r(i,u,s,l)}return i})}return sm=e,sm}var om,ek;function hY(){if(ek)return om;ek=1;var n=cY(),t=uY(),e=t(function(r,i,a){n(r,i,a)});return om=e,om}var lm,nk;function w3(){if(nk)return lm;nk=1;function n(t,e){return t<e}return lm=n,lm}var cm,rk;function fY(){if(rk)return cm;rk=1;var n=gx(),t=w3(),e=Xs();function r(i){return i&&i.length?n(i,e,t):void 0}return cm=r,cm}var um,ik;function dY(){if(ik)return um;ik=1;var n=gx(),t=pa(),e=w3();function r(i,a){return i&&i.length?n(i,t(a,2),e):void 0}return um=r,um}var hm,ak;function gY(){if(ak)return hm;ak=1;var n=vi(),t=function(){return n.Date.now()};return hm=t,hm}var fm,sk;function pY(){if(sk)return fm;sk=1;var n=Bf(),t=Vf(),e=zf(),r=ti(),i=Ac();function a(s,o,l,c){if(!r(s))return s;o=t(o,s);for(var u=-1,h=o.length,f=h-1,d=s;d!=null&&++u<h;){var g=i(o[u]),v=l;if(g==="__proto__"||g==="constructor"||g==="prototype")return s;if(u!=f){var p=d[g];v=c?c(p,g,d):void 0,v===void 0&&(v=r(p)?p:e(o[u+1])?[]:{})}n(d,g,v),d=d[g]}return s}return fm=a,fm}var dm,ok;function vY(){if(ok)return dm;ok=1;var n=Hf(),t=pY(),e=Vf();function r(i,a,s){for(var o=-1,l=a.length,c={};++o<l;){var u=a[o],h=n(i,u);s(h,u)&&t(c,e(u,i),h)}return c}return dm=r,dm}var gm,lk;function yY(){if(lk)return gm;lk=1;var n=vY(),t=JL();function e(r,i){return n(r,i,function(a,s){return t(r,s)})}return gm=e,gm}var pm,ck;function mY(){if(ck)return pm;ck=1;var n=y3(),t=s3(),e=o3();function r(i){return e(t(i,void 0,n),i+"")}return pm=r,pm}var vm,uk;function bY(){if(uk)return vm;uk=1;var n=yY(),t=mY(),e=t(function(r,i){return r==null?{}:n(r,i)});return vm=e,vm}var ym,hk;function wY(){if(hk)return ym;hk=1;var n=Math.ceil,t=Math.max;function e(r,i,a,s){for(var o=-1,l=t(n((i-r)/(a||1)),0),c=Array(l);l--;)c[s?l:++o]=r,r+=a;return c}return ym=e,ym}var mm,fk;function xY(){if(fk)return mm;fk=1;var n=wY(),t=Yf(),e=v3();function r(i){return function(a,s,o){return o&&typeof o!="number"&&t(a,s,o)&&(s=o=void 0),a=e(a),s===void 0?(s=a,a=0):s=e(s),o=o===void 0?a<s?1:-1:e(o),n(a,s,o,i)}}return mm=r,mm}var bm,dk;function EY(){if(dk)return bm;dk=1;var n=xY(),t=n();return bm=t,bm}var wm,gk;function SY(){if(gk)return wm;gk=1;function n(t,e){var r=t.length;for(t.sort(e);r--;)t[r]=t[r].value;return t}return wm=n,wm}var xm,pk;function _Y(){if(pk)return xm;pk=1;var n=Wo();function t(e,r){if(e!==r){var i=e!==void 0,a=e===null,s=e===e,o=n(e),l=r!==void 0,c=r===null,u=r===r,h=n(r);if(!c&&!h&&!o&&e>r||o&&l&&u&&!c&&!h||a&&l&&u||!i&&u||!s)return 1;if(!a&&!o&&!h&&e<r||h&&i&&s&&!a&&!o||c&&i&&s||!l&&s||!u)return-1}return 0}return xm=t,xm}var Em,vk;function MY(){if(vk)return Em;vk=1;var n=_Y();function t(e,r,i){for(var a=-1,s=e.criteria,o=r.criteria,l=s.length,c=i.length;++a<l;){var u=n(s[a],o[a]);if(u){if(a>=c)return u;var h=i[a];return u*(h=="desc"?-1:1)}}return e.index-r.index}return Em=t,Em}var Sm,yk;function OY(){if(yk)return Sm;yk=1;var n=Wf(),t=Hf(),e=pa(),r=r3(),i=SY(),a=jf(),s=MY(),o=Xs(),l=xn();function c(u,h,f){h.length?h=n(h,function(v){return l(v)?function(p){return t(p,v.length===1?v[0]:v)}:v}):h=[o];var d=-1;h=n(h,a(e));var g=r(u,function(v,p,y){var m=n(h,function(w){return w(v)});return{criteria:m,index:++d,value:v}});return i(g,function(v,p){return s(v,p,f)})}return Sm=c,Sm}var _m,mk;function TY(){if(mk)return _m;mk=1;var n=fx(),t=OY(),e=Uf(),r=Yf(),i=e(function(a,s){if(a==null)return[];var o=s.length;return o>1&&r(a,s[0],s[1])?s=[]:o>2&&r(s[0],s[1],s[2])&&(s=[s[0]]),t(a,n(s,1),[])});return _m=i,_m}var Mm,bk;function kY(){if(bk)return Mm;bk=1;var n=KL(),t=0;function e(r){var i=++t;return n(r)+i}return Mm=e,Mm}var Om,wk;function AY(){if(wk)return Om;wk=1;function n(t,e,r){for(var i=-1,a=t.length,s=e.length,o={};++i<a;){var l=i<s?e[i]:void 0;r(o,t[i],l)}return o}return Om=n,Om}var Tm,xk;function CY(){if(xk)return Tm;xk=1;var n=Bf(),t=AY();function e(r,i){return t(r||[],i||[],n)}return Tm=e,Tm}var km,Ek;function Ze(){if(Ek)return km;Ek=1;var n;if(typeof Zw=="function")try{n={cloneDeep:HU(),constant:ox(),defaults:UU(),each:GL(),filter:t3(),find:tY(),flatten:y3(),forEach:$L(),forIn:eY(),has:e3(),isUndefined:n3(),last:nY(),map:i3(),mapValues:rY(),max:aY(),merge:hY(),min:fY(),minBy:dY(),now:gY(),pick:bY(),range:EY(),reduce:a3(),sortBy:TY(),uniqueId:kY(),values:u3(),zipObject:CY()}}catch{}return n||(n=window._),km=n,km}var Am,Sk;function PY(){if(Sk)return Am;Sk=1,Am=n;function n(){var r={};r._next=r._prev=r,this._sentinel=r}n.prototype.dequeue=function(){var r=this._sentinel,i=r._prev;if(i!==r)return t(i),i},n.prototype.enqueue=function(r){var i=this._sentinel;r._prev&&r._next&&t(r),r._next=i._next,i._next._prev=r,i._next=r,r._prev=i},n.prototype.toString=function(){for(var r=[],i=this._sentinel,a=i._prev;a!==i;)r.push(JSON.stringify(a,e)),a=a._prev;return"["+r.join(", ")+"]"};function t(r){r._prev._next=r._next,r._next._prev=r._prev,delete r._next,delete r._prev}function e(r,i){if(r!=="_next"&&r!=="_prev")return i}return Am}var Cm,_k;function NY(){if(_k)return Cm;_k=1;var n=Ze(),t=pi().Graph,e=PY();Cm=i;var r=n.constant(1);function i(c,u){if(c.nodeCount()<=1)return[];var h=o(c,u||r),f=a(h.graph,h.buckets,h.zeroIdx);return n.flatten(n.map(f,function(d){return c.outEdges(d.v,d.w)}),!0)}function a(c,u,h){for(var f=[],d=u[u.length-1],g=u[0],v;c.nodeCount();){for(;v=g.dequeue();)s(c,u,h,v);for(;v=d.dequeue();)s(c,u,h,v);if(c.nodeCount()){for(var p=u.length-2;p>0;--p)if(v=u[p].dequeue(),v){f=f.concat(s(c,u,h,v,!0));break}}}return f}function s(c,u,h,f,d){var g=d?[]:void 0;return n.forEach(c.inEdges(f.v),function(v){var p=c.edge(v),y=c.node(v.v);d&&g.push({v:v.v,w:v.w}),y.out-=p,l(u,h,y)}),n.forEach(c.outEdges(f.v),function(v){var p=c.edge(v),y=v.w,m=c.node(y);m.in-=p,l(u,h,m)}),c.removeNode(f.v),g}function o(c,u){var h=new t,f=0,d=0;n.forEach(c.nodes(),function(p){h.setNode(p,{v:p,in:0,out:0})}),n.forEach(c.edges(),function(p){var y=h.edge(p.v,p.w)||0,m=u(p),w=y+m;h.setEdge(p.v,p.w,w),d=Math.max(d,h.node(p.v).out+=m),f=Math.max(f,h.node(p.w).in+=m)});var g=n.range(d+f+3).map(function(){return new e}),v=f+1;return n.forEach(h.nodes(),function(p){l(g,v,h.node(p))}),{graph:h,buckets:g,zeroIdx:v}}function l(c,u,h){h.out?h.in?c[h.out-h.in+u].enqueue(h):c[c.length-1].enqueue(h):c[0].enqueue(h)}return Cm}var Pm,Mk;function RY(){if(Mk)return Pm;Mk=1;var n=Ze(),t=NY();Pm={run:e,undo:i};function e(a){var s=a.graph().acyclicer==="greedy"?t(a,o(a)):r(a);n.forEach(s,function(l){var c=a.edge(l);a.removeEdge(l),c.forwardName=l.name,c.reversed=!0,a.setEdge(l.w,l.v,c,n.uniqueId("rev"))});function o(l){return function(c){return l.edge(c).weight}}}function r(a){var s=[],o={},l={};function c(u){n.has(l,u)||(l[u]=!0,o[u]=!0,n.forEach(a.outEdges(u),function(h){n.has(o,h.w)?s.push(h):c(h.w)}),delete o[u])}return n.forEach(a.nodes(),c),s}function i(a){n.forEach(a.edges(),function(s){var o=a.edge(s);if(o.reversed){a.removeEdge(s);var l=o.forwardName;delete o.reversed,delete o.forwardName,a.setEdge(s.w,s.v,o,l)}})}return Pm}var Nm,Ok;function Sr(){if(Ok)return Nm;Ok=1;var n=Ze(),t=pi().Graph;Nm={addDummyNode:e,simplify:r,asNonCompoundGraph:i,successorWeights:a,predecessorWeights:s,intersectRect:o,buildLayerMatrix:l,normalizeRanks:c,removeEmptyRanks:u,addBorderNode:h,maxRank:f,partition:d,time:g,notime:v};function e(p,y,m,w){var E;do E=n.uniqueId(w);while(p.hasNode(E));return m.dummy=y,p.setNode(E,m),E}function r(p){var y=new t().setGraph(p.graph());return n.forEach(p.nodes(),function(m){y.setNode(m,p.node(m))}),n.forEach(p.edges(),function(m){var w=y.edge(m.v,m.w)||{weight:0,minlen:1},E=p.edge(m);y.setEdge(m.v,m.w,{weight:w.weight+E.weight,minlen:Math.max(w.minlen,E.minlen)})}),y}function i(p){var y=new t({multigraph:p.isMultigraph()}).setGraph(p.graph());return n.forEach(p.nodes(),function(m){p.children(m).length||y.setNode(m,p.node(m))}),n.forEach(p.edges(),function(m){y.setEdge(m,p.edge(m))}),y}function a(p){var y=n.map(p.nodes(),function(m){var w={};return n.forEach(p.outEdges(m),function(E){w[E.w]=(w[E.w]||0)+p.edge(E).weight}),w});return n.zipObject(p.nodes(),y)}function s(p){var y=n.map(p.nodes(),function(m){var w={};return n.forEach(p.inEdges(m),function(E){w[E.v]=(w[E.v]||0)+p.edge(E).weight}),w});return n.zipObject(p.nodes(),y)}function o(p,y){var m=p.x,w=p.y,E=y.x-m,S=y.y-w,O=p.width/2,k=p.height/2;if(!E&&!S)throw new Error("Not possible to find intersection inside of the rectangle");var T,C;return Math.abs(S)*O>Math.abs(E)*k?(S<0&&(k=-k),T=k*E/S,C=k):(E<0&&(O=-O),T=O,C=O*S/E),{x:m+T,y:w+C}}function l(p){var y=n.map(n.range(f(p)+1),function(){return[]});return n.forEach(p.nodes(),function(m){var w=p.node(m),E=w.rank;n.isUndefined(E)||(y[E][w.order]=m)}),y}function c(p){var y=n.min(n.map(p.nodes(),function(m){return p.node(m).rank}));n.forEach(p.nodes(),function(m){var w=p.node(m);n.has(w,"rank")&&(w.rank-=y)})}function u(p){var y=n.min(n.map(p.nodes(),function(S){return p.node(S).rank})),m=[];n.forEach(p.nodes(),function(S){var O=p.node(S).rank-y;m[O]||(m[O]=[]),m[O].push(S)});var w=0,E=p.graph().nodeRankFactor;n.forEach(m,function(S,O){n.isUndefined(S)&&O%E!==0?--w:w&&n.forEach(S,function(k){p.node(k).rank+=w})})}function h(p,y,m,w){var E={width:0,height:0};return arguments.length>=4&&(E.rank=m,E.order=w),e(p,"border",E,y)}function f(p){return n.max(n.map(p.nodes(),function(y){var m=p.node(y).rank;if(!n.isUndefined(m))return m}))}function d(p,y){var m={lhs:[],rhs:[]};return n.forEach(p,function(w){y(w)?m.lhs.push(w):m.rhs.push(w)}),m}function g(p,y){var m=n.now();try{return y()}finally{console.log(p+" time: "+(n.now()-m)+"ms")}}function v(p,y){return y()}return Nm}var Rm,Tk;function LY(){if(Tk)return Rm;Tk=1;var n=Ze(),t=Sr();Rm={run:e,undo:i};function e(a){a.graph().dummyChains=[],n.forEach(a.edges(),function(s){r(a,s)})}function r(a,s){var o=s.v,l=a.node(o).rank,c=s.w,u=a.node(c).rank,h=s.name,f=a.edge(s),d=f.labelRank;if(u!==l+1){a.removeEdge(s);var g,v,p;for(p=0,++l;l<u;++p,++l)f.points=[],v={width:0,height:0,edgeLabel:f,edgeObj:s,rank:l},g=t.addDummyNode(a,"edge",v,"_d"),l===d&&(v.width=f.width,v.height=f.height,v.dummy="edge-label",v.labelpos=f.labelpos),a.setEdge(o,g,{weight:f.weight},h),p===0&&a.graph().dummyChains.push(g),o=g;a.setEdge(o,c,{weight:f.weight},h)}}function i(a){n.forEach(a.graph().dummyChains,function(s){var o=a.node(s),l=o.edgeLabel,c;for(a.setEdge(o.edgeObj,l);o.dummy;)c=a.successors(s)[0],a.removeNode(s),l.points.push({x:o.x,y:o.y}),o.dummy==="edge-label"&&(l.x=o.x,l.y=o.y,l.width=o.width,l.height=o.height),s=c,o=a.node(s)})}return Rm}var Lm,kk;function Lh(){if(kk)return Lm;kk=1;var n=Ze();Lm={longestPath:t,slack:e};function t(r){var i={};function a(s){var o=r.node(s);if(n.has(i,s))return o.rank;i[s]=!0;var l=n.min(n.map(r.outEdges(s),function(c){return a(c.w)-r.edge(c).minlen}));return(l===Number.POSITIVE_INFINITY||l===void 0||l===null)&&(l=0),o.rank=l}n.forEach(r.sources(),a)}function e(r,i){return r.node(i.w).rank-r.node(i.v).rank-r.edge(i).minlen}return Lm}var Im,Ak;function x3(){if(Ak)return Im;Ak=1;var n=Ze(),t=pi().Graph,e=Lh().slack;Im=r;function r(o){var l=new t({directed:!1}),c=o.nodes()[0],u=o.nodeCount();l.setNode(c,{});for(var h,f;i(l,o)<u;)h=a(l,o),f=l.hasNode(h.v)?e(o,h):-e(o,h),s(l,o,f);return l}function i(o,l){function c(u){n.forEach(l.nodeEdges(u),function(h){var f=h.v,d=u===f?h.w:f;!o.hasNode(d)&&!e(l,h)&&(o.setNode(d,{}),o.setEdge(u,d,{}),c(d))})}return n.forEach(o.nodes(),c),o.nodeCount()}function a(o,l){return n.minBy(l.edges(),function(c){if(o.hasNode(c.v)!==o.hasNode(c.w))return e(l,c)})}function s(o,l,c){n.forEach(o.nodes(),function(u){l.node(u).rank+=c})}return Im}var Dm,Ck;function IY(){if(Ck)return Dm;Ck=1;var n=Ze(),t=x3(),e=Lh().slack,r=Lh().longestPath,i=pi().alg.preorder,a=pi().alg.postorder,s=Sr().simplify;Dm=o,o.initLowLimValues=h,o.initCutValues=l,o.calcCutValue=u,o.leaveEdge=d,o.enterEdge=g,o.exchangeEdges=v;function o(w){w=s(w),r(w);var E=t(w);h(E),l(E,w);for(var S,O;S=d(E);)O=g(E,w,S),v(E,w,S,O)}function l(w,E){var S=a(w,w.nodes());S=S.slice(0,S.length-1),n.forEach(S,function(O){c(w,E,O)})}function c(w,E,S){var O=w.node(S),k=O.parent;w.edge(S,k).cutvalue=u(w,E,S)}function u(w,E,S){var O=w.node(S),k=O.parent,T=!0,C=E.edge(S,k),P=0;return C||(T=!1,C=E.edge(k,S)),P=C.weight,n.forEach(E.nodeEdges(S),function(N){var L=N.v===S,D=L?N.w:N.v;if(D!==k){var G=L===T,H=E.edge(N).weight;if(P+=G?H:-H,y(w,S,D)){var W=w.edge(S,D).cutvalue;P+=G?-W:W}}}),P}function h(w,E){arguments.length<2&&(E=w.nodes()[0]),f(w,{},1,E)}function f(w,E,S,O,k){var T=S,C=w.node(O);return E[O]=!0,n.forEach(w.neighbors(O),function(P){n.has(E,P)||(S=f(w,E,S,P,O))}),C.low=T,C.lim=S++,k?C.parent=k:delete C.parent,S}function d(w){return n.find(w.edges(),function(E){return w.edge(E).cutvalue<0})}function g(w,E,S){var O=S.v,k=S.w;E.hasEdge(O,k)||(O=S.w,k=S.v);var T=w.node(O),C=w.node(k),P=T,N=!1;T.lim>C.lim&&(P=C,N=!0);var L=n.filter(E.edges(),function(D){return N===m(w,w.node(D.v),P)&&N!==m(w,w.node(D.w),P)});return n.minBy(L,function(D){return e(E,D)})}function v(w,E,S,O){var k=S.v,T=S.w;w.removeEdge(k,T),w.setEdge(O.v,O.w,{}),h(w),l(w,E),p(w,E)}function p(w,E){var S=n.find(w.nodes(),function(k){return!E.node(k).parent}),O=i(w,S);O=O.slice(1),n.forEach(O,function(k){var T=w.node(k).parent,C=E.edge(k,T),P=!1;C||(C=E.edge(T,k),P=!0),E.node(k).rank=E.node(T).rank+(P?C.minlen:-C.minlen)})}function y(w,E,S){return w.hasEdge(E,S)}function m(w,E,S){return S.low<=E.lim&&E.lim<=S.lim}return Dm}var Fm,Pk;function DY(){if(Pk)return Fm;Pk=1;var n=Lh(),t=n.longestPath,e=x3(),r=IY();Fm=i;function i(l){switch(l.graph().ranker){case"network-simplex":o(l);break;case"tight-tree":s(l);break;case"longest-path":a(l);break;default:o(l)}}var a=t;function s(l){t(l),e(l)}function o(l){r(l)}return Fm}var Bm,Nk;function FY(){if(Nk)return Bm;Nk=1;var n=Ze();Bm=t;function t(i){var a=r(i);n.forEach(i.graph().dummyChains,function(s){for(var o=i.node(s),l=o.edgeObj,c=e(i,a,l.v,l.w),u=c.path,h=c.lca,f=0,d=u[f],g=!0;s!==l.w;){if(o=i.node(s),g){for(;(d=u[f])!==h&&i.node(d).maxRank<o.rank;)f++;d===h&&(g=!1)}if(!g){for(;f<u.length-1&&i.node(d=u[f+1]).minRank<=o.rank;)f++;d=u[f]}i.setParent(s,d),s=i.successors(s)[0]}})}function e(i,a,s,o){var l=[],c=[],u=Math.min(a[s].low,a[o].low),h=Math.max(a[s].lim,a[o].lim),f,d;f=s;do f=i.parent(f),l.push(f);while(f&&(a[f].low>u||h>a[f].lim));for(d=f,f=o;(f=i.parent(f))!==d;)c.push(f);return{path:l.concat(c.reverse()),lca:d}}function r(i){var a={},s=0;function o(l){var c=s;n.forEach(i.children(l),o),a[l]={low:c,lim:s++}}return n.forEach(i.children(),o),a}return Bm}var zm,Rk;function BY(){if(Rk)return zm;Rk=1;var n=Ze(),t=Sr();zm={run:e,cleanup:s};function e(o){var l=t.addDummyNode(o,"root",{},"_root"),c=i(o),u=n.max(n.values(c))-1,h=2*u+1;o.graph().nestingRoot=l,n.forEach(o.edges(),function(d){o.edge(d).minlen*=h});var f=a(o)+1;n.forEach(o.children(),function(d){r(o,l,h,f,u,c,d)}),o.graph().nodeRankFactor=h}function r(o,l,c,u,h,f,d){var g=o.children(d);if(!g.length){d!==l&&o.setEdge(l,d,{weight:0,minlen:c});return}var v=t.addBorderNode(o,"_bt"),p=t.addBorderNode(o,"_bb"),y=o.node(d);o.setParent(v,d),y.borderTop=v,o.setParent(p,d),y.borderBottom=p,n.forEach(g,function(m){r(o,l,c,u,h,f,m);var w=o.node(m),E=w.borderTop?w.borderTop:m,S=w.borderBottom?w.borderBottom:m,O=w.borderTop?u:2*u,k=E!==S?1:h-f[d]+1;o.setEdge(v,E,{weight:O,minlen:k,nestingEdge:!0}),o.setEdge(S,p,{weight:O,minlen:k,nestingEdge:!0})}),o.parent(d)||o.setEdge(l,v,{weight:0,minlen:h+f[d]})}function i(o){var l={};function c(u,h){var f=o.children(u);f&&f.length&&n.forEach(f,function(d){c(d,h+1)}),l[u]=h}return n.forEach(o.children(),function(u){c(u,1)}),l}function a(o){return n.reduce(o.edges(),function(l,c){return l+o.edge(c).weight},0)}function s(o){var l=o.graph();o.removeNode(l.nestingRoot),delete l.nestingRoot,n.forEach(o.edges(),function(c){var u=o.edge(c);u.nestingEdge&&o.removeEdge(c)})}return zm}var jm,Lk;function zY(){if(Lk)return jm;Lk=1;var n=Ze(),t=Sr();jm=e;function e(i){function a(s){var o=i.children(s),l=i.node(s);if(o.length&&n.forEach(o,a),n.has(l,"minRank")){l.borderLeft=[],l.borderRight=[];for(var c=l.minRank,u=l.maxRank+1;c<u;++c)r(i,"borderLeft","_bl",s,l,c),r(i,"borderRight","_br",s,l,c)}}n.forEach(i.children(),a)}function r(i,a,s,o,l,c){var u={width:0,height:0,rank:c,borderType:a},h=l[a][c-1],f=t.addDummyNode(i,"border",u,s);l[a][c]=f,i.setParent(f,o),h&&i.setEdge(h,f,{weight:1})}return jm}var qm,Ik;function jY(){if(Ik)return qm;Ik=1;var n=Ze();qm={adjust:t,undo:e};function t(c){var u=c.graph().rankdir.toLowerCase();(u==="lr"||u==="rl")&&r(c)}function e(c){var u=c.graph().rankdir.toLowerCase();(u==="bt"||u==="rl")&&a(c),(u==="lr"||u==="rl")&&(o(c),r(c))}function r(c){n.forEach(c.nodes(),function(u){i(c.node(u))}),n.forEach(c.edges(),function(u){i(c.edge(u))})}function i(c){var u=c.width;c.width=c.height,c.height=u}function a(c){n.forEach(c.nodes(),function(u){s(c.node(u))}),n.forEach(c.edges(),function(u){var h=c.edge(u);n.forEach(h.points,s),n.has(h,"y")&&s(h)})}function s(c){c.y=-c.y}function o(c){n.forEach(c.nodes(),function(u){l(c.node(u))}),n.forEach(c.edges(),function(u){var h=c.edge(u);n.forEach(h.points,l),n.has(h,"x")&&l(h)})}function l(c){var u=c.x;c.x=c.y,c.y=u}return qm}var $m,Dk;function qY(){if(Dk)return $m;Dk=1;var n=Ze();$m=t;function t(e){var r={},i=n.filter(e.nodes(),function(c){return!e.children(c).length}),a=n.max(n.map(i,function(c){return e.node(c).rank})),s=n.map(n.range(a+1),function(){return[]});function o(c){if(!n.has(r,c)){r[c]=!0;var u=e.node(c);s[u.rank].push(c),n.forEach(e.successors(c),o)}}var l=n.sortBy(i,function(c){return e.node(c).rank});return n.forEach(l,o),s}return $m}var Gm,Fk;function $Y(){if(Fk)return Gm;Fk=1;var n=Ze();Gm=t;function t(r,i){for(var a=0,s=1;s<i.length;++s)a+=e(r,i[s-1],i[s]);return a}function e(r,i,a){for(var s=n.zipObject(a,n.map(a,function(f,d){return d})),o=n.flatten(n.map(i,function(f){return n.sortBy(n.map(r.outEdges(f),function(d){return{pos:s[d.w],weight:r.edge(d).weight}}),"pos")}),!0),l=1;l<a.length;)l<<=1;var c=2*l-1;l-=1;var u=n.map(new Array(c),function(){return 0}),h=0;return n.forEach(o.forEach(function(f){var d=f.pos+l;u[d]+=f.weight;for(var g=0;d>0;)d%2&&(g+=u[d+1]),d=d-1>>1,u[d]+=f.weight;h+=f.weight*g})),h}return Gm}var Wm,Bk;function GY(){if(Bk)return Wm;Bk=1;var n=Ze();Wm=t;function t(e,r){return n.map(r,function(i){var a=e.inEdges(i);if(a.length){var s=n.reduce(a,function(o,l){var c=e.edge(l),u=e.node(l.v);return{sum:o.sum+c.weight*u.order,weight:o.weight+c.weight}},{sum:0,weight:0});return{v:i,barycenter:s.sum/s.weight,weight:s.weight}}else return{v:i}})}return Wm}var Vm,zk;function WY(){if(zk)return Vm;zk=1;var n=Ze();Vm=t;function t(i,a){var s={};n.forEach(i,function(l,c){var u=s[l.v]={indegree:0,in:[],out:[],vs:[l.v],i:c};n.isUndefined(l.barycenter)||(u.barycenter=l.barycenter,u.weight=l.weight)}),n.forEach(a.edges(),function(l){var c=s[l.v],u=s[l.w];!n.isUndefined(c)&&!n.isUndefined(u)&&(u.indegree++,c.out.push(s[l.w]))});var o=n.filter(s,function(l){return!l.indegree});return e(o)}function e(i){var a=[];function s(c){return function(u){u.merged||(n.isUndefined(u.barycenter)||n.isUndefined(c.barycenter)||u.barycenter>=c.barycenter)&&r(c,u)}}function o(c){return function(u){u.in.push(c),--u.indegree===0&&i.push(u)}}for(;i.length;){var l=i.pop();a.push(l),n.forEach(l.in.reverse(),s(l)),n.forEach(l.out,o(l))}return n.map(n.filter(a,function(c){return!c.merged}),function(c){return n.pick(c,["vs","i","barycenter","weight"])})}function r(i,a){var s=0,o=0;i.weight&&(s+=i.barycenter*i.weight,o+=i.weight),a.weight&&(s+=a.barycenter*a.weight,o+=a.weight),i.vs=a.vs.concat(i.vs),i.barycenter=s/o,i.weight=o,i.i=Math.min(a.i,i.i),a.merged=!0}return Vm}var Hm,jk;function VY(){if(jk)return Hm;jk=1;var n=Ze(),t=Sr();Hm=e;function e(a,s){var o=t.partition(a,function(v){return n.has(v,"barycenter")}),l=o.lhs,c=n.sortBy(o.rhs,function(v){return-v.i}),u=[],h=0,f=0,d=0;l.sort(i(!!s)),d=r(u,c,d),n.forEach(l,function(v){d+=v.vs.length,u.push(v.vs),h+=v.barycenter*v.weight,f+=v.weight,d=r(u,c,d)});var g={vs:n.flatten(u,!0)};return f&&(g.barycenter=h/f,g.weight=f),g}function r(a,s,o){for(var l;s.length&&(l=n.last(s)).i<=o;)s.pop(),a.push(l.vs),o++;return o}function i(a){return function(s,o){return s.barycenter<o.barycenter?-1:s.barycenter>o.barycenter?1:a?o.i-s.i:s.i-o.i}}return Hm}var Um,qk;function HY(){if(qk)return Um;qk=1;var n=Ze(),t=GY(),e=WY(),r=VY();Um=i;function i(o,l,c,u){var h=o.children(l),f=o.node(l),d=f?f.borderLeft:void 0,g=f?f.borderRight:void 0,v={};d&&(h=n.filter(h,function(S){return S!==d&&S!==g}));var p=t(o,h);n.forEach(p,function(S){if(o.children(S.v).length){var O=i(o,S.v,c,u);v[S.v]=O,n.has(O,"barycenter")&&s(S,O)}});var y=e(p,c);a(y,v);var m=r(y,u);if(d&&(m.vs=n.flatten([d,m.vs,g],!0),o.predecessors(d).length)){var w=o.node(o.predecessors(d)[0]),E=o.node(o.predecessors(g)[0]);n.has(m,"barycenter")||(m.barycenter=0,m.weight=0),m.barycenter=(m.barycenter*m.weight+w.order+E.order)/(m.weight+2),m.weight+=2}return m}function a(o,l){n.forEach(o,function(c){c.vs=n.flatten(c.vs.map(function(u){return l[u]?l[u].vs:u}),!0)})}function s(o,l){n.isUndefined(o.barycenter)?(o.barycenter=l.barycenter,o.weight=l.weight):(o.barycenter=(o.barycenter*o.weight+l.barycenter*l.weight)/(o.weight+l.weight),o.weight+=l.weight)}return Um}var Ym,$k;function UY(){if($k)return Ym;$k=1;var n=Ze(),t=pi().Graph;Ym=e;function e(i,a,s){var o=r(i),l=new t({compound:!0}).setGraph({root:o}).setDefaultNodeLabel(function(c){return i.node(c)});return n.forEach(i.nodes(),function(c){var u=i.node(c),h=i.parent(c);(u.rank===a||u.minRank<=a&&a<=u.maxRank)&&(l.setNode(c),l.setParent(c,h||o),n.forEach(i[s](c),function(f){var d=f.v===c?f.w:f.v,g=l.edge(d,c),v=n.isUndefined(g)?0:g.weight;l.setEdge(d,c,{weight:i.edge(f).weight+v})}),n.has(u,"minRank")&&l.setNode(c,{borderLeft:u.borderLeft[a],borderRight:u.borderRight[a]}))}),l}function r(i){for(var a;i.hasNode(a=n.uniqueId("_root")););return a}return Ym}var Xm,Gk;function YY(){if(Gk)return Xm;Gk=1;var n=Ze();Xm=t;function t(e,r,i){var a={},s;n.forEach(i,function(o){for(var l=e.parent(o),c,u;l;){if(c=e.parent(l),c?(u=a[c],a[c]=l):(u=s,s=l),u&&u!==l){r.setEdge(u,l);return}l=c}})}return Xm}var Km,Wk;function XY(){if(Wk)return Km;Wk=1;var n=Ze(),t=qY(),e=$Y(),r=HY(),i=UY(),a=YY(),s=pi().Graph,o=Sr();Km=l;function l(f){var d=o.maxRank(f),g=c(f,n.range(1,d+1),"inEdges"),v=c(f,n.range(d-1,-1,-1),"outEdges"),p=t(f);h(f,p);for(var y=Number.POSITIVE_INFINITY,m,w=0,E=0;E<4;++w,++E){u(w%2?g:v,w%4>=2),p=o.buildLayerMatrix(f);var S=e(f,p);S<y&&(E=0,m=n.cloneDeep(p),y=S)}h(f,m)}function c(f,d,g){return n.map(d,function(v){return i(f,v,g)})}function u(f,d){var g=new s;n.forEach(f,function(v){var p=v.graph().root,y=r(v,p,g,d);n.forEach(y.vs,function(m,w){v.node(m).order=w}),a(v,g,y.vs)})}function h(f,d){n.forEach(d,function(g){n.forEach(g,function(v,p){f.node(v).order=p})})}return Km}var Zm,Vk;function KY(){if(Vk)return Zm;Vk=1;var n=Ze(),t=pi().Graph,e=Sr();Zm={positionX:g,findType1Conflicts:r,findType2Conflicts:i,addConflict:s,hasConflict:o,verticalAlignment:l,horizontalCompaction:c,alignCoordinates:f,findSmallestWidthAlignment:h,balance:d};function r(y,m){var w={};function E(S,O){var k=0,T=0,C=S.length,P=n.last(O);return n.forEach(O,function(N,L){var D=a(y,N),G=D?y.node(D).order:C;(D||N===P)&&(n.forEach(O.slice(T,L+1),function(H){n.forEach(y.predecessors(H),function(W){var q=y.node(W),z=q.order;(z<k||G<z)&&!(q.dummy&&y.node(H).dummy)&&s(w,W,H)})}),T=L+1,k=G)}),O}return n.reduce(m,E),w}function i(y,m){var w={};function E(O,k,T,C,P){var N;n.forEach(n.range(k,T),function(L){N=O[L],y.node(N).dummy&&n.forEach(y.predecessors(N),function(D){var G=y.node(D);G.dummy&&(G.order<C||G.order>P)&&s(w,D,N)})})}function S(O,k){var T=-1,C,P=0;return n.forEach(k,function(N,L){if(y.node(N).dummy==="border"){var D=y.predecessors(N);D.length&&(C=y.node(D[0]).order,E(k,P,L,T,C),P=L,T=C)}E(k,P,k.length,C,O.length)}),k}return n.reduce(m,S),w}function a(y,m){if(y.node(m).dummy)return n.find(y.predecessors(m),function(w){return y.node(w).dummy})}function s(y,m,w){if(m>w){var E=m;m=w,w=E}var S=y[m];S||(y[m]=S={}),S[w]=!0}function o(y,m,w){if(m>w){var E=m;m=w,w=E}return n.has(y[m],w)}function l(y,m,w,E){var S={},O={},k={};return n.forEach(m,function(T){n.forEach(T,function(C,P){S[C]=C,O[C]=C,k[C]=P})}),n.forEach(m,function(T){var C=-1;n.forEach(T,function(P){var N=E(P);if(N.length){N=n.sortBy(N,function(W){return k[W]});for(var L=(N.length-1)/2,D=Math.floor(L),G=Math.ceil(L);D<=G;++D){var H=N[D];O[P]===P&&C<k[H]&&!o(w,P,H)&&(O[H]=P,O[P]=S[P]=S[H],C=k[H])}}})}),{root:S,align:O}}function c(y,m,w,E,S){var O={},k=u(y,m,w,S),T=S?"borderLeft":"borderRight";function C(L,D){for(var G=k.nodes(),H=G.pop(),W={};H;)W[H]?L(H):(W[H]=!0,G.push(H),G=G.concat(D(H))),H=G.pop()}function P(L){O[L]=k.inEdges(L).reduce(function(D,G){return Math.max(D,O[G.v]+k.edge(G))},0)}function N(L){var D=k.outEdges(L).reduce(function(H,W){return Math.min(H,O[W.w]-k.edge(W))},Number.POSITIVE_INFINITY),G=y.node(L);D!==Number.POSITIVE_INFINITY&&G.borderType!==T&&(O[L]=Math.max(O[L],D))}return C(P,k.predecessors.bind(k)),C(N,k.successors.bind(k)),n.forEach(E,function(L){O[L]=O[w[L]]}),O}function u(y,m,w,E){var S=new t,O=y.graph(),k=v(O.nodesep,O.edgesep,E);return n.forEach(m,function(T){var C;n.forEach(T,function(P){var N=w[P];if(S.setNode(N),C){var L=w[C],D=S.edge(L,N);S.setEdge(L,N,Math.max(k(y,P,C),D||0))}C=P})}),S}function h(y,m){return n.minBy(n.values(m),function(w){var E=Number.NEGATIVE_INFINITY,S=Number.POSITIVE_INFINITY;return n.forIn(w,function(O,k){var T=p(y,k)/2;E=Math.max(O+T,E),S=Math.min(O-T,S)}),E-S})}function f(y,m){var w=n.values(m),E=n.min(w),S=n.max(w);n.forEach(["u","d"],function(O){n.forEach(["l","r"],function(k){var T=O+k,C=y[T],P;if(C!==m){var N=n.values(C);P=k==="l"?E-n.min(N):S-n.max(N),P&&(y[T]=n.mapValues(C,function(L){return L+P}))}})})}function d(y,m){return n.mapValues(y.ul,function(w,E){if(m)return y[m.toLowerCase()][E];var S=n.sortBy(n.map(y,E));return(S[1]+S[2])/2})}function g(y){var m=e.buildLayerMatrix(y),w=n.merge(r(y,m),i(y,m)),E={},S;n.forEach(["u","d"],function(k){S=k==="u"?m:n.values(m).reverse(),n.forEach(["l","r"],function(T){T==="r"&&(S=n.map(S,function(L){return n.values(L).reverse()}));var C=(k==="u"?y.predecessors:y.successors).bind(y),P=l(y,S,w,C),N=c(y,S,P.root,P.align,T==="r");T==="r"&&(N=n.mapValues(N,function(L){return-L})),E[k+T]=N})});var O=h(y,E);return f(E,O),d(E,y.graph().align)}function v(y,m,w){return function(E,S,O){var k=E.node(S),T=E.node(O),C=0,P;if(C+=k.width/2,n.has(k,"labelpos"))switch(k.labelpos.toLowerCase()){case"l":P=-k.width/2;break;case"r":P=k.width/2;break}if(P&&(C+=w?P:-P),P=0,C+=(k.dummy?m:y)/2,C+=(T.dummy?m:y)/2,C+=T.width/2,n.has(T,"labelpos"))switch(T.labelpos.toLowerCase()){case"l":P=T.width/2;break;case"r":P=-T.width/2;break}return P&&(C+=w?P:-P),P=0,C}}function p(y,m){return y.node(m).width}return Zm}var Jm,Hk;function ZY(){if(Hk)return Jm;Hk=1;var n=Ze(),t=Sr(),e=KY().positionX;Jm=r;function r(a){a=t.asNonCompoundGraph(a),i(a),n.forEach(e(a),function(s,o){a.node(o).x=s})}function i(a){var s=t.buildLayerMatrix(a),o=a.graph().ranksep,l=0;n.forEach(s,function(c){var u=n.max(n.map(c,function(h){return a.node(h).height}));n.forEach(c,function(h){a.node(h).y=l+u/2}),l+=u+o})}return Jm}var Qm,Uk;function JY(){if(Uk)return Qm;Uk=1;var n=Ze(),t=RY(),e=LY(),r=DY(),i=Sr().normalizeRanks,a=FY(),s=Sr().removeEmptyRanks,o=BY(),l=zY(),c=jY(),u=XY(),h=ZY(),f=Sr(),d=pi().Graph;Qm=g;function g(J,V){var nt=V&&V.debugTiming?f.time:f.notime;nt("layout",function(){var dt=nt("  buildLayoutGraph",function(){return C(J)});nt("  runLayout",function(){v(dt,nt)}),nt("  updateInputGraph",function(){p(J,dt)})})}function v(J,V){V("    makeSpaceForEdgeLabels",function(){P(J)}),V("    removeSelfEdges",function(){Z(J)}),V("    acyclic",function(){t.run(J)}),V("    nestingGraph.run",function(){o.run(J)}),V("    rank",function(){r(f.asNonCompoundGraph(J))}),V("    injectEdgeLabelProxies",function(){N(J)}),V("    removeEmptyRanks",function(){s(J)}),V("    nestingGraph.cleanup",function(){o.cleanup(J)}),V("    normalizeRanks",function(){i(J)}),V("    assignRankMinMax",function(){L(J)}),V("    removeEdgeLabelProxies",function(){D(J)}),V("    normalize.run",function(){e.run(J)}),V("    parentDummyChains",function(){a(J)}),V("    addBorderSegments",function(){l(J)}),V("    order",function(){u(J)}),V("    insertSelfEdges",function(){at(J)}),V("    adjustCoordinateSystem",function(){c.adjust(J)}),V("    position",function(){h(J)}),V("    positionSelfEdges",function(){ft(J)}),V("    removeBorderNodes",function(){z(J)}),V("    normalize.undo",function(){e.undo(J)}),V("    fixupEdgeLabelCoords",function(){W(J)}),V("    undoCoordinateSystem",function(){c.undo(J)}),V("    translateGraph",function(){G(J)}),V("    assignNodeIntersects",function(){H(J)}),V("    reversePoints",function(){q(J)}),V("    acyclic.undo",function(){t.undo(J)})}function p(J,V){n.forEach(J.nodes(),function(nt){var dt=J.node(nt),Nt=V.node(nt);dt&&(dt.x=Nt.x,dt.y=Nt.y,V.children(nt).length&&(dt.width=Nt.width,dt.height=Nt.height))}),n.forEach(J.edges(),function(nt){var dt=J.edge(nt),Nt=V.edge(nt);dt.points=Nt.points,n.has(Nt,"x")&&(dt.x=Nt.x,dt.y=Nt.y)}),J.graph().width=V.graph().width,J.graph().height=V.graph().height}var y=["nodesep","edgesep","ranksep","marginx","marginy"],m={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},w=["acyclicer","ranker","rankdir","align"],E=["width","height"],S={width:0,height:0},O=["minlen","weight","width","height","labeloffset"],k={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},T=["labelpos"];function C(J){var V=new d({multigraph:!0,compound:!0}),nt=Gt(J.graph());return V.setGraph(n.merge({},m,ct(nt,y),n.pick(nt,w))),n.forEach(J.nodes(),function(dt){var Nt=Gt(J.node(dt));V.setNode(dt,n.defaults(ct(Nt,E),S)),V.setParent(dt,J.parent(dt))}),n.forEach(J.edges(),function(dt){var Nt=Gt(J.edge(dt));V.setEdge(dt,n.merge({},k,ct(Nt,O),n.pick(Nt,T)))}),V}function P(J){var V=J.graph();V.ranksep/=2,n.forEach(J.edges(),function(nt){var dt=J.edge(nt);dt.minlen*=2,dt.labelpos.toLowerCase()!=="c"&&(V.rankdir==="TB"||V.rankdir==="BT"?dt.width+=dt.labeloffset:dt.height+=dt.labeloffset)})}function N(J){n.forEach(J.edges(),function(V){var nt=J.edge(V);if(nt.width&&nt.height){var dt=J.node(V.v),Nt=J.node(V.w),Wt={rank:(Nt.rank-dt.rank)/2+dt.rank,e:V};f.addDummyNode(J,"edge-proxy",Wt,"_ep")}})}function L(J){var V=0;n.forEach(J.nodes(),function(nt){var dt=J.node(nt);dt.borderTop&&(dt.minRank=J.node(dt.borderTop).rank,dt.maxRank=J.node(dt.borderBottom).rank,V=n.max(V,dt.maxRank))}),J.graph().maxRank=V}function D(J){n.forEach(J.nodes(),function(V){var nt=J.node(V);nt.dummy==="edge-proxy"&&(J.edge(nt.e).labelRank=nt.rank,J.removeNode(V))})}function G(J){var V=Number.POSITIVE_INFINITY,nt=0,dt=Number.POSITIVE_INFINITY,Nt=0,Wt=J.graph(),Kt=Wt.marginx||0,qe=Wt.marginy||0;function U(X){var rt=X.x,lt=X.y,vt=X.width,ut=X.height;V=Math.min(V,rt-vt/2),nt=Math.max(nt,rt+vt/2),dt=Math.min(dt,lt-ut/2),Nt=Math.max(Nt,lt+ut/2)}n.forEach(J.nodes(),function(X){U(J.node(X))}),n.forEach(J.edges(),function(X){var rt=J.edge(X);n.has(rt,"x")&&U(rt)}),V-=Kt,dt-=qe,n.forEach(J.nodes(),function(X){var rt=J.node(X);rt.x-=V,rt.y-=dt}),n.forEach(J.edges(),function(X){var rt=J.edge(X);n.forEach(rt.points,function(lt){lt.x-=V,lt.y-=dt}),n.has(rt,"x")&&(rt.x-=V),n.has(rt,"y")&&(rt.y-=dt)}),Wt.width=nt-V+Kt,Wt.height=Nt-dt+qe}function H(J){n.forEach(J.edges(),function(V){var nt=J.edge(V),dt=J.node(V.v),Nt=J.node(V.w),Wt,Kt;nt.points?(Wt=nt.points[0],Kt=nt.points[nt.points.length-1]):(nt.points=[],Wt=Nt,Kt=dt),nt.points.unshift(f.intersectRect(dt,Wt)),nt.points.push(f.intersectRect(Nt,Kt))})}function W(J){n.forEach(J.edges(),function(V){var nt=J.edge(V);if(n.has(nt,"x"))switch((nt.labelpos==="l"||nt.labelpos==="r")&&(nt.width-=nt.labeloffset),nt.labelpos){case"l":nt.x-=nt.width/2+nt.labeloffset;break;case"r":nt.x+=nt.width/2+nt.labeloffset;break}})}function q(J){n.forEach(J.edges(),function(V){var nt=J.edge(V);nt.reversed&&nt.points.reverse()})}function z(J){n.forEach(J.nodes(),function(V){if(J.children(V).length){var nt=J.node(V),dt=J.node(nt.borderTop),Nt=J.node(nt.borderBottom),Wt=J.node(n.last(nt.borderLeft)),Kt=J.node(n.last(nt.borderRight));nt.width=Math.abs(Kt.x-Wt.x),nt.height=Math.abs(Nt.y-dt.y),nt.x=Wt.x+nt.width/2,nt.y=dt.y+nt.height/2}}),n.forEach(J.nodes(),function(V){J.node(V).dummy==="border"&&J.removeNode(V)})}function Z(J){n.forEach(J.edges(),function(V){if(V.v===V.w){var nt=J.node(V.v);nt.selfEdges||(nt.selfEdges=[]),nt.selfEdges.push({e:V,label:J.edge(V)}),J.removeEdge(V)}})}function at(J){var V=f.buildLayerMatrix(J);n.forEach(V,function(nt){var dt=0;n.forEach(nt,function(Nt,Wt){var Kt=J.node(Nt);Kt.order=Wt+dt,n.forEach(Kt.selfEdges,function(qe){f.addDummyNode(J,"selfedge",{width:qe.label.width,height:qe.label.height,rank:Kt.rank,order:Wt+ ++dt,e:qe.e,label:qe.label},"_se")}),delete Kt.selfEdges})})}function ft(J){n.forEach(J.nodes(),function(V){var nt=J.node(V);if(nt.dummy==="selfedge"){var dt=J.node(nt.e.v),Nt=dt.x+dt.width/2,Wt=dt.y,Kt=nt.x-Nt,qe=dt.height/2;J.setEdge(nt.e,nt.label),J.removeNode(V),nt.label.points=[{x:Nt+2*Kt/3,y:Wt-qe},{x:Nt+5*Kt/6,y:Wt-qe},{x:Nt+Kt,y:Wt},{x:Nt+5*Kt/6,y:Wt+qe},{x:Nt+2*Kt/3,y:Wt+qe}],nt.label.x=nt.x,nt.label.y=nt.y}})}function ct(J,V){return n.mapValues(n.pick(J,V),Number)}function Gt(J){var V={};return n.forEach(J,function(nt,dt){V[dt.toLowerCase()]=nt}),V}return Qm}var t1,Yk;function QY(){if(Yk)return t1;Yk=1;var n=Ze(),t=Sr(),e=pi().Graph;t1={debugOrdering:r};function r(i){var a=t.buildLayerMatrix(i),s=new e({compound:!0,multigraph:!0}).setGraph({});return n.forEach(i.nodes(),function(o){s.setNode(o,{label:o}),s.setParent(o,"layer"+i.node(o).rank)}),n.forEach(i.edges(),function(o){s.setEdge(o.v,o.w,{},o.name)}),n.forEach(a,function(o,l){var c="layer"+l;s.setNode(c,{rank:"same"}),n.reduce(o,function(u,h){return s.setEdge(u,h,{style:"invis"}),h})}),s}return t1}var e1,Xk;function tX(){return Xk||(Xk=1,e1="0.8.5"),e1}var n1,Kk;function eX(){return Kk||(Kk=1,n1={graphlib:pi(),layout:JY(),debug:QY(),util:{time:Sr().time,notime:Sr().notime},version:tX()}),n1}var E3=eX();const nX=lc(E3);class Xf{constructor(t){this.id="dagre",this.options={},Object.assign(this.options,Xf.defaultOptions,t)}execute(t,e){return oe(this,void 0,void 0,function*(){return this.genericDagreLayout(!1,t,Object.assign(Object.assign({},this.options),e))})}assign(t,e){return oe(this,void 0,void 0,function*(){yield this.genericDagreLayout(!0,t,Object.assign(Object.assign({},this.options),e))})}genericDagreLayout(t,e,r){return oe(this,void 0,void 0,function*(){const{nodeSize:i}=r,a=new E3.graphlib.Graph;a.setGraph(r),a.setDefaultEdgeLabel(()=>({}));const s=e.getAllNodes(),o=e.getAllEdges();[...s,...o].some(({id:c})=>Lt(c))&&console.error("Dagre layout only support string id, it will convert number to string."),e.getAllNodes().forEach(c=>{const{id:u}=c,h=Object.assign({},c.data);if(i!==void 0){const[f,d]=_c(zt(i)?i(c):i);Object.assign(h,{width:f,height:d})}a.setNode(u.toString(),h)}),e.getAllEdges().forEach(({id:c,source:u,target:h})=>{a.setEdge(u.toString(),h.toString(),{id:c})}),nX.layout(a);const l={nodes:[],edges:[]};return a.nodes().forEach(c=>{const u=a.node(c);l.nodes.push({id:c,data:u}),t&&e.mergeNodeData(c,u)}),a.edges().forEach(c=>{const u=a.edge(c),{id:h}=u,f=an(u,["id"]),{v:d,w:g}=c;l.edges.push({id:h,source:d,target:g,data:f}),t&&e.mergeEdgeData(h,f)}),l})}}Xf.defaultOptions={};class px{constructor(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}distanceTo(t){const e=this.rx-t.rx,r=this.ry-t.ry;return Math.hypot(e,r)}setPos(t,e){this.rx=t,this.ry=e}resetForce(){this.fx=0,this.fy=0}addForce(t){const e=t.rx-this.rx,r=t.ry-this.ry;let i=Math.hypot(e,r);i=i<1e-4?1e-4:i;const a=this.g*(this.degree+1)*(t.degree+1)/i;this.fx+=a*e/i,this.fy+=a*r/i}in(t){return t.contains(this.rx,this.ry)}add(t){const e=this.mass+t.mass,r=(this.rx*this.mass+t.rx*t.mass)/e,i=(this.ry*this.mass+t.ry*t.mass)/e,a=this.degree+t.degree,s={rx:r,ry:i,mass:e,degree:a};return new px(s)}}class go{constructor(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}getLength(){return this.length}contains(t,e){const r=this.length/2;return t<=this.xmid+r&&t>=this.xmid-r&&e<=this.ymid+r&&e>=this.ymid-r}NW(){const t=this.xmid-this.length/4,e=this.ymid+this.length/4,r=this.length/2,i={xmid:t,ymid:e,length:r};return new go(i)}NE(){const t=this.xmid+this.length/4,e=this.ymid+this.length/4,r=this.length/2,i={xmid:t,ymid:e,length:r};return new go(i)}SW(){const t=this.xmid-this.length/4,e=this.ymid-this.length/4,r=this.length/2,i={xmid:t,ymid:e,length:r};return new go(i)}SE(){const t=this.xmid+this.length/4,e=this.ymid-this.length/4,r=this.length/2,i={xmid:t,ymid:e,length:r};return new go(i)}}class po{constructor(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,t!=null&&(this.quad=t)}insert(t){if(this.body==null){this.body=t;return}this._isExternal()?(this.quad&&(this.NW=new po(this.quad.NW()),this.NE=new po(this.quad.NE()),this.SW=new po(this.quad.SW()),this.SE=new po(this.quad.SE())),this._putBody(this.body),this._putBody(t),this.body=this.body.add(t)):(this.body=this.body.add(t),this._putBody(t))}_putBody(t){this.quad&&(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))}_isExternal(){return this.NW==null&&this.NE==null&&this.SW==null&&this.SE==null}updateForce(t){if(!(this.body==null||t===this.body))if(this._isExternal())t.addForce(this.body);else{const e=this.quad?this.quad.getLength():0,r=this.body.distanceTo(t);e/r<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t))}}}const rX={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1};class iX{constructor(t={}){this.options=t,this.id="forceAtlas2",this.options=Object.assign(Object.assign({},rX),t)}execute(t,e){return oe(this,void 0,void 0,function*(){return this.genericForceAtlas2Layout(!1,t,e)})}assign(t,e){return oe(this,void 0,void 0,function*(){yield this.genericForceAtlas2Layout(!0,t,e)})}genericForceAtlas2Layout(t,e,r){return oe(this,void 0,void 0,function*(){const i=e.getAllEdges(),a=e.getAllNodes(),s=this.formatOptions(r,a.length),{width:o,height:l,prune:c,maxIteration:u,nodeSize:h,center:f}=s;if(!(a!=null&&a.length)||a.length===1)return Vs(e,t,f);const d=a.map(y=>Br(y,[o,l])),g=i.filter(y=>{const{source:m,target:w}=y;return m!==w}),v=new kn({nodes:d,edges:g}),p=this.getSizes(v,h);if(this.run(v,e,u,p,t,s),c){for(let m=0;m<g.length;m+=1){const{source:w,target:E}=g[m],S=v.getDegree(w),O=v.getDegree(w);if(S<=1){const k=v.getNode(E);v.mergeNodeData(w,{x:k.data.x,y:k.data.y})}else if(O<=1){const k=v.getNode(w);v.mergeNodeData(E,{x:k.data.x,y:k.data.y})}}const y=Object.assign(Object.assign({},s),{prune:!1,barnesHut:!1});this.run(v,e,100,p,t,y)}return{nodes:d,edges:i}})}getSizes(t,e){const r=t.getAllNodes(),i={};for(let a=0;a<r.length;a+=1){const s=r[a];i[s.id]=Yw(e,void 0)(s)}return i}formatOptions(t={},e){const r=Object.assign(Object.assign({},this.options),t),{center:i,width:a,height:s,barnesHut:o,prune:l,maxIteration:c,kr:u,kg:h}=r;return r.width=!a&&typeof window<"u"?window.innerWidth:a,r.height=!s&&typeof window<"u"?window.innerHeight:s,r.center=i||[r.width/2,r.height/2],o===void 0&&e>250&&(r.barnesHut=!0),l===void 0&&e>100&&(r.prune=!0),c===0&&!l?(r.maxIteration=250,e<=200&&e>100?r.maxIteration=1e3:e>200&&(r.maxIteration=1200)):c===0&&l&&(r.maxIteration=100,e<=200&&e>100?r.maxIteration=500:e>200&&(r.maxIteration=950)),u||(r.kr=50,e>100&&e<=500?r.kr=20:e>500&&(r.kr=1)),h||(r.kg=20,e>100&&e<=500?r.kg=10:e>500&&(r.kg=1)),r}run(t,e,r,i,a,s){const{kr:o,barnesHut:l,onTick:c}=s,u=t.getAllNodes();let h=0,f=r;const d={},g={},v={};for(let p=0;p<u.length;p+=1){const{data:y,id:m}=u[p];if(d[m]=[0,0],l){const w={id:p,rx:y.x,ry:y.y,mass:1,g:o,degree:t.getDegree(m)};v[m]=new px(w)}}for(;f>0;)h=this.oneStep(t,{iter:f,preventOverlapIters:50,krPrime:100,sg:h,forces:d,preForces:g,bodies:v,sizes:i},s),f--,c==null||c({nodes:u,edges:e.getAllEdges()});return t}oneStep(t,e,r){const{iter:i,preventOverlapIters:a,krPrime:s,sg:o,preForces:l,bodies:c,sizes:u}=e;let{forces:h}=e;const{preventOverlap:f,barnesHut:d}=r,g=t.getAllNodes();for(let v=0;v<g.length;v+=1){const{id:p}=g[v];l[p]=[...h[p]],h[p]=[0,0]}return h=this.getAttrForces(t,i,a,u,h,r),d&&(f&&i>a||!f)?h=this.getOptRepGraForces(t,h,c,r):h=this.getRepGraForces(t,i,a,h,s,u,r),this.updatePos(t,h,l,o,r)}getAttrForces(t,e,r,i,a,s){const{preventOverlap:o,dissuadeHubs:l,mode:c,prune:u}=s,h=t.getAllEdges();for(let f=0;f<h.length;f+=1){const{source:d,target:g}=h[f],v=t.getNode(d),p=t.getNode(g),y=t.getDegree(d),m=t.getDegree(g);if(u&&(y<=1||m<=1))continue;const w=[p.data.x-v.data.x,p.data.y-v.data.y];let E=Math.hypot(w[0],w[1]);E=E<1e-4?1e-4:E,w[0]=w[0]/E,w[1]=w[1]/E,o&&e<r&&(E=E-i[d]-i[g]);let S=E,O=S;c==="linlog"&&(S=Math.log(1+E),O=S),l&&(S=E/y,O=E/m),o&&e<r&&E<=0?(S=0,O=0):o&&e<r&&E>0&&(S=E,O=E),a[d][0]+=S*w[0],a[g][0]-=O*w[0],a[d][1]+=S*w[1],a[g][1]-=O*w[1]}return a}getOptRepGraForces(t,e,r,i){const{kg:a,center:s,prune:o}=i,l=t.getAllNodes(),c=l.length;let u=9e10,h=-9e10,f=9e10,d=-9e10;for(let m=0;m<c;m+=1){const{id:w,data:E}=l[m];o&&t.getDegree(w)<=1||(r[w].setPos(E.x,E.y),E.x>=h&&(h=E.x),E.x<=u&&(u=E.x),E.y>=d&&(d=E.y),E.y<=f&&(f=E.y))}const g=Math.max(h-u,d-f),v={xmid:(h+u)/2,ymid:(d+f)/2,length:g,massCenter:s,mass:c},p=new go(v),y=new po(p);for(let m=0;m<c;m+=1){const{id:w}=l[m];o&&t.getDegree(w)<=1||r[w].in(p)&&y.insert(r[w])}for(let m=0;m<c;m+=1){const{id:w,data:E}=l[m],S=t.getDegree(w);if(o&&S<=1)continue;r[w].resetForce(),y.updateForce(r[w]),e[w][0]-=r[w].fx,e[w][1]-=r[w].fy;const O=[E.x-s[0],E.y-s[1]];let k=Math.hypot(O[0],O[1]);k=k<1e-4?1e-4:k,O[0]=O[0]/k,O[1]=O[1]/k;const T=a*(S+1);e[w][0]-=T*O[0],e[w][1]-=T*O[1]}return e}getRepGraForces(t,e,r,i,a,s,o){const{preventOverlap:l,kr:c,kg:u,center:h,prune:f}=o,d=t.getAllNodes(),g=d.length;for(let v=0;v<g;v+=1){const p=d[v],y=t.getDegree(p.id);for(let S=v+1;S<g;S+=1){const O=d[S],k=t.getDegree(O.id);if(f&&(y<=1||k<=1))continue;const T=[O.data.x-p.data.x,O.data.y-p.data.y];let C=Math.hypot(T[0],T[1]);C=C<1e-4?1e-4:C,T[0]=T[0]/C,T[1]=T[1]/C,l&&e<r&&(C=C-s[p.id]-s[O.id]);let P=c*(y+1)*(k+1)/C;l&&e<r&&C<0?P=a*(y+1)*(k+1):l&&e<r&&C===0?P=0:l&&e<r&&C>0&&(P=c*(y+1)*(k+1)/C),i[p.id][0]-=P*T[0],i[O.id][0]+=P*T[0],i[p.id][1]-=P*T[1],i[O.id][1]+=P*T[1]}const m=[p.data.x-h[0],p.data.y-h[1]],w=Math.hypot(m[0],m[1]);m[0]=m[0]/w,m[1]=m[1]/w;const E=u*(y+1);i[p.id][0]-=E*m[0],i[p.id][1]-=E*m[1]}return i}updatePos(t,e,r,i,a){const{ks:s,tao:o,prune:l,ksmax:c}=a,u=t.getAllNodes(),h=u.length,f=[],d=[];let g=0,v=0,p=i;for(let m=0;m<h;m+=1){const{id:w}=u[m],E=t.getDegree(w);if(l&&E<=1)continue;const S=[e[w][0]-r[w][0],e[w][1]-r[w][1]],O=Math.hypot(S[0],S[1]),k=[e[w][0]+r[w][0],e[w][1]+r[w][1]],T=Math.hypot(k[0],k[1]);f[m]=O,d[m]=T/2,g+=(E+1)*f[m],v+=(E+1)*d[m]}const y=p;p=o*v/g,y!==0&&(p=p>1.5*y?1.5*y:p);for(let m=0;m<h;m+=1){const{id:w,data:E}=u[m],S=t.getDegree(w);if(l&&S<=1||Lt(E.fx)&&Lt(E.fy))continue;let O=s*p/(1+p*Math.sqrt(f[m])),k=Math.hypot(e[w][0],e[w][1]);k=k<1e-4?1e-4:k;const T=c/k;O=O>T?T:O;const C=O*e[w][0],P=O*e[w][1];t.mergeNodeData(w,{x:E.x+C,y:E.y+P})}return p}}const aX={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},sX=800;class oX{constructor(t={}){this.options=t,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=Object.assign(Object.assign({},aX),t)}execute(t,e){return oe(this,void 0,void 0,function*(){return this.genericFruchtermanLayout(!1,t,e)})}assign(t,e){return oe(this,void 0,void 0,function*(){yield this.genericFruchtermanLayout(!0,t,e)})}stop(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval),this.running=!1}tick(t=this.options.maxIteration||1){if(this.lastResult)return this.lastResult;for(let r=0;r<t;r++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);const e={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&e.nodes.forEach(r=>this.lastGraph.mergeNodeData(r.id,{x:r.data.x,y:r.data.y,z:this.options.dimensions===3?r.data.z:void 0})),e}genericFruchtermanLayout(t,e,r){return oe(this,void 0,void 0,function*(){if(this.running)return;const i=this.formatOptions(r),{dimensions:a,width:s,height:o,center:l,clustering:c,nodeClusterBy:u,maxIteration:h,onTick:f}=i,d=e.getAllNodes(),g=e.getAllEdges();if(!(d!=null&&d.length)){const w={nodes:[],edges:g};return this.lastResult=w,w}if(d.length===1){t&&e.mergeNodeData(d[0].id,{x:l[0],y:l[1],z:a===3?l[2]:void 0});const w={nodes:[Object.assign(Object.assign({},d[0]),{data:Object.assign(Object.assign({},d[0].data),{x:l[0],y:l[1],z:a===3?l[2]:void 0})})],edges:g};return this.lastResult=w,w}const v=d.map(w=>Br(w,[s,o])),p=new kn({nodes:v,edges:g}),y={};if(c&&v.forEach(w=>{const E=w.data[u];y[E]||(y[E]={name:E,cx:0,cy:0,count:0})}),this.lastLayoutNodes=v,this.lastLayoutEdges=g,this.lastAssign=t,this.lastGraph=p,this.lastOptions=i,this.lastClusterMap=y,typeof window>"u")return;let m=0;return new Promise(w=>{this.timeInterval=window.setInterval(()=>{if(!this.running){w({nodes:v,edges:g});return}this.runOneStep(p,y,i),t&&v.forEach(({id:E,data:S})=>e.mergeNodeData(E,{x:S.x,y:S.y,z:a===3?S.z:void 0})),f==null||f({nodes:v,edges:g}),m++,m>=h&&(window.clearInterval(this.timeInterval),w({nodes:v,edges:g}))},0),this.running=!0})})}formatOptions(t={}){const e=Object.assign(Object.assign({},this.options),t),{clustering:r,nodeClusterBy:i}=e,{center:a,width:s,height:o}=e;return e.width=!s&&typeof window<"u"?window.innerWidth:s,e.height=!o&&typeof window<"u"?window.innerHeight:o,e.center=a||[e.width/2,e.height/2],e.clustering=r&&!!i,e}runOneStep(t,e,r){const{dimensions:i,height:a,width:s,gravity:o,center:l,speed:c,clustering:u,nodeClusterBy:h,clusterGravity:f}=r,d=a*s,g=Math.sqrt(d)/10,v=t.getAllNodes(),p=d/(v.length+1),y=Math.sqrt(p),m={};if(this.applyCalculate(t,m,y,p),u){for(const E in e)e[E].cx=0,e[E].cy=0,e[E].count=0;v.forEach(E=>{const{data:S}=E,O=e[S[h]];Lt(S.x)&&(O.cx+=S.x),Lt(S.y)&&(O.cy+=S.y),O.count++});for(const E in e)e[E].cx/=e[E].count,e[E].cy/=e[E].count;const w=f||o;v.forEach((E,S)=>{const{id:O,data:k}=E;if(!Lt(k.x)||!Lt(k.y))return;const T=e[k[h]],C=Math.sqrt((k.x-T.cx)*(k.x-T.cx)+(k.y-T.cy)*(k.y-T.cy)),P=y*w;m[O].x-=P*(k.x-T.cx)/C,m[O].y-=P*(k.y-T.cy)/C})}v.forEach((w,E)=>{const{id:S,data:O}=w;if(!Lt(O.x)||!Lt(O.y))return;const k=.01*y*o;m[S].x-=k*(O.x-l[0]),m[S].y-=k*(O.y-l[1]),i===3&&(m[S].z-=k*(O.z-l[2]))}),v.forEach((w,E)=>{const{id:S,data:O}=w;if(Lt(O.fx)&&Lt(O.fy)){O.x=O.fx,O.y=O.fy,i===3&&(O.z=O.fz);return}if(!Lt(O.x)||!Lt(O.y))return;const k=Math.sqrt(m[S].x*m[S].x+m[S].y*m[S].y+(i===3?m[S].z*m[S].z:0));if(k>0){const T=Math.min(g*(c/sX),k);t.mergeNodeData(S,{x:O.x+m[S].x/k*T,y:O.y+m[S].y/k*T,z:i===3?O.z+m[S].z/k*T:void 0})}})}applyCalculate(t,e,r,i){this.calRepulsive(t,e,i),this.calAttractive(t,e,r)}calRepulsive(t,e,r){const i=t.getAllNodes();i.forEach(({data:a,id:s},o)=>{e[s]={x:0,y:0,z:0},i.forEach(({data:l,id:c},u)=>{if(o<=u||!Lt(a.x)||!Lt(l.x)||!Lt(a.y)||!Lt(l.y))return;let h=a.x-l.x,f=a.y-l.y,d=this.options.dimensions===3?a.z-l.z:0,g=h*h+f*f+d*d;g===0&&(g=1,h=.01,f=.01,d=.01);const v=r/g,p=h*v,y=f*v,m=d*v;e[s].x+=p,e[s].y+=y,e[c].x-=p,e[c].y-=y,this.options.dimensions===3&&(e[s].z+=m,e[c].z-=m)})})}calAttractive(t,e,r){t.getAllEdges().forEach(a=>{const{source:s,target:o}=a;if(!s||!o||s===o)return;const{data:l}=t.getNode(s),{data:c}=t.getNode(o);if(!Lt(c.x)||!Lt(l.x)||!Lt(c.y)||!Lt(l.y))return;const u=c.x-l.x,h=c.y-l.y,f=this.options.dimensions===3?c.z-l.z:0,d=Math.sqrt(u*u+h*h+f*f)/r,g=u*d,v=h*d,p=f*d;e[s].x+=g,e[s].y+=v,e[o].x-=g,e[o].y-=v,this.options.dimensions===3&&(e[s].z+=p,e[o].z-=p)})}}const lX={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300};class cX{constructor(t={}){this.options=t,this.id="grid",this.options=Object.assign(Object.assign({},lX),t)}execute(t,e){return oe(this,void 0,void 0,function*(){return this.genericGridLayout(!1,t,e)})}assign(t,e){return oe(this,void 0,void 0,function*(){yield this.genericGridLayout(!0,t,e)})}genericGridLayout(t,e,r){return oe(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),r),{begin:a=[0,0],condense:s,preventOverlapPadding:o,preventOverlap:l,rows:c,cols:u,nodeSpacing:h,nodeSize:f,width:d,height:g,position:v}=i;let{sortBy:p}=i;const y=e.getAllNodes(),m=e.getAllEdges(),w=y==null?void 0:y.length;if(!w||w===1)return Vs(e,t,a);const E=y.map(H=>Br(H));p!=="id"&&(!me(p)||E[0].data[p]===void 0)&&(p="degree"),p==="degree"?E.sort((H,W)=>e.getDegree(W.id,"both")-e.getDegree(H.id,"both")):p==="id"?E.sort((H,W)=>Lt(W.id)&&Lt(H.id)?W.id-H.id:`${H.id}`.localeCompare(`${W.id}`)):E.sort((H,W)=>W.data[p]-H.data[p]);const S=!d&&typeof window<"u"?window.innerWidth:d,O=!g&&typeof window<"u"?window.innerHeight:g,k=w,T={rows:c,cols:u};if(c!=null&&u!=null)T.rows=c,T.cols=u;else if(c!=null&&u==null)T.rows=c,T.cols=Math.ceil(k/T.rows);else if(c==null&&u!=null)T.cols=u,T.rows=Math.ceil(k/T.cols);else{const H=Math.sqrt(k*O/S);T.rows=Math.round(H),T.cols=Math.round(S/O*H)}if(T.rows=Math.max(T.rows,1),T.cols=Math.max(T.cols,1),T.cols*T.rows>k){const H=Tu(T),W=ku(T);(H-1)*W>=k?Tu(T,H-1):(W-1)*H>=k&&ku(T,W-1)}else for(;T.cols*T.rows<k;){const H=Tu(T),W=ku(T);(W+1)*H>=k?ku(T,W+1):Tu(T,H+1)}let C=s?0:S/T.cols,P=s?0:O/T.rows;if(l||h){const H=Cs(10,h),W=Uw(30,f,!1);E.forEach(q=>{(!q.data.x||!q.data.y)&&(q.data.x=0,q.data.y=0);const z=e.getNode(q.id),[Z,at]=_c(W(z)||30),ft=H!==void 0?H(q):o,ct=Z+ft,Gt=at+ft;C=Math.max(C,ct),P=Math.max(P,Gt)})}const N={},L={row:0,col:0},D={};for(let H=0;H<E.length;H++){const W=E[H];let q;if(v&&(q=v(e.getNode(W.id))),q&&(q.row!==void 0||q.col!==void 0)){const z={row:q.row,col:q.col};if(z.col===void 0)for(z.col=0;Pb(N,z);)z.col++;else if(z.row===void 0)for(z.row=0;Pb(N,z);)z.row++;D[W.id]=z,S3(N,z)}uX(W,a,C,P,D,T,L,N)}const G={nodes:E,edges:m};return t&&E.forEach(H=>{e.mergeNodeData(H.id,{x:H.data.x,y:H.data.y})}),G})}}const Tu=(n,t)=>{let e;const r=n.rows||5,i=n.cols||5;return t==null?e=Math.min(r,i):Math.min(r,i)===n.rows?n.rows=t:n.cols=t,e},ku=(n,t)=>{let e;const r=n.rows||5,i=n.cols||5;return t==null?e=Math.max(r,i):Math.max(r,i)===n.rows?n.rows=t:n.cols=t,e},Pb=(n,t)=>n[`c-${t.row}-${t.col}`]||!1,S3=(n,t)=>n[`c-${t.row}-${t.col}`]=!0,Zk=(n,t)=>{const e=n.cols||5;t.col++,t.col>=e&&(t.col=0,t.row++)},uX=(n,t,e,r,i,a,s,o)=>{let l,c;const u=i[n.id];if(u)l=u.col*e+e/2+t[0],c=u.row*r+r/2+t[1];else{for(;Pb(o,s);)Zk(a,s);l=s.col*e+e/2+t[0],c=s.row*r+r/2+t[1],S3(o,s),Zk(a,s)}n.data.x=l,n.data.y=c},hX=(n,t,e)=>{try{const r=La.mul(La.pow(t,2),-.5),i=r.mean("row"),a=r.mean("column"),s=r.mean();r.add(s).subRowVector(i).subColumnVector(a);const o=new vL(r),l=La.sqrt(o.diagonalMatrix).diagonal();return o.leftSingularVectors.toJSON().map(c=>La.mul([c],[l]).toJSON()[0].splice(0,n))}catch{const i=[];for(let a=0;a<t.length;a++){const s=Math.random()*e,o=Math.random()*e;i.push([s,o])}return i}},fX=800,dX={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},gX=(n,t)=>{const e=Object.assign(Object.assign({},dX),t),{positions:r,iterations:i,width:a,k:s,speed:o=100,strictRadial:l,focusIdx:c,radii:u=[],nodeSizeFunc:h}=e,f=n.getAllNodes(),d=[],g=a/10;for(let v=0;v<i;v++)r.forEach((p,y)=>{d[y]={x:0,y:0}}),pX(f,r,d,s,u,h),vX(r,d,o,l,c,g,a,u);return r},pX=(n,t,e,r,i,a)=>{t.forEach((s,o)=>{e[o]={x:0,y:0},t.forEach((l,c)=>{if(o===c||i[o]!==i[c])return;let u=s.x-l.x,h=s.y-l.y,f=Math.sqrt(u*u+h*h);if(f===0){f=1;const d=o>c?1:-1;u=.01*d,h=.01*d}if(f<a(n[o])/2+a(n[c])/2){const d=r*r/f;e[o].x+=u/f*d,e[o].y+=h/f*d}})})},vX=(n,t,e,r,i,a,s,o)=>{const l=a||s/10;return r&&t.forEach((c,u)=>{const h=n[u].x-n[i].x,f=n[u].y-n[i].y,d=Math.sqrt(h*h+f*f);let g=f/d,v=-h/d;const p=Math.sqrt(c.x*c.x+c.y*c.y);let y=Math.acos((g*c.x+v*c.y)/p);y>Math.PI/2&&(y-=Math.PI/2,g*=-1,v*=-1);const m=Math.cos(y)*p;c.x=g*m,c.y=v*m}),n.forEach((c,u)=>{if(u===i)return;const h=Math.sqrt(t[u].x*t[u].x+t[u].y*t[u].y);if(h>0&&u!==i){const f=Math.min(l*(e/fX),h);if(c.x+=t[u].x/h*f,c.y+=t[u].y/h*f,r){let d=c.x-n[i].x,g=c.y-n[i].y;const v=Math.sqrt(d*d+g*g);d=d/v*o[u],g=g/v*o[u],c.x=n[i].x+d,c.y=n[i].y+g}}}),n},yX={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10};class mX{constructor(t={}){this.options=t,this.id="radial",this.options=Object.assign(Object.assign({},yX),t)}execute(t,e){return oe(this,void 0,void 0,function*(){return this.genericRadialLayout(!1,t,e)})}assign(t,e){return oe(this,void 0,void 0,function*(){yield this.genericRadialLayout(!0,t,e)})}genericRadialLayout(t,e,r){return oe(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),r),{width:a,height:s,center:o,focusNode:l,unitRadius:c,nodeSize:u,nodeSpacing:h,strictRadial:f,preventOverlap:d,maxPreventOverlapIteration:g,sortBy:v,linkDistance:p=50,sortStrength:y=10,maxIteration:m=1e3}=i,w=e.getAllNodes(),E=e.getAllEdges(),S=!a&&typeof window<"u"?window.innerWidth:a,O=!s&&typeof window<"u"?window.innerHeight:s,k=o||[S/2,O/2];if(!(w!=null&&w.length)||w.length===1)return Vs(e,t,k);let T=w[0];if(me(l)){for(let dt=0;dt<w.length;dt++)if(w[dt].id===l){T=w[dt];break}}else T=l||w[0];const C=xX(w,T.id),P=hL({nodes:w,edges:E}),N=uL(P),L=SX(N,C);EX(N,C,L+1);const D=N[C];let G=S-k[0]>k[0]?k[0]:S-k[0],H=O-k[1]>k[1]?k[1]:O-k[1];G===0&&(G=S/2),H===0&&(H=O/2);const W=Math.min(G,H),q=Math.max(...D),z=[],Z=c||W/q;D.forEach((dt,Nt)=>{z[Nt]=dt*Z});const at=bX(w,N,p,z,Z,v,y),ft=wX(at),ct=hX(p,at,p);let Gt=ct.map(([dt,Nt])=>({x:(isNaN(dt)?Math.random()*p:dt)-ct[C][0],y:(isNaN(Nt)?Math.random()*p:Nt)-ct[C][1]}));this.run(m,Gt,ft,at,z,C);let J;if(d){J=Yw(u,h);const dt={nodes:w,nodeSizeFunc:J,positions:Gt,radii:z,height:O,width:S,strictRadial:!!f,focusIdx:C,iterations:g||200,k:Gt.length/4.5};Gt=gX(e,dt)}const V=[];return Gt.forEach((dt,Nt)=>{const Wt=Br(w[Nt]);Wt.data.x=dt.x+k[0],Wt.data.y=dt.y+k[1],V.push(Wt)}),t&&V.forEach(dt=>e.mergeNodeData(dt.id,{x:dt.data.x,y:dt.data.y})),{nodes:V,edges:E}})}run(t,e,r,i,a,s){for(let o=0;o<=t;o++){const l=o/t;this.oneIteration(l,e,a,i,r,s)}}oneIteration(t,e,r,i,a,s){const o=1-t;e.forEach((l,c)=>{const u=yS(l,{x:0,y:0}),h=u===0?0:1/u;if(c===s)return;let f=0,d=0,g=0;e.forEach((p,y)=>{if(c===y)return;const m=yS(l,p),w=m===0?0:1/m,E=i[y][c];g+=a[c][y],f+=a[c][y]*(p.x+E*(l.x-p.x)*w),d+=a[c][y]*(p.y+E*(l.y-p.y)*w)});const v=r[c]===0?0:1/r[c];g*=o,g+=t*v*v,f*=o,f+=t*v*l.x*h,l.x=f/g,d*=o,d+=t*v*l.y*h,l.y=d/g})}}const bX=(n,t,e,r,i,a,s)=>{if(!n)return[];const o=[];if(t){const l={};t.forEach((c,u)=>{const h=[];c.forEach((f,d)=>{var g,v;if(u===d)h.push(0);else if(r[u]===r[d])if(a==="data")h.push(f*(Math.abs(u-d)*s)/(r[u]/i));else if(a){let p,y;if(l[n[u].id])p=l[n[u].id];else{const m=(a==="id"?n[u].id:(g=n[u].data)===null||g===void 0?void 0:g[a])||0;me(m)?p=m.charCodeAt(0):p=m,l[n[u].id]=p}if(l[n[d].id])y=l[n[d].id];else{const m=(a==="id"?n[d].id:(v=n[d].data)===null||v===void 0?void 0:v[a])||0;me(m)?y=m.charCodeAt(0):y=m,l[n[d].id]=y}h.push(f*(Math.abs(p-y)*s)/(r[u]/i))}else h.push(f*e/(r[u]/i));else{const p=(e+i)/2;h.push(f*p)}}),o.push(h)})}return o},wX=n=>{const t=n.length,e=n[0].length,r=[];for(let i=0;i<t;i++){const a=[];for(let s=0;s<e;s++)n[i][s]!==0?a.push(1/(n[i][s]*n[i][s])):a.push(0);r.push(a)}return r},xX=(n,t)=>{let e=-1;return n.forEach((r,i)=>{r.id===t&&(e=i)}),Math.max(e,0)},EX=(n,t,e)=>{const r=n.length;for(let i=0;i<r;i++)if(n[t][i]===1/0){n[t][i]=e,n[i][t]=e;for(let a=0;a<r;a++)n[i][a]!==1/0&&n[t][a]===1/0&&(n[t][a]=e+n[i][a],n[a][t]=e+n[i][a])}for(let i=0;i<r;i++)if(i!==t){for(let a=0;a<r;a++)if(n[i][a]===1/0){let s=Math.abs(n[t][i]-n[t][a]);s=s===0?1:s,n[i][a]=s}}},SX=(n,t)=>{let e=0;for(let r=0;r<n[t].length;r++)n[t][r]!==1/0&&(e=n[t][r]>e?n[t][r]:e);return e},_X={center:[0,0],width:300,height:300};class MX{constructor(t={}){this.options=t,this.id="random",this.options=Object.assign(Object.assign({},_X),t)}execute(t,e){return oe(this,void 0,void 0,function*(){return this.genericRandomLayout(!1,t,e)})}assign(t,e){return oe(this,void 0,void 0,function*(){yield this.genericRandomLayout(!0,t,e)})}genericRandomLayout(t,e,r){return oe(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),r),{center:a,width:s,height:o}=i,l=e.getAllNodes(),c=.9,u=!s&&typeof window<"u"?window.innerWidth:s,h=!o&&typeof window<"u"?window.innerHeight:o,f=a||[u/2,h/2],d=[];return l&&l.forEach(v=>{d.push({id:v.id,data:{x:(Math.random()-.5)*c*u+f[0],y:(Math.random()-.5)*c*h+f[1]}})}),t&&d.forEach(v=>e.mergeNodeData(v.id,{x:v.data.x,y:v.data.y})),{nodes:d,edges:e.getAllEdges()}})}}/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const _3=Symbol("Comlink.proxy"),OX=Symbol("Comlink.endpoint"),M3=Symbol("Comlink.releaseProxy"),r1=Symbol("Comlink.finalizer"),Yu=Symbol("Comlink.thrown"),O3=n=>typeof n=="object"&&n!==null||typeof n=="function",TX={canHandle:n=>O3(n)&&n[_3],serialize(n){const{port1:t,port2:e}=new MessageChannel;return k3(n,t),[e,[e]]},deserialize(n){return n.start(),C3(n)}},kX={canHandle:n=>O3(n)&&Yu in n,serialize({value:n}){let t;return n instanceof Error?t={isError:!0,value:{message:n.message,name:n.name,stack:n.stack}}:t={isError:!1,value:n},[t,[]]},deserialize(n){throw n.isError?Object.assign(new Error(n.value.message),n.value):n.value}},T3=new Map([["proxy",TX],["throw",kX]]);function AX(n,t){for(const e of n)if(t===e||e==="*"||e instanceof RegExp&&e.test(t))return!0;return!1}function k3(n,t=globalThis,e=["*"]){t.addEventListener("message",function r(i){if(!i||!i.data)return;if(!AX(e,i.origin)){console.warn(`Invalid origin '${i.origin}' for comlink proxy`);return}const{id:a,type:s,path:o}=Object.assign({path:[]},i.data),l=(i.data.argumentList||[]).map(ms);let c;try{const u=o.slice(0,-1).reduce((f,d)=>f[d],n),h=o.reduce((f,d)=>f[d],n);switch(s){case"GET":c=h;break;case"SET":u[o.slice(-1)[0]]=ms(i.data.value),c=!0;break;case"APPLY":c=h.apply(u,l);break;case"CONSTRUCT":{const f=new h(...l);c=IX(f)}break;case"ENDPOINT":{const{port1:f,port2:d}=new MessageChannel;k3(n,d),c=LX(f,[f])}break;case"RELEASE":c=void 0;break;default:return}}catch(u){c={value:u,[Yu]:0}}Promise.resolve(c).catch(u=>({value:u,[Yu]:0})).then(u=>{const[h,f]=Fh(u);t.postMessage(Object.assign(Object.assign({},h),{id:a}),f),s==="RELEASE"&&(t.removeEventListener("message",r),A3(t),r1 in n&&typeof n[r1]=="function"&&n[r1]())}).catch(u=>{const[h,f]=Fh({value:new TypeError("Unserializable return value"),[Yu]:0});t.postMessage(Object.assign(Object.assign({},h),{id:a}),f)})}),t.start&&t.start()}function CX(n){return n.constructor.name==="MessagePort"}function A3(n){CX(n)&&n.close()}function C3(n,t){const e=new Map;return n.addEventListener("message",function(i){const{data:a}=i;if(!a||!a.id)return;const s=e.get(a.id);if(s)try{s(a)}finally{e.delete(a.id)}}),Nb(n,e,[],t)}function Au(n){if(n)throw new Error("Proxy has been released and is not useable")}function P3(n){return uo(n,new Map,{type:"RELEASE"}).then(()=>{A3(n)})}const Ih=new WeakMap,Dh="FinalizationRegistry"in globalThis&&new FinalizationRegistry(n=>{const t=(Ih.get(n)||0)-1;Ih.set(n,t),t===0&&P3(n)});function PX(n,t){const e=(Ih.get(t)||0)+1;Ih.set(t,e),Dh&&Dh.register(n,t,n)}function NX(n){Dh&&Dh.unregister(n)}function Nb(n,t,e=[],r=function(){}){let i=!1;const a=new Proxy(r,{get(s,o){if(Au(i),o===M3)return()=>{NX(a),P3(n),t.clear(),i=!0};if(o==="then"){if(e.length===0)return{then:()=>a};const l=uo(n,t,{type:"GET",path:e.map(c=>c.toString())}).then(ms);return l.then.bind(l)}return Nb(n,t,[...e,o])},set(s,o,l){Au(i);const[c,u]=Fh(l);return uo(n,t,{type:"SET",path:[...e,o].map(h=>h.toString()),value:c},u).then(ms)},apply(s,o,l){Au(i);const c=e[e.length-1];if(c===OX)return uo(n,t,{type:"ENDPOINT"}).then(ms);if(c==="bind")return Nb(n,t,e.slice(0,-1));const[u,h]=Jk(l);return uo(n,t,{type:"APPLY",path:e.map(f=>f.toString()),argumentList:u},h).then(ms)},construct(s,o){Au(i);const[l,c]=Jk(o);return uo(n,t,{type:"CONSTRUCT",path:e.map(u=>u.toString()),argumentList:l},c).then(ms)}});return PX(a,n),a}function RX(n){return Array.prototype.concat.apply([],n)}function Jk(n){const t=n.map(Fh);return[t.map(e=>e[0]),RX(t.map(e=>e[1]))]}const N3=new WeakMap;function LX(n,t){return N3.set(n,t),n}function IX(n){return Object.assign(n,{[_3]:!0})}function Fh(n){for(const[t,e]of T3)if(e.canHandle(n)){const[r,i]=e.serialize(n);return[{type:"HANDLER",name:t,value:r},i]}return[{type:"RAW",value:n},N3.get(n)||[]]}function ms(n){switch(n.type){case"HANDLER":return T3.get(n.name).deserialize(n.value);case"RAW":return n.value}}function uo(n,t,e,r){return new Promise(i=>{const a=DX();t.set(a,i),n.start&&n.start(),n.postMessage(Object.assign({id:a},e),r)})}function DX(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}class FX extends wf{constructor(t,e,r){super(),this.graph=t,this.layout=e,this.options=r,this.spawnWorker()}spawnWorker(){this.proxy=C3(new Worker(new URL(""+new URL("worker-CY73Iqy_.js",import.meta.url).href,import.meta.url),{type:"module"})),this.running&&(this.running=!1,this.execute())}execute(){var t;return oe(this,void 0,void 0,function*(){if(this.running)return this;this.running=!0;const e=this.layout.options,{onTick:r}=e,i=an(e,["onTick"]),a={};Object.keys(i).forEach(c=>{zt(i[c])||(a[c]=i[c])});const s={layout:{id:this.layout.id,options:a,iterations:(t=this.options)===null||t===void 0?void 0:t.iterations},nodes:this.graph.getAllNodes(),edges:this.graph.getAllEdges()},o=new Float32Array([0]),[l]=yield this.proxy.calculateLayout(s,[o]);return l})}stop(){return this.running=!1,this.proxy.stopLayout(),this}kill(){this.proxy[M3]()}isRunning(){return this.running}}var BX=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(r.next(u))}catch(h){s(h)}}function l(u){try{c(r.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((r=r.apply(n,t||[])).next())})};class Kf extends xf{constructor(){super(...arguments),this.id="fishbone"}getRoot(){const t=this.context.model.getRootsData();if(!(Ti(t)||t.length>2))return t[0]}formatSize(t){const e=typeof t=="function"?t:()=>t;return r=>jr(e(r))}doLayout(t,e){const{hGap:r,getRibSep:i,vGap:a,nodeSize:s,height:o}=e,{model:l}=this.context,c=this.formatSize(s);let u=c(t)[0]+i(t);const h=(w,E=0)=>{var S;return E+=r*((w.children||[]).length+1),(S=w.children)===null||S===void 0||S.forEach(O=>{var k;(k=l.getNodeLikeDatum(O).children)===null||k===void 0||k.forEach(C=>{const P=l.getNodeLikeDatum(C);E=h(P,E)})}),E},f=w=>{if(w.depth===1)return u;const E=l.getParentData(w.id,"tree");if(no(w)){const S=l.getParentData(E.id,"tree"),O=v(w)-v(S);return f(E)+O*r/a}else{const S=(E.children||[]).indexOf(w.id),O=l.getNodeData((E.children||[]).slice(S));return d(E)-O.reduce((k,T)=>k+h(T),0)-c(E)[0]/2}},d=G1(w=>{if(i1(w))return c(w)[0]/2;const E=l.getParentData(w.id,"tree");if(no(w))return f(w)+h(w)+c(w)[0]/2;{const S=v(w)-v(E),O=r/a;return f(w)+S*O}},w=>w.id),g=w=>v(l.getParentData(w,"tree")),v=G1(w=>{if(i1(w))return o/2;if(no(w)){const E=l.getParentData(w.id,"tree"),S=E.children.indexOf(w.id);if(S===0)return g(E.id)+a;const O=l.getNodeLikeDatum(E.children[S-1]);if(Ti(O.children))return v(O)+a;const k=l.getDescendantsData(O.id);return Math.max(...k.map(T=>no(T)?g(T.id):v(T)))+a}else{if(Ti(w.children))return g(w.id)+a;const E=l.getNodeLikeDatum(w.children.slice(-1)[0]);if(Ti(E.children))return v(E)+a;const S=l.getDescendantsData(w.id).slice(-1)[0];return(no(S)?g(S.id):v(S))+a}},w=>w.id);let p=0;const y={nodes:[],edges:[]},m=w=>{var E;(E=w.children)===null||E===void 0||E.forEach(C=>m(l.getNodeLikeDatum(C)));const S=v(w),O=d(w);if(y.nodes.push({id:w.id,x:O,y:S}),i1(w))return;const k=l.getRelatedEdgesData(w.id,"in")[0],T=[f(w),no(w)?S:g(w.id)];y.edges.push({id:tt(k),controlPoints:[T],relatedNodeId:w.id}),p=Math.max(p,O+i(w)),w.depth===1&&(u=p)};return m(t),y}placeAlterative(t,e){const r=(e.children||[]).filter((o,l)=>l%2!==0);if(r.length===0)return t;const{model:i}=this.context,a=t.nodes.find(o=>o.id===e.id).y,s=o=>{const l=i.getAncestorsData(o,"tree");if(Ti(l))return!1;const c=l.length===1?o:l[l.length-2].id;return r.includes(c)};t.nodes.forEach(o=>{s(o.id)&&(o.y=2*a-o.y)}),t.edges.forEach(o=>{s(o.relatedNodeId)&&(o.controlPoints=o.controlPoints.map(l=>[l[0],2*a-l[1]]))})}rightToLeft(t,e){return t.nodes.forEach(r=>r.x=e.width-r.x),t.edges.forEach(r=>{r.controlPoints=r.controlPoints.map(i=>[e.width-i[0],i[1]])}),t}execute(t,e){return BX(this,void 0,void 0,function*(){const r=Object.assign(Object.assign(Object.assign({},Kf.defaultOptions),this.options),e),{direction:i,nodeSize:a}=r,s=this.getRoot();if(!s)return t;const o=this.formatSize(a);r.vGap||(r.vGap=Math.max(...(t.nodes||[]).map(f=>o(f)[1]))),r.hGap||(r.hGap=Math.max(...(t.nodes||[]).map(f=>o(f)[0])));let l=this.doLayout(s,r);this.placeAlterative(l,s),i==="RL"&&(l=this.rightToLeft(l,r));const{model:c}=this.context,u=[],h=[];return l.nodes.forEach(f=>{const{id:d,x:g,y:v}=f,p=c.getNodeLikeDatum(d);u.push(Qk(p,{x:g,y:v}))}),l.edges.forEach(f=>{const{id:d,controlPoints:g}=f,v=c.getEdgeDatum(d);h.push(Qk(v,{controlPoints:g}))}),{nodes:u,edges:h}})}}Kf.defaultOptions={direction:"RL",getRibSep:()=>60};const Qk=(n,t)=>Object.assign(Object.assign({},n),{style:Object.assign(Object.assign({},n.style||{}),t)}),i1=n=>n.depth===0,no=n=>(n.depth||(n.depth=0))%2===0;var zX=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(r.next(u))}catch(h){s(h)}}function l(u){try{c(r.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((r=r.apply(n,t||[])).next())})};class Zf extends xf{constructor(){super(...arguments),this.id="snake"}formatSize(t,e){const r=typeof e=="function"?e:()=>e;return t.reduce((i,a)=>{const[s,o]=jr(r(a))||[0,0];return[Math.max(i[0],s),Math.max(i[1],o)]},[0,0])}validate(t){const{nodes:e=[],edges:r=[]}=t,i={},a={},s={};e.forEach(f=>{i[f.id]=0,a[f.id]=0,s[f.id]=[]}),r.forEach(f=>{i[f.target]++,a[f.source]++,s[f.source].push(f.target)});const o=new Set,l=f=>{o.has(f)||(o.add(f),s[f].forEach(l))};if(l(e[0].id),o.size!==e.length)return!1;const c=e.filter(f=>i[f.id]===0),u=e.filter(f=>a[f.id]===0);return!(c.length!==1||u.length!==1||e.filter(f=>i[f.id]===1&&a[f.id]===1).length!==e.length-2)}execute(t,e){return zX(this,void 0,void 0,function*(){var r;if(!this.validate(t))return t;const{nodeSize:i,padding:a,sortBy:s,cols:o,colGap:l,rowGap:c,clockwise:u,width:h,height:f}=Object.assign({},Zf.defaultOptions,this.options,e),[d,g,v,p]=qi(a),y=this.formatSize(t.nodes||[],i),m=Math.ceil((t.nodes||[]).length/o);let w=l||(h-p-g-o*y[0])/(o-1),E=c||(f-d-v-m*y[1])/(m-1);return(E===1/0||E<0)&&(E=0),(w===1/0||w<0)&&(w=0),{nodes:((s?(r=t.nodes)===null||r===void 0?void 0:r.sort(s):jX(t))||[]).map((k,T)=>{const C=Math.floor(T/o),P=T%o,N=u?C%2===0?P:o-1-P:C%2===0?o-1-P:P,L=p+N*(y[0]+w)+y[0]/2,D=d+C*(y[1]+E)+y[1]/2;return{id:k.id,style:{x:L,y:D}}})}})}}Zf.defaultOptions={padding:0,cols:5,clockwise:!0};function jX(n){const{nodes:t=[],edges:e=[]}=n,r={},i={};t.forEach(o=>{r[o.id]=0,i[o.id]=[]}),e.forEach(o=>{r[o.target]++,i[o.source].push(o.target)});const a=[],s=[];for(t.forEach(o=>{r[o.id]===0&&a.push(o.id)});a.length>0;){const o=a.shift(),l=t.find(c=>c.id===o);s.push(l),i[o].forEach(c=>{r[c]--,r[c]===0&&a.push(c)})}return s}const qX=["rgb(158, 1, 66)","rgb(213, 62, 79)","rgb(244, 109, 67)","rgb(253, 174, 97)","rgb(254, 224, 139)","rgb(255, 255, 191)","rgb(230, 245, 152)","rgb(171, 221, 164)","rgb(102, 194, 165)","rgb(50, 136, 189)","rgb(94, 79, 162)"],$X=["rgb(78, 121, 167)","rgb(242, 142, 44)","rgb(225, 87, 89)","rgb(118, 183, 178)","rgb(89, 161, 79)","rgb(237, 201, 73)","rgb(175, 122, 161)","rgb(255, 157, 167)","rgb(156, 117, 95)","rgb(186, 176, 171)"],GX=["rgb(255, 245, 235)","rgb(254, 230, 206)","rgb(253, 208, 162)","rgb(253, 174, 107)","rgb(253, 141, 60)","rgb(241, 105, 19)","rgb(217, 72, 1)","rgb(166, 54, 3)","rgb(127, 39, 4)"],WX=["rgb(247, 252, 245)","rgb(229, 245, 224)","rgb(199, 233, 192)","rgb(161, 217, 155)","rgb(116, 196, 118)","rgb(65, 171, 93)","rgb(35, 139, 69)","rgb(0, 109, 44)","rgb(0, 68, 27)"],VX=["rgb(247, 251, 255)","rgb(222, 235, 247)","rgb(198, 219, 239)","rgb(158, 202, 225)","rgb(107, 174, 214)","rgb(66, 146, 198)","rgb(33, 113, 181)","rgb(8, 81, 156)","rgb(8, 48, 107)"];class Wn extends Nw{}function Vo(n,t=!0,e){const r=document.createElement("div");return r.setAttribute("class",`g6-${n}`),Object.assign(r.style,{position:"absolute",display:"block"}),t&&Object.assign(r.style,{position:"unset",gridArea:"1 / 1 / 2 / 2",inset:"0px",height:"100%",width:"100%",overflow:"hidden",pointerEvents:"none"}),e&&Object.assign(r.style,e),r}function Rb(n,t="div",e={},r="",i=document.body){const a=document.getElementById(n);a&&a.remove();const s=document.createElement(t);return s.innerHTML=r,s.id=n,Object.assign(s.style,e),i.appendChild(s),s}var HX=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(r.next(u))}catch(h){s(h)}}function l(u){try{c(r.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((r=r.apply(n,t||[])).next())})};class Jf extends Wn{constructor(t,e){super(t,Object.assign({},Jf.defaultOptions,e)),this.$element=Vo("background"),this.context.canvas.getContainer().prepend(this.$element),this.update(e)}update(t){const e=Object.create(null,{update:{get:()=>super.update}});return HX(this,void 0,void 0,function*(){e.update.call(this,t),Object.assign(this.$element.style,gw(this.options,["key","type"]))})}destroy(){super.destroy(),this.$element.remove()}}Jf.defaultOptions={transition:"background 0.5s",backgroundSize:"cover",zIndex:"-1"};function vx(n,t,e,r,i,a){const s=n,o=t,l=e-s,c=r-o;let u=i-s,h=a-o,f=u*l+h*c,d=0;f<=0?d=0:(u=l-u,h=c-h,f=u*l+h*c,f<=0?d=0:d=f*f/(l*l+c*c));const g=u*u+h*h-d;return g<0?0:g}function Da(n,t,e,r){return(n-e)*(n-e)+(t-r)*(t-r)}function tA(n,t,e,r,i){return Da(n,t,e,r)<i*i}function UX(n){if(!Number.isFinite(n))return e=>e;if(n===0)return Math.round;const t=Math.pow(10,n);return e=>Math.round(e*t)/t}function R3(n){const t=Math.min(n.x1,n.x2),e=Math.max(n.x1,n.x2),r=Math.min(n.y1,n.y2),i=Math.max(n.y1,n.y2);return{x:t,y:r,x2:e,y2:i,width:e-t,height:i-r}}class Pn{constructor(t,e,r,i){this.x1=t,this.y1=e,this.x2=r,this.y2=i}equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2}draw(t){t.moveTo(this.x1,this.y1),t.lineTo(this.x2,this.y2)}toString(){return`Line(from=(${this.x1},${this.y1}),to=(${this.x2},${this.y2}))`}static from(t){return new Pn(t.x1,t.y1,t.x2,t.y2)}cuts(t,e){if(this.y1===this.y2||e<this.y1&&e<=this.y2||e>this.y1&&e>=this.y2||t>this.x1&&t>=this.x2)return!1;if(t<this.x1&&t<=this.x2)return!0;const r=this.x1+(e-this.y1)*(this.x2-this.x1)/(this.y2-this.y1);return t<=r}distSquare(t,e){return vx(this.x1,this.y1,this.x2,this.y2,t,e)}ptClose(t,e,r){if(this.x1<this.x2){if(t<this.x1-r||t>this.x2+r)return!1}else if(t<this.x2-r||t>this.x1+r)return!1;if(this.y1<this.y2){if(e<this.y1-r||e>this.y2+r)return!1}else if(e<this.y2-r||e>this.y1+r)return!1;return!0}}var nn;(function(n){n[n.POINT=1]="POINT",n[n.PARALLEL=2]="PARALLEL",n[n.COINCIDENT=3]="COINCIDENT",n[n.NONE=4]="NONE"})(nn||(nn={}));class a1{constructor(t,e=0,r=0){this.state=t,this.x=e,this.y=r}}function Cu(n,t){const e=(t.x2-t.x1)*(n.y1-t.y1)-(t.y2-t.y1)*(n.x1-t.x1),r=(n.x2-n.x1)*(n.y1-t.y1)-(n.y2-n.y1)*(n.x1-t.x1),i=(t.y2-t.y1)*(n.x2-n.x1)-(t.x2-t.x1)*(n.y2-n.y1);if(i){const a=e/i,s=r/i;return 0<=a&&a<=1&&0<=s&&s<=1?new a1(nn.POINT,n.x1+a*(n.x2-n.x1),n.y1+a*(n.y2-n.y1)):new a1(nn.NONE)}return new a1(e===0||r===0?nn.COINCIDENT:nn.PARALLEL)}function L3(n,t){const e=(t.x2-t.x1)*(n.y1-t.y1)-(t.y2-t.y1)*(n.x1-t.x1),r=(n.x2-n.x1)*(n.y1-t.y1)-(n.y2-n.y1)*(n.x1-t.x1),i=(t.y2-t.y1)*(n.x2-n.x1)-(t.x2-t.x1)*(n.y2-n.y1);if(i){const a=e/i,s=r/i;if(0<=a&&a<=1&&0<=s&&s<=1)return a}return Number.POSITIVE_INFINITY}function YX(n,t){function e(i,a,s,o){let l=L3(t,new Pn(i,a,s,o));return l=Math.abs(l-.5),l>=0&&l<=1?1:0}let r=e(n.x,n.y,n.x2,n.y);return r+=e(n.x,n.y,n.x,n.y2),r>1||(r+=e(n.x,n.y2,n.x2,n.y2),r>1)?!0:(r+=e(n.x2,n.y,n.x2,n.y2),r>0)}var rn;(function(n){n[n.LEFT=0]="LEFT",n[n.TOP=1]="TOP",n[n.RIGHT=2]="RIGHT",n[n.BOTTOM=3]="BOTTOM"})(rn||(rn={}));function Xu(n,t,e){const r=new Set;return n.width<=0?(r.add(rn.LEFT),r.add(rn.RIGHT)):t<n.x?r.add(rn.LEFT):t>n.x+n.width&&r.add(rn.RIGHT),n.height<=0?(r.add(rn.TOP),r.add(rn.BOTTOM)):e<n.y?r.add(rn.TOP):e>n.y+n.height&&r.add(rn.BOTTOM),r}function I3(n,t){let e=t.x1,r=t.y1;const i=t.x2,a=t.y2,s=Array.from(Xu(n,i,a));if(s.length===0)return!0;let o=Xu(n,e,r);for(;o.size!==0;){for(const l of s)if(o.has(l))return!1;if(o.has(rn.RIGHT)||o.has(rn.LEFT)){let l=n.x;o.has(rn.RIGHT)&&(l+=n.width),r=r+(l-e)*(a-r)/(i-e),e=l}else{let l=n.y;o.has(rn.BOTTOM)&&(l+=n.height),e=e+(l-r)*(i-e)/(a-r),r=l}o=Xu(n,e,r)}return!0}function XX(n,t){let e=Number.POSITIVE_INFINITY,r=0;function i(a,s,o,l){let c=L3(t,new Pn(a,s,o,l));c=Math.abs(c-.5),c>=0&&c<=1&&(r++,c<e&&(e=c))}return i(n.x,n.y,n.x2,n.y),i(n.x,n.y,n.x,n.y2),r>1||(i(n.x,n.y2,n.x2,n.y2),r>1)?e:(i(n.x2,n.y,n.x2,n.y2),r===0?-1:e)}function KX(n,t){let e=0;const r=Cu(n,new Pn(t.x,t.y,t.x2,t.y));e+=r.state===nn.POINT?1:0;const i=Cu(n,new Pn(t.x,t.y,t.x,t.y2));e+=i.state===nn.POINT?1:0;const a=Cu(n,new Pn(t.x,t.y2,t.x2,t.y2));e+=a.state===nn.POINT?1:0;const s=Cu(n,new Pn(t.x2,t.y,t.x2,t.y2));return e+=s.state===nn.POINT?1:0,{top:r,left:i,bottom:a,right:s,count:e}}class Yn{constructor(t,e,r,i){this.x=t,this.y=e,this.width=r,this.height=i}get x2(){return this.x+this.width}get y2(){return this.y+this.height}get cx(){return this.x+this.width/2}get cy(){return this.y+this.height/2}get radius(){return Math.max(this.width,this.height)/2}static from(t){return new Yn(t.x,t.y,t.width,t.height)}equals(t){return this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height}clone(){return new Yn(this.x,this.y,this.width,this.height)}add(t){const e=Math.min(this.x,t.x),r=Math.min(this.y,t.y),i=Math.max(this.x2,t.x+t.width),a=Math.max(this.y2,t.y+t.height);this.x=e,this.y=r,this.width=i-e,this.height=a-r}addPoint(t){const e=Math.min(this.x,t.x),r=Math.min(this.y,t.y),i=Math.max(this.x2,t.x),a=Math.max(this.y2,t.y);this.x=e,this.y=r,this.width=i-e,this.height=a-r}toString(){return`Rectangle[x=${this.x}, y=${this.y}, w=${this.width}, h=${this.height}]`}draw(t){t.rect(this.x,this.y,this.width,this.height)}containsPt(t,e){return t>=this.x&&t<=this.x2&&e>=this.y&&e<=this.y2}get area(){return this.width*this.height}intersects(t){return this.area<=0||t.width<=0||t.height<=0?!1:t.x+t.width>this.x&&t.y+t.height>this.y&&t.x<this.x2&&t.y<this.y2}distSquare(t,e){if(this.containsPt(t,e))return 0;const r=Xu(this,t,e);return r.has(rn.TOP)?r.has(rn.LEFT)?Da(t,e,this.x,this.y):r.has(rn.RIGHT)?Da(t,e,this.x2,this.y):(this.y-e)*(this.y-e):r.has(rn.BOTTOM)?r.has(rn.LEFT)?Da(t,e,this.x,this.y2):r.has(rn.RIGHT)?Da(t,e,this.x2,this.y2):(e-this.y2)*(e-this.y2):r.has(rn.LEFT)?(this.x-t)*(this.x-t):r.has(rn.RIGHT)?(t-this.x2)*(t-this.x2):0}}function ZX(n){if(n.length===0)return null;const t=n[0],e=new Yn(t.x,t.y,0,0);for(const r of n)e.addPoint(r);return e}class Bh{constructor(t,e,r){this.cx=t,this.cy=e,this.radius=r}get x(){return this.cx-this.radius}get x2(){return this.cx+this.radius}get width(){return this.radius*2}get y(){return this.cy-this.radius}get y2(){return this.cy+this.radius}get height(){return this.radius*2}static from(t){return new Bh(t.cx,t.cy,t.radius)}containsPt(t,e){return Da(this.cx,this.cy,t,e)<this.radius*this.radius}distSquare(t,e){const r=Da(this.cx,this.cy,t,e);if(r<this.radius*this.radius)return 0;const i=Math.sqrt(r)-this.radius;return i*i}draw(t){t.ellipse(this.cx,this.cy,this.radius,this.radius,0,0,Math.PI*2)}}class Ps{constructor(t,e=0,r=0,i=0,a=0,s=10,o=10,l=new Float32Array(Math.max(0,s*o)).fill(0)){this.pixelGroup=t,this.i=e,this.j=r,this.pixelX=i,this.pixelY=a,this.width=s,this.height=o,this.area=l}createSub(t,e){return new Ps(this.pixelGroup,t.x,t.y,e.x,e.y,t.width,t.height)}static fromPixelRegion(t,e){return new Ps(e,0,0,t.x,t.y,Math.ceil(t.width/e),Math.ceil(t.height/e))}copy(t,e){return new Ps(this.pixelGroup,this.scaleX(e.x),this.scaleY(e.y),e.x,e.y,t.width,t.height,t.area)}boundX(t){return t<this.i?this.i:t>=this.width?this.width-1:t}boundY(t){return t<this.j?this.j:t>=this.height?this.height-1:t}scaleX(t){return this.boundX(Math.floor((t-this.pixelX)/this.pixelGroup))}scaleY(t){return this.boundY(Math.floor((t-this.pixelY)/this.pixelGroup))}scale(t){const e=this.scaleX(t.x),r=this.scaleY(t.y),i=this.boundX(Math.ceil((t.x+t.width-this.pixelX)/this.pixelGroup)),a=this.boundY(Math.ceil((t.y+t.height-this.pixelY)/this.pixelGroup)),s=i-e,o=a-r;return new Yn(e,r,s,o)}invertScaleX(t){return Math.round(t*this.pixelGroup+this.pixelX)}invertScaleY(t){return Math.round(t*this.pixelGroup+this.pixelY)}addPadding(t,e){const r=Math.ceil(e/this.pixelGroup),i=this.boundX(t.x-r),a=this.boundY(t.y-r),s=this.boundX(t.x2+r),o=this.boundY(t.y2+r),l=s-i,c=o-a;return new Yn(i,a,l,c)}get(t,e){return t<0||e<0||t>=this.width||e>=this.height?Number.NaN:this.area[t+e*this.width]}inc(t,e,r){t<0||e<0||t>=this.width||e>=this.height||(this.area[t+e*this.width]+=r)}set(t,e,r){t<0||e<0||t>=this.width||e>=this.height||(this.area[t+e*this.width]=r)}incArea(t,e){if(t.width<=0||t.height<=0||e===0)return;const r=this.width,i=t.width,a=Math.max(0,t.i),s=Math.max(0,t.j),o=Math.min(t.i+t.width,r),l=Math.min(t.j+t.height,this.height);if(!(l<=0||o<=0||a>=r||l>=this.height))for(let c=s;c<l;c++){const u=(c-t.j)*i,h=c*r;for(let f=a;f<o;f++){const d=t.area[f-t.i+u];d!==0&&(this.area[f+h]+=e*d)}}}fill(t){this.area.fill(t)}fillArea(t,e){const r=t.x+t.y*this.width;for(let i=0;i<t.height;i++){const a=r+i*this.width;this.area.fill(e,a,a+t.width)}}fillHorizontalLine(t,e,r,i){const a=t+e*this.width;this.area.fill(i,a,a+r)}fillVerticalLine(t,e,r,i){const a=t+e*this.width;for(let s=0;s<r;s++)this.area[a+s*this.width]=i}clear(){this.area.fill(0)}toString(){let t="";for(let e=0;e<this.height;e++){const r=e*this.width;for(let i=0;i<this.width;i++){const a=this.area[r+i];t+=a.toFixed(1).padStart(6),t+=" "}t+=`
`}return t}draw(t,e=!0){if(this.width<=0||this.height<=0)return;t.save(),e&&t.translate(this.pixelX,this.pixelY);const r=this.area.reduce((s,o)=>Math.min(s,o),Number.POSITIVE_INFINITY),i=this.area.reduce((s,o)=>Math.max(s,o),Number.NEGATIVE_INFINITY),a=s=>(s-r)/(i-r);t.scale(this.pixelGroup,this.pixelGroup);for(let s=0;s<this.width;s++)for(let o=0;o<this.height;o++){const l=this.area[s+o*this.width];t.fillStyle=`rgba(0, 0, 0, ${a(l)})`,t.fillRect(s,o,1,1)}t.restore()}drawThreshold(t,e,r=!0){if(!(this.width<=0||this.height<=0)){t.save(),r&&t.translate(this.pixelX,this.pixelY),t.scale(this.pixelGroup,this.pixelGroup);for(let i=0;i<this.width;i++)for(let a=0;a<this.height;a++){const s=this.area[i+a*this.width];t.fillStyle=s>e?"black":"white",t.fillRect(i,a,1,1)}t.restore()}}}function D3(n,t){const e=r=>({x:r.x-t,y:r.y-t,width:r.width+2*t,height:r.height+2*t});return Array.isArray(n)?n.map(e):e(n)}function eA(n,t,e){return F3(Object.assign(R3(n),{distSquare:(r,i)=>vx(n.x1,n.y1,n.x2,n.y2,r,i)}),t,e)}function F3(n,t,e){const r=D3(n,e),i=t.scale(r),a=t.createSub(i,r);return JX(a,t,e,(s,o)=>n.distSquare(s,o)),a}function JX(n,t,e,r){const i=e*e;for(let a=0;a<n.height;a++)for(let s=0;s<n.width;s++){const o=t.invertScaleX(n.i+s),l=t.invertScaleY(n.j+a),c=r(o,l);if(c===0){n.set(s,a,i);continue}if(c<i){const u=e-Math.sqrt(c);n.set(s,a,u*u)}}return n}function QX(n,t,e){const r=t.scale(n),i=t.addPadding(r,e),a=t.createSub(i,{x:n.x-e,y:n.y-e}),s=r.x-i.x,o=r.y-i.y,l=i.x2-r.x2,c=i.y2-r.y2,u=i.width-s-l,h=i.height-o-c,f=e*e;a.fillArea({x:s,y:o,width:u+1,height:h+1},f);const d=[0],g=Math.max(o,s,l,c);{const m=t.invertScaleX(r.x+r.width/2);for(let w=1;w<g;w++){const E=t.invertScaleY(r.y-w),S=n.distSquare(m,E);if(S<f){const O=e-Math.sqrt(S);d.push(O*O)}else break}}const v=[],p=Math.max(s,l),y=Math.max(o,l);for(let m=1;m<p;m++){const w=t.invertScaleX(r.x-m),E=[];for(let S=1;S<y;S++){const O=t.invertScaleY(r.y-S),k=n.distSquare(w,O);if(k<f){const T=e-Math.sqrt(k);E.push(T*T)}else E.push(0)}v.push(E)}for(let m=1;m<Math.min(o,d.length);m++){const w=d[m];a.fillHorizontalLine(s,o-m,u+1,w)}for(let m=1;m<Math.min(c,d.length);m++){const w=d[m];a.fillHorizontalLine(s,o+h+m,u+1,w)}for(let m=1;m<Math.min(s,d.length);m++){const w=d[m];a.fillVerticalLine(s-m,o,h+1,w)}for(let m=1;m<Math.min(c,d.length);m++){const w=d[m];a.fillVerticalLine(s+u+m,o,h+1,w)}for(let m=1;m<s;m++){const w=v[m-1],E=s-m;for(let S=1;S<o;S++)a.set(E,o-S,w[S-1]);for(let S=1;S<c;S++)a.set(E,o+h+S,w[S-1])}for(let m=1;m<l;m++){const w=v[m-1],E=s+u+m;for(let S=1;S<o;S++)a.set(E,o-S,w[S-1]);for(let S=1;S<c;S++)a.set(E,o+h+S,w[S-1])}return a}function Ge(n,t){return{x:n,y:t}}function tK(n,t,e,r){if(n.length===0)return[];const i=aK(n);return i.map((a,s)=>{const o=i.slice(0,s);return eK(t,a,o,e,r)}).flat()}function eK(n,t,e,r,i){const a=Ge(t.cx,t.cy),s=iK(a,e,n);if(s==null)return[];const o=new Pn(a.x,a.y,s.cx,s.cy),l=nK(o,n,r,i);return rK(l,n)}function nK(n,t,e,r){const i=[],a=[];a.push(n);let s=!0;for(let o=0;o<e&&s;o++)for(s=!1;!s&&a.length>0;){const l=a.pop(),c=B3(t,l),u=c?KX(l,c):null;if(!c||!u||u.count!==2){s||i.push(l);continue}let h=r,f=Nu(c,h,u,!0),d=ma(f,a)||ma(f,i),g=Pu(f,t);for(;!d&&g&&h>=1;)h/=1.5,f=Nu(c,h,u,!0),d=ma(f,a)||ma(f,i),g=Pu(f,t);if(f&&!d&&!g&&(a.push(new Pn(l.x1,l.y1,f.x,f.y)),a.push(new Pn(f.x,f.y,l.x2,l.y2)),s=!0),s)continue;h=r,f=Nu(c,h,u,!1);let v=ma(f,a)||ma(f,i);for(g=Pu(f,t);!v&&g&&h>=1;)h/=1.5,f=Nu(c,h,u,!1),v=ma(f,a)||ma(f,i),g=Pu(f,t);f&&!v&&(a.push(new Pn(l.x1,l.y1,f.x,f.y)),a.push(new Pn(f.x,f.y,l.x2,l.y2)),s=!0),s||i.push(l)}for(;a.length>0;)i.push(a.pop());return i}function rK(n,t){const e=[];for(;n.length>0;){const r=n.pop();if(n.length===0){e.push(r);break}const i=n.pop(),a=new Pn(r.x1,r.y1,i.x2,i.y2);B3(t,a)?(e.push(r),n.push(i)):n.push(a)}return e}function iK(n,t,e){let r=Number.POSITIVE_INFINITY;return t.reduce((i,a)=>{const s=Da(n.x,n.y,a.cx,a.cy);if(s>r)return i;const o=new Pn(n.x,n.y,a.cx,a.cy),l=sK(e,o);return s*(l+1)*(l+1)<r&&(i=a,r=s*(l+1)*(l+1)),i},null)}function aK(n){if(n.length<2)return n;let t=0,e=0;return n.forEach(r=>{t+=r.cx,e+=r.cy}),t/=n.length,e/=n.length,n.map(r=>{const i=t-r.cx,a=e-r.cy,s=i*i+a*a;return[r,s]}).sort((r,i)=>r[1]-i[1]).map(r=>r[0])}function Pu(n,t){return t.some(e=>e.containsPt(n.x,n.y))}function ma(n,t){return t.some(e=>!!(tA(e.x1,e.y1,n.x,n.y,.001)||tA(e.x2,e.y2,n.x,n.y,.001)))}function B3(n,t){let e=Number.POSITIVE_INFINITY,r=null;for(const i of n){if(!I3(i,t))continue;const a=XX(i,t);a>=0&&a<e&&(r=i,e=a)}return r}function sK(n,t){return n.reduce((e,r)=>I3(r,t)&&YX(r,t)?e+1:e,0)}function Nu(n,t,e,r){const i=e.top,a=e.left,s=e.bottom,o=e.right;if(r){if(a.state===nn.POINT){if(i.state===nn.POINT)return Ge(n.x-t,n.y-t);if(s.state===nn.POINT)return Ge(n.x-t,n.y2+t);const f=n.width*n.height;return n.width*((a.y-n.y+(o.y-n.y))*.5)<f*.5?a.y>o.y?Ge(n.x-t,n.y-t):Ge(n.x2+t,n.y-t):a.y<o.y?Ge(n.x-t,n.y2+t):Ge(n.x2+t,n.y2+t)}if(o.state===nn.POINT){if(i.state===nn.POINT)return Ge(n.x2+t,n.y-t);if(s.state===nn.POINT)return Ge(n.x2+t,n.y2+t)}const u=n.height*n.width;return n.height*((i.x-n.x+(o.x-n.x))*.5)<u*.5?i.x>s.x?Ge(n.x-t,n.y-t):Ge(n.x-t,n.y2+t):i.x<s.x?Ge(n.x2+t,n.y-t):Ge(n.x2+t,n.y2+t)}if(a.state===nn.POINT){if(i.state===nn.POINT)return Ge(n.x2+t,n.y2+t);if(s.state===nn.POINT)return Ge(n.x2+t,n.y-t);const u=n.height*n.width;return n.width*((a.y-n.y+(o.y-n.y))*.5)<u*.5?a.y>o.y?Ge(n.x2+t,n.y2+t):Ge(n.x-t,n.y2+t):a.y<o.y?Ge(n.x2+t,n.y-t):Ge(n.x-t,n.y-t)}if(o.state===nn.POINT){if(i.state===nn.POINT)return Ge(n.x-t,n.y2+t);if(s.state===nn.POINT)return Ge(n.x-t,n.y-t)}const l=n.height*n.width;return n.height*((i.x-n.x+(o.x-n.x))*.5)<l*.5?i.x>s.x?Ge(n.x2+t,n.y2+t):Ge(n.x2+t,n.y-t):i.x<s.x?Ge(n.x-t,n.y2+t):Ge(n.x-t,n.y-t)}function oK(n,t,e,r){if(!(n.closed?e<n.length:e<n.length-1))return!1;const a=n.get(t),s=n.get(e+1);for(let o=t+1;o<=e;o++){const l=n.get(o);if(vx(a.x,a.y,s.x,s.y,l.x,l.y)>r)return!1}return!0}function lK(n=0){return t=>{if(n<0||t.length<3)return t;const e=[];let r=0;const i=n*n;for(;r<t.length;){let a=r+1;for(;oK(t,r,a,i);)a++;e.push(t.get(r)),r=a}return new Ho(e)}}function cK(n,t){switch(n){case-2:return(((-t+3)*t-3)*t+1)/6;case-1:return((3*t-6)*t*t+4)/6;case 0:return(((-3*t+3)*t+3)*t+1)/6;case 1:return t*t*t/6;default:throw new Error("unknown error")}}function uK(n=6){function a(s,o,l){let c=0,u=0;for(let h=-2;h<=1;h++){const f=s.get(o+h),d=cK(h,l);c+=d*f.x,u+=d*f.y}return{x:c,y:u}}return s=>{if(s.length<3)return s;const o=[],l=s.closed,c=s.length+3-1+(l?0:2);o.push(a(s,2-(l?0:2),0));for(let u=2-(l?0:2);u<c;u++)for(let h=1;h<=n;h++)o.push(a(s,u,h/n));return new Ho(o)}}function hK(n=8){return t=>{let e=n,r=t.length;if(e>1)for(r=Math.floor(t.length/e);r<3&&e>1;)e-=1,r=Math.floor(t.length/e);const i=[];for(let a=0,s=0;s<r;s++,a+=e)i.push(t.get(a));return new Ho(i)}}class Ho{constructor(t=[],e=!0){this.points=t,this.closed=e}get(t){const e=t,r=this.points.length;return t<0?this.closed?this.get(t+r):this.points[0]:t>=r?this.closed?this.get(t-r):this.points[r-1]:this.points[e]}get length(){return this.points.length}toString(t=1/0){const e=this.points;if(e.length===0)return"";const r=typeof t=="function"?t:UX(t);let i="M";for(const a of e)i+=`${r(a.x)},${r(a.y)} L`;return i=i.slice(0,-1),this.closed&&(i+=" Z"),i}draw(t){const e=this.points;if(e.length!==0){t.beginPath(),t.moveTo(e[0].x,e[0].y);for(const r of e)t.lineTo(r.x,r.y);this.closed&&t.closePath()}}sample(t){return hK(t)(this)}simplify(t){return lK(t)(this)}bSplines(t){return uK(t)(this)}apply(t){return t(this)}containsElements(t){const e=ZX(this.points);return e?t.every(r=>e.containsPt(r.cx,r.cy)&&this.withinArea(r.cx,r.cy)):!1}withinArea(t,e){if(this.length===0)return!1;let r=0;const i=this.points[0],a=new Pn(i.x,i.y,i.x,i.y);for(let s=1;s<this.points.length;s++){const o=this.points[s];a.x1=a.x2,a.y1=a.y2,a.x2=o.x,a.y2=o.y,a.cuts(t,e)&&r++}return a.x1=a.x2,a.y1=a.y2,a.x2=i.x,a.y2=i.y,a.cuts(t,e)&&r++,r%2===1}}class fK{constructor(t=0){this.count=0,this.arr=[],this.set=new Set,this.arr.length=t}add(t){this.set.add(`${t.x}x${t.y}`),this.arr[this.count++]=t}contains(t){return this.set.has(`${t.x}x${t.y}`)}isFirst(t){if(this.count===0)return!1;const e=this.arr[0];return e!=null&&e.x===t.x&&e.y===t.y}path(){return new Ho(this.arr.slice(0,this.count))}clear(){this.set.clear(),this.count=0}get(t){return this.arr[t]}get length(){return this.count}}const il=0,Ru=1,Lu=2,s1=3;function dK(n,t){const e=(Math.floor(n.width)+Math.floor(n.height))*2,r=new fK(e);function i(l,c,u,h){const f=n.get(l,c);return Number.isNaN(f)?Number.NaN:f>t?u+h:u}function a(l,c){let u=il;return u=i(l,c,u,1),u=i(l+1,c,u,2),u=i(l,c+1,u,4),u=i(l+1,c+1,u,8),Number.isNaN(u)?-1:u}let s=Ru;function o(l,c){let u=l,h=c,f=n.invertScaleX(u),d=n.invertScaleY(h);for(let g=0;g<n.width*n.height;g++){const v={x:f,y:d};if(r.contains(v)){if(r.isFirst(v))return!0}else r.add(v);const p=a(u,h);switch(p){case-1:return!0;case 0:case 3:case 2:case 7:s=Lu;break;case 12:case 14:case 4:s=s1;break;case 6:s=s===il?s1:Lu;break;case 1:case 13:case 5:s=il;break;case 9:s=s===Lu?il:Ru;break;case 10:case 8:case 11:s=Ru;break;default:return console.warn("Marching squares invalid state: "+p),!0}switch(s){case il:h--,d-=n.pixelGroup;break;case Ru:h++,d+=n.pixelGroup;break;case s1:u--,f-=n.pixelGroup;break;case Lu:u++,f+=n.pixelGroup;break;default:return console.warn("Marching squares invalid state: "+p),!0}}return!0}for(let l=0;l<n.width;l++)for(let c=0;c<n.height;c++){if(n.get(l,c)<=t)continue;const u=a(l,c);if(!(u<0||u===15)&&o(l,c))return r.path()}return null}const Qf={maxRoutingIterations:100,maxMarchingIterations:20,pixelGroup:4,edgeR0:10,edgeR1:20,nodeR0:15,nodeR1:50,morphBuffer:10,threshold:1,memberInfluenceFactor:1,edgeInfluenceFactor:1,nonMemberInfluenceFactor:-.8,virtualEdges:!0};function Ll(n){return n!=null&&typeof n.radius=="number"}function nA(n,t){if(Ll(n)!==Ll(t))return!1;if(Ll(n)){const r=t;return n.cx===r.cx&&n.cy===r.cy&&n.radius===r.radius}const e=t;return n.x===e.x&&n.y===e.y&&n.width===e.width&&n.height===e.height}var si;(function(n){n[n.MEMBERS=0]="MEMBERS",n[n.NON_MEMBERS=1]="NON_MEMBERS",n[n.EDGES=2]="EDGES"})(si||(si={}));let rA=class{constructor(t={}){this.dirty=new Set,this.members=[],this.nonMembers=[],this.virtualEdges=[],this.edges=[],this.activeRegion=new Yn(0,0,0,0),this.potentialArea=new Ps(1,0,0,0,0,0,0),this.o=Object.assign({},Qf,t)}pushMember(...t){if(t.length!==0){this.dirty.add(si.MEMBERS);for(const e of t)this.members.push({raw:e,obj:Ll(e)?Bh.from(e):Yn.from(e),area:null})}}removeMember(t){const e=this.members.findIndex(r=>nA(r.raw,t));return e<0?!1:(this.members.splice(e,1),this.dirty.add(si.MEMBERS),!0)}removeNonMember(t){const e=this.nonMembers.findIndex(r=>nA(r.raw,t));return e<0?!1:(this.nonMembers.splice(e,1),this.dirty.add(si.NON_MEMBERS),!0)}removeEdge(t){const e=this.edges.findIndex(r=>r.obj.equals(t));return e<0?!1:(this.edges.splice(e,1),this.dirty.add(si.NON_MEMBERS),!0)}pushNonMember(...t){if(t.length!==0){this.dirty.add(si.NON_MEMBERS);for(const e of t)this.nonMembers.push({raw:e,obj:Ll(e)?Bh.from(e):Yn.from(e),area:null})}}pushEdge(...t){if(t.length!==0){this.dirty.add(si.EDGES);for(const e of t)this.edges.push({raw:e,obj:Pn.from(e),area:null})}}update(){const t=this.dirty.has(si.MEMBERS),e=this.dirty.has(si.NON_MEMBERS);let r=this.dirty.has(si.EDGES);this.dirty.clear();const i=this.members.map(c=>c.obj);if(this.o.virtualEdges&&(t||e)){const c=this.nonMembers.map(f=>f.obj),u=tK(i,c,this.o.maxRoutingIterations,this.o.morphBuffer),h=new Map(this.virtualEdges.map(f=>[f.obj.toString(),f.area]));this.virtualEdges=u.map(f=>{var d;return{raw:f,obj:f,area:(d=h.get(f.toString()))!==null&&d!==void 0?d:null}}),r=!0}let a=!1;if(t||r){const c=this.virtualEdges.concat(this.edges).map(d=>d.obj),u=pK(i,c),h=Math.max(this.o.edgeR1,this.o.nodeR1)+this.o.morphBuffer,f=Yn.from(D3(u,h));f.equals(this.activeRegion)||(a=!0,this.activeRegion=f)}if(a){const c=Math.ceil(this.activeRegion.width/this.o.pixelGroup),u=Math.ceil(this.activeRegion.height/this.o.pixelGroup);this.activeRegion.x!==this.potentialArea.pixelX||this.activeRegion.y!==this.potentialArea.pixelY?(this.potentialArea=Ps.fromPixelRegion(this.activeRegion,this.o.pixelGroup),this.members.forEach(h=>h.area=null),this.nonMembers.forEach(h=>h.area=null),this.edges.forEach(h=>h.area=null),this.virtualEdges.forEach(h=>h.area=null)):(c!==this.potentialArea.width||u!==this.potentialArea.height)&&(this.potentialArea=Ps.fromPixelRegion(this.activeRegion,this.o.pixelGroup))}const s=new Map,o=c=>{if(c.area){const u=`${c.obj.width}x${c.obj.height}x${c.obj instanceof Yn?"R":"C"}`;s.set(u,c.area)}},l=c=>{if(c.area)return;const u=`${c.obj.width}x${c.obj.height}x${c.obj instanceof Yn?"R":"C"}`;if(s.has(u)){const f=s.get(u);c.area=this.potentialArea.copy(f,{x:c.obj.x-this.o.nodeR1,y:c.obj.y-this.o.nodeR1});return}const h=c.obj instanceof Yn?QX(c.obj,this.potentialArea,this.o.nodeR1):F3(c.obj,this.potentialArea,this.o.nodeR1);c.area=h,s.set(u,h)};this.members.forEach(o),this.nonMembers.forEach(o),this.members.forEach(l),this.nonMembers.forEach(c=>{this.activeRegion.intersects(c.obj)?l(c):c.area=null}),this.edges.forEach(c=>{c.area||(c.area=eA(c.obj,this.potentialArea,this.o.edgeR1))}),this.virtualEdges.forEach(c=>{c.area||(c.area=eA(c.obj,this.potentialArea,this.o.edgeR1))})}drawMembers(t){for(const e of this.members)e.obj.draw(t)}drawNonMembers(t){for(const e of this.nonMembers)e.obj.draw(t)}drawEdges(t){for(const e of this.edges)e.obj.draw(t)}drawPotentialArea(t,e=!0){this.potentialArea.draw(t,e)}compute(){if(this.members.length===0)return new Ho([]);this.dirty.size>0&&this.update();const{o:t,potentialArea:e}=this,r=this.members.map(o=>o.area),i=this.virtualEdges.concat(this.edges).map(o=>o.area),a=this.nonMembers.filter(o=>o.area!=null).map(o=>o.area),s=this.members.map(o=>o.obj);return gK(e,r,i,a,o=>o.containsElements(s),t)}};function gK(n,t,e,r,i,a={}){const s=Object.assign({},Qf,a);let o=s.threshold,l=s.memberInfluenceFactor,c=s.edgeInfluenceFactor,u=s.nonMemberInfluenceFactor;const h=(s.nodeR0-s.nodeR1)*(s.nodeR0-s.nodeR1),f=(s.edgeR0-s.edgeR1)*(s.edgeR0-s.edgeR1);for(let d=0;d<s.maxMarchingIterations;d++){if(n.clear(),l!==0){const v=l/h;for(const p of t)n.incArea(p,v)}if(c!==0){const v=c/f;for(const p of e)n.incArea(p,v)}if(u!==0){const v=u/h;for(const p of r)n.incArea(p,v)}const g=dK(n,o);if(g&&i(g))return g;if(o*=.95,d<=s.maxMarchingIterations*.5)l*=1.2,c*=1.2;else if(u!==0&&r.length>0)u*=.8;else break}return new Ho([])}function pK(n,t){if(n.length===0)return new Yn(0,0,0,0);const e=Yn.from(n[0]);for(const r of n)e.add(r);for(const r of t)e.add(R3(r));return e}var vK=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};class td extends Wn{constructor(t,e){super(t,fr({},td.defaultOptions,e)),this.members=new Map,this.avoidMembers=new Map,this.bubbleSetOptions={},this.drawBubbleSets=()=>{const{style:r,bubbleSetOptions:i}=this.parseOptions();en(this.bubbleSetOptions,i)||this.init(),this.bubbleSetOptions=Object.assign({},i);const a=Object.assign(Object.assign({},r),{d:this.getPath()});this.shape?this.shape.update(a):(this.shape=new bc({style:a}),this.context.canvas.appendChild(this.shape))},this.updateBubbleSetsPath=r=>{if(!this.shape)return;const i=tt(r.data);[...this.options.members,...this.options.avoidMembers].includes(i)&&this.shape.update(Object.assign(Object.assign({},this.parseOptions().style),{d:this.getPath(i)}))},this.getPath=r=>{const{graph:i}=this.context,a=this.options.members,s=[...this.members.keys()],o=this.options.avoidMembers,l=[...this.avoidMembers.keys()];if(!r&&en(a,s)&&en(o,l))return this.path;const{enter:c=[],exit:u=[]}=ja(s,a,p=>p),{enter:h=[],exit:f=[]}=ja(l,o,p=>p);r&&(u.push(r),c.push(r));const d=(p,y,m)=>{p.forEach(w=>{const E=m?this.members:this.avoidMembers,S=m?"pushMember":"pushNonMember",O=m?"removeMember":"removeNonMember";if(y){let k;i.getElementType(w)==="edge"?([k]=mK(i,w),this.bubbleSets.pushEdge(k)):([k]=yK(i,w),this.bubbleSets[S](k)),E.set(w,k)}else{const k=E.get(w);k&&(i.getElementType(w)==="edge"?this.bubbleSets.removeEdge(k):this.bubbleSets[O](k),E.delete(w))}})};d(u,!1,!0),d(c,!0,!0),d(f,!1,!1),d(h,!0,!1);const v=this.bubbleSets.compute().sample(8).simplify(0).bSplines().simplify(0);return this.path=ER(v.points.map(jn)),this.path},this.bindEvents(),this.bubbleSets=new rA(this.options)}bindEvents(){this.context.graph.on(Mt.AFTER_RENDER,this.drawBubbleSets),this.context.graph.on(Mt.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath)}init(){this.bubbleSets=new rA(this.options),this.members=new Map,this.avoidMembers=new Map}parseOptions(){const t=this.options,{type:e,key:r,members:i,avoidMembers:a}=t,s=vK(t,["type","key","members","avoidMembers"]),o=Object.keys(s).reduce((l,c)=>(c in Qf?l.bubbleSetOptions[c]=s[c]:l.style[c]=s[c],l),{style:{},bubbleSetOptions:{}});return Object.assign({type:e,key:r,members:i,avoidMembers:a},o)}addMember(t){const e=Array.isArray(t)?t:[t];e.some(r=>this.options.avoidMembers.includes(r))&&(this.options.avoidMembers=this.options.avoidMembers.filter(r=>!e.includes(r))),this.options.members=[...new Set([...this.options.members,...e])],this.drawBubbleSets()}removeMember(t){const e=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter(r=>!e.includes(r)),this.drawBubbleSets()}updateMember(t){this.options.members=zt(t)?t(this.options.members):t,this.drawBubbleSets()}getMember(){return this.options.members}addAvoidMember(t){const e=Array.isArray(t)?t:[t];e.some(r=>this.options.members.includes(r))&&(this.options.members=this.options.members.filter(r=>!e.includes(r))),this.options.avoidMembers=[...new Set([...this.options.avoidMembers,...e])],this.drawBubbleSets()}removeAvoidMember(t){const e=Array.isArray(t)?t:[t];this.options.avoidMembers.some(r=>e.includes(r))&&(this.options.avoidMembers=this.options.avoidMembers.filter(r=>!e.includes(r)),this.drawBubbleSets())}updateAvoidMember(t){this.options.avoidMembers=Array.isArray(t)?t:[t],this.drawBubbleSets()}getAvoidMember(){return this.options.avoidMembers}destroy(){this.context.graph.off(Mt.AFTER_RENDER,this.drawBubbleSets),this.context.graph.off(Mt.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath),this.shape.destroy(),super.destroy()}}td.defaultOptions=Object.assign({members:[],avoidMembers:[],fill:"lightblue",fillOpacity:.2,stroke:"blue",strokeOpacity:.2},Qf);const yK=(n,t)=>(Array.isArray(t)?t:[t]).map(r=>{const i=n.getElementRenderBounds(r);return new Yn(i.min[0],i.min[1],$i(i),Gi(i))}),mK=(n,t)=>(Array.isArray(t)?t:[t]).map(r=>{const i=n.getEdgeData(r),a=n.getElementPosition(i.source),s=n.getElementPosition(i.target);return Pn.from({x1:a[0],y1:a[1],x2:s[0],y2:s[1]})});function bK(n){return`
    <ul class="g6-contextmenu-ul">
      ${n.map(t=>`<li  class="g6-contextmenu-li" value="${t.value}">${t.name}</li>`).join("")}
    </ul>
  `}const wK=`
  .g6-contextmenu {
    font-size: 12px;
    background-color: rgba(255, 255, 255, 0.96);
    border-radius: 4px;
    overflow: hidden;
    box-shadow: rgba(0, 0, 0, 0.12) 0px 6px 12px 0px;
    transition: visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1) 0s, left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s;
  }

  .g6-contextmenu-ul {
    max-width: 256px;
    min-width: 96px;
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .g6-contextmenu-li {
    padding: 8px 12px;
    cursor: pointer;
    user-select: none;
  }

  .g6-contextmenu-li:hover {
    background-color: #f5f5f5;
    cursor: pointer;
  }
`;var iA=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(r.next(u))}catch(h){s(h)}}function l(u){try{c(r.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((r=r.apply(n,t||[])).next())})};class ed extends Wn{constructor(t,e){super(t,Object.assign({},ed.defaultOptions,e)),this.targetElement=null,this.onTriggerEvent=r=>{var i;(i=r.preventDefault)===null||i===void 0||i.call(r),this.show(r)},this.onMenuItemClick=r=>{const{onClick:i,trigger:a}=this.options;if(r.target instanceof HTMLElement&&r.target.className.includes("g6-contextmenu-li")){const s=r.target.getAttribute("value");i==null||i(s,r.target,this.targetElement),this.hide()}a!=="click"&&this.hide()},this.initElement(),this.update(e)}initElement(){this.$element=Vo("contextmenu",!1,{zIndex:"99"});const{className:t}=this.options;t&&this.$element.classList.add(t),this.context.canvas.getContainer().appendChild(this.$element),Rb("g6-contextmenu-css","style",{},wK,document.head)}show(t){return iA(this,void 0,void 0,function*(){const{enable:e,offset:r}=this.options;if(typeof e=="function"&&!e(t)||!e){this.hide();return}const i=yield this.getDOMContent(t);i instanceof HTMLElement?(this.$element.innerHTML="",this.$element.appendChild(i)):this.$element.innerHTML=i;const a=this.context.graph.getCanvas().getContainer().getBoundingClientRect();this.$element.style.left=`${t.client.x-a.left+r[0]}px`,this.$element.style.top=`${t.client.y-a.top+r[1]}px`,this.$element.style.display="block",this.targetElement=t.target})}hide(){this.$element.style.display="none",this.targetElement=null}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy(),this.$element.remove()}getDOMContent(t){return iA(this,void 0,void 0,function*(){const{getContent:e,getItems:r}=this.options;return r?bK(yield r(t)):yield e(t)})}bindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;t.on(`canvas:${e}`,this.onTriggerEvent),t.on(`node:${e}`,this.onTriggerEvent),t.on(`edge:${e}`,this.onTriggerEvent),t.on(`combo:${e}`,this.onTriggerEvent),document.addEventListener("click",this.onMenuItemClick)}unbindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;t.off(`canvas:${e}`,this.onTriggerEvent),t.off(`node:${e}`,this.onTriggerEvent),t.off(`edge:${e}`,this.onTriggerEvent),t.off(`combo:${e}`,this.onTriggerEvent),document.removeEventListener("click",this.onMenuItemClick)}}ed.defaultOptions={trigger:"contextmenu",offset:[4,4],loadingContent:'<div class="g6-contextmenu-loading">Loading...</div>',getContent:()=>"It is a empty context menu.",enable:()=>!0};class nd extends Wn{constructor(t,e){super(t,Object.assign({},nd.defaultOptions,e)),this.edgeBundles={},this.edgePoints={},this.onBundle=()=>{const{model:r,element:i}=this.context,a=r.getEdgeData();this.divideEdges(this.options.divisions);const{cycles:s,iterRate:o,divRate:l}=this.options;let{lambda:c,divisions:u,iterations:h}=this.options;for(let f=0;f<s;f++){for(let d=0;d<h;d++){const g={};a.forEach(v=>{var p;if(v.source===v.target)return;const y=tt(v);g[y]=this.getEdgeForces(v,u,c);for(let m=0;m<u+1;m++)(p=this.edgePoints)[y]||(p[y]=[]),this.edgePoints[y][m]=re(this.edgePoints[y][m],g[y][m])})}c/=2,u*=l,h*=o,this.divideEdges(u)}a.forEach(f=>{const d=tt(f),g=i.getElement(d);g==null||g.update({d:qw(this.edgePoints[d])})})},this.bindEvents()}get nodeMap(){const t=this.context.model.getNodeData();return Object.fromEntries(t.map(e=>[tt(e),Fs(fn(e))]))}divideEdges(t){this.context.model.getEdgeData().forEach(r=>{var i;const a=tt(r);(i=this.edgePoints)[a]||(i[a]=[]);const s=this.nodeMap[r.source],o=this.nodeMap[r.target];if(t===1)this.edgePoints[a].push(s),this.edgePoints[a].push(gi(re(s,o),2)),this.edgePoints[a].push(o);else{const c=(this.edgePoints[a].length===0?ze(s,o):MK(this.edgePoints[a]))/(t+1);let u=c;const h=[s];for(let f=1;f<this.edgePoints[a].length;f++){const d=this.edgePoints[a][f-1],g=this.edgePoints[a][f];let v=ze(g,d);for(;v>u;){const p=u/v,y=re(d,Qi(Me(g,d),p));h.push(y),v-=u,u=c}u-=v}h.push(o),this.edgePoints[a]=h}})}getVectorPosition(t){const e=this.nodeMap[t.source],r=this.nodeMap[t.target],[i,a]=Me(r,e),s=ze(e,r);return{source:e,target:r,vx:i,vy:a,length:s}}measureEdgeCompatibility(t,e){const r=this.getVectorPosition(t),i=this.getVectorPosition(e),a=xK(r,i),s=EK(r,i),o=SK(r,i),l=_K(r,i);return a*s*o*l}getEdgeBundles(){const t={},e=this.options.bundleThreshold,r=this.context.model.getEdgeData();return r.forEach((i,a)=>{r.forEach((s,o)=>{var l,c;if(o<=a)return;this.measureEdgeCompatibility(i,s)>=e&&(t[l=tt(i)]||(t[l]=[]),t[tt(i)].push(s),t[c=tt(s)]||(t[c]=[]),t[tt(s)].push(i))})}),t}getSpringForce(t,e){const{pre:r,cur:i,next:a}=t;return Qi(Me(re(r,a),Qi(i,2)),e)}getElectrostaticForce(t,e){Ti(this.edgeBundles)&&(this.edgeBundles=this.getEdgeBundles());const r=this.edgeBundles[tt(e)];let i=[0,0];return r==null||r.forEach(a=>{const s=this.edgePoints[tt(a)][t],o=this.edgePoints[tt(e)][t],l=Me(s,o),c=ze(s,o);i=re(i,Qi(l,1/c))}),i}getEdgeForces(t,e,r){const i=this.nodeMap[t.source],a=this.nodeMap[t.target],s=this.options.K/(ze(i,a)*(e+1)),o=[[0,0]],l=tt(t);for(let c=1;c<e;c++){const u=this.getSpringForce({pre:this.edgePoints[l][c-1],cur:this.edgePoints[l][c],next:this.edgePoints[l][c+1]||[0,0]},s),h=this.getElectrostaticForce(c,t);o.push(Qi(re(u,h),r))}return o.push([0,0]),o}bindEvents(){const{graph:t}=this.context;t.on(Mt.AFTER_RENDER,this.onBundle)}unbindEvents(){const{graph:t}=this.context;t.off(Mt.AFTER_RENDER,this.onBundle)}destroy(){this.unbindEvents(),super.destroy()}}nd.defaultOptions={K:.1,lambda:.1,divisions:1,divRate:2,cycles:6,iterations:90,iterRate:2/3,bundleThreshold:.6};const xK=(n,t)=>Math.abs(M9([n.vx,n.vy],[t.vx,t.vy])/(n.length*t.length)),EK=(n,t)=>{const e=(n.length+t.length)/2;return 2/(e/Math.min(n.length,t.length)+Math.max(n.length,t.length)/e)},SK=(n,t)=>{const e=(n.length+t.length)/2,r=gi(re(n.source,n.target),2),i=gi(re(t.source,t.target),2);return e/(e+ze(r,i))},aA=(n,t)=>{if(t.source[0]===t.target[0])return[t.source[0],n[1]];if(t.source[1]===t.target[1])return[n[0],t.source[1]];const e=(t.source[1]-t.target[1])/(t.source[0]-t.target[0]),r=(e*e*t.source[0]+e*(n[1]-t.source[1])+n[0])/(e*e+1),i=e*(r-t.source[0])+t.source[1];return[r,i]},sA=(n,t)=>{const e=aA(t.source,n),r=aA(t.target,n),i=gi(re(e,r),2),a=gi(re(n.source,n.target),2);return ze(e,r)===0?0:Math.max(0,1-2*ze(a,i)/ze(e,r))},_K=(n,t)=>Math.min(sA(n,t),sA(t,n)),MK=n=>{let t=0;for(let e=1;e<n.length;e++)t+=ze(n[e],n[e-1]);return t},OK={fill:"#fff",fillOpacity:1,lineWidth:1,stroke:"#000",strokeOpacity:.8,zIndex:-1/0},oA=.05;class rd extends Wn{constructor(t,e){super(t,Object.assign({},rd.defaultOptions,e)),this.shapes=new Map,this.r=this.options.r,this.onEdgeFilter=r=>{if(this.options.trigger==="drag"&&this.isLensOn)return;const i=jn(r.canvas);this.renderLens(i),this.renderFocusElements()},this.renderLens=r=>{const i=Object.assign({},OK,this.options.style);this.isLensOn||(this.lens=new wc({style:i}),this.canvas.appendChild(this.lens)),Object.assign(i,ci(r),{size:this.r*2}),this.lens.update(i)},this.getFilterData=()=>{const{filter:r}=this.options,{model:i}=this.context,a=i.getData();if(!r)return a;const{nodes:s,edges:o,combos:l}=a;return{nodes:s.filter(c=>r(tt(c),"node")),edges:o.filter(c=>r(tt(c),"edge")),combos:l.filter(c=>r(tt(c),"combo"))}},this.getFocusElements=r=>{const{nodes:i,edges:a}=this.getFilterData(),s=i.filter(c=>ze(fn(c),r)<this.r),o=s.map(c=>tt(c)),l=a.filter(c=>{const{source:u,target:h}=c,f=o.includes(u),d=o.includes(h);switch(this.options.nodeType){case"both":return f&&d;case"either":return f!==d;case"source":return f&&!d;case"target":return!f&&d;default:return!1}});return{nodes:s,edges:l}},this.renderFocusElements=()=>{const{element:r,graph:i}=this.context;if(!this.isLensOn)return;const a=this.lens.getCenter(),{nodes:s,edges:o}=this.getFocusElements(a),l=new Set,c=u=>{const h=tt(u);l.add(h);const f=r.getElement(h);if(!f)return;const d=this.shapes.get(h)||f.cloneNode();d.setPosition(f.getPosition()),d.id=f.id,this.shapes.has(h)?Object.entries(f.attributes).forEach(([p,y])=>{d.style[p]!==y&&(d.style[p]=y)}):(this.canvas.appendChild(d),this.shapes.set(h,d));const g=i.getElementType(h),v=this.getElementStyle(g,u);d.update(v)};s.forEach(c),o.forEach(c),this.shapes.forEach((u,h)=>{l.has(h)||(u.destroy(),this.shapes.delete(h))})},this.scaleRByWheel=r=>{var i;this.options.preventDefault&&r.preventDefault();const{clientX:a,clientY:s,deltaX:o,deltaY:l}=r,{graph:c,canvas:u}=this.context,h=c.getCanvasByClient([a,s]),f=(i=this.lens)===null||i===void 0?void 0:i.getCenter();if(!this.isLensOn||ze(h,f)>this.r)return;const{maxR:d,minR:g}=this.options,v=o+l>0?1/(1-oA):1-oA,p=Math.min(...u.getSize())/2;this.r=Math.max(g||0,Math.min(d||p,this.r*v)),this.renderLens(f),this.renderFocusElements()},this.isLensDragging=!1,this.onDragStart=r=>{var i;const a=jn(r.canvas),s=(i=this.lens)===null||i===void 0?void 0:i.getCenter();!this.isLensOn||ze(a,s)>this.r||(this.isLensDragging=!0)},this.onDrag=r=>{if(!this.isLensDragging)return;const i=jn(r.canvas);this.renderLens(i),this.renderFocusElements()},this.onDragEnd=()=>{this.isLensDragging=!1},this.bindEvents()}get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}getElementStyle(t,e){const r=t==="node"?this.options.nodeStyle:this.options.edgeStyle;return typeof r=="function"?r(e):r}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var t;const{graph:e}=this.context,{trigger:r,scaleRBy:i}=this.options,a=e.getCanvas().getLayer();["click","drag"].includes(r)&&a.addEventListener(st.CLICK,this.onEdgeFilter),r==="pointermove"?a.addEventListener(st.POINTER_MOVE,this.onEdgeFilter):r==="drag"&&(a.addEventListener(st.DRAG_START,this.onDragStart),a.addEventListener(st.DRAG,this.onDrag),a.addEventListener(st.DRAG_END,this.onDragEnd)),i==="wheel"&&((t=this.graphDom)===null||t===void 0||t.addEventListener(st.WHEEL,this.scaleRByWheel,{passive:!1}))}unbindEvents(){var t;const{graph:e}=this.context,{trigger:r,scaleRBy:i}=this.options,a=e.getCanvas().getLayer();["click","drag"].includes(r)&&a.removeEventListener(st.CLICK,this.onEdgeFilter),r==="pointermove"?a.removeEventListener(st.POINTER_MOVE,this.onEdgeFilter):r==="drag"&&(a.removeEventListener(st.DRAG_START,this.onDragStart),a.removeEventListener(st.DRAG,this.onDrag),a.removeEventListener(st.DRAG_END,this.onDragEnd)),i==="wheel"&&((t=this.graphDom)===null||t===void 0||t.removeEventListener(st.WHEEL,this.scaleRByWheel))}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),this.isLensOn&&this.lens.destroy(),this.shapes.forEach((t,e)=>{t.destroy(),this.shapes.delete(e)}),super.destroy()}}rd.defaultOptions={trigger:"pointermove",r:60,nodeType:"both",filter:()=>!0,style:{lineWidth:2},nodeStyle:{label:!1},edgeStyle:{label:!0},scaleRBy:"wheel",preventDefault:!0};const TK={fill:"#ccc",fillOpacity:.1,lineWidth:2,stroke:"#000",strokeOpacity:.8,labelFontSize:12},lA=.05,cA=.1;class id extends Wn{constructor(t,e){super(t,Object.assign({},id.defaultOptions,e)),this.r=this.options.r,this.d=this.options.d,this.onCreateFisheye=r=>{if(this.options.trigger==="drag"&&this.isLensOn)return;const i=jn(r.canvas);this.onMagnify(i)},this.onMagnify=r=>{r.some(isNaN)||(this.renderLens(r),this.renderFocusElements())},this.renderLens=r=>{const i=Object.assign({},TK,this.options.style);this.isLensOn||(this.lens=new wc({style:i}),this.canvas.appendChild(this.lens)),Object.assign(i,ci(r),{size:this.r*2,label:this.options.showDPercent,labelText:this.getDPercent()}),this.lens.update(i)},this.getDPercent=()=>{const{minD:r,maxD:i}=this.options;return`${Math.round((this.d-r)/(i-r)*100)}%`},this.prevMagnifiedStyleMap=new Map,this.prevOriginStyleMap=new Map,this.renderFocusElements=()=>{if(!this.isLensOn)return;const{graph:r}=this.context,i=this.lens.getCenter(),a=(this.d+1)*this.r,s=new Map,o=new Map;r.getNodeData().forEach(c=>{const u=fn(c),h=ze(u,i);if(h>this.r)return;const f=a*h/(this.d*h+this.r),[d,g]=u,[v,p]=i,y=(d-v)/h,m=(g-p)/h,w=[v+f*y,p+f*m],E=tt(c),S=this.getNodeStyle(c),O=Ns(r.getElementRenderStyle(E),Object.keys(S));s.set(E,Object.assign(Object.assign({},ci(w)),S)),o.set(E,Object.assign(Object.assign({},ci(u)),O))}),this.updateStyle(s,o)},this.getNodeStyle=r=>{const{nodeStyle:i}=this.options;return typeof i=="function"?i(r):i},this.updateStyle=(r,i)=>{const{graph:a,element:s}=this.context,{enter:o,exit:l,keep:c}=ja(Array.from(this.prevMagnifiedStyleMap.keys()),Array.from(r.keys()),f=>f),u=new Set,h=(f,d)=>{const g=s.getElement(f);g==null||g.update(d),a.getRelatedEdgesData(f).forEach(v=>{u.add(tt(v))})};[...o,...c].forEach(f=>{h(f,r.get(f))}),l.forEach(f=>{h(f,this.prevOriginStyleMap.get(f)),this.prevOriginStyleMap.delete(f)}),u.forEach(f=>{const d=s.getElement(f);d==null||d.update({})}),this.prevMagnifiedStyleMap=r,i.forEach((f,d)=>{this.prevOriginStyleMap.has(d)||this.prevOriginStyleMap.set(d,f)})},this.isWheelValid=r=>{if(this.options.preventDefault&&r.preventDefault(),!this.isLensOn)return!1;const{clientX:i,clientY:a}=r,s=this.context.graph.getCanvasByClient([i,a]),o=this.lens.getCenter();return!(ze(s,o)>this.r)},this.scaleR=r=>{const{maxR:i,minR:a}=this.options,s=r?1/(1-lA):1-lA,o=Math.min(...this.context.canvas.getSize())/2;this.r=Math.max(a||0,Math.min(i||o,this.r*s))},this.scaleD=r=>{const{maxD:i,minD:a}=this.options,s=r?this.d+cA:this.d-cA;this.d=Math.max(a,Math.min(i,s))},this.scaleRByWheel=r=>{if(!this.isWheelValid(r))return;const{deltaX:i,deltaY:a}=r;this.scaleR(i+a>0);const s=this.lens.getCenter();this.onMagnify(s)},this.scaleDByWheel=r=>{if(!this.isWheelValid(r))return;const{deltaX:i,deltaY:a}=r;this.scaleD(i+a>0);const s=this.lens.getCenter();this.onMagnify(s)},this.isDragValid=r=>{if(this.options.preventDefault&&r.preventDefault(),!this.isLensOn)return!1;const i=jn(r.canvas),a=this.lens.getCenter();return!(ze(i,a)>this.r)},this.isLensDragging=!1,this.onDragStart=r=>{this.isDragValid(r)&&(this.isLensDragging=!0)},this.onDrag=r=>{if(!this.isLensDragging)return;const i=jn(r.canvas);this.onMagnify(i)},this.onDragEnd=()=>{this.isLensDragging=!1},this.scaleRByDrag=r=>{if(!this.isLensDragging)return;const{dx:i,dy:a}=r;this.scaleR(i-a>0);const s=this.lens.getCenter();this.onMagnify(s)},this.scaleDByDrag=r=>{if(!this.isLensDragging)return;const{dx:i,dy:a}=r;this.scaleD(i-a>0);const s=this.lens.getCenter();this.onMagnify(s)},this.bindEvents()}get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var t;const{graph:e}=this.context,{trigger:r,scaleRBy:i,scaleDBy:a}=this.options,s=e.getCanvas().getLayer();if(["click","drag"].includes(r)&&s.addEventListener(st.CLICK,this.onCreateFisheye),r==="pointermove"&&s.addEventListener(st.POINTER_MOVE,this.onCreateFisheye),r==="drag"||i==="drag"||a==="drag"){s.addEventListener(st.DRAG_START,this.onDragStart),s.addEventListener(st.DRAG_END,this.onDragEnd);const o=r==="drag"?this.onDrag:i==="drag"?this.scaleRByDrag:this.scaleDByDrag;s.addEventListener(st.DRAG,o)}if(i==="wheel"||a==="wheel"){const o=i==="wheel"?this.scaleRByWheel:this.scaleDByWheel;(t=this.graphDom)===null||t===void 0||t.addEventListener(st.WHEEL,o,{passive:!1})}}unbindEvents(){var t;const{graph:e}=this.context,{trigger:r,scaleRBy:i,scaleDBy:a}=this.options,s=e.getCanvas().getLayer();if(["click","drag"].includes(r)&&s.removeEventListener(st.CLICK,this.onCreateFisheye),r==="pointermove"&&s.removeEventListener(st.POINTER_MOVE,this.onCreateFisheye),r==="drag"||i==="drag"||a==="drag"){s.removeEventListener(st.DRAG_START,this.onDragStart),s.removeEventListener(st.DRAG_END,this.onDragEnd);const o=r==="drag"?this.onDrag:i==="drag"?this.scaleRByDrag:this.scaleDByDrag;s.removeEventListener(st.DRAG,o)}if(i==="wheel"||a==="wheel"){const o=i==="wheel"?this.scaleRByWheel:this.scaleDByWheel;(t=this.graphDom)===null||t===void 0||t.removeEventListener(st.WHEEL,o)}}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){var t;this.unbindEvents(),this.isLensOn&&((t=this.lens)===null||t===void 0||t.destroy()),this.prevMagnifiedStyleMap.clear(),this.prevOriginStyleMap.clear(),super.destroy()}}id.defaultOptions={trigger:"pointermove",r:120,d:1.5,maxD:5,minD:0,showDPercent:!0,style:{},nodeStyle:{label:!0},preventDefault:!0};class ad extends Wn{constructor(t,e){super(t,Object.assign({},ad.defaultOptions,e)),this.$el=this.context.canvas.getContainer(),this.graphSize=[0,0],this.onFullscreenChange=()=>{var r,i,a,s;const o=!!document.fullscreenElement;this.options.autoFit&&this.setGraphSize(o),o?(i=(r=this.options).onEnter)===null||i===void 0||i.call(r):(s=(a=this.options).onExit)===null||s===void 0||s.call(a)},this.shortcut=new Fo(t.graph),this.bindEvents(),this.style=document.createElement("style"),document.head.appendChild(this.style),this.style.innerHTML=`
      :not(:root):fullscreen::backdrop {
        background: transparent;
      }
    `}bindEvents(){this.unbindEvents(),this.shortcut.unbindAll();const{request:t=[],exit:e=[]}=this.options.trigger;this.shortcut.bind(t,this.request),this.shortcut.bind(e,this.exit),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(i=>{document.addEventListener(i,this.onFullscreenChange,!1)})}unbindEvents(){this.shortcut.unbindAll(),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(e=>{document.removeEventListener(e,this.onFullscreenChange,!1)})}setGraphSize(t=!0){var e,r;let i,a;t?(i=((e=globalThis.screen)===null||e===void 0?void 0:e.width)||0,a=((r=globalThis.screen)===null||r===void 0?void 0:r.height)||0,this.graphSize=this.context.graph.getSize()):[i,a]=this.graphSize,this.context.graph.setSize(i,a),this.context.graph.render()}request(){document.fullscreenElement||!kK()||this.$el.requestFullscreen().catch(t=>{ji.warn(`Error attempting to enable full-screen: ${t.message} (${t.name})`)})}exit(){document.fullscreenElement&&document.exitFullscreen()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.exit(),this.style.remove(),super.destroy()}}ad.defaultOptions={trigger:{},autoFit:!0};function kK(){return document.fullscreenEnabled||Reflect.get(document,"webkitFullscreenEnabled")||Reflect.get(document,"mozFullscreenEnabled")||Reflect.get(document,"msFullscreenEnabled")}class sd extends Wn{constructor(t,e){super(t,Object.assign({},sd.defaultOptions,e)),this.$element=Vo("grid-line",!0),this.offset=[0,0],this.onTransform=i=>{if(!this.options.follow)return;const{data:{translate:a}}=i;a&&this.updateOffset(a)},this.context.canvas.getContainer().prepend(this.$element),this.updateStyle(),this.bindEvents()}update(t){super.update(t),this.updateStyle()}bindEvents(){const{graph:t}=this.context;t.on(Mt.AFTER_TRANSFORM,this.onTransform)}updateStyle(){const{size:t,stroke:e,lineWidth:r,border:i,borderLineWidth:a,borderStroke:s,borderStyle:o}=this.options;Object.assign(this.$element.style,{border:i?`${a}px ${o} ${s}`:"none",backgroundImage:`linear-gradient(${e} ${r}px, transparent ${r}px), linear-gradient(90deg, ${e} ${r}px, transparent ${r}px)`,backgroundSize:`${t}px ${t}px`,backgroundRepeat:"repeat"})}updateOffset(t){this.offset=T9(re(this.offset,t),this.options.size),this.$element.style.backgroundPosition=`${this.offset[0]}px ${this.offset[1]}px`}destroy(){this.context.graph.off(Mt.AFTER_TRANSFORM,this.onTransform),this.$element.remove(),super.destroy()}}sd.defaultOptions={border:!0,borderLineWidth:1,borderStroke:"#eee",borderStyle:"solid",lineWidth:1,size:20,stroke:"#eee"};function yx(n){const t={Added:new Map,Updated:new Map,Removed:new Map};return n.forEach(e=>{const{type:r,value:i}=e,a=tt(i);if(r==="NodeAdded"||r==="EdgeAdded"||r==="ComboAdded")t.Added.set(a,e);else if(r==="NodeUpdated"||r==="EdgeUpdated"||r==="ComboUpdated")if(t.Added.has(a))t.Added.set(a,{type:r.replace("Updated","Added"),value:i});else if(t.Updated.has(a)){const{original:s}=t.Updated.get(a);t.Updated.set(a,{type:r,value:i,original:s})}else t.Removed.has(a)||t.Updated.set(a,e);else(r==="NodeRemoved"||r==="EdgeRemoved"||r==="ComboRemoved")&&(t.Added.has(a)?t.Added.delete(a):(t.Updated.has(a)&&t.Updated.delete(a),t.Removed.set(a,e)))}),[...Array.from(t.Added.values()),...Array.from(t.Updated.values()),...Array.from(t.Removed.values())]}function z3(n){const{NodeAdded:t=[],NodeUpdated:e=[],NodeRemoved:r=[],EdgeAdded:i=[],EdgeUpdated:a=[],EdgeRemoved:s=[],ComboAdded:o=[],ComboUpdated:l=[],ComboRemoved:c=[]}=Kh(n,u=>u.type);return{add:{nodes:t,edges:i,combos:o},update:{nodes:e,edges:a,combos:l},remove:{nodes:r,edges:s,combos:c}}}function j3(n,t){for(const e in n)hn(n[e])&&!Array.isArray(n[e])&&n[e]!==null?(t[e]||(t[e]={}),j3(n[e],t[e])):t[e]===void 0&&(t[e]=Yl(e))}function AK(n,t=!1,e){const r={animation:t,current:{add:{},update:{},remove:{}},original:{add:{},update:{},remove:{}}},{add:i,update:a,remove:s}=z3(yx(n));return["nodes","edges","combos"].forEach(o=>{a[o]&&a[o].forEach(l=>{var c,u;const h=Object.assign({},l.value);let f=Object.assign({},l.original);if(e){const d=e.graph.getElementType(tt(l.original)),g=d==="edge"?"stroke":"fill",v=e.element.getElementComputedStyle(d,l.original);f=Object.assign(Object.assign({},l.original),{style:Object.assign({[g]:v[g]},l.original.style)})}j3(h,f),(c=r.current.update)[o]||(c[o]=[]),r.current.update[o].push(h),(u=r.original.update)[o]||(u[o]=[]),r.original.update[o].push(f)}),i[o]&&i[o].forEach(l=>{var c,u;const h=Object.assign({},l.value);(c=r.current.add)[o]||(c[o]=[]),r.current.add[o].push(h),(u=r.original.remove)[o]||(u[o]=[]),r.original.remove[o].push(h)}),s[o]&&s[o].forEach(l=>{var c,u;const h=Object.assign({},l.value);(c=r.current.remove)[o]||(c[o]=[]),r.current.remove[o].push(h),(u=r.original.add)[o]||(u[o]=[]),r.original.add[o].push(h)})}),r}class od extends Wn{constructor(t,e){super(t,Object.assign({},od.defaultOptions,e)),this.batchChanges=null,this.batchAnimation=!1,this.undoStack=[],this.redoStack=[],this.freezed=!1,this.executeCommand=(i,a=!0)=>{var s,o,l;this.freezed=!0,(o=(s=this.options).executeCommand)===null||o===void 0||o.call(s,i);const c=a?i.original:i.current;this.context.graph.addData(c.add),this.context.graph.updateData(c.update),this.context.graph.removeData(sR(c.remove,!1)),(l=this.context.element)===null||l===void 0||l.draw({silence:!0,animation:i.animation}),this.freezed=!1},this.addCommand=i=>{var a;if(!this.freezed){if(i.type===Mt.AFTER_DRAW){const{dataChanges:s=[],animation:o=!0}=i.data;if(!((a=this.context.batch)===null||a===void 0)&&a.isBatching){if(!this.batchChanges)return;this.batchChanges.push(s),this.batchAnimation&&(this.batchAnimation=o);return}this.batchChanges=[s],this.batchAnimation=o}this.undoStackPush(AK(this.batchChanges.flat(),this.batchAnimation,this.context)),this.notify(Ma.ADD,this.undoStack[this.undoStack.length-1])}},this.initBatchCommand=i=>{const{initiate:a}=i.data;this.batchAnimation=!1,a?this.batchChanges=[]:this.undoStack.pop()||(this.batchChanges=null)},this.emitter=new wf;const{graph:r}=this.context;r.on(Mt.AFTER_DRAW,this.addCommand),r.on(Mt.BATCH_START,this.initBatchCommand),r.on(Mt.BATCH_END,this.addCommand)}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}undo(){var t,e,r,i;const a=this.undoStack.pop();if(a){if(this.executeCommand(a),((e=(t=this.options).beforeAddCommand)===null||e===void 0?void 0:e.call(t,a,!1))===!1)return;this.redoStack.push(a),(i=(r=this.options).afterAddCommand)===null||i===void 0||i.call(r,a,!1),this.notify(Ma.UNDO,a)}return this}redo(){const t=this.redoStack.pop();return t&&(this.executeCommand(t,!1),this.undoStackPush(t),this.notify(Ma.REDO,t)),this}undoAndCancel(){const t=this.undoStack.pop();return t&&(this.executeCommand(t,!1),this.redoStack=[],this.notify(Ma.CANCEL,t)),this}undoStackPush(t){var e,r,i,a;const{stackSize:s}=this.options;s!==0&&this.undoStack.length>=s&&this.undoStack.shift(),((r=(e=this.options).beforeAddCommand)===null||r===void 0?void 0:r.call(e,t,!0))!==!1&&(this.undoStack.push(t),(a=(i=this.options).afterAddCommand)===null||a===void 0||a.call(i,t,!0))}clear(){this.undoStack=[],this.redoStack=[],this.batchChanges=null,this.batchAnimation=!1,this.notify(Ma.CLEAR,null)}notify(t,e){this.emitter.emit(t,{cmd:e}),this.emitter.emit(Ma.CHANGE,{cmd:e})}on(t,e){this.emitter.on(t,e)}destroy(){const{graph:t}=this.context;t.off(Mt.AFTER_DRAW,this.addCommand),t.off(Mt.BATCH_START,this.initBatchCommand),t.off(Mt.BATCH_END,this.addCommand),this.emitter.off(),super.destroy(),this.undoStack=[],this.redoStack=[]}}od.defaultOptions={stackSize:0};var o1,uA;function CK(){if(uA)return o1;uA=1;function n(e,r,i,a,s,o){const l=(o-r)*(i-e)-(a-r)*(s-e);return l>0?!0:!(l<0)}function t(e,r){const i=e[0][0],a=e[0][1],s=e[1][0],o=e[1][1],l=r[0][0],c=r[0][1],u=r[1][0],h=r[1][1];return n(i,a,l,c,u,h)!==n(s,o,l,c,u,h)&&n(i,a,s,o,l,c)!==n(i,a,s,o,u,h)}return o1=t,o1}var l1,hA;function PK(){if(hA)return l1;hA=1;function n(e,r){this._cells=[],this._cellSize=r,this._reverseCellSize=1/r;for(let i=0;i<e.length;i++){const a=e[i],s=this.coordToCellNum(a[0]),o=this.coordToCellNum(a[1]);if(this._cells[s])this._cells[s][o]?this._cells[s][o].push(a):this._cells[s][o]=[a];else{const l=[];l[o]=[a],this._cells[s]=l}}}n.prototype={cellPoints:function(e,r){return this._cells[e]!==void 0&&this._cells[e][r]!==void 0?this._cells[e][r]:[]},rangePoints:function(e){const r=this.coordToCellNum(e[0]),i=this.coordToCellNum(e[1]),a=this.coordToCellNum(e[2]),s=this.coordToCellNum(e[3]),o=[];for(let l=r;l<=a;l++)for(let c=i;c<=s;c++)for(let u=0;u<this.cellPoints(l,c).length;u++)o.push(this.cellPoints(l,c)[u]);return o},removePoint:function(e){const r=this.coordToCellNum(e[0]),i=this.coordToCellNum(e[1]),a=this._cells[r][i];let s;for(let o=0;o<a.length;o++)if(a[o][0]===e[0]&&a[o][1]===e[1]){s=o;break}return a.splice(s,1),a},trunc:Math.trunc||function(e){return e-e%1},coordToCellNum:function(e){return this.trunc(e*this._reverseCellSize)},extendBbox:function(e,r){return[e[0]-r*this._cellSize,e[1]-r*this._cellSize,e[2]+r*this._cellSize,e[3]+r*this._cellSize]}};function t(e,r){return new n(e,r)}return l1=t,l1}var c1,fA;function NK(){return fA||(fA=1,c1={toXy:function(n,t){return t===void 0?n.slice():n.map(function(e){return new Function("pt","return [pt"+t[0]+",pt"+t[1]+"];")(e)})},fromXy:function(n,t){return t===void 0?n.slice():n.map(function(e){return new Function("pt","const o = {}; o"+t[0]+"= pt[0]; o"+t[1]+"= pt[1]; return o;")(e)})}}),c1}var u1,dA;function RK(){if(dA)return u1;dA=1;function n(i,a,s){return(a[0]-i[0])*(s[1]-i[1])-(a[1]-i[1])*(s[0]-i[0])}function t(i){const a=[];for(let s=0;s<i.length;s++){for(;a.length>=2&&n(a[a.length-2],a[a.length-1],i[s])<=0;)a.pop();a.push(i[s])}return a.pop(),a}function e(i){const a=i.reverse(),s=[];for(let o=0;o<a.length;o++){for(;s.length>=2&&n(s[s.length-2],s[s.length-1],a[o])<=0;)s.pop();s.push(a[o])}return s.pop(),s}function r(i){const a=t(i),o=e(i).concat(a);return o.push(i[0]),o}return u1=r,u1}var h1,gA;function LK(){if(gA)return h1;gA=1;const n=CK(),t=PK(),e=NK(),r=RK();function i(p){const y=[p[0]];let m=p[0];for(let w=1;w<p.length;w++){const E=p[w];(m[0]!==E[0]||m[1]!==E[1])&&y.push(E),m=E}return y}function a(p){return p.sort(function(y,m){return y[0]-m[0]||y[1]-m[1]})}function s(p,y){return Math.pow(y[0]-p[0],2)+Math.pow(y[1]-p[1],2)}function o(p,y,m){const w=[y[0]-p[0],y[1]-p[1]],E=[m[0]-p[0],m[1]-p[1]],S=s(p,y),O=s(p,m);return(w[0]*E[0]+w[1]*E[1])/Math.sqrt(S*O)}function l(p,y){for(let m=0;m<y.length-1;m++){const w=[y[m],y[m+1]];if(!(p[0][0]===w[0][0]&&p[0][1]===w[0][1]||p[0][0]===w[1][0]&&p[0][1]===w[1][1])&&n(p,w))return!0}return!1}function c(p){let y=1/0,m=1/0,w=-1/0,E=-1/0;for(let S=p.length-1;S>=0;S--)p[S][0]<y&&(y=p[S][0]),p[S][1]<m&&(m=p[S][1]),p[S][0]>w&&(w=p[S][0]),p[S][1]>E&&(E=p[S][1]);return[w-y,E-m]}function u(p){return[Math.min(p[0][0],p[1][0]),Math.min(p[0][1],p[1][1]),Math.max(p[0][0],p[1][0]),Math.max(p[0][1],p[1][1])]}function h(p,y,m){let w=null,E=g,S=g,O,k;for(let T=0;T<y.length;T++)O=o(p[0],p[1],y[T]),k=o(p[1],p[0],y[T]),O>E&&k>S&&!l([p[0],y[T]],m)&&!l([p[1],y[T]],m)&&(E=O,S=k,w=y[T]);return w}function f(p,y,m,w,E){let S=!1;for(let O=0;O<p.length-1;O++){const k=[p[O],p[O+1]],T=k[0][0]+","+k[0][1]+","+k[1][0]+","+k[1][1];if(s(k[0],k[1])<y||E.has(T))continue;let C=0,P=u(k),N,L,D;do P=w.extendBbox(P,C),N=P[2]-P[0],L=P[3]-P[1],D=h(k,w.rangePoints(P),p),C++;while(D===null&&(m[0]>N||m[1]>L));N>=m[0]&&L>=m[1]&&E.add(T),D!==null&&(p.splice(O+1,0,D),w.removePoint(D),S=!0)}return S?f(p,y,m,w,E):p}function d(p,y,m){let w=y||20;const E=i(a(e.toXy(p,m)));if(E.length<4){const N=E.concat([E[0]]);return m?e.fromXy(N,m):N}const S=c(E),O=[S[0]*v,S[1]*v],k=r(E),T=E.filter(function(N){return k.indexOf(N)<0}),C=Math.ceil(1/(E.length/(S[0]*S[1]))),P=f(k,Math.pow(w,2),O,t(T,C),new Set);return m?e.fromXy(P,m):P}const g=Math.cos(90/(180/Math.PI)),v=.6;return h1=d,h1}var IK=LK();const DK=lc(IK);function FK(n,t,e){if(n.length===1)return BK(n[0],t,e);if(n.length===2)return pA(n,t,e);if(n.length===3){const[r,i,a]=Iw(n);if(dR(r,i,a))return pA([r,a],t,e)}switch(e){case"smooth":return jK(n,t);case"sharp":return qK(n,t);case"rounded":default:return zK(n,t)}}const BK=(n,t,e)=>{if(e==="sharp")return[["M",n[0]-t,n[1]-t],["L",n[0]+t,n[1]-t],["L",n[0]+t,n[1]+t],["L",n[0]-t,n[1]+t],["Z"]];const r=[t,t,0,0,0];return[["M",n[0],n[1]-t],["A",...r,n[0],n[1]+t],["A",...r,n[0],n[1]-t]]},pA=(n,t,e)=>{const r=[t,t,0,0,0],i=e==="sharp"?re(n[0],Na(sa(Me(n[0],n[1])),t)):n[0],a=e==="sharp"?re(n[1],Na(sa(Me(n[1],n[0])),t)):n[1],s=Na(sa(rf(Me(i,a),!1)),t),o=Na(s,-1),l=re(i,s),c=re(a,s),u=re(a,o),h=re(i,o);return e==="sharp"?[["M",l[0],l[1]],["L",c[0],c[1]],["L",u[0],u[1]],["L",h[0],h[1]],["Z"]]:[["M",l[0],l[1]],["L",c[0],c[1]],["A",...r,u[0],u[1]],["L",h[0],h[1]],["A",...r,l[0],l[1]]]},zK=(n,t)=>{const e=Iw(n).map((o,l)=>{const c=(l-2+n.length)%n.length,u=(l-1+n.length)%n.length,h=(l+1)%n.length,f=n[c],d=n[u],g=n[h],v=Me(f,d),p=Me(d,o),y=Me(o,g),m=(k,T)=>Rw(k,T,!0)<Math.PI,w=m(v,p),E=m(p,y),S=k=>Na(sa(rf(k,!1)),t),O=S(p);return[{p:Fs(w?re(d,S(v)):re(d,O)),concave:w&&d},{p:Fs(E?re(o,S(y)):re(o,O)),concave:E&&o}]}),r=[t,t,0,0,0],i=e.findIndex((o,l)=>!e[(l-1+e.length)%e.length][0].concave&&!e[(l-1+e.length)%e.length][1].concave&&!o[0].concave&&!o[0].concave&&!o[1].concave),a=e.slice(i).concat(e.slice(0,i));let s=[];return a.flatMap((o,l)=>{const c=[],u=a[e.length-1];return l===0&&c.push(["M",...u[1].p]),o[0].concave?s.push(o[0].p,o[1].p):c.push(["A",...r,...o[0].p]),o[1].concave?s.unshift(o[1].p):c.push(["L",...o[1].p]),s.length===3&&(c.pop(),c.push(["C",...s.flat()]),s=[]),c})},jK=(n,t)=>{const e=Iw(n).map((r,i)=>{const a=n[(i+1)%n.length];return{p:r,v:sa(Me(a,r))}});return e.forEach((r,i)=>{const a=i>0?i-1:n.length-1,s=e[a].v,o=sa(re(s,Na(r.v,Rw(s,r.v,!0)<Math.PI?1:-1)));r.p=re(r.p,Na(o,t))}),ER(e.map(r=>r.p))},qK=(n,t)=>{const r=n.map((a,s)=>{const o=n[s===0?n.length-1:s-1],l=Xl(Na(sa(rf(Me(o,a),!1)),t));return[re(o,l),re(a,l)]}).flat();return r.map((a,s)=>{if(s%2===0)return null;const o=[r[(s-1)%r.length],r[s%r.length]],l=[r[(s+1)%r.length],r[(s+2)%r.length]];return Lw(o,l,!0)}).filter(Boolean).map((a,s)=>[s===0?"M":"L",a[0],a[1]]).concat([["Z"]])};var $K=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};class ld extends Wn{constructor(t,e){super(t,Object.assign({},ld.defaultOptions,e)),this.hullMemberIds=[],this.drawHull=()=>{if(!this.shape)this.shape=new bc({style:this.getHullStyle()}),this.context.canvas.appendChild(this.shape);else{const r=!en(this.optionsCache,this.options);this.shape.update(this.getHullStyle(r))}this.optionsCache=Object.assign({},this.options)},this.updateHullPath=r=>{this.shape&&this.options.members.includes(tt(r.data))&&this.shape.update({d:this.getHullPath(!0)})},this.getHullPath=(r=!1)=>{const{graph:i}=this.context,a=this.getMember();if(a.length===0)return"";const s=a.map(c=>i.getNodeData(c)),o=DK(s.map(fn),this.options.concavity).slice(1).reverse(),l=o.flatMap(c=>s.filter(u=>en(fn(u),c)).map(tt));return en(l,this.hullMemberIds)&&!r?this.path:(this.hullMemberIds=l,this.path=FK(o,this.getPadding(),this.options.corner),this.path)},this.bindEvents()}bindEvents(){this.context.graph.on(Mt.AFTER_RENDER,this.drawHull),this.context.graph.on(Mt.AFTER_ELEMENT_UPDATE,this.updateHullPath)}getHullStyle(t){const e=this.options,{members:r,padding:i,corner:a}=e,s=$K(e,["members","padding","corner"]);return Object.assign(Object.assign({},s),{d:this.getHullPath(t)})}getPadding(){const{graph:t}=this.context;return this.hullMemberIds.reduce((r,i)=>{const{halfExtents:a}=t.getElementRenderBounds(i),s=Math.max(a[0],a[1]);return Math.max(r,s)},0)+this.options.padding}addMember(t){const e=Array.isArray(t)?t:[t];this.options.members=[...new Set([...this.options.members,...e])],this.shape.update({d:this.getHullPath()})}removeMember(t){const e=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter(r=>!e.includes(r)),e.some(r=>this.hullMemberIds.includes(r))&&this.shape.update({d:this.getHullPath()})}updateMember(t){this.options.members=zt(t)?t(this.options.members):t,this.shape.update(this.getHullStyle(!0))}getMember(){return this.options.members}destroy(){this.context.graph.off(Mt.AFTER_DRAW,this.drawHull),this.shape.destroy(),this.hullMemberIds=[],super.destroy()}}ld.defaultOptions={members:[],padding:10,corner:"rounded",concavity:1/0,fill:"lightblue",fillOpacity:.2,labelOpacity:1,stroke:"blue",strokeOpacity:.2};function q3(n,t){t(n),n.children&&n.children.forEach(function(e){e&&q3(e,t)})}function Cc(n){cd(n,!0)}function ui(n){cd(n,!1)}function cd(n,t){var e=t?"visible":"hidden";q3(n,function(r){r.attr("visibility",e)})}var GK=function(n){le(t,n);function t(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=n.apply(this,Rt([],$(e),!1))||this;return i.isMutationObserved=!0,i.addEventListener(ce.INSERTED,function(){ui(i)}),i}return t}(Tn);function $3(n){var t=n.appendChild(new GK({class:"offscreen"}));return ui(t),t}function WK(n){for(var t=n;t;){if(t.className==="offscreen")return!0;t=t.parent}return!1}var mx=function(n){le(t,n);function t(e){e===void 0&&(e={});var r=e.style,i=an(e,["style"]);return n.call(this,pt({style:pt({text:"",fill:"black",fontFamily:"sans-serif",fontSize:16,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineWidth:1,textAlign:"start",textBaseline:"middle"},r)},i))||this}return Object.defineProperty(t.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=$3(this)),this._offscreen},enumerable:!1,configurable:!0}),t.prototype.disconnectedCallback=function(){var e;(e=this._offscreen)===null||e===void 0||e.destroy()},t}(Qa);function Lo(n){return n*Math.PI/180}function G3(n){return Number((n*180/Math.PI).toPrecision(5))}var cr=function(){function n(t,e,r,i){t===void 0&&(t=0),e===void 0&&(e=0),r===void 0&&(r=0),i===void 0&&(i=0),this.x=0,this.y=0,this.width=0,this.height=0,this.x=t,this.y=e,this.width=r,this.height=i}return Object.defineProperty(n.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),n.fromRect=function(t){return new n(t.x,t.y,t.width,t.height)},n.prototype.toJSON=function(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.top,right:this.right,bottom:this.bottom,left:this.left}},n.prototype.isPointIn=function(t,e){return t>=this.left&&t<=this.right&&e>=this.top&&e<=this.bottom},n}();function Zr(n,t){return zt(n)?n.apply(void 0,Rt([],$(t),!1)):n}var yi=function(n,t){var e=function(i){return"".concat(t,"-").concat(i)},r=Object.fromEntries(Object.entries(n).map(function(i){var a=$(i,2),s=a[0],o=a[1],l=e(o);return[s,{name:l,class:".".concat(l),id:"#".concat(l),toString:function(){return l}}]}));return Object.assign(r,{prefix:e}),r},VK=5,W3=function(n,t,e,r){e===void 0&&(e=0),r===void 0&&(r=VK),Object.entries(t).forEach(function(i){var a=$(i,2),s=a[0],o=a[1],l=n;Object.prototype.hasOwnProperty.call(t,s)&&(o?Ao(o)?(Ao(n[s])||(l[s]={}),e<r?W3(n[s],o,e+1,r):l[s]=t[s]):$r(o)?(l[s]=[],l[s]=l[s].concat(o)):l[s]=o:l[s]=o)})},Ln=function(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];for(var r=0;r<t.length;r+=1)W3(n,t[r]);return n},V3=function(n){return n!==void 0&&n!=null&&!Number.isNaN(n)},Iu,HK=G1(function(n,t){var e=t.fontSize,r=t.fontFamily,i=t.fontWeight,a=t.fontStyle,s=t.fontVariant;return Iu||(Iu=bt.offscreenCanvasCreator.getOrCreateContext(void 0)),Iu.font=[a,s,i,"".concat(e,"px"),r].join(" "),Iu.measureText(n).width},function(n,t){return[n,Object.values(t||H3(n)).join()].join("")},4096),H3=function(n){var t=n.style.fontFamily||"sans-serif",e=n.style.fontWeight||"normal",r=n.style.fontStyle||"normal",i=n.style.fontVariant,a=n.style.fontSize;return a=typeof a=="object"?a.value:a,{fontSize:a,fontFamily:t,fontWeight:e,fontStyle:r,fontVariant:i}};function U3(n){return n.nodeName==="text"?n:n.nodeName==="g"&&n.children.length===1&&n.children[0].nodeName==="text"?n.children[0]:null}function Y3(n,t){var e=U3(n);e&&e.attr(t)}function Lb(n,t,e){e===void 0&&(e="..."),Y3(n,{wordWrap:!0,wordWrapWidth:t,maxLines:1,textOverflow:e})}function UK(n,t,e,r){e===void 0&&(e=2),r===void 0&&(r="top"),Y3(n,{wordWrap:!0,wordWrapWidth:t,maxLines:e,textBaseline:r})}function vA(n){var t=n.canvas,e=n.touches,r=n.offsetX,i=n.offsetY;if(t){var a=t.x,s=t.y;return[a,s]}if(e){var o=e[0],l=o.clientX,c=o.clientY;return[l,c]}return r&&i?[r,i]:[0,0]}function ua(n){return typeof n=="function"?n():me(n)||Lt(n)?new mx({style:{text:String(n)}}):n}function YK(n,t){return n.reduce(function(e,r){return(e[r[t]]=e[r[t]]||[]).push(r),e},{})}function qr(n,t,e,r,i){return r===void 0&&(r=!0),i===void 0&&(i=function(a){a.node().removeChildren()}),n?e(t):(r&&i(t),null)}function Bn(n,t,e,r,i){return r===void 0&&(r=!0),i===void 0&&(i=!1),r&&n===t||i&&n===e?!0:n>t&&n<e}var XK=function(n,t){return function(e){return n*(1-e)+t*e}};function KK(n,t){var e=t?t.length:0,r=n?Math.min(e,n.length):0;return function(i){var a=new Array(r),s=new Array(e),o=0;for(o=0;o<r;++o)a[o]=bx(n[o],t[o]);for(;o<e;++o)s[o]=t[o];for(o=0;o<r;++o)s[o]=a[o](i);return s}}function ZK(n,t){n===void 0&&(n={}),t===void 0&&(t={});var e={},r={};return Object.entries(t).forEach(function(i){var a=$(i,2),s=a[0],o=a[1];s in n?e[s]=bx(n[s],o):r[s]=o}),function(i){return Object.entries(e).forEach(function(a){var s=$(a,2),o=s[0],l=s[1];return r[o]=l(i)}),r}}function bx(n,t){return typeof n=="number"&&typeof t=="number"?XK(n,t):Array.isArray(n)&&Array.isArray(t)?KK(n,t):typeof n=="object"&&typeof t=="object"?ZK(n,t):function(e){return n}}function JK(n,t,e,r){if(!r)return n.attr("__keyframe_data__",e),null;var i=r.duration,a=i===void 0?0:i,s=bx(t,e),o=Math.ceil(+a/16),l=new Array(o).fill(0).map(function(c,u,h){return{__keyframe_data__:s(u/(h.length-1))}});return n.animate(l,pt({fill:"both"},r))}function na(n,t){return[n[0]*t,n[1]*t]}function ml(n,t){return[n[0]+t[0],n[1]+t[1]]}function f1(n,t){return[n[0]-t[0],n[1]-t[1]]}function fs(n,t){return[Math.min(n[0],t[0]),Math.min(n[1],t[1])]}function ds(n,t){return[Math.max(n[0],t[0]),Math.max(n[1],t[1])]}function nc(n,t){return Math.sqrt(Math.pow(n[0]-t[0],2)+Math.pow(n[1]-t[1],2))}function X3(n){if(n[0]===0&&n[1]===0)return[0,0];var t=Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2));return[n[0]/t,n[1]/t]}function QK(n,t){return t?[n[1],-n[0]]:[-n[1],n[0]]}function yA(n,t){return+n.toPrecision(t)}function mA(n,t){var e={},r=Array.isArray(t)?t:[t];for(var i in n)r.includes(i)||(e[i]=n[i]);return e}function tZ(n,t,e,r){var i,a=[],s=!!r,o,l,c=[1/0,1/0],u=[-1/0,-1/0],h,f,d;if(s){i=$(r,2),c=i[0],u=i[1];for(var g=0,v=n.length;g<v;g+=1){var p=n[g];c=fs(c,p),u=ds(u,p)}}for(var g=0,y=n.length;g<y;g+=1){var p=n[g];if(g===0)d=p;else if(g===y-1)f=p,a.push(d),a.push(f);else{var m=[g?g-1:y-1,g-1][1];o=n[m],l=n[g+1];var w=[0,0];w=f1(l,o),w=na(w,t);var E=nc(p,o),S=nc(p,l),O=E+S;O!==0&&(E/=O,S/=O);var k=na(w,-E),T=na(w,S);f=ml(p,k),h=ml(p,T),h=fs(h,ds(l,p)),h=ds(h,fs(l,p)),k=f1(h,p),k=na(k,-E/S),f=ml(p,k),f=fs(f,ds(o,p)),f=ds(f,fs(o,p)),T=f1(p,f),T=na(T,S/E),h=ml(p,T),s&&(f=ds(f,c),f=fs(f,u),h=ds(h,c),h=fs(h,u)),a.push(d),a.push(f),d=h}}return a}function eZ(n,t,e){e===void 0&&(e=[[0,0],[1,1]]);for(var r=!1,i=[],a=0,s=n.length;a<s;a+=2)i.push([n[a],n[a+1]]);for(var o=tZ(i,.4,r,e),l=i.length,c=[],u,h,f,a=0;a<l-1;a+=1)u=o[a*2],h=o[a*2+1],f=i[a+1],c.push(["C",u[0],u[1],h[0],h[1],f[0],f[1]]);return c}var nZ=["$el","cx","cy","d","dx","dy","fill","fillOpacity","filter","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","height","img","increasedLineWidthForHitTesting","innerHTML","isBillboard","billboardRotation","isSizeAttenuation","isClosed","isOverflowing","leading","letterSpacing","lineDash","lineHeight","lineWidth","markerEnd","markerEndOffset","markerMid","markerStart","markerStartOffset","maxLines","metrics","miterLimit","offsetX","offsetY","opacity","path","points","r","radius","rx","ry","shadowColor","src","stroke","strokeOpacity","text","textAlign","textBaseline","textDecorationColor","textDecorationLine","textDecorationStyle","textOverflow","textPath","textPathSide","textPathStartOffset","transform","transformOrigin","visibility","width","wordWrap","wordWrapWidth","x","x1","x2","y","y1","y2","z1","z2","zIndex"];function rZ(n){return nZ.includes(n)}function bA(n){var t={};for(var e in n)rZ(e)&&(t[e]=n[e]);return t}function iZ(n,t){if(n.length<=t)return n;for(var e=Math.floor(n.length/t),r=[],i=0;i<n.length;i+=e)r.push(n[i]);return r}function wx(n,t,e){var r=n.getBBox(),i=r.width,a=r.height,s=t/Math.max(i,a);return n.style.transform="scale(".concat(s,")"),s}function aZ(n,t){var e=new Map;return n.forEach(function(r){var i=t(r);e.has(i)||e.set(i,[]),e.get(i).push(r)}),e}function sZ(n){throw new Error(n)}var oZ=function(){function n(i,a,s,o,l,c,u){i===void 0&&(i=null),a===void 0&&(a=null),s===void 0&&(s=null),o===void 0&&(o=null),l===void 0&&(l=[null,null,null,null,null]),c===void 0&&(c=[]),u===void 0&&(u=[]),t.add(this),this._elements=Array.from(i),this._data=a,this._parent=s,this._document=o,this._enter=l[0],this._update=l[1],this._exit=l[2],this._merge=l[3],this._split=l[4],this._transitions=c,this._facetElements=u}n.prototype.selectAll=function(i){var a=typeof i=="string"?this._parent.querySelectorAll(i):i;return new e(a,null,this._elements[0],this._document)},n.prototype.selectFacetAll=function(i){var a=typeof i=="string"?this._parent.querySelectorAll(i):i;return new e(this._elements,null,this._parent,this._document,void 0,void 0,a)},n.prototype.select=function(i){var a=typeof i=="string"?this._parent.querySelectorAll(i)[0]||null:i;return new e([a],null,a,this._document)},n.prototype.append=function(i){var a=this,s=typeof i=="function"?i:function(){return a.createElement(i)},o=[];if(this._data!==null){for(var l=0;l<this._data.length;l++){var c=this._data[l],u=$(Array.isArray(c)?c:[c,null],2),h=u[0],f=u[1],d=s(h,l);d.__data__=h,f!==null&&(d.__fromElements__=f),this._parent.appendChild(d),o.push(d)}return new e(o,null,this._parent,this._document)}for(var l=0;l<this._elements.length;l++){var g=this._elements[l],h=g.__data__,d=s(h,l);g.appendChild(d),o.push(d)}return new e(o,null,o[0],this._document)},n.prototype.maybeAppend=function(i,a){var s=Hd(this,t,"m",r).call(this,i[0]==="#"?i:"#".concat(i),a);return s.attr("id",i),s},n.prototype.maybeAppendByClassName=function(i,a){var s=i.toString(),o=Hd(this,t,"m",r).call(this,s[0]==="."?s:".".concat(s),a);return o.attr("className",s),o},n.prototype.maybeAppendByName=function(i,a){var s=Hd(this,t,"m",r).call(this,'[name="'.concat(i,'"]'),a);return s.attr("name",i),s},n.prototype.data=function(i,a,s){var o,l;a===void 0&&(a=function(P){return P}),s===void 0&&(s=function(){return null});for(var c=[],u=[],h=new Set(this._elements),f=[],d=new Set,g=new Map(this._elements.map(function(P,N){return[a(P.__data__,N),P]})),v=new Map(this._facetElements.map(function(P,N){return[a(P.__data__,N),P]})),p=aZ(this._elements,function(P){return s(P.__data__)}),y=0;y<i.length;y++){var m=i[y],w=a(m,y),E=s(m,y);if(g.has(w)){var S=g.get(w);S.__data__=m,S.__facet__=!1,u.push(S),h.delete(S),g.delete(w)}else if(v.has(w)){var S=v.get(w);S.__data__=m,S.__facet__=!0,u.push(S),v.delete(w)}else if(p.has(w)){var O=p.get(w);f.push([m,O]);try{for(var k=(o=void 0,uc(O)),T=k.next();!T.done;T=k.next()){var S=T.value;h.delete(S)}}catch(P){o={error:P}}finally{try{T&&!T.done&&(l=k.return)&&l.call(k)}finally{if(o)throw o.error}}p.delete(w)}else if(g.has(E)){var S=g.get(E);S.__toData__?S.__toData__.push(m):S.__toData__=[m],d.add(S),h.delete(S)}else c.push(m)}var C=[new e([],c,this._parent,this._document),new e(u,null,this._parent,this._document),new e(h,null,this._parent,this._document),new e([],f,this._parent,this._document),new e(d,null,this._parent,this._document)];return new e(this._elements,null,this._parent,this._document,C)},n.prototype.merge=function(i){var a=Rt(Rt([],$(this._elements),!1),$(i._elements),!1),s=Rt(Rt([],$(this._transitions),!1),$(i._transitions),!1);return new e(a,null,this._parent,this._document,void 0,s)},n.prototype.createElement=function(i){if(this._document)return this._document.createElement(i,{});var a=e.registry[i];return a?new a:sZ("Unknown node type: ".concat(i))},n.prototype.join=function(i,a,s,o,l){i===void 0&&(i=function(g){return g}),a===void 0&&(a=function(g){return g}),s===void 0&&(s=function(g){return g.remove()}),o===void 0&&(o=function(g){return g}),l===void 0&&(l=function(g){return g.remove()});var c=i(this._enter),u=a(this._update),h=s(this._exit),f=o(this._merge),d=l(this._split);return u.merge(c).merge(h).merge(f).merge(d)},n.prototype.remove=function(){for(var i=function(o){var l=a._elements[o],c=a._transitions[o];c?c.then(function(){return l.remove()}):l.remove()},a=this,s=0;s<this._elements.length;s++)i(s);return new e([],null,this._parent,this._document,void 0,this._transitions)},n.prototype.each=function(i){for(var a=0;a<this._elements.length;a++){var s=this._elements[a],o=s.__data__;i.call(s,o,a)}return this},n.prototype.attr=function(i,a){var s=typeof a!="function"?function(){return a}:a;return this.each(function(o,l){a!==void 0&&(this[i]=s.call(this,o,l))})},n.prototype.style=function(i,a,s){s===void 0&&(s=!0);var o=typeof a!="function"||!s?function(){return a}:a;return this.each(function(l,c){a!==void 0&&(this.style[i]=o.call(this,l,c))})},n.prototype.styles=function(i,a){return i===void 0&&(i={}),a===void 0&&(a=!0),this.each(function(s,o){var l=this;Object.entries(i).forEach(function(c){var u=$(c,2),h=u[0],f=u[1],d=typeof f!="function"||!a?function(){return f}:f;f!==void 0&&l.attr(h,d.call(l,s,o))})})},n.prototype.update=function(i,a){a===void 0&&(a=!0);var s=typeof i!="function"||!a?function(){return i}:i;return this.each(function(o,l){i&&this.update&&this.update(s.call(this,o,l))})},n.prototype.maybeUpdate=function(i,a){a===void 0&&(a=!0);var s=typeof i!="function"||!a?function(){return i}:i;return this.each(function(o,l){i&&this.update&&this.update(s.call(this,o,l))})},n.prototype.transition=function(i){var a=this._transitions;return this.each(function(s,o){a[o]=i.call(this,s,o)})},n.prototype.on=function(i,a){return this.each(function(){this.addEventListener(i,a)}),this},n.prototype.call=function(i){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];return i.call.apply(i,Rt([this._parent,this],$(a),!1)),this},n.prototype.node=function(){return this._elements[0]},n.prototype.nodes=function(){return this._elements},n.prototype.transitions=function(){return this._transitions.filter(function(i){return!!i})},n.prototype.parent=function(){return this._parent};var t,e,r;return e=n,t=new WeakSet,r=function(a,s){var o=this._elements[0],l=o.querySelector(a);if(l)return new e([l],null,this._parent,this._document);var c=typeof s=="string"?this.createElement(s):s();return o.appendChild(c),new e([c],null,this._parent,this._document)},n.registry={g:Tn,rect:Rn,circle:da,path:Fr,text:mx,ellipse:dc,image:pc,line:Is,polygon:Gs,polyline:tf,html:gc},n}();function jt(n){return new oZ([n],null,n,n.ownerDocument)}function lZ(n,t,e){return n.querySelector(t)?jt(n).select(t):jt(n).append(e)}function $n(n){if(Lt(n))return[n,n,n,n];if($r(n)){var t=n.length;if(t===1)return[n[0],n[0],n[0],n[0]];if(t===2)return[n[0],n[1],n[0],n[1]];if(t===3)return[n[0],n[1],n[2],n[1]];if(t===4)return n}return[0,0,0,0]}function wA(n){var t=n.getLocalBounds(),e=t.min,r=t.max,i=$([e,r],2),a=$(i[0],2),s=a[0],o=a[1],l=$(i[1],2),c=l[0],u=l[1];return{x:s,y:o,width:c-s,height:u-o,left:s,bottom:u,top:o,right:c}}function cZ(n,t){var e=$(n,2),r=e[0],i=e[1],a=$(t,2),s=a[0],o=a[1];return r!==s&&i===o}function uZ(n,t){var e,r,i=t.attributes;try{for(var a=uc(Object.entries(i)),s=a.next();!s.done;s=a.next()){var o=$(s.value,2),l=o[0],c=o[1];l!=="id"&&l!=="className"&&n.attr(l,c)}}catch(u){e={error:u}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}}function xx(n){return n.toString().charAt(0).toUpperCase()+n.toString().slice(1)}function hZ(n){return n.toString().charAt(0).toLowerCase()+n.toString().slice(1)}function fZ(n,t){return"".concat(t).concat(xx(n))}function xA(n,t,e){var r;e===void 0&&(e=!0);var i=t||((r=n.match(/^([a-z][a-z0-9]+)/))===null||r===void 0?void 0:r[0])||"",a=n.replace(new RegExp("^(".concat(i,")")),"");return e?hZ(a):a}function dZ(n,t){Object.entries(t).forEach(function(e){var r=$(e,2),i=r[0],a=r[1];Rt([n],$(n.querySelectorAll(i)),!1).filter(function(s){return s.matches(i)}).forEach(function(s){if(s){var o=s;o.style.cssText+=Object.entries(a).reduce(function(l,c){return"".concat(l).concat(c.join(":"),";")},"")}})})}var Du=function(n,t){if(!(n!=null&&n.startsWith(t)))return!1;var e=n[t.length];return e>="A"&&e<="Z"};function te(n,t,e){e===void 0&&(e=!1);var r={};return Object.entries(n).forEach(function(i){var a=$(i,2),s=a[0],o=a[1];if(!(s==="className"||s==="class")){if(Du(s,"show")&&Du(xA(s,"show"),t)!==e)s===fZ(t,"show")?r[s]=o:r[s.replace(new RegExp(xx(t)),"")]=o;else if(!Du(s,"show")&&Du(s,t)!==e){var l=xA(s,t);l==="filter"&&typeof o=="function"||(r[l]=o)}}}),r}function ho(n,t){return Object.entries(n).reduce(function(e,r){var i=$(r,2),a=i[0],s=i[1];return a.startsWith("show")?e["show".concat(t).concat(a.slice(4))]=s:e["".concat(t).concat(xx(a))]=s,e},{})}function ha(n,t){t===void 0&&(t=["x","y","class","className"]);var e=["transform","transformOrigin","anchor","visibility","pointerEvents","zIndex","cursor","clipPath","clipPathTargets","offsetPath","offsetPathTargets","offsetDistance","draggable","droppable"],r={},i={};return Object.entries(n).forEach(function(a){var s=$(a,2),o=s[0],l=s[1];t.includes(o)||(e.indexOf(o)!==-1?i[o]=l:r[o]=l)}),[r,i]}function vr(n,t){var e={YYYY:n.getFullYear(),MM:n.getMonth()+1,DD:n.getDate(),HH:n.getHours(),mm:n.getMinutes(),ss:n.getSeconds()},r=t;return Object.keys(e).forEach(function(i){var a=e[i];r=r.replace(i,i==="YYYY"?"".concat(a):"".concat(a).padStart(2,"0"))}),r}function gZ(n,t,e){var r=n.getBBox(),i=r.width,a=r.height,s=$([t,e].map(function(c,u){var h;return c.includes("%")?parseFloat(((h=c.match(/[+-]?([0-9]*[.])?[0-9]+/))===null||h===void 0?void 0:h[0])||"0")/100*(u===0?i:a):c}),2),o=s[0],l=s[1];return[o,l]}function K3(n,t){if(t)try{var e=/translate\(([+-]*[\d]+[%]*),[ ]*([+-]*[\d]+[%]*)\)/g,r=t.replace(e,function(i,a,s){return"translate(".concat(gZ(n,a,s),")")});n.attr("transform",r)}catch{}}function pZ(n){var t;return((t=n[0])===null||t===void 0?void 0:t.map(function(e,r){return n.map(function(i){return i[r]})}))||[]}var EA=function(n,t){if(t==null){n.innerHTML="";return}n.replaceChildren?Array.isArray(t)?n.replaceChildren.apply(n,Rt([],$(t),!1)):n.replaceChildren(t):(n.innerHTML="",Array.isArray(t)?t.forEach(function(e){return n.appendChild(e)}):n.appendChild(t))};function vZ(){cd(this,this.attributes.visibility!=="hidden")}var sn=function(n){le(t,n);function t(e,r){r===void 0&&(r={});var i=n.call(this,Ln({},{style:r},e))||this;return i.initialized=!1,i._defaultOptions=r,i}return Object.defineProperty(t.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=$3(this)),this._offscreen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultOptions",{get:function(){return this._defaultOptions},enumerable:!1,configurable:!0}),t.prototype.connectedCallback=function(){this.render(this.attributes,this),this.bindEvents(this.attributes,this),this.initialized=!0},t.prototype.disconnectedCallback=function(){var e;(e=this._offscreen)===null||e===void 0||e.destroy()},t.prototype.attributeChangedCallback=function(e){e==="visibility"&&vZ.call(this)},t.prototype.update=function(e,r){var i;return this.attr(Ln({},this.attributes,e||{})),(i=this.render)===null||i===void 0?void 0:i.call(this,this.attributes,this,r)},t.prototype.clear=function(){this.removeChildren()},t.prototype.bindEvents=function(e,r){},t.prototype.getSubShapeStyle=function(e){e.x,e.y,e.transform,e.transformOrigin,e.class,e.className,e.zIndex;var r=an(e,["x","y","transform","transformOrigin","class","className","zIndex"]);return r},t}(_w),Z3=function(n,t,e){return[["M",n-e,t],["A",e,e,0,1,0,n+e,t],["A",e,e,0,1,0,n-e,t],["Z"]]},yZ=Z3,mZ=function(n,t,e){return[["M",n-e,t-e],["L",n+e,t-e],["L",n+e,t+e],["L",n-e,t+e],["Z"]]},bZ=function(n,t,e){return[["M",n-e,t],["L",n,t-e],["L",n+e,t],["L",n,t+e],["Z"]]},wZ=function(n,t,e){var r=e*Math.sin(.3333333333333333*Math.PI);return[["M",n-e,t+r],["L",n,t-r],["L",n+e,t+r],["Z"]]},xZ=function(n,t,e){var r=e*Math.sin(.3333333333333333*Math.PI);return[["M",n-e,t-r],["L",n+e,t-r],["L",n,t+r],["Z"]]},EZ=function(n,t,e){var r=e/2*Math.sqrt(3);return[["M",n,t-e],["L",n+r,t-e/2],["L",n+r,t+e/2],["L",n,t+e],["L",n-r,t+e/2],["L",n-r,t-e/2],["Z"]]},SZ=function(n,t,e){var r=e-1.5;return[["M",n-e,t-r],["L",n+e,t+r],["L",n+e,t-r],["L",n-e,t+r],["Z"]]},J3=function(n,t,e){return[["M",n,t+e],["L",n,t-e]]},_Z=function(n,t,e){return[["M",n-e,t-e],["L",n+e,t+e],["M",n+e,t-e],["L",n-e,t+e]]},MZ=function(n,t,e){return[["M",n-e/2,t-e],["L",n+e/2,t-e],["M",n,t-e],["L",n,t+e],["M",n-e/2,t+e],["L",n+e/2,t+e]]},OZ=function(n,t,e){return[["M",n-e,t],["L",n+e,t],["M",n,t-e],["L",n,t+e]]},TZ=function(n,t,e){return[["M",n-e,t],["L",n+e,t]]},Q3=function(n,t,e){return[["M",n-e,t],["L",n+e,t]]},kZ=Q3,AZ=function(n,t,e){return[["M",n-e,t],["A",e/2,e/2,0,1,1,n,t],["A",e/2,e/2,0,1,0,n+e,t]]},CZ=function(n,t,e){return[["M",n-e-1,t-2.5],["L",n,t-2.5],["L",n,t+2.5],["L",n+e+1,t+2.5]]},PZ=function(n,t,e){return[["M",n-e-1,t+2.5],["L",n,t+2.5],["L",n,t-2.5],["L",n+e+1,t-2.5]]},NZ=function(n,t,e){return[["M",n-(e+1),t+2.5],["L",n-e/2,t+2.5],["L",n-e/2,t-2.5],["L",n+e/2,t-2.5],["L",n+e/2,t+2.5],["L",n+e+1,t+2.5]]};function RZ(n,t){return[["M",n-5,t+2.5],["L",n-5,t],["L",n,t],["L",n,t-3],["L",n,t+3],["L",n+6.5,t+3]]}var LZ=function(n,t,e){return[["M",n-e,t-e],["L",n+e,t],["L",n-e,t+e],["Z"]]};function IZ(n){var t="default";if(hn(n)&&n instanceof Image)t="image";else if(zt(n))t="symbol";else if(me(n)){var e=new RegExp("data:(image|text)");n.match(e)?t="base64":/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(n)?t="url":t="symbol"}return t}function DZ(n){var t=IZ(n);return["base64","url","image"].includes(t)?"image":n&&t==="symbol"?"path":null}var ke=function(n){le(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.render=function(e,r){var i=e.x,a=i===void 0?0:i,s=e.y,o=s===void 0?0:s,l=this.getSubShapeStyle(e),c=l.symbol,u=l.size,h=u===void 0?16:u,f=an(l,["symbol","size"]),d=DZ(c);qr(!!d,jt(r),function(g){g.maybeAppendByClassName("marker",d).attr("className","marker ".concat(d,"-marker")).call(function(v){if(d==="image"){var p=h*2;v.styles({img:c,width:p,height:p,x:a-h,y:o-h})}else{var p=h/2,y=zt(c)?c:t.getSymbol(c);v.styles(pt({d:y==null?void 0:y(a,o,p)},f))}})})},t.MARKER_SYMBOL_MAP=new Map,t.registerSymbol=function(e,r){t.MARKER_SYMBOL_MAP.set(e,r)},t.getSymbol=function(e){return t.MARKER_SYMBOL_MAP.get(e)},t.getSymbols=function(){return Array.from(t.MARKER_SYMBOL_MAP.keys())},t}(sn);ke.registerSymbol("cross",_Z);ke.registerSymbol("hyphen",TZ);ke.registerSymbol("line",J3);ke.registerSymbol("plus",OZ);ke.registerSymbol("tick",MZ);ke.registerSymbol("circle",Z3);ke.registerSymbol("point",yZ);ke.registerSymbol("bowtie",SZ);ke.registerSymbol("hexagon",EZ);ke.registerSymbol("square",mZ);ke.registerSymbol("diamond",bZ);ke.registerSymbol("triangle",wZ);ke.registerSymbol("triangle-down",xZ);ke.registerSymbol("line",J3);ke.registerSymbol("dot",Q3);ke.registerSymbol("dash",kZ);ke.registerSymbol("smooth",AZ);ke.registerSymbol("hv",CZ);ke.registerSymbol("vh",PZ);ke.registerSymbol("hvh",NZ);ke.registerSymbol("vhv",RZ);function zh(n,...t){return t.reduce((e,r)=>i=>e(r(i)),n)}function Ib(n,t){return t-n?e=>(e-n)/(t-n):e=>.5}function FZ(n,t){const e=t<n?t:n,r=n>t?n:t;return i=>Math.min(Math.max(e,i),r)}function BZ(n,t,e,r,i){let a=e,s=r||n.length;const o=l=>l;for(;a<s;){const l=Math.floor((a+s)/2);o(n[l])>t?s=l:a=l+1}return a}const SA=Math.sqrt(50),_A=Math.sqrt(10),MA=Math.sqrt(2);function Ku(n,t,e){const r=(t-n)/Math.max(0,e),i=Math.floor(Math.log(r)/Math.LN10),a=r/10**i;return i>=0?(a>=SA?10:a>=_A?5:a>=MA?2:1)*10**i:-(10**-i)/(a>=SA?10:a>=_A?5:a>=MA?2:1)}const zZ=(n,t,e=5)=>{const r=[n,t];let i=0,a=r.length-1,s=r[i],o=r[a],l;return o<s&&([s,o]=[o,s],[i,a]=[a,i]),l=Ku(s,o,e),l>0?(s=Math.floor(s/l)*l,o=Math.ceil(o/l)*l,l=Ku(s,o,e)):l<0&&(s=Math.ceil(s*l)/l,o=Math.floor(o*l)/l,l=Ku(s,o,e)),l>0?(r[i]=Math.floor(s/l)*l,r[a]=Math.ceil(o/l)*l):l<0&&(r[i]=Math.ceil(s*l)/l,r[a]=Math.floor(o*l)/l),r};function OA(n){return!Qt(n)&&!wB(n)&&!Number.isNaN(n)}var d1={exports:{}},g1,TA;function jZ(){return TA||(TA=1,g1={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),g1}var p1={exports:{}},v1,kA;function qZ(){return kA||(kA=1,v1=function(t){return!t||typeof t=="string"?!1:t instanceof Array||Array.isArray(t)||t.length>=0&&(t.splice instanceof Function||Object.getOwnPropertyDescriptor(t,t.length-1)&&t.constructor.name!=="String")}),v1}var AA;function $Z(){if(AA)return p1.exports;AA=1;var n=qZ(),t=Array.prototype.concat,e=Array.prototype.slice,r=p1.exports=function(a){for(var s=[],o=0,l=a.length;o<l;o++){var c=a[o];n(c)?s=t.call(s,e.call(c)):s.push(c)}return s};return r.wrap=function(i){return function(){return i(r(arguments))}},p1.exports}var CA;function GZ(){if(CA)return d1.exports;CA=1;var n=jZ(),t=$Z(),e=Object.hasOwnProperty,r=Object.create(null);for(var i in n)e.call(n,i)&&(r[n[i]]=i);var a=d1.exports={to:{},get:{}};a.get=function(l){var c=l.substring(0,3).toLowerCase(),u,h;switch(c){case"hsl":u=a.get.hsl(l),h="hsl";break;case"hwb":u=a.get.hwb(l),h="hwb";break;default:u=a.get.rgb(l),h="rgb";break}return u?{model:h,value:u}:null},a.get.rgb=function(l){if(!l)return null;var c=/^#([a-f0-9]{3,4})$/i,u=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,h=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,f=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,d=/^(\w+)$/,g=[0,0,0,1],v,p,y;if(v=l.match(u)){for(y=v[2],v=v[1],p=0;p<3;p++){var m=p*2;g[p]=parseInt(v.slice(m,m+2),16)}y&&(g[3]=parseInt(y,16)/255)}else if(v=l.match(c)){for(v=v[1],y=v[3],p=0;p<3;p++)g[p]=parseInt(v[p]+v[p],16);y&&(g[3]=parseInt(y+y,16)/255)}else if(v=l.match(h)){for(p=0;p<3;p++)g[p]=parseInt(v[p+1],0);v[4]&&(v[5]?g[3]=parseFloat(v[4])*.01:g[3]=parseFloat(v[4]))}else if(v=l.match(f)){for(p=0;p<3;p++)g[p]=Math.round(parseFloat(v[p+1])*2.55);v[4]&&(v[5]?g[3]=parseFloat(v[4])*.01:g[3]=parseFloat(v[4]))}else return(v=l.match(d))?v[1]==="transparent"?[0,0,0,0]:e.call(n,v[1])?(g=n[v[1]],g[3]=1,g):null:null;for(p=0;p<3;p++)g[p]=s(g[p],0,255);return g[3]=s(g[3],0,1),g},a.get.hsl=function(l){if(!l)return null;var c=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,u=l.match(c);if(u){var h=parseFloat(u[4]),f=(parseFloat(u[1])%360+360)%360,d=s(parseFloat(u[2]),0,100),g=s(parseFloat(u[3]),0,100),v=s(isNaN(h)?1:h,0,1);return[f,d,g,v]}return null},a.get.hwb=function(l){if(!l)return null;var c=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,u=l.match(c);if(u){var h=parseFloat(u[4]),f=(parseFloat(u[1])%360+360)%360,d=s(parseFloat(u[2]),0,100),g=s(parseFloat(u[3]),0,100),v=s(isNaN(h)?1:h,0,1);return[f,d,g,v]}return null},a.to.hex=function(){var l=t(arguments);return"#"+o(l[0])+o(l[1])+o(l[2])+(l[3]<1?o(Math.round(l[3]*255)):"")},a.to.rgb=function(){var l=t(arguments);return l.length<4||l[3]===1?"rgb("+Math.round(l[0])+", "+Math.round(l[1])+", "+Math.round(l[2])+")":"rgba("+Math.round(l[0])+", "+Math.round(l[1])+", "+Math.round(l[2])+", "+l[3]+")"},a.to.rgb.percent=function(){var l=t(arguments),c=Math.round(l[0]/255*100),u=Math.round(l[1]/255*100),h=Math.round(l[2]/255*100);return l.length<4||l[3]===1?"rgb("+c+"%, "+u+"%, "+h+"%)":"rgba("+c+"%, "+u+"%, "+h+"%, "+l[3]+")"},a.to.hsl=function(){var l=t(arguments);return l.length<4||l[3]===1?"hsl("+l[0]+", "+l[1]+"%, "+l[2]+"%)":"hsla("+l[0]+", "+l[1]+"%, "+l[2]+"%, "+l[3]+")"},a.to.hwb=function(){var l=t(arguments),c="";return l.length>=4&&l[3]!==1&&(c=", "+l[3]),"hwb("+l[0]+", "+l[1]+"%, "+l[2]+"%"+c+")"},a.to.keyword=function(l){return r[l.slice(0,3)]};function s(l,c,u){return Math.min(Math.max(c,l),u)}function o(l){var c=Math.round(l).toString(16).toUpperCase();return c.length<2?"0"+c:c}return d1.exports}var WZ=GZ();const VZ=lc(WZ);function y1(n,t,e){let r=e;return r<0&&(r+=1),r>1&&(r-=1),r<1/6?n+(t-n)*6*r:r<1/2?t:r<2/3?n+(t-n)*(2/3-r)*6:n}function HZ(n){const t=n[0]/360,e=n[1]/100,r=n[2]/100,i=n[3];if(e===0)return[r*255,r*255,r*255,i];const a=r<.5?r*(1+e):r+e-r*e,s=2*r-a,o=y1(s,a,t+1/3),l=y1(s,a,t),c=y1(s,a,t-1/3);return[o*255,l*255,c*255,i]}function PA(n){const t=VZ.get(n);if(!t)return null;const{model:e,value:r}=t;return e==="rgb"?r:e==="hsl"?HZ(r):null}const jh=(n,t)=>e=>n*(1-e)+t*e,UZ=(n,t)=>{const e=PA(n),r=PA(t);return e===null||r===null?e?()=>n:()=>t:i=>{const a=new Array(4);for(let u=0;u<4;u+=1){const h=e[u],f=r[u];a[u]=h*(1-i)+f*i}const[s,o,l,c]=a;return`rgba(${Math.round(s)}, ${Math.round(o)}, ${Math.round(l)}, ${c})`}},YZ=(n,t)=>typeof n=="number"&&typeof t=="number"?jh(n,t):typeof n=="string"&&typeof t=="string"?UZ(n,t):()=>n,XZ=(n,t)=>{const e=jh(n,t);return r=>Math.round(e(r))};function NA({map:n,initKey:t},e){const r=t(e);return n.has(r)?n.get(r):e}function KZ({map:n,initKey:t},e){const r=t(e);return n.has(r)?n.get(r):(n.set(r,e),e)}function ZZ({map:n,initKey:t},e){const r=t(e);return n.has(r)&&(e=n.get(r),n.delete(r)),e}function JZ(n){return typeof n=="object"?n.valueOf():n}class RA extends Map{constructor(t){if(super(),this.map=new Map,this.initKey=JZ,t!==null)for(const[e,r]of t)this.set(e,r)}get(t){return super.get(NA({map:this.map,initKey:this.initKey},t))}has(t){return super.has(NA({map:this.map,initKey:this.initKey},t))}set(t,e){return super.set(KZ({map:this.map,initKey:this.initKey},t),e)}delete(t){return super.delete(ZZ({map:this.map,initKey:this.initKey},t))}}class tI{constructor(t){this.options=fr({},this.getDefaultOptions()),this.update(t)}getOptions(){return this.options}update(t={}){this.options=fr({},this.options,t),this.rescale(t)}rescale(t){}}const Ex=Symbol("defaultUnknown");function LA(n,t,e){for(let r=0;r<t.length;r+=1)n.has(t[r])||n.set(e(t[r]),r)}function IA(n){const{value:t,from:e,to:r,mapper:i,notFoundReturn:a}=n;let s=i.get(t);if(s===void 0){if(a!==Ex)return a;s=e.push(t)-1,i.set(t,s)}return r[s%r.length]}function DA(n){return n instanceof Date?t=>`${t}`:typeof n=="object"?t=>JSON.stringify(t):t=>t}class Sx extends tI{getDefaultOptions(){return{domain:[],range:[],unknown:Ex}}constructor(t){super(t)}map(t){return this.domainIndexMap.size===0&&LA(this.domainIndexMap,this.getDomain(),this.domainKey),IA({value:this.domainKey(t),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(t){return this.rangeIndexMap.size===0&&LA(this.rangeIndexMap,this.getRange(),this.rangeKey),IA({value:this.rangeKey(t),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(t){const[e]=this.options.domain,[r]=this.options.range;if(this.domainKey=DA(e),this.rangeKey=DA(r),!this.rangeIndexMap){this.rangeIndexMap=new Map,this.domainIndexMap=new Map;return}(!t||t.range)&&this.rangeIndexMap.clear(),(!t||t.domain||t.compare)&&(this.domainIndexMap.clear(),this.sortedDomain=void 0)}clone(){return new Sx(this.options)}getRange(){return this.options.range}getDomain(){if(this.sortedDomain)return this.sortedDomain;const{domain:t,compare:e}=this.options;return this.sortedDomain=e?[...t].sort(e):t,this.sortedDomain}}function QZ(n){const t=Math.min(...n);return n.map(e=>e/t)}function tJ(n,t){const e=n.length,r=t-e;return r>0?[...n,...new Array(r).fill(1)]:r<0?n.slice(0,t):n}function eJ(n){return Math.round(n*1e12)/1e12}function nJ(n){const{domain:t,range:e,paddingOuter:r,paddingInner:i,flex:a,round:s,align:o}=n,l=t.length,c=tJ(a,l),[u,h]=e,f=h-u,d=2/l*r+1-1/l*i,g=f/d,v=g*i/l,p=g-l*v,y=QZ(c),m=y.reduce((L,D)=>L+D),w=p/m,E=new RA(t.map((L,D)=>{const G=y[D]*w;return[L,s?Math.floor(G):G]})),S=new RA(t.map((L,D)=>{const H=y[D]*w+v;return[L,s?Math.floor(H):H]})),O=Array.from(S.values()).reduce((L,D)=>L+D),T=(f-(O-O/l*i))*o,C=u+T;let P=s?Math.round(C):C;const N=new Array(l);for(let L=0;L<l;L+=1){N[L]=eJ(P);const D=t[L];P+=S.get(D)}return{valueBandWidth:E,valueStep:S,adjustedRange:N}}function rJ(n){var t;const{domain:e}=n,r=e.length;if(r===0)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(!!(!((t=n.flex)===null||t===void 0)&&t.length))return nJ(n);const{range:a,paddingOuter:s,paddingInner:o,round:l,align:c}=n;let u,h,f=a[0];const g=a[1]-f,v=s*2,p=r-o;u=g/Math.max(1,v+p),l&&(u=Math.floor(u)),f+=(g-u*(r-o))*c,h=u*(1-o),l&&(f=Math.round(f),h=Math.round(h));const y=new Array(r).fill(0).map((m,w)=>f+w*u);return{valueStep:u,valueBandWidth:h,adjustedRange:y}}class _x extends Sx{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:Ex,flex:[]}}constructor(t){super(t)}clone(){return new _x(this.options)}getStep(t){return this.valueStep===void 0?1:typeof this.valueStep=="number"?this.valueStep:t===void 0?Array.from(this.valueStep.values())[0]:this.valueStep.get(t)}getBandWidth(t){return this.valueBandWidth===void 0?1:typeof this.valueBandWidth=="number"?this.valueBandWidth:t===void 0?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(t)}getRange(){return this.adjustedRange}getPaddingInner(){const{padding:t,paddingInner:e}=this.options;return t>0?t:e}getPaddingOuter(){const{padding:t,paddingOuter:e}=this.options;return t>0?t:e}rescale(){super.rescale();const{align:t,domain:e,range:r,round:i,flex:a}=this.options,{adjustedRange:s,valueBandWidth:o,valueStep:l}=rJ({align:t,range:r,round:i,flex:a,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:e});this.valueStep=l,this.valueBandWidth=o,this.adjustedRange=s}}const iJ=(n,t,e)=>{let r,i,a=n,s=t;if(a===s&&e>0)return[a];let o=Ku(a,s,e);if(o===0||!Number.isFinite(o))return[];if(o>0){a=Math.ceil(a/o),s=Math.floor(s/o),i=new Array(r=Math.ceil(s-a+1));for(let l=0;l<r;l+=1)i[l]=(a+l)*o}else{o=-o,a=Math.ceil(a*o),s=Math.floor(s*o),i=new Array(r=Math.ceil(s-a+1));for(let l=0;l<r;l+=1)i[l]=(a+l)/o}return i},aJ=(n,t,e)=>{const[r,i]=n,[a,s]=t;let o,l;return r<i?(o=Ib(r,i),l=e(a,s)):(o=Ib(i,r),l=e(s,a)),zh(l,o)},sJ=(n,t,e)=>{const r=Math.min(n.length,t.length)-1,i=new Array(r),a=new Array(r),s=n[0]>n[r],o=s?[...n].reverse():n,l=s?[...t].reverse():t;for(let c=0;c<r;c+=1)i[c]=Ib(o[c],o[c+1]),a[c]=e(l[c],l[c+1]);return c=>{const u=BZ(n,c,1,r)-1,h=i[u],f=a[u];return zh(f,h)(c)}},FA=(n,t,e,r)=>(Math.min(n.length,t.length)>2?sJ:aJ)(n,t,r?XZ:e);class oJ extends tI{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:jh,tickCount:5}}map(t){return OA(t)?this.output(t):this.options.unknown}invert(t){return OA(t)?this.input(t):this.options.unknown}nice(){if(!this.options.nice)return;const[t,e,r,...i]=this.getTickMethodOptions();this.options.domain=this.chooseNice()(t,e,r,...i)}getTicks(){const{tickMethod:t}=this.options,[e,r,i,...a]=this.getTickMethodOptions();return t(e,r,i,...a)}getTickMethodOptions(){const{domain:t,tickCount:e}=this.options,r=t[0],i=t[t.length-1];return[r,i,e]}chooseNice(){return zZ}rescale(){this.nice();const[t,e]=this.chooseTransforms();this.composeOutput(t,this.chooseClamp(t)),this.composeInput(t,e,this.chooseClamp(e))}chooseClamp(t){const{clamp:e,range:r}=this.options,i=this.options.domain.map(t),a=Math.min(i.length,r.length);return e?FZ(i[0],i[a-1]):W1}composeOutput(t,e){const{domain:r,range:i,round:a,interpolate:s}=this.options,o=FA(r.map(t),i,s,a);this.output=zh(o,e,t)}composeInput(t,e,r){const{domain:i,range:a}=this.options,s=FA(a,i.map(t),jh);this.input=zh(e,r,s)}}class Il extends oJ{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:YZ,tickMethod:iJ,tickCount:5}}chooseTransforms(){return[W1,W1]}clone(){return new Il(this.options)}}var lJ=function(n){le(t,n);function t(e){var r=this,i=e.style,a=an(e,["style"]);return r=n.call(this,fr({},{type:"column"},pt({style:i},a)))||this,r.columnsGroup=new Tn({name:"columns"}),r.appendChild(r.columnsGroup),r.render(),r}return t.prototype.render=function(){var e=this.attributes,r=e.columns,i=e.x,a=e.y;this.columnsGroup.style.transform="translate(".concat(i,", ").concat(a,")"),jt(this.columnsGroup).selectAll(".column").data(r.flat()).join(function(s){return s.append("rect").attr("className","column").each(function(o){this.attr(o)})},function(s){return s.each(function(o){this.attr(o)})},function(s){return s.remove()})},t.prototype.update=function(e){this.attr(Ln({},this.attributes,e)),this.render()},t.prototype.clear=function(){this.removeChildren()},t}(je),cJ=function(n){le(t,n);function t(e){var r=this,i=e.style,a=an(e,["style"]);return r=n.call(this,fr({},{type:"lines"},pt({style:i},a)))||this,r.linesGroup=r.appendChild(new Tn),r.areasGroup=r.appendChild(new Tn),r.render(),r}return t.prototype.render=function(){var e=this.attributes,r=e.lines,i=e.areas,a=e.x,s=e.y;this.style.transform="translate(".concat(a,", ").concat(s,")"),r&&this.renderLines(r),i&&this.renderAreas(i)},t.prototype.clear=function(){this.linesGroup.removeChildren(),this.areasGroup.removeChildren()},t.prototype.update=function(e){this.attr(Ln({},this.attributes,e)),this.render()},t.prototype.renderLines=function(e){jt(this.linesGroup).selectAll(".line").data(e).join(function(r){return r.append("path").attr("className","line").each(function(i){this.attr(i)})},function(r){return r.each(function(i){this.attr(i)})},function(r){return r.remove()})},t.prototype.renderAreas=function(e){jt(this.linesGroup).selectAll(".area").data(e).join(function(r){return r.append("path").attr("className","area").each(function(i){this.attr(i)})},function(r){return r.each(function(i){this.style(i)})},function(r){return r.remove()})},t}(je);function uJ(n,t){var e,r=t.x,i=t.y,a=$(i.getOptions().range||[0,0],2),s=a[0],o=a[1];return o>s&&(e=$([s,o],2),o=e[0],s=e[1]),n.map(function(l){var c=l.map(function(u,h){return[r.map(h),tn(i.map(u),o,s)]});return c})}function rc(n,t){t===void 0&&(t=!1);var e=t?n.length-1:0,r=n.map(function(i,a){return Rt([a===e?"M":"L"],$(i),!1)});return t?r.reverse():r}function qh(n,t){if(t===void 0&&(t=!1),n.length<=2)return rc(n);for(var e=[],r=n.length,i=0;i<r;i+=1){var a=t?n[r-i-1]:n[i];en(a,e.slice(-2))||e.push.apply(e,Rt([],$(a),!1))}var s=eZ(e);return t?s.unshift(Rt(["M"],$(n[r-1]),!1)):s.unshift(Rt(["M"],$(n[0]),!1)),s}function Mx(n,t,e){var r=Va(n);return r.push(["L",t,e],["L",0,e],["Z"]),r}function hJ(n,t,e,r){return n.map(function(i){return Mx(t?qh(i):rc(i),e,r)})}function fJ(n,t,e){for(var r=[],i=n.length-1;i>=0;i-=1){var a=n[i],s=rc(a),o=void 0;if(i===0)o=Mx(s,t,e);else{var l=n[i-1],c=rc(l,!0);c[0][0]="L",o=Rt(Rt(Rt([],$(s),!1),$(c),!1),[["Z"]],!1)}r.push(o)}return r}function dJ(n,t,e){for(var r=[],i=n.length-1;i>=0;i-=1){var a=n[i],s=qh(a),o=void 0;if(i===0)o=Mx(s,t,e);else{var l=n[i-1],c=qh(l,!0),u=a[0];c[0][0]="L",o=Rt(Rt(Rt([],$(s),!1),$(c),!1),[Rt(["M"],$(u),!1),["Z"]],!1)}r.push(o)}return r}function BA(n){return n.length===0?[0,0]:[uh(gB(n,function(t){return uh(t)||0})),ch(dB(n,function(t){return ch(t)||0}))]}function zA(n){for(var t=Va(n),e=t[0].length,r=$([Array(e).fill(0),Array(e).fill(0)],2),i=r[0],a=r[1],s=0;s<t.length;s+=1)for(var o=t[s],l=0;l<e;l+=1)o[l]>=0?(o[l]+=i[l],i[l]=o[l]):(o[l]+=a[l],a[l]=o[l]);return t}var gJ=function(n){le(t,n);function t(e){return n.call(this,e,{type:"line",x:0,y:0,width:200,height:20,isStack:!1,color:["#83daad","#edbf45","#d2cef9","#e290b3","#6f63f4"],smooth:!0,lineLineWidth:1,areaOpacity:0,isGroup:!1,columnLineWidth:1,columnStroke:"#fff",scale:1,spacing:0})||this}return Object.defineProperty(t.prototype,"rawData",{get:function(){var e=this.attributes.data;if(!e||(e==null?void 0:e.length)===0)return[[]];var r=Va(e);return Lt(r[0])?[r]:r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this.attributes.isStack?zA(this.rawData):this.rawData},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scales",{get:function(){return this.createScales(this.data)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"baseline",{get:function(){var e=this.scales.y,r=$(e.getOptions().domain||[0,0],2),i=r[0],a=r[1];return a<0?e.map(a):e.map(i<0?0:i)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"containerShape",{get:function(){var e=this.attributes,r=e.width,i=e.height;return{width:r,height:i}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"linesStyle",{get:function(){var e=this,r=this.attributes,i=r.type,a=r.isStack,s=r.smooth;if(i!=="line")throw new Error("linesStyle can only be used in line type");var o=te(this.attributes,"area"),l=te(this.attributes,"line"),c=this.containerShape.width,u=this.data;if(u[0].length===0)return{lines:[],areas:[]};var h=this.scales,f=h.x,d=h.y,g=uJ(u,{x:f,y:d}),v=[];if(o){var p=this.baseline;a?v=s?dJ(g,c,p):fJ(g,c,p):v=hJ(g,s,c,p)}return{lines:g.map(function(y,m){return pt({stroke:e.getColor(m),d:s?qh(y):rc(y)},l)}),areas:v.map(function(y,m){return pt({d:y,fill:e.getColor(m)},o)})}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columnsStyle",{get:function(){var e=this,r=te(this.attributes,"column"),i=this.attributes,a=i.isStack,s=i.type,o=i.scale;if(s!=="column")throw new Error("columnsStyle can only be used in column type");var l=this.containerShape.height,c=this.rawData;if(!c)return{columns:[]};a&&(c=zA(c));var u=this.createScales(c),h=u.x,f=u.y,d=$(BA(c),2),g=d[0],v=d[1],p=new Il({domain:[0,v-(g>0?0:g)],range:[0,l*o]}),y=h.getBandWidth(),m=this.rawData;return{columns:c.map(function(w,E){return w.map(function(S,O){var k=y/c.length,T=function(){return{x:h.map(O)+k*E,y:S>=0?f.map(S):f.map(0),width:k,height:p.map(Math.abs(S))}},C=function(){return{x:h.map(O),y:f.map(S),width:y,height:p.map(m[E][O])}};return pt(pt({fill:e.getColor(E)},r),a?C():T())})})}},enumerable:!1,configurable:!0}),t.prototype.render=function(e,r){lZ(r,".container","rect").attr("className","container").node();var i=e.type,a=e.x,s=e.y,o="spark".concat(i),l=pt({x:a,y:s},i==="line"?this.linesStyle:this.columnsStyle);jt(r).selectAll(".spark").data([i]).join(function(c){return c.append(function(u){return u==="line"?new cJ({className:o,style:l}):new lJ({className:o,style:l})}).attr("className","spark ".concat(o))},function(c){return c.update(l)},function(c){return c.remove()})},t.prototype.getColor=function(e){var r=this.attributes.color;return $r(r)?r[e%r.length]:zt(r)?r.call(null,e):r},t.prototype.createScales=function(e){var r,i,a=this.attributes,s=a.type,o=a.scale,l=a.range,c=l===void 0?[]:l,u=a.spacing,h=this.containerShape,f=h.width,d=h.height,g=$(BA(e),2),v=g[0],p=g[1],y=new Il({domain:[(r=c[0])!==null&&r!==void 0?r:v,(i=c[1])!==null&&i!==void 0?i:p],range:[d,d*(1-o)]});return s==="line"?{type:s,x:new Il({domain:[0,e[0].length-1],range:[0,f]}),y}:{type:s,x:new _x({domain:e[0].map(function(m,w){return w}),range:[0,f],paddingInner:u,paddingOuter:u/2,align:.5}),y}},t.tag="sparkline",t}(sn);function pJ(n){return typeof n=="boolean"?!1:"enter"in n&&"update"in n&&"exit"in n}function jA(n){if(!n)return{enter:!1,update:!1,exit:!1};var t=["enter","update","exit"],e=Object.fromEntries(Object.entries(n).filter(function(r){var i=$(r,1),a=i[0];return!t.includes(a)}));return Object.fromEntries(t.map(function(r){return pJ(n)?n[r]===!1?[r,!1]:[r,pt(pt({},n[r]),e)]:[r,e]}))}function Uo(n,t){n?n.finished.then(t):t()}function vJ(n,t){n.length===0?t():Promise.all(n.map(function(e){return e==null?void 0:e.finished})).then(t)}function eI(n,t){"update"in n?n.update(t):n.attr(t)}function nI(n,t,e){if(t.length===0)return null;if(!e){var r=t.slice(-1)[0];return eI(n,{style:r}),null}return n.animate(t,e)}function yJ(n,t){return!(n.nodeName!=="text"||t.nodeName!=="text"||n.attributes.text!==t.attributes.text)}function mJ(n,t,e,r){if(r===void 0&&(r="destroy"),yJ(n,t))return n.remove(),[null];var i=function(){r==="destroy"?n.destroy():r==="hide"&&ui(n),t.isVisible()&&Cc(t)};if(!e)return i(),[null];var a=e.duration,s=a===void 0?0:a,o=e.delay,l=o===void 0?0:o,c=Math.ceil(+s/2),u=+s/4,h=$(n.getGeometryBounds().center,2),f=h[0],d=h[1],g=$(t.getGeometryBounds().center,2),v=g[0],p=g[1],y=$([(f+v)/2-f,(d+p)/2-d],2),m=y[0],w=y[1],E=n.style.opacity,S=E===void 0?1:E,O=t.style.opacity,k=O===void 0?1:O,T=n.style.transform||"",C=t.style.transform||"",P=n.animate([{opacity:S,transform:"translate(0, 0) ".concat(T)},{opacity:0,transform:"translate(".concat(m,", ").concat(w,") ").concat(T)}],pt(pt({fill:"both"},e),{duration:l+c+u})),N=t.animate([{opacity:0,transform:"translate(".concat(-m,", ").concat(-w,") ").concat(C),offset:.01},{opacity:k,transform:"translate(0, 0) ".concat(C)}],pt(pt({fill:"both"},e),{duration:c+u,delay:l+c-u}));return Uo(N,i),[P,N]}function fi(n,t,e){var r={},i={};return Object.entries(t).forEach(function(a){var s=$(a,2),o=s[0],l=s[1];if(!Ut(l)){var c=n.style[o]||n.parsedStyle[o]||0;c!==l&&(r[o]=c,i[o]=l)}}),e?nI(n,[r,i],pt({fill:"both"},e)):(eI(n,i),null)}function ud(n,t){return n.style.opacity||(n.style.opacity=1),fi(n,{opacity:0},t)}var rI={fill:"#fff",lineWidth:1,radius:2,size:10,stroke:"#bfbfbf",strokeOpacity:1,zIndex:0},iI={fill:"#000",fillOpacity:.45,fontSize:12,textAlign:"center",textBaseline:"middle",zIndex:1},aI={x:0,y:0,orientation:"horizontal",showLabel:!0,type:"start"},Si=yi({foreground:"foreground",handle:"handle",selection:"selection",sparkline:"sparkline",sparklineGroup:"sparkline-group",track:"track",brushArea:"brush-area"},"slider"),ka=yi({labelGroup:"label-group",label:"label",iconGroup:"icon-group",icon:"icon",iconRect:"icon-rect",iconLine:"icon-line"},"handle"),bJ=function(n){le(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.render=function(e,r){var i=e.x,a=e.y,s=e.size,o=s===void 0?10:s,l=e.radius,c=l===void 0?o/4:l,u=e.orientation,h=an(e,["x","y","size","radius","orientation"]),f=o,d=f*2.4,g=jt(r).maybeAppendByClassName(ka.iconRect,"rect").styles(pt(pt({},h),{width:f,height:d,radius:c,x:i-f/2,y:a-d/2,transformOrigin:"center"})),v=i+1/3*f-f/2,p=i+2/3*f-f/2,y=a+1/4*d-d/2,m=a+3/4*d-d/2;g.maybeAppendByClassName("".concat(ka.iconLine,"-1"),"line").styles(pt({x1:v,x2:v,y1:y,y2:m},h)),g.maybeAppendByClassName("".concat(ka.iconLine,"-2"),"line").styles(pt({x1:p,x2:p,y1:y,y2:m},h)),u==="vertical"&&(g.node().style.transform="rotate(90)")},t}(sn),wJ=function(n){le(t,n);function t(e){return n.call(this,e,aI)||this}return t.prototype.renderLabel=function(e){var r=this,i=this.attributes,a=i.x,s=i.y,o=i.showLabel,l=te(this.attributes,"label"),c=l.x,u=c===void 0?0:c,h=l.y,f=h===void 0?0:h,d=l.transform,g=l.transformOrigin,v=an(l,["x","y","transform","transformOrigin"]),p=$(ha(v,[]),2),y=p[0],m=p[1],w=jt(e).maybeAppendByClassName(ka.labelGroup,"g").styles(m),E=pt(pt({},iI),y),S=E.text,O=an(E,["text"]);qr(!!o,w,function(k){r.label=k.maybeAppendByClassName(ka.label,"text").styles(pt(pt({},O),{x:a+u,y:s+f,transform:d,transformOrigin:g,text:"".concat(S)})),r.label.on("mousedown",function(T){T.stopPropagation()}),r.label.on("touchstart",function(T){T.stopPropagation()})})},t.prototype.renderIcon=function(e){var r=this.attributes,i=r.x,a=r.y,s=r.orientation,o=r.type,l=pt(pt({x:i,y:a,orientation:s},rI),te(this.attributes,"icon")),c=this.attributes.iconShape,u=c===void 0?function(){return new bJ({style:l})}:c,h=jt(e).maybeAppendByClassName(ka.iconGroup,"g");h.selectAll(ka.icon.class).data([u]).join(function(f){return f.append(typeof u=="string"?u:function(){return u(o)}).attr("className",ka.icon.name)},function(f){return f.update(l)},function(f){return f.remove()})},t.prototype.render=function(e,r){this.renderIcon(r),this.renderLabel(r)},t}(sn),xJ=function(n){le(t,n);function t(e){var r=n.call(this,e,pt(pt(pt({x:0,y:0,animate:{duration:100,fill:"both"},brushable:!0,formatter:function(i){return i.toString()},handleSpacing:2,orientation:"horizontal",padding:0,autoFitLabel:!0,scrollable:!0,selectionFill:"#5B8FF9",selectionFillOpacity:.45,selectionZIndex:2,showHandle:!0,showLabel:!0,slidable:!0,trackFill:"#416180",trackLength:200,trackOpacity:.05,trackSize:20,trackZIndex:-1,values:[0,1],type:"range",selectionType:"select",handleIconOffset:0},ho(aI,"handle")),ho(rI,"handleIcon")),ho(iI,"handleLabel")))||this;return r.range=[0,1],r.onDragStart=function(i){return function(a){a.stopPropagation(),r.target=i,r.prevPos=r.getOrientVal(vA(a));var s=r.availableSpace,o=s.x,l=s.y,c=r.getBBox(),u=c.x,h=c.y;r.selectionStartPos=r.getRatio(r.prevPos-r.getOrientVal([o,l])-r.getOrientVal([+u,+h])),r.selectionWidth=0,document.addEventListener("pointermove",r.onDragging),document.addEventListener("pointerup",r.onDragEnd)}},r.onDragging=function(i){var a=r.attributes,s=a.slidable,o=a.brushable,l=a.type;i.stopPropagation();var c=r.getOrientVal(vA(i)),u=c-r.prevPos;if(u){var h=r.getRatio(u);switch(r.target){case"start":s&&r.setValuesOffset(h);break;case"end":s&&r.setValuesOffset(0,h);break;case"selection":s&&r.setValuesOffset(h,h);break;case"track":if(!o)return;r.selectionWidth+=h,l==="range"?r.innerSetValues([r.selectionStartPos,r.selectionStartPos+r.selectionWidth].sort(),!0):r.innerSetValues([0,r.selectionStartPos+r.selectionWidth],!0);break}r.prevPos=c}},r.onDragEnd=function(){document.removeEventListener("pointermove",r.onDragging),document.removeEventListener("pointermove",r.onDragging),document.removeEventListener("pointerup",r.onDragEnd),r.target="",r.updateHandlesPosition(!1)},r.onValueChange=function(i){var a=r.attributes,s=a.onChange,o=a.type,l=o==="range"?i:i[1],c=o==="range"?r.getValues():r.getValues()[1],u=new pn("valuechange",{detail:{oldValue:l,value:c}});r.dispatchEvent(u),s==null||s(c)},r.selectionStartPos=0,r.selectionWidth=0,r.prevPos=0,r.target="",r}return Object.defineProperty(t.prototype,"values",{get:function(){return this.attributes.values},set:function(e){this.attributes.values=this.clampValues(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sparklineStyle",{get:function(){var e=this.attributes.orientation;if(e!=="horizontal")return null;var r=te(this.attributes,"sparkline");return pt(pt({zIndex:0},this.availableSpace),r)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shape",{get:function(){var e=this.attributes,r=e.trackLength,i=e.trackSize,a=$(this.getOrientVal([[r,i],[i,r]]),2),s=a[0],o=a[1];return{width:s,height:o}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"availableSpace",{get:function(){var e=this.attributes;e.x,e.y;var r=e.padding,i=$($n(r),4),a=i[0],s=i[1],o=i[2],l=i[3],c=this.shape,u=c.width,h=c.height;return{x:l,y:a,width:u-(l+s),height:h-(a+o)}},enumerable:!1,configurable:!0}),t.prototype.getValues=function(){return this.values},t.prototype.setValues=function(e,r){e===void 0&&(e=[0,0]),r===void 0&&(r=!1),this.attributes.values=e;var i=r===!1?!1:this.attributes.animate;this.updateSelectionArea(i),this.updateHandlesPosition(i)},t.prototype.updateSelectionArea=function(e){var r=this.calcSelectionArea();this.foregroundGroup.selectAll(Si.selection.class).each(function(i,a){fi(this,r[a],e)})},t.prototype.updateHandlesPosition=function(e){this.attributes.showHandle&&(this.startHandle&&fi(this.startHandle,this.getHandleStyle("start"),e),this.endHandle&&fi(this.endHandle,this.getHandleStyle("end"),e))},t.prototype.innerSetValues=function(e,r){e===void 0&&(e=[0,0]),r===void 0&&(r=!1);var i=this.values,a=this.clampValues(e);this.attributes.values=a,this.setValues(a),r&&this.onValueChange(i)},t.prototype.renderTrack=function(e){var r=this.attributes,i=r.x,a=r.y,s=te(this.attributes,"track");this.trackShape=jt(e).maybeAppendByClassName(Si.track,"rect").styles(pt(pt({x:i,y:a},this.shape),s))},t.prototype.renderBrushArea=function(e){var r=this.attributes,i=r.x,a=r.y,s=r.brushable;this.brushArea=jt(e).maybeAppendByClassName(Si.brushArea,"rect").styles(pt({x:i,y:a,fill:"transparent",cursor:s?"crosshair":"default"},this.shape))},t.prototype.renderSparkline=function(e){var r=this,i=this.attributes,a=i.x,s=i.y,o=i.orientation,l=jt(e).maybeAppendByClassName(Si.sparklineGroup,"g");qr(o==="horizontal",l,function(c){var u=pt(pt({},r.sparklineStyle),{x:a,y:s});c.maybeAppendByClassName(Si.sparkline,function(){return new gJ({style:u})}).update(u)})},t.prototype.renderHandles=function(){var e=this,r,i=this.attributes,a=i.showHandle,s=i.type,o=s==="range"?["start","end"]:["end"],l=a?o:[],c=this;(r=this.foregroundGroup)===null||r===void 0||r.selectAll(Si.handle.class).data(l.map(function(u){return{type:u}}),function(u){return u.type}).join(function(u){return u.append(function(h){var f=h.type;return new wJ({style:e.getHandleStyle(f)})}).each(function(h){var f=h.type;this.attr("class","".concat(Si.handle.name," ").concat(f,"-handle"));var d="".concat(f,"Handle");c[d]=this,this.addEventListener("pointerdown",c.onDragStart(f))})},function(u){return u.each(function(h){var f=h.type;this.update(c.getHandleStyle(f))})},function(u){return u.each(function(h){var f=h.type,d="".concat(f,"Handle");c[d]=void 0}).remove()})},t.prototype.renderSelection=function(e){var r=this.attributes,i=r.x,a=r.y,s=r.type,o=r.selectionType;this.foregroundGroup=jt(e).maybeAppendByClassName(Si.foreground,"g");var l=te(this.attributes,"selection"),c=function(h){return h.style("visibility",function(f){return f.show?"visible":"hidden"}).style("cursor",function(f){return o==="select"?"grab":o==="invert"?"crosshair":"default"}).styles(pt(pt({},l),{transform:"translate(".concat(i,", ").concat(a,")")}))},u=this;this.foregroundGroup.selectAll(Si.selection.class).data(s==="value"?[]:this.calcSelectionArea().map(function(h,f){return{style:pt({},h),index:f,show:o==="select"?f===1:f!==1}}),function(h){return h.index}).join(function(h){return h.append("rect").attr("className",Si.selection.name).call(c).each(function(f,d){var g=this;d===1?(u.selectionShape=jt(this),this.on("pointerdown",function(v){g.attr("cursor","grabbing"),u.onDragStart("selection")(v)}),u.dispatchCustomEvent(this,"pointerenter","selectionMouseenter"),u.dispatchCustomEvent(this,"pointerleave","selectionMouseleave"),u.dispatchCustomEvent(this,"click","selectionClick"),this.addEventListener("pointerdown",function(){g.attr("cursor","grabbing")}),this.addEventListener("pointerup",function(){g.attr("cursor","pointer")}),this.addEventListener("pointerover",function(){g.attr("cursor","pointer")})):this.on("pointerdown",u.onDragStart("track"))})},function(h){return h.call(c)},function(h){return h.remove()}),this.updateSelectionArea(!1),this.renderHandles()},t.prototype.render=function(e,r){this.renderTrack(r),this.renderSparkline(r),this.renderBrushArea(r),this.renderSelection(r)},t.prototype.clampValues=function(e,r){var i;r===void 0&&(r=4);var a=$(this.range,2),s=a[0],o=a[1],l=$(this.getValues().map(function(p){return yA(p,r)}),2),c=l[0],u=l[1],h=Array.isArray(e)?e:[c,e??u],f=$((h||[c,u]).map(function(p){return yA(p,r)}),2),d=f[0],g=f[1];if(this.attributes.type==="value")return[0,tn(g,s,o)];d>g&&(i=$([g,d],2),d=i[0],g=i[1]);var v=g-d;return v>o-s?[s,o]:d<s?c===s&&u===g?[s,g]:[s,v+s]:g>o?u===o&&c===d?[d,o]:[o-v,o]:[d,g]},t.prototype.calcSelectionArea=function(e){var r=$(this.clampValues(e),2),i=r[0],a=r[1],s=this.availableSpace,o=s.x,l=s.y,c=s.width,u=s.height;return this.getOrientVal([[{y:l,height:u,x:o,width:i*c},{y:l,height:u,x:i*c+o,width:(a-i)*c},{y:l,height:u,x:a*c,width:(1-a)*c}],[{x:o,width:c,y:l,height:i*u},{x:o,width:c,y:i*u+l,height:(a-i)*u},{x:o,width:c,y:a*u,height:(1-a)*u}]])},t.prototype.calcHandlePosition=function(e){var r=this.attributes.handleIconOffset,i=this.availableSpace,a=i.x,s=i.y,o=i.width,l=i.height,c=$(this.clampValues(),2),u=c[0],h=c[1],f=e==="start"?-r:r,d=(e==="start"?u:h)*this.getOrientVal([o,l])+f;return{x:a+this.getOrientVal([d,o/2]),y:s+this.getOrientVal([l/2,d])}},t.prototype.inferTextStyle=function(e){var r=this.attributes.orientation;return r==="horizontal"?{}:e==="start"?{transformOrigin:"left center",transform:"rotate(90)",textAlign:"start"}:e==="end"?{transformOrigin:"right center",transform:"rotate(90)",textAlign:"end"}:{}},t.prototype.calcHandleText=function(e){var r,i=this.attributes,a=i.type,s=i.orientation,o=i.formatter,l=i.autoFitLabel,c=te(this.attributes,"handle"),u=te(c,"label"),h=c.spacing,f=this.getHandleSize(),d=this.clampValues(),g=e==="start"?d[0]:d[1],v=o(g),p=new mx({style:pt(pt(pt({},u),this.inferTextStyle(e)),{text:v})}),y=p.getBBox(),m=y.width,w=y.height;if(p.destroy(),!l){if(a==="value")return{text:v,x:0,y:-w-h};var E=h+f+(s==="horizontal"?m/2:0);return r={text:v},r[s==="horizontal"?"x":"y"]=e==="start"?-E:E,r}var S=0,O=0,k=this.availableSpace,T=k.width,C=k.height,P=this.calcSelectionArea()[1],N=P.x,L=P.y,D=P.width,G=P.height,H=h+f;if(s==="horizontal"){var W=H+m/2;if(e==="start"){var q=N-H-m;S=q>0?-W:W}else{var z=T-N-D-H>m;S=z?W:-W}}else{var Z=H,at=w+H;e==="start"?O=L-f>w?-at:Z:O=C-(L+G)-f>w?at:-Z}return{x:S,y:O,text:v}},t.prototype.getHandleLabelStyle=function(e){var r=te(this.attributes,"handleLabel");return pt(pt(pt({},r),this.calcHandleText(e)),this.inferTextStyle(e))},t.prototype.getHandleIconStyle=function(){var e=this.attributes.handleIconShape,r=te(this.attributes,"handleIcon"),i=this.getOrientVal(["ew-resize","ns-resize"]),a=this.getHandleSize();return pt({cursor:i,shape:e,size:a},r)},t.prototype.getHandleStyle=function(e){var r=this.attributes,i=r.x,a=r.y,s=r.showLabel,o=r.showLabelOnInteraction,l=r.orientation,c=this.calcHandlePosition(e),u=c.x,h=c.y,f=this.calcHandleText(e),d=s;return!s&&o&&(this.target?d=!0:d=!1),pt(pt(pt({},ho(this.getHandleIconStyle(),"icon")),ho(pt(pt({},this.getHandleLabelStyle(e)),f),"label")),{transform:"translate(".concat(u+i,", ").concat(h+a,")"),orientation:l,showLabel:d,type:e,zIndex:3})},t.prototype.getHandleSize=function(){var e=this.attributes,r=e.handleIconSize,i=e.width,a=e.height;return r||Math.floor((this.getOrientVal([+a,+i])+4)/2.4)},t.prototype.getOrientVal=function(e){var r=$(e,2),i=r[0],a=r[1],s=this.attributes.orientation;return s==="horizontal"?i:a},t.prototype.setValuesOffset=function(e,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var a=this.attributes.type,s=$(this.getValues(),2),o=s[0],l=s[1],c=a==="range"?e:0,u=[o+c,l+r].sort();i?this.setValues(u):this.innerSetValues(u,!0)},t.prototype.getRatio=function(e){var r=this.availableSpace,i=r.width,a=r.height;return e/this.getOrientVal([i,a])},t.prototype.dispatchCustomEvent=function(e,r,i){var a=this;e.on(r,function(s){s.stopPropagation(),a.dispatchEvent(new pn(i,{detail:s}))})},t.prototype.bindEvents=function(){this.addEventListener("wheel",this.onScroll);var e=this.brushArea;this.dispatchCustomEvent(e,"click","trackClick"),this.dispatchCustomEvent(e,"pointerenter","trackMouseenter"),this.dispatchCustomEvent(e,"pointerleave","trackMouseleave"),e.on("pointerdown",this.onDragStart("track"))},t.prototype.onScroll=function(e){var r=this.attributes.scrollable;if(r){var i=e.deltaX,a=e.deltaY,s=a||i,o=this.getRatio(s);this.setValuesOffset(o,o,!0)}},t.tag="slider",t}(sn),Ox={data:[],animate:{enter:!1,update:{duration:100,easing:"ease-in-out-sine",fill:"both"},exit:{duration:100,fill:"both"}},showArrow:!0,showGrid:!0,showLabel:!0,showLine:!0,showTick:!0,showTitle:!0,showTrunc:!1,dataThreshold:100,lineLineWidth:1,lineStroke:"black",crossPadding:10,titleFill:"black",titleFontSize:12,titlePosition:"lb",titleSpacing:0,titleTextAlign:"center",titleTextBaseline:"middle",lineArrow:function(){return new Fr({style:{d:[["M",10,10],["L",-10,0],["L",10,-10],["L",0,0],["L",10,10],["Z"]],fill:"black",transformOrigin:"center"}})},labelAlign:"parallel",labelDirection:"positive",labelFontSize:12,labelSpacing:0,gridConnect:"line",gridControlAngles:[],gridDirection:"positive",gridLength:0,gridType:"segment",lineArrowOffset:15,lineArrowSize:10,tickDirection:"positive",tickLength:5,tickLineWidth:1,tickStroke:"black",labelOverlap:[]};fr({},Ox,{style:{type:"arc"}});fr({},Ox,{style:{}});var _e=yi({mainGroup:"main-group",gridGroup:"grid-group",grid:"grid",lineGroup:"line-group",line:"line",tickGroup:"tick-group",tick:"tick",tickItem:"tick-item",labelGroup:"label-group",label:"label",labelItem:"label-item",titleGroup:"title-group",title:"title",lineFirst:"line-first",lineSecond:"line-second"},"axis"),Io=yi({lineGroup:"line-group",line:"line",regionGroup:"region-group",region:"region"},"grid");function sI(n){return n.reduce(function(t,e,r){return t.push(Rt([r===0?"M":"L"],$(e),!1)),t},[])}function EJ(n,t,e){var r=t.connect,i=r===void 0?"line":r,a=t.center;if(i==="line")return sI(n);if(!a)return[];var s=nc(n[0],a),o=e?0:1;return n.reduce(function(l,c,u){return u===0?l.push(Rt(["M"],$(c),!1)):l.push(Rt(["A",s,s,0,0,o],$(c),!1)),l},[])}function Db(n,t,e){return t.type==="surround"?EJ(n,t,e):sI(n)}function SJ(n,t,e){var r=e.type,i=e.connect,a=e.center,s=e.closed,o=s?[["Z"]]:[],l=$([Db(n,e),Db(t.slice().reverse(),e,!0)],2),c=l[0],u=l[1],h=$([n[0],t.slice(-1)[0]],2),f=h[0],d=h[1],g=function(m,w){return[c,m,u,w,o].flat()};if(i==="line"||r==="surround")return g([Rt(["L"],$(d),!1)],[Rt(["L"],$(f),!1)]);if(!a)throw new Error("Arc grid need to specified center");var v=$([nc(d,a),nc(f,a)],2),p=v[0],y=v[1];return g([Rt(["A",p,p,0,0,1],$(d),!1),Rt(["L"],$(d),!1)],[Rt(["A",y,y,0,0,0],$(f),!1),Rt(["L"],$(f),!1)])}function _J(n,t,e,r){var i=e.animate,a=e.isBillboard,s=t.map(function(o,l){return{id:o.id||"grid-line-".concat(l),d:Db(o.points,e)}});return n.selectAll(Io.line.class).data(s,function(o){return o.id}).join(function(o){return o.append("path").each(function(l,c){var u=Zr(bA(pt({d:l.d},r)),[l,c,s]);this.attr(pt({class:Io.line.name,stroke:"#D9D9D9",lineWidth:1,lineDash:[4,4],isBillboard:a},u))})},function(o){return o.transition(function(l,c){var u=Zr(bA(pt({d:l.d},r)),[l,c,s]);return fi(this,u,i.update)})},function(o){return o.transition(function(){var l=this,c=ud(this,i.exit);return Uo(c,function(){return l.remove()}),c})}).transitions()}function MJ(n,t,e){var r=e.animate,i=e.connect,a=e.areaFill;if(t.length<2||!a||!i)return[];for(var s=Array.isArray(a)?a:[a,"transparent"],o=function(g){return s[g%s.length]},l=[],c=0;c<t.length-1;c++){var u=$([t[c].points,t[c+1].points],2),h=u[0],f=u[1],d=SJ(h,f,e);l.push({d,fill:o(c)})}return n.selectAll(Io.region.class).data(l,function(g,v){return v}).join(function(g){return g.append("path").each(function(v,p){var y=Zr(v,[v,p,l]);this.attr(y)}).attr("className",Io.region.name)},function(g){return g.transition(function(v,p){var y=Zr(v,[v,p,l]);return fi(this,y,r.update)})},function(g){return g.transition(function(){var v=this,p=ud(this,r.exit);return Uo(p,function(){return v.remove()}),p})}).transitions()}function OJ(n){var t=n.data,e=t===void 0?[]:t,r=n.closed;return r?e.map(function(i){var a=i.points,s=$(a,1),o=s[0];return pt(pt({},i),{points:Rt(Rt([],$(a),!1),[o],!1)})}):e}var TJ=function(n){le(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.render=function(e,r){e.type,e.center,e.areaFill,e.closed;var i=an(e,["type","center","areaFill","closed"]),a=OJ(e),s=jt(r).maybeAppendByClassName(Io.lineGroup,"g"),o=jt(r).maybeAppendByClassName(Io.regionGroup,"g"),l=_J(s,a,e,i),c=MJ(o,a,e);return Rt(Rt([],$(l),!1),$(c),!1)},t}(sn);function oI(n,t){return Object.fromEntries(Object.entries(n).map(function(e){var r=$(e,2),i=r[0],a=r[1];return[i,Zr(a,t)]}))}function Tx(n,t){return t&&zt(t)?n.filter(t):n}function lI(n,t){var e=t.startAngle,r=t.endAngle;return(r-e)*n+e}function hd(n,t){if(t.type==="linear"){var e=$(t.startPos,2),r=e[0],i=e[1],a=$(t.endPos,2),s=a[0],o=a[1],l=$([s-r,o-i],2),c=l[0],u=l[1];return X3([c,u])}var h=Lo(lI(n,t));return[-Math.sin(h),Math.cos(h)]}function kx(n,t,e){var r=hd(n,e);return QK(r,t!=="positive")}function Pc(n,t){return kx(n,t.labelDirection,t)}function kJ(n,t){var e=$(t.startPos,2),r=e[0],i=e[1],a=$(t.endPos,2),s=a[0],o=a[1],l=$([s-r,o-i],2),c=l[0],u=l[1];return[r+c*n,i+u*n]}function AJ(n,t){var e=t.radius,r=$(t.center,2),i=r[0],a=r[1],s=Lo(lI(n,t));return[i+e*Math.cos(s),a+e*Math.sin(s)]}function fd(n,t){return t.type==="linear"?kJ(n,t):AJ(n,t)}function cI(n){return hd(0,n)[1]===0}function uI(n){return hd(0,n)[0]===0}function hI(n,t){return t-n===360}function qA(n,t,e,r,i){var a=t-n,s=$([i,i],2),o=s[0],l=s[1],c=$([Lo(n),Lo(t)],2),u=c[0],h=c[1],f=function(C){return[e+i*Math.cos(C),r+i*Math.sin(C)]},d=$(f(u),2),g=d[0],v=d[1],p=$(f(h),2),y=p[0],m=p[1];if(hI(n,t)){var w=(h+u)/2,E=$(f(w),2),S=E[0],O=E[1];return[["M",g,v],["A",o,l,0,1,0,S,O],["A",o,l,0,1,0,y,m]]}var k=a>180?1:0,T=n>t?0:1;return"M".concat(g,",").concat(v,",A").concat(o,",").concat(l,",0,").concat(k,",").concat(T,",").concat(y,",").concat(m)}function CJ(n){var t=n.attributes,e=t.startAngle,r=t.endAngle,i=t.center,a=t.radius;return Rt(Rt([e,r],$(i),!1),[a],!1)}function PJ(n,t,e,r){var i=t.startAngle,a=t.endAngle,s=t.center,o=t.radius;return n.selectAll(_e.line.class).data([{d:qA.apply(void 0,Rt(Rt([i,a],$(s),!1),[o],!1))}],function(l,c){return c}).join(function(l){return l.append("path").attr("className",_e.line.name).styles(t).styles({d:function(c){return c.d}})},function(l){return l.transition(function(){var c=this,u=JK(this,CJ(this),Rt(Rt([i,a],$(s),!1),[o],!1),r.update);if(u){var h=function(){var f=sr(c.attributes,"__keyframe_data__");c.style.d=qA.apply(void 0,Rt([],$(f),!1))};u.onframe=h,u.onfinish=h}return u}).styles(t)},function(l){return l.remove()}).styles(e).transitions()}function NJ(n,t){t.truncRange,t.truncShape,t.lineExtension}function RJ(n,t,e){e===void 0&&(e=[0,0]);var r=$([n,t,e],3),i=$(r[0],2),a=i[0],s=i[1],o=$(r[1],2),l=o[0],c=o[1],u=$(r[2],2),h=u[0],f=u[1],d=$([l-a,c-s],2),g=d[0],v=d[1],p=Math.sqrt(Math.pow(g,2)+Math.pow(v,2)),y=$([-h/p,f/p],2),m=y[0],w=y[1];return[m*g,m*v,w*g,w*v]}function $A(n){var t=$(n,2),e=$(t[0],2),r=e[0],i=e[1],a=$(t[1],2),s=a[0],o=a[1];return{x1:r,y1:i,x2:s,y2:o}}function LJ(n,t,e,r){var i=t.showTrunc,a=t.startPos,s=t.endPos,o=t.truncRange,l=t.lineExtension,c=$([a,s],2),u=$(c[0],2),h=u[0],f=u[1],d=$(c[1],2),g=d[0],v=d[1],p=$(l?RJ(a,s,l):new Array(4).fill(0),4),y=p[0],m=p[1],w=p[2],E=p[3],S=function(z){return n.selectAll(_e.line.class).data(z,function(Z,at){return at}).join(function(Z){return Z.append("line").attr("className",function(at){return"".concat(_e.line.name," ").concat(at.className)}).styles(e).transition(function(at){return fi(this,$A(at.line),!1)})},function(Z){return Z.styles(e).transition(function(at){var ft=at.line;return fi(this,$A(ft),r.update)})},function(Z){return Z.remove()}).transitions()};if(!i||!o)return S([{line:[[h+y,f+m],[g+w,v+E]],className:_e.line.name}]);var O=$(o,2),k=O[0],T=O[1],C=g-h,P=v-f,N=$([h+C*k,f+P*k],2),L=N[0],D=N[1],G=$([h+C*T,f+P*T],2),H=G[0],W=G[1],q=S([{line:[[h+y,f+m],[L,D]],className:_e.lineFirst.name},{line:[[H,W],[g+w,v+E]],className:_e.lineSecond.name}]);return NJ(n,t),q}function IJ(n,t,e,r){var i=e.showArrow,a=e.showTrunc,s=e.lineArrow,o=e.lineArrowOffset,l=e.lineArrowSize,c;if(t==="arc"?c=n.select(_e.line.class):a?c=n.select(_e.lineSecond.class):c=n.select(_e.line.class),!i||!s||e.type==="arc"&&hI(e.startAngle,e.endAngle)){var u=c.node();u&&(u.style.markerEnd=void 0);return}var h=ua(s);h.attr(r),wx(h,l),c.style("markerEnd",h).style("markerEndOffset",-o)}function DJ(n,t,e){var r=t.type,i,a=te(t,"line");return r==="linear"?i=LJ(n,t,mA(a,"arrow"),e):i=PJ(n,t,mA(a,"arrow"),e),IJ(n,r,t,a),i}function FJ(n,t){return kx(n,t.gridDirection,t)}function fI(n){var t=n.type,e=n.gridCenter;return t==="linear"?e:e||n.center}function BJ(n,t){var e=t.gridLength;return n.map(function(r,i){var a=r.value,s=$(fd(a,t),2),o=s[0],l=s[1],c=$(na(FJ(a,t),e),2),u=c[0],h=c[1];return{id:i,points:[[o,l],[o+u,l+h]]}})}function zJ(n,t){var e=t.gridControlAngles,r=fI(t);if(!r)throw new Error("grid center is not provide");if(n.length<2)throw new Error("Invalid grid data");if(!e||e.length===0)throw new Error("Invalid gridControlAngles");var i=$(r,2),a=i[0],s=i[1];return n.map(function(o,l){var c=o.value,u=$(fd(c,t),2),h=u[0],f=u[1],d=$([h-a,f-s],2),g=d[0],v=d[1],p=[];return e.forEach(function(y){var m=Lo(y),w=$([Math.cos(m),Math.sin(m)],2),E=w[0],S=w[1],O=g*E-v*S+a,k=g*S+v*E+s;p.push([O,k])}),{points:p,id:l}})}function jJ(n,t,e,r){var i=te(e,"grid"),a=i.type,s=i.areaFill,o=fI(e),l=Tx(t,e.gridFilter),c=a==="segment"?BJ(l,e):zJ(l,e),u=pt(pt({},i),{center:o,areaFill:zt(s)?l.map(function(h,f){return Zr(s,[h,f,l])}):s,animate:r,data:c});return n.selectAll(_e.grid.class).data([1]).join(function(h){return h.append(function(){return new TJ({style:u})}).attr("className",_e.grid.name)},function(h){return h.transition(function(){return this.update(u)})},function(h){return h.remove()}).transitions()}var Fb=function(){function n(t,e,r,i){this.set(t,e,r,i)}return Object.defineProperty(n.prototype,"left",{get:function(){return this.x1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.y1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.x2},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.y2},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this.defined("x2")&&this.defined("x1")?this.x2-this.x1:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.defined("y2")&&this.defined("y1")?this.y2-this.y1:void 0},enumerable:!1,configurable:!0}),n.prototype.rotatedPoints=function(t,e,r){var i=this,a=i.x1,s=i.y1,o=i.x2,l=i.y2,c=Math.cos(t),u=Math.sin(t),h=e-e*c+r*u,f=r-e*u-r*c,d=[[c*a-u*l+h,u*a+c*l+f],[c*o-u*l+h,u*o+c*l+f],[c*a-u*s+h,u*a+c*s+f],[c*o-u*s+h,u*o+c*s+f]];return d},n.prototype.set=function(t,e,r,i){return r<t?(this.x2=t,this.x1=r):(this.x1=t,this.x2=r),i<e?(this.y2=e,this.y1=i):(this.y1=e,this.y2=i),this},n.prototype.defined=function(t){return this[t]!==Number.MAX_VALUE&&this[t]!==-Number.MAX_VALUE},n}();function Bb(n,t){var e=n.getEulerAngles()||0;n.setEulerAngles(0);var r=n.getBounds(),i=$(r.min,2),a=i[0],s=i[1],o=$(r.max,2),l=o[0],c=o[1],u=n.getBBox(),h=u.width,f=u.height,d=f,g=0,v=0,p=a,y=s,m=U3(n);if(m){d-=1.5;var w=m.style.textAlign,E=m.style.textBaseline;w==="center"?p=(a+l)/2:(w==="right"||w==="end")&&(p=l),E==="middle"?y=(s+c)/2:E==="bottom"&&(y=c)}var S=$($n(t),4),O=S[0],k=O===void 0?0:O,T=S[1],C=T===void 0?0:T,P=S[2],N=P===void 0?k:P,L=S[3],D=L===void 0?C:L,G=new Fb((g+=a)-D,(v+=s)-k,g+h+C,v+d+N);return n.setEulerAngles(e),G.rotatedPoints(Lo(e),p,y)}function bl(n,t){return t[0]<=Math.max(n[0][0],n[1][0])&&t[0]<=Math.min(n[0][0],n[1][0])&&t[1]<=Math.max(n[0][1],n[1][1])&&t[1]<=Math.min(n[0][1],n[1][1])}function wl(n,t,e){var r=(t[1]-n[1])*(e[0]-t[0])-(t[0]-n[0])*(e[1]-t[1]);return r===0?0:r<0?2:1}function qJ(n,t){var e=wl(n[0],n[1],t[0]),r=wl(n[0],n[1],t[1]),i=wl(t[0],t[1],n[0]),a=wl(t[0],t[1],n[1]);return!!(e!==r&&i!==a||e===0&&bl(n,t[0])||r===0&&bl(n,t[1])||i===0&&bl(t,n[0])||a===0&&bl(t,n[1]))}function $J(n,t){var e=n.length;if(e<3)return!1;var r=[t,[9999,t[1]]],i=0,a=0;do{var s=[n[a],n[(a+1)%e]];if(qJ(s,r)){if(wl(s[0],t,s[1])===0)return bl(s,t);i++}a=(a+1)%e}while(a!==0);return!!(i&1)}function GJ(n,t){return t.every(function(e){return $J(n,e)})}function WJ(n,t,e){var r=n.x1,i=n.x2,a=n.y1,s=n.y2,o=[[r,a],[i,a],[i,s],[r,s]],l=Bb(t,e);return GJ(o,l)}function VJ(n,t){var e=$(n,4),r=e[0],i=e[1],a=e[2],s=e[3],o=$(t,4),l=o[0],c=o[1],u=o[2],h=o[3],f=a-r,d=s-i,g=u-l,v=h-c,p=f*v-g*d;if(p===0)return!1;var y=p>0,m=r-l,w=i-c,E=f*w-d*m;if(E<0===y)return!1;var S=g*w-v*m;return!(S<0===y||E>p===y||S>p===y)}function HJ(n,t){var e=[[n[0],n[1],n[2],n[3]],[n[2],n[3],n[4],n[5]],[n[4],n[5],n[6],n[7]],[n[6],n[7],n[0],n[1]]];return e.some(function(r){return VJ(t,r)})}function UJ(n,t,e){var r,i,a=Bb(n,e).flat(1),s=Bb(t,e).flat(1),o=[[a[0],a[1],a[2],a[3]],[a[0],a[1],a[4],a[5]],[a[4],a[5],a[6],a[7]],[a[2],a[3],a[6],a[7]]];try{for(var l=uc(o),c=l.next();!c.done;c=l.next()){var u=c.value;if(HJ(s,u))return!0}}catch(h){r={error:h}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}return!1}function YJ(n,t){var e=n.type,r=n.labelDirection,i=n.crossSize;if(!i)return!1;if(e==="arc"){var a=n.center,s=n.radius,o=$(a,2),l=o[0],c=o[1],u=r==="negative"?0:i,h=-s-u,f=s+u,d=$($n(t),4),g=d[0],v=d[1],p=d[2],y=d[3];return new Fb(l+h-y,c+h-g,l+f+v,c+f+p)}var m=$(n.startPos,2),w=m[0],E=m[1],S=$(n.endPos,2),O=S[0],k=S[1],T=$(uI(n)?[-t,0,t,0]:[0,t,0,-t],4),C=T[0],P=T[1],N=T[2],L=T[3],D=Pc(0,n),G=na(D,i),H=new Fb(w,E,O,k);return H.x1+=L,H.y1+=C,H.x2+=P+G[0],H.y2+=N+G[1],H}function dd(n,t,e){var r,i,a=t.crossPadding,s=new Set,o=null,l=YJ(t,a),c=function(g){return l?WJ(l,g):!0},u=function(g,v){return!g||!g.firstChild?!0:!UJ(g.firstChild,v.firstChild,$n(e))};try{for(var h=uc(n),f=h.next();!f.done;f=h.next()){var d=f.value;c(d)?!o||u(o,d)?o=d:(s.add(o),s.add(d)):s.add(d)}}catch(g){r={error:g}}finally{try{f&&!f.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}return Array.from(s)}function m1(n,t){return t===void 0&&(t={}),Ut(n)?0:typeof n=="number"?n:Math.floor(HK(n,t))}function XJ(n,t,e,r){if(!(n.length<=1)){var i=t.suffix,a=i===void 0?"...":i,s=t.minLength,o=t.maxLength,l=o===void 0?1/0:o,c=t.step,u=c===void 0?" ":c,h=t.margin,f=h===void 0?[0,0,0,0]:h,d=H3(r.getTextShape(n[0])),g=m1(u,d),v=s?m1(s,d):g,p=m1(l,d);(Ut(p)||p===1/0)&&(p=Math.max.apply(null,n.map(function(O){return O.getBBox().width})));var y=n.slice(),m=$(f,4);m[0],m[1],m[2],m[3];for(var w=function(O){if(y.forEach(function(k){r.ellipsis(r.getTextShape(k),O,a)}),y=dd(n,e,f),y.length<1)return{value:void 0}},E=p;E>v+g;E-=g){var S=w(E);if(typeof S=="object")return S.value}}}var KJ={parity:function(n,t){var e=t.seq,r=e===void 0?2:e;return n.filter(function(i,a){return a%r?(ui(i),!1):!0})}},ZJ=function(n){return n.filter(V3)};function JJ(n,t,e,r){var i=n.length,a=t.keepHeader,s=t.keepTail;if(!(i<=1||i===2&&a&&s)){var o=KJ.parity,l=function(w){return w.forEach(r.show),w},c=2,u=n.slice(),h=n.slice(),f=Math.min.apply(Math,Rt([1],$(n.map(function(w){return w.getBBox().width})),!1));if(e.type==="linear"&&(cI(e)||uI(e))){var d=wA(n[0]).left,g=wA(n[i-1]).right,v=Math.abs(g-d)||1;c=Math.max(Math.floor(i*f/v),c)}var p,y;for(a&&(p=u.splice(0,1)[0]),s&&(y=u.splice(-1,1)[0],u.reverse()),l(u);c<n.length&&dd(ZJ(y?Rt(Rt([y],$(h),!1),[p],!1):Rt([p],$(h),!1)),e,t==null?void 0:t.margin).length;){if(y&&!p&&c%2===0){var m=u.splice(0,1);m.forEach(r.hide)}else if(y&&p){var m=u.splice(0,1);m.forEach(r.hide)}h=o(l(u),{seq:c}),c++}}}function QJ(n,t,e,r){var i,a,s=t.optionalAngles,o=s===void 0?[0,45,90]:s,l=t.margin,c=t.recoverWhenFailed,u=c===void 0?!0:c,h=n.map(function(y){return y.getLocalEulerAngles()}),f=function(){return dd(n,e,l).length<1},d=function(y){return n.forEach(function(m,w){var E=Array.isArray(y)?y[w]:y;r.rotate(m,+E)})};try{for(var g=uc(o),v=g.next();!v.done;v=g.next()){var p=v.value;if(d(p),f())return}}catch(y){i={error:y}}finally{try{v&&!v.done&&(a=g.return)&&a.call(g)}finally{if(i)throw i.error}}u&&d(h)}function tQ(n){var t=n.type,e=n.labelDirection;return t==="linear"&&cI(n)?e==="negative"?"bottom":"top":"middle"}function eQ(n,t,e,r){var i=t.wordWrapWidth,a=i===void 0?50:i,s=t.maxLines,o=s===void 0?3:s,l=t.recoverWhenFailed,c=l===void 0?!0:l,u=t.margin,h=u===void 0?[0,0,0,0]:u,f=n.map(function(m){return m.attr("maxLines")||1}),d=Math.min.apply(Math,Rt([],$(f),!1)),g=function(){return dd(n,e,h).length<1},v=tQ(e),p=function(m){return n.forEach(function(w,E){var S=Array.isArray(m)?m[E]:m;r.wrap(w,a,S,v)})};if(!(d>o)){for(var y=d;y<=o;y++)if(p(y),g())return;c&&p(f)}}var nQ=new Map([["hide",JJ],["rotate",QJ],["ellipsis",XJ],["wrap",eQ]]);function rQ(n,t,e){return t.labelOverlap.length<1?!1:e==="hide"?!WK(n[0]):e==="rotate"?!n.some(function(r){var i;return!!(!((i=r.attr("transform"))===null||i===void 0)&&i.includes("rotate"))}):e==="ellipsis"||e==="wrap"?n.filter(function(r){return r.querySelector("text")}).length>1:!0}function iQ(n,t,e){var r=t.labelOverlap,i=r===void 0?[]:r;i.length&&i.forEach(function(a){var s=a.type,o=nQ.get(s);rQ(n,t,s)&&(o==null||o(n,a,t,e))})}function aQ(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var e=function(r){return r==="positive"?-1:1};return n.reduce(function(r,i){return r*e(i)},1)}function GA(n){for(var t=n;t<0;)t+=360;return Math.round(t%360)}function zb(n,t){var e=$(n,2),r=e[0],i=e[1],a=$(t,2),s=a[0],o=a[1],l=$([r*s+i*o,r*o-i*s],2),c=l[0],u=l[1];return Math.atan2(u,c)}function sQ(n){var t=(n+360)%180;return Bn(t,-90,90)||(t+=180),t}function oQ(n,t,e){var r,i=e.labelAlign,a=(r=t.style.transform)===null||r===void 0?void 0:r.includes("rotate");if(a)return t.getLocalEulerAngles();var s=0,o=Pc(n.value,e),l=hd(n.value,e);return i==="horizontal"?0:(i==="perpendicular"?s=zb([1,0],o):s=zb([l[0]<0?-1:1,0],l),sQ(G3(s)))}function dI(n,t,e){var r=e.type,i=e.labelAlign,a=Pc(n,e),s=GA(t),o=GA(G3(zb([1,0],a))),l="center",c="middle";return r==="linear"?[90,270].includes(o)&&s===0?(l="center",c=a[1]===1?"top":"bottom"):!(o%180)&&[90,270].includes(s)?l="center":o===0?(Bn(s,0,90,!1,!0)||Bn(s,0,90)||Bn(s,270,360))&&(l="start"):o===90?Bn(s,0,90,!1,!0)?l="start":(Bn(s,90,180)||Bn(s,270,360))&&(l="end"):o===270?Bn(s,0,90,!1,!0)?l="end":(Bn(s,90,180)||Bn(s,270,360))&&(l="start"):o===180&&(s===90?l="start":(Bn(s,0,90)||Bn(s,270,360))&&(l="end")):i==="parallel"?Bn(o,0,180,!0)?c="top":c="bottom":i==="horizontal"?Bn(o,90,270,!1)?l="end":(Bn(o,270,360,!1)||Bn(o,0,90))&&(l="start"):i==="perpendicular"&&(Bn(o,90,270)?l="end":l="start"),{textAlign:l,textBaseline:c}}function lQ(n,t,e){t.setLocalEulerAngles(n);var r=t.__data__.value,i=dI(r,n,e),a=t.querySelector(_e.labelItem.class);a&&gI(a,i)}function WA(n,t,e){var r=e.showTick,i=e.tickLength,a=e.tickDirection,s=e.labelDirection,o=e.labelSpacing,l=t.indexOf(n),c=Zr(o,[n,l,t]),u=$([Pc(n.value,e),aQ(s,a)],2),h=u[0],f=u[1],d=f===1?Zr(r?i:0,[n,l,t]):0,g=$(ml(na(h,c+d),fd(n.value,e)),2),v=g[0],p=g[1];return{x:v,y:p}}function cQ(n,t,e,r){var i=r.labelFormatter,a=zt(i)?function(){return ua(Zr(i,[n,t,e,Pc(n.value,r)]))}:function(){return ua(n.label||"")};return a}function gI(n,t){n.nodeName==="text"&&n.attr(t)}function VA(n){iQ(this.node().childNodes,n,{hide:ui,show:Cc,rotate:function(t,e){lQ(+e,t,n)},ellipsis:function(t,e,r){t&&Lb(t,e||1/0,r)},wrap:function(t,e,r){t&&UK(t,e,r)},getTextShape:function(t){return t.querySelector("text")}})}function HA(n,t,e,r,i){var a=e.indexOf(t),s=jt(n).append(cQ(t,a,e,i)).attr("className",_e.labelItem.name).node(),o=$(ha(oI(r,[t,a,e])),2),l=o[0],c=o[1],u=c.transform,h=an(c,["transform"]);K3(s,u);var f=oQ(t,s,i);return s.getLocalEulerAngles()||s.setLocalEulerAngles(f),gI(s,pt(pt({},dI(t.value,f,i)),l)),n.attr(h),s}function uQ(n,t,e,r){var i=Tx(t,e.labelFilter),a=te(e,"label");return n.selectAll(_e.label.class).data(i,function(s,o){return o}).join(function(s){return s.append("g").attr("className",_e.label.name).transition(function(o){HA(this,o,t,a,e);var l=WA(o,t,e),c=l.x,u=l.y;return this.style.transform="translate(".concat(c,", ").concat(u,")"),null}).call(function(){VA.call(n,e)})},function(s){return s.transition(function(o){var l=this.querySelector(_e.labelItem.class),c=HA(this,o,t,a,e),u=mJ(l,c,r.update),h=WA(o,t,e),f=h.x,d=h.y,g=fi(this,{transform:"translate(".concat(f,", ").concat(d,")")},r.update);return Rt(Rt([],$(u),!1),[g],!1)}).call(function(o){var l=sr(o,"_transitions").flat().filter(V3);vJ(l,function(){VA.call(n,e)})})},function(s){return s.transition(function(){var o=this,l=ud(this.childNodes[0],r.exit);return Uo(l,function(){return jt(o).remove()}),l})}).transitions()}function pI(n,t){return kx(n,t.tickDirection,t)}function hQ(n,t){var e=$(n,2),r=e[0],i=e[1];return[[0,0],[r*t,i*t]]}function fQ(n,t,e,r,i){var a=i.tickLength,s=$(hQ(r,Zr(a,[n,t,e])),2),o=$(s[0],2),l=o[0],c=o[1],u=$(s[1],2),h=u[0],f=u[1];return{x1:l,x2:h,y1:c,y2:f}}function dQ(n,t,e,r,i){var a=i.tickFormatter,s=pI(t.value,i),o="line";return zt(a)&&(o=function(){return Zr(a,[t,e,r,s])}),n.append(o).attr("className",_e.tickItem.name)}function gQ(n,t,e,r,i,a,s){var o=pI(n.value,a),l=fQ(n,t,e,o,a),c=l.x1,u=l.x2,h=l.y1,f=l.y2,d=$(ha(oI(s,[n,t,e,o])),2),g=d[0],v=d[1];r.node().nodeName==="line"&&r.styles(pt({x1:c,x2:u,y1:h,y2:f},g)),i.attr(v),r.styles(g)}function UA(n,t,e,r,i,a){var s=dQ(jt(this),n,t,e,r);gQ(n,t,e,s,this,r,i);var o=$(fd(n.value,r),2),l=o[0],c=o[1];return fi(this,{transform:"translate(".concat(l,", ").concat(c,")")},a)}function pQ(n,t,e,r){var i=Tx(t,e.tickFilter),a=te(e,"tick");return n.selectAll(_e.tick.class).data(i,function(s){return s.id||s.label}).join(function(s){return s.append("g").attr("className",_e.tick.name).transition(function(o,l){return UA.call(this,o,l,i,e,a,!1)})},function(s){return s.transition(function(o,l){return this.removeChildren(),UA.call(this,o,l,i,e,a,r.update)})},function(s){return s.transition(function(){var o=this,l=ud(this.childNodes[0],r.exit);return Uo(l,function(){return o.remove()}),l})}).transitions()}var YA=yi({text:"text"},"title");function gd(n){return/\S+-\S+/g.test(n)?n.split("-").map(function(t){return t[0]}):n.length>2?[n[0]]:n.split("")}function vQ(n,t){var e=n.attributes,r=e.position,i=e.spacing,a=e.inset,s=e.text,o=n.getBBox(),l=t.getBBox(),c=gd(r),u=$($n(s?i:0),4),h=u[0],f=u[1],d=u[2],g=u[3],v=$($n(a),4),p=v[0],y=v[1],m=v[2],w=v[3],E=$([g+f,h+d],2),S=E[0],O=E[1],k=$([w+y,p+m],2),T=k[0],C=k[1];if(c[0]==="l")return new cr(o.x,o.y,l.width+o.width+S+T,Math.max(l.height+C,o.height));if(c[0]==="t")return new cr(o.x,o.y,Math.max(l.width+T,o.width),l.height+o.height+O+C);var P=$([t.attributes.width||l.width,t.attributes.height||l.height],2),N=P[0],L=P[1];return new cr(l.x,l.y,N+o.width+S+T,L+o.height+O+C)}function yQ(n,t){var e=Object.entries(t).reduce(function(r,i){var a=$(i,2),s=a[0],o=a[1],l=n.node().attr(s);return l||(r[s]=o),r},{});n.styles(e)}function mQ(n){var t,e,r,i,a=n,s=a.width,o=a.height,l=a.position,c=$([+s/2,+o/2],2),u=c[0],h=c[1],f=$([+u,+h,"center","middle"],4),d=f[0],g=f[1],v=f[2],p=f[3],y=gd(l);return y.includes("l")&&(t=$([0,"start"],2),d=t[0],v=t[1]),y.includes("r")&&(e=$([+s,"end"],2),d=e[0],v=e[1]),y.includes("t")&&(r=$([0,"top"],2),g=r[0],p=r[1]),y.includes("b")&&(i=$([+o,"bottom"],2),g=i[0],p=i[1]),{x:d,y:g,textAlign:v,textBaseline:p}}var bQ=function(n){le(t,n);function t(e){return n.call(this,e,{text:"",width:0,height:0,fill:"#4a505a",fontWeight:"bold",fontSize:12,fontFamily:"sans-serif",inset:0,spacing:0,position:"top-left"})||this}return t.prototype.getAvailableSpace=function(){var e=this,r=this.attributes,i=r.width,a=r.height,s=r.position,o=r.spacing,l=r.inset,c=e.querySelector(YA.text.class);if(!c)return new cr(0,0,+i,+a);var u=c.getBBox(),h=u.width,f=u.height,d=$($n(o),4),g=d[0],v=d[1],p=d[2],y=d[3],m=$([0,0,+i,+a],4),w=m[0],E=m[1],S=m[2],O=m[3],k=gd(s);if(k.includes("i"))return new cr(w,E,S,O);k.forEach(function(W,q){var z,Z,at,ft;W==="t"&&(z=$(q===0?[f+p,+a-f-p]:[0,+a],2),E=z[0],O=z[1]),W==="r"&&(Z=$([+i-h-y],1),S=Z[0]),W==="b"&&(at=$([+a-f-g],1),O=at[0]),W==="l"&&(ft=$(q===0?[h+v,+i-h-v]:[0,+i],2),w=ft[0],S=ft[1])});var T=$($n(l),4),C=T[0],P=T[1],N=T[2],L=T[3],D=$([L+P,C+N],2),G=D[0],H=D[1];return new cr(w+L,E+C,S-G,O-H)},t.prototype.getBBox=function(){return this.title?this.title.getBBox():new cr(0,0,0,0)},t.prototype.render=function(e,r){var i=this;e.width,e.height,e.position,e.spacing;var a=an(e,["width","height","position","spacing"]),s=$(ha(a),1),o=s[0],l=mQ(e),c=l.x,u=l.y,h=l.textAlign,f=l.textBaseline;qr(!!a.text,jt(r),function(d){i.title=d.maybeAppendByClassName(YA.text,"text").styles(o).call(yQ,{x:c,y:u,textAlign:h,textBaseline:f}).node()})},t}(sn);function wQ(n,t,e){var r=e.titlePosition,i=r===void 0?"lb":r,a=e.titleSpacing,s=gd(i),o=n.node().getLocalBounds(),l=$(o.min,2),c=l[0],u=l[1],h=$(o.halfExtents,2),f=h[0],d=h[1],g=$(t.node().getLocalBounds().halfExtents,2),v=g[0],p=g[1],y=$([c+f,u+d],2),m=y[0],w=y[1],E=$($n(a),4),S=E[0],O=E[1],k=E[2],T=E[3];if(["start","end"].includes(i)&&e.type==="linear"){var C=e.startPos,P=e.endPos,N=$(i==="start"?[C,P]:[P,C],2),L=N[0],D=N[1],G=X3([-D[0]+L[0],-D[1]+L[1]]),H=$(na(G,S),2),W=H[0],q=H[1];return{x:L[0]+W,y:L[1]+q}}return s.includes("t")&&(w-=d+p+S),s.includes("r")&&(m+=f+v+O),s.includes("l")&&(m-=f+v+T),s.includes("b")&&(w+=d+p+k),{x:m,y:w}}function xQ(n,t,e){var r=n.getGeometryBounds().halfExtents,i=r[1]*2;if(t==="vertical"){if(e==="left")return"rotate(-90) translate(0, ".concat(i/2,")");if(e==="right")return"rotate(-90) translate(0, -".concat(i/2,")")}return""}function XA(n,t,e,r,i){var a=te(r,"title"),s=$(ha(a),2),o=s[0],l=s[1],c=l.transform,u=l.transformOrigin,h=an(l,["transform","transformOrigin"]);t.styles(h);var f=c||xQ(n.node(),o.direction,o.position);n.styles(pt(pt({},o),{transformOrigin:u})),K3(n.node(),f);var d=wQ(jt(e._offscreen||e.querySelector(_e.mainGroup.class)),t,r),g=d.x,v=d.y,p=fi(t.node(),{transform:"translate(".concat(g,", ").concat(v,")")},i);return p}function EQ(n,t,e,r){var i=e.titleText;return n.selectAll(_e.title.class).data([{title:i}].filter(function(a){return!!a.title}),function(a,s){return a.title}).join(function(a){return a.append(function(){return ua(i)}).attr("className",_e.title.name).transition(function(){return XA(jt(this),n,t,e,r.enter)})},function(a){return a.transition(function(){return XA(jt(this),n,t,e,r.update)})},function(a){return a.remove()}).transitions()}function KA(n,t,e,r){var i=n.showLine,a=n.showTick,s=n.showLabel,o=t.maybeAppendByClassName(_e.lineGroup,"g"),l=qr(i,o,function(d){return DJ(d,n,r)})||[],c=t.maybeAppendByClassName(_e.tickGroup,"g"),u=qr(a,c,function(d){return pQ(d,e,n,r)})||[],h=t.maybeAppendByClassName(_e.labelGroup,"g"),f=qr(s,h,function(d){return uQ(d,e,n,r)})||[];return Rt(Rt(Rt([],$(l),!1),$(u),!1),$(f),!1).filter(function(d){return!!d})}var SQ=function(n){le(t,n);function t(e){return n.call(this,e,Ox)||this}return t.prototype.render=function(e,r,i){var a=this,s=e.titleText,o=e.data,l=e.animate,c=e.showTitle,u=e.showGrid,h=e.dataThreshold,f=e.truncRange,d=iZ(o,h).filter(function(S){var O=S.value;return!(f&&O>f[0]&&O<f[1])}),g=jA(i===void 0?l:i),v=jt(r).maybeAppendByClassName(_e.gridGroup,"g"),p=qr(u,v,function(S){return jJ(S,d,e,g)})||[],y=jt(r).maybeAppendByClassName(_e.mainGroup,"g");s&&(!this.initialized&&g.enter||this.initialized&&g.update)&&KA(e,jt(this.offscreenGroup),d,jA(!1));var m=KA(e,jt(y.node()),d,g),w=jt(r).maybeAppendByClassName(_e.titleGroup,"g"),E=qr(c,w,function(S){return EQ(S,a,e,g)})||[];return Rt(Rt(Rt([],$(p),!1),$(m),!1),$(E),!1).flat().filter(function(S){return!!S})},t}(sn),Ur=yi({prevBtnGroup:"prev-btn-group",prevBtn:"prev-btn",nextBtnGroup:"next-btn-group",nextBtn:"next-btn",pageInfoGroup:"page-info-group",pageInfo:"page-info",playWindow:"play-window",contentGroup:"content-group",controller:"controller",clipPath:"clip-path"},"navigator"),_Q=function(n){le(t,n);function t(e){var r=n.call(this,e,{x:0,y:0,animate:{easing:"linear",duration:200,fill:"both"},buttonCursor:"pointer",buttonFill:"black",buttonD:LZ(0,0,6),buttonSize:12,controllerPadding:5,controllerSpacing:5,formatter:function(i,a){return"".concat(i,"/").concat(a)},defaultPage:0,loop:!1,orientation:"horizontal",pageNumFill:"black",pageNumFontSize:12,pageNumTextAlign:"start",pageNumTextBaseline:"middle"})||this;return r.playState="idle",r.contentGroup=r.appendChild(new Tn({class:Ur.contentGroup.name})),r.playWindow=r.contentGroup.appendChild(new Tn({class:Ur.playWindow.name})),r.innerCurrPage=r.defaultPage,r}return Object.defineProperty(t.prototype,"defaultPage",{get:function(){var e=this.attributes.defaultPage;return tn(e,0,Math.max(this.pageViews.length-1,0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageViews",{get:function(){return this.playWindow.children},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"controllerShape",{get:function(){return this.totalPages>1?{width:55,height:0}:{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageShape",{get:function(){var e=this.pageViews,r=$(pZ(e.map(function(h){var f=h.getBBox(),d=f.width,g=f.height;return[d,g]})).map(function(h){return Math.max.apply(Math,Rt([],$(h),!1))}),2),i=r[0],a=r[1],s=this.attributes,o=s.pageWidth,l=o===void 0?i:o,c=s.pageHeight,u=c===void 0?a:c;return{pageWidth:l,pageHeight:u}},enumerable:!1,configurable:!0}),t.prototype.getContainer=function(){return this.playWindow},Object.defineProperty(t.prototype,"totalPages",{get:function(){return this.pageViews.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currPage",{get:function(){return this.innerCurrPage},enumerable:!1,configurable:!0}),t.prototype.getBBox=function(){var e=n.prototype.getBBox.call(this),r=e.x,i=e.y,a=this.controllerShape,s=this.pageShape,o=s.pageWidth,l=s.pageHeight;return new cr(r,i,o+a.width,l)},t.prototype.goTo=function(e){var r=this,i=this.attributes.animate,a=this,s=a.currPage,o=a.playState,l=a.playWindow,c=a.pageViews;if(o!=="idle"||e<0||c.length<=0||e>=c.length)return null;c[s].setLocalPosition(0,0),this.prepareFollowingPage(e);var u=$(this.getFollowingPageDiff(e),2),h=u[0],f=u[1];this.playState="running";var d=nI(l,[{transform:"translate(0, 0)"},{transform:"translate(".concat(-h,", ").concat(-f,")")}],i);return Uo(d,function(){r.innerCurrPage=e,r.playState="idle",r.setVisiblePages([e]),r.updatePageInfo()}),d},t.prototype.prev=function(){var e=this.attributes.loop,r=this.pageViews.length,i=this.currPage;if(!e&&i<=0)return null;var a=e?(i-1+r)%r:tn(i-1,0,r);return this.goTo(a)},t.prototype.next=function(){var e=this.attributes.loop,r=this.pageViews.length,i=this.currPage;if(!e&&i>=r-1)return null;var a=e?(i+1)%r:tn(i+1,0,r);return this.goTo(a)},t.prototype.renderClipPath=function(e){var r=this.pageShape,i=r.pageWidth,a=r.pageHeight;if(!i||!a){this.contentGroup.style.clipPath=void 0;return}this.clipPath=e.maybeAppendByClassName(Ur.clipPath,"rect").styles({width:i,height:a}),this.contentGroup.attr("clipPath",this.clipPath.node())},t.prototype.setVisiblePages=function(e){this.playWindow.children.forEach(function(r,i){e.includes(i)?Cc(r):ui(r)})},t.prototype.adjustControllerLayout=function(){var e=this,r=e.prevBtnGroup,i=e.nextBtnGroup,a=e.pageInfoGroup,s=this.attributes,o=s.orientation,l=s.controllerPadding,c=a.getBBox(),u=c.width;c.height;var h=$(o==="horizontal"?[-180,0]:[-90,90],2),f=h[0],d=h[1];r.setLocalEulerAngles(f),i.setLocalEulerAngles(d);var g=r.getBBox(),v=g.width,p=g.height,y=i.getBBox(),m=y.width,w=y.height,E=Math.max(v,u,m),S=o==="horizontal"?{offset:[[0,0],[v/2+l,0],[v+u+l*2,0]],textAlign:"start"}:{offset:[[E/2,-p-l],[E/2,0],[E/2,w+l]],textAlign:"center"},O=$(S.offset,3),k=$(O[0],2),T=k[0],C=k[1],P=$(O[1],2),N=P[0],L=P[1],D=$(O[2],2),G=D[0],H=D[1],W=S.textAlign,q=a.querySelector("text");q&&(q.style.textAlign=W),r.setLocalPosition(T,C),a.setLocalPosition(N,L),i.setLocalPosition(G,H)},t.prototype.updatePageInfo=function(){var e,r=this,i=r.currPage,a=r.pageViews,s=r.attributes.formatter;a.length<2||((e=this.pageInfoGroup.querySelector(Ur.pageInfo.class))===null||e===void 0||e.attr("text",s(i+1,a.length)),this.adjustControllerLayout())},t.prototype.getFollowingPageDiff=function(e){var r=this.currPage;if(r===e)return[0,0];var i=this.attributes.orientation,a=this.pageShape,s=a.pageWidth,o=a.pageHeight,l=e<r?-1:1;return i==="horizontal"?[l*s,0]:[0,l*o]},t.prototype.prepareFollowingPage=function(e){var r=this,i=r.currPage,a=r.pageViews;if(this.setVisiblePages([e,i]),e!==i){var s=$(this.getFollowingPageDiff(e),2),o=s[0],l=s[1];a[e].setLocalPosition(o,l)}},t.prototype.renderController=function(e){var r=this,i=this.attributes.controllerSpacing,a=this.pageShape,s=a.pageWidth,o=a.pageHeight,l=this.pageViews.length>=2,c=e.maybeAppendByClassName(Ur.controller,"g");if(cd(c.node(),l),!!l){var u=te(this.attributes,"button"),h=te(this.attributes,"pageNum"),f=$(ha(u),2),d=f[0],g=f[1],v=d.size,p=an(d,["size"]),y=!c.select(Ur.prevBtnGroup.class).node(),m=c.maybeAppendByClassName(Ur.prevBtnGroup,"g").styles(g);this.prevBtnGroup=m.node();var w=m.maybeAppendByClassName(Ur.prevBtn,"path"),E=c.maybeAppendByClassName(Ur.nextBtnGroup,"g").styles(g);this.nextBtnGroup=E.node();var S=E.maybeAppendByClassName(Ur.nextBtn,"path");[w,S].forEach(function(k){k.styles(pt(pt({},p),{transformOrigin:"center"})),wx(k.node(),v)});var O=c.maybeAppendByClassName(Ur.pageInfoGroup,"g");this.pageInfoGroup=O.node(),O.maybeAppendByClassName(Ur.pageInfo,"text").styles(h),this.updatePageInfo(),c.node().setLocalPosition(s+i,o/2),y&&(this.prevBtnGroup.addEventListener("click",function(){r.prev()}),this.nextBtnGroup.addEventListener("click",function(){r.next()}))}},t.prototype.render=function(e,r){var i=e.x,a=i===void 0?0:i,s=e.y,o=s===void 0?0:s;this.attr("transform","translate(".concat(a,", ").concat(o,")"));var l=jt(r);this.renderClipPath(l),this.renderController(l),this.setVisiblePages([this.defaultPage]),this.goTo(this.defaultPage)},t.prototype.bindEvents=function(){var e=this,r=cc(function(){return e.render(e.attributes,e)},50);this.playWindow.addEventListener(ce.INSERTED,r),this.playWindow.addEventListener(ce.REMOVED,r)},t}(sn);function MQ(n,t,e){var r=1.4,i=r*e;return[["M",n-e,t-i],["L",n+e,t-i],["L",n+e,t+i],["L",n-e,t+i],["Z"]]}var vI=1.4,yI=.4;function OQ(n,t,e){var r=e,i=r*vI,a=r/2,s=r/6,o=n+i*yI;return[["M",n,t],["L",o,t+a],["L",n+i,t+a],["L",n+i,t-a],["L",o,t-a],["Z"],["M",o,t+s],["L",n+i-2,t+s],["M",o,t-s],["L",n+i-2,t-s]]}function TQ(n,t,e){var r=e,i=r*vI,a=r/2,s=r/6,o=t+i*yI;return[["M",n,t],["L",n-a,o],["L",n-a,t+i],["L",n+a,t+i],["L",n+a,o],["Z"],["M",n-s,o],["L",n-s,t+i-2],["M",n+s,o],["L",n+s,t+i-2]]}ke.registerSymbol("hiddenHandle",MQ);ke.registerSymbol("verticalHandle",OQ);ke.registerSymbol("horizontalHandle",TQ);function jb(n,t,e){return n===void 0&&(n="horizontal"),n==="horizontal"?t:e}var Ar=yi({layout:"flex",markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label",valueGroup:"value-group",value:"value",backgroundGroup:"background-group",background:"background"},"legend-category-item");function kQ(n){var t=n.querySelector(Ar.marker.class);return t?t.style:{}}var AQ=function(n){le(t,n);function t(e){return n.call(this,e,{span:[1,1],marker:function(){return new da({style:{r:6}})},markerSize:10,labelFill:"#646464",valueFill:"#646464",labelFontSize:12,valueFontSize:12,labelTextBaseline:"middle",valueTextBaseline:"middle"})||this}return Object.defineProperty(t.prototype,"showValue",{get:function(){var e=this.attributes.valueText;return e?typeof e=="string"||typeof e=="number"?e!=="":typeof e=="function"?!0:e.attr("text")!=="":!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"actualSpace",{get:function(){var e=this.labelGroup,r=this.valueGroup,i=this.attributes.markerSize,a=e.node().getBBox(),s=a.width,o=a.height,l=r.node().getBBox(),c=l.width,u=l.height;return{markerWidth:i,labelWidth:s,valueWidth:c,height:Math.max(i,o,u)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"span",{get:function(){var e=this.attributes.span;if(!e)return[1,1];var r=$($n(e),2),i=r[0],a=r[1],s=this.showValue?a:0,o=i+s;return[i/o,s/o]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shape",{get:function(){var e,r=this.attributes,i=r.markerSize,a=r.width,s=this.actualSpace,o=s.markerWidth,l=s.height,c=this.actualSpace,u=c.labelWidth,h=c.valueWidth,f=$(this.spacing,2),d=f[0],g=f[1];if(a){var v=a-i-d-g,p=$(this.span,2),y=p[0],m=p[1];e=$([y*v,m*v],2),u=e[0],h=e[1]}var w=o+u+h+d+g;return{width:w,height:l,markerWidth:o,labelWidth:u,valueWidth:h}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"spacing",{get:function(){var e=this.attributes.spacing;if(!e)return[0,0];var r=$($n(e),2),i=r[0],a=r[1];return this.showValue?[i,a]:[i,0]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layout",{get:function(){var e=this.shape,r=e.markerWidth,i=e.labelWidth,a=e.valueWidth,s=e.width,o=e.height,l=$(this.spacing,2),c=l[0],u=l[1];return{height:o,width:s,markerWidth:r,labelWidth:i,valueWidth:a,position:[r/2,r+c,r+i+c+u]}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaleSize",{get:function(){var e=kQ(this.markerGroup.node()),r=this.attributes,i=r.markerSize,a=r.markerStrokeWidth,s=a===void 0?e.strokeWidth:a,o=r.markerLineWidth,l=o===void 0?e.lineWidth:o,c=r.markerStroke,u=c===void 0?e.stroke:c,h=+(s||l||(u?1:0))*Math.sqrt(2),f=this.markerGroup.node().getBBox(),d=f.width,g=f.height;return(1-h/Math.max(d,g))*i},enumerable:!1,configurable:!0}),t.prototype.renderMarker=function(e){var r=this,i=this.attributes.marker,a=te(this.attributes,"marker");this.markerGroup=e.maybeAppendByClassName(Ar.markerGroup,"g").style("zIndex",0),qr(!!i,this.markerGroup,function(){var s,o=r.markerGroup.node(),l=(s=o.childNodes)===null||s===void 0?void 0:s[0],c=typeof i=="string"?new ke({style:{symbol:i},className:Ar.marker.name}):i();l?c.nodeName===l.nodeName?l instanceof ke?l.update(pt(pt({},a),{symbol:i})):(uZ(l,c),jt(l).styles(a)):(l.remove(),jt(c).attr("className",Ar.marker.name).styles(a),o.appendChild(c)):(c instanceof ke||jt(c).attr("className",Ar.marker.name).styles(a),o.appendChild(c)),r.markerGroup.node().scale(1/r.markerGroup.node().getScale()[0]);var u=wx(r.markerGroup.node(),r.scaleSize);r.markerGroup.node().style._transform="scale(".concat(u,")")})},t.prototype.renderLabel=function(e){var r=te(this.attributes,"label"),i=r.text,a=an(r,["text"]);this.labelGroup=e.maybeAppendByClassName(Ar.labelGroup,"g").style("zIndex",0),this.labelGroup.maybeAppendByClassName(Ar.label,function(){return ua(i)}).styles(a)},t.prototype.renderValue=function(e){var r=this,i=te(this.attributes,"value"),a=i.text,s=an(i,["text"]);this.valueGroup=e.maybeAppendByClassName(Ar.valueGroup,"g").style("zIndex",0),qr(this.showValue,this.valueGroup,function(){r.valueGroup.maybeAppendByClassName(Ar.value,function(){return ua(a)}).styles(s)})},t.prototype.renderBackground=function(e){var r=this.shape,i=r.width,a=r.height,s=te(this.attributes,"background");this.background=e.maybeAppendByClassName(Ar.backgroundGroup,"g").style("zIndex",-1),this.background.maybeAppendByClassName(Ar.background,"rect").styles(pt({width:i,height:a},s))},t.prototype.adjustLayout=function(){var e=this.layout,r=e.labelWidth,i=e.valueWidth,a=e.height,s=$(e.position,3),o=s[0],l=s[1],c=s[2],u=a/2;this.markerGroup.styles({transform:"translate(".concat(o,", ").concat(u,")").concat(this.markerGroup.node().style._transform)}),this.labelGroup.styles({transform:"translate(".concat(l,", ").concat(u,")")}),Lb(this.labelGroup.select(Ar.label.class).node(),Math.ceil(r)),this.showValue&&(this.valueGroup.styles({transform:"translate(".concat(c,", ").concat(u,")")}),Lb(this.valueGroup.select(Ar.value.class).node(),Math.ceil(i)))},t.prototype.render=function(e,r){var i=jt(r),a=e.x,s=a===void 0?0:a,o=e.y,l=o===void 0?0:o;i.styles({transform:"translate(".concat(s,", ").concat(l,")")}),this.renderMarker(i),this.renderLabel(i),this.renderValue(i),this.renderBackground(i),this.adjustLayout()},t}(sn),gs=yi({page:"item-page",navigator:"navigator",item:"item"},"items"),ZA=function(n,t,e){return e===void 0&&(e=!0),n?t(n):e},CQ=function(n){le(t,n);function t(e){var r=n.call(this,e,{data:[],gridRow:1/0,gridCol:void 0,padding:0,width:1e3,height:100,rowPadding:0,colPadding:0,layout:"flex",orientation:"horizontal",click:Vd,mouseenter:Vd,mouseleave:Vd})||this;return r.navigatorShape=[0,0],r}return Object.defineProperty(t.prototype,"pageViews",{get:function(){return this.navigator.getContainer()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"grid",{get:function(){var e=this.attributes,r=e.gridRow,i=e.gridCol,a=e.data;if(!r&&!i)throw new Error("gridRow and gridCol can not be set null at the same time");return r&&i?[r,i]:r?[r,a.length]:[a.length,i]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderData",{get:function(){var e=this.attributes,r=e.data,i=e.layout,a=te(this.attributes,"item"),s=r.map(function(o,l){var c=o.id,u=c===void 0?l:c,h=o.label,f=o.value;return{id:"".concat(u),index:l,style:pt({layout:i,labelText:h,valueText:f},Object.fromEntries(Object.entries(a).map(function(d){var g=$(d,2),v=g[0],p=g[1];return[v,Zr(p,[o,l,r])]})))}});return s},enumerable:!1,configurable:!0}),t.prototype.getGridLayout=function(){var e=this,r=this.attributes,i=r.orientation,a=r.width,s=r.rowPadding,o=r.colPadding,l=$(this.navigatorShape,1),c=l[0],u=$(this.grid,2),h=u[0],f=u[1],d=f*h,g=0;return this.pageViews.children.map(function(v,p){var y,m,w=Math.floor(p/d),E=p%d,S=e.ifHorizontal(f,h),O=[Math.floor(E/S),E%S];i==="vertical"&&O.reverse();var k=$(O,2),T=k[0],C=k[1],P=(a-c-(f-1)*o)/f,N=v.getBBox().height,L=$([0,0],2),D=L[0],G=L[1];return i==="horizontal"?(y=$([g,T*(N+s)],2),D=y[0],G=y[1],g=C===f-1?0:g+P+o):(m=$([C*(P+o),g],2),D=m[0],G=m[1],g=T===h-1?0:g+N+s),{page:w,index:p,row:T,col:C,pageIndex:E,width:P,height:N,x:D,y:G}})},t.prototype.getFlexLayout=function(){var e=this.attributes,r=e.width,i=e.height,a=e.rowPadding,s=e.colPadding,o=$(this.navigatorShape,1),l=o[0],c=$(this.grid,2),u=c[0],h=c[1],f=$([r-l,i],2),d=f[0],g=f[1],v=$([0,0,0,0,0,0,0,0],8),p=v[0],y=v[1],m=v[2],w=v[3],E=v[4],S=v[5],O=v[6],k=v[7];return this.pageViews.children.map(function(T,C){var P,N,L,D,G=T.getBBox(),H=G.width,W=G.height,q=O===0?0:s,z=O+q+H;if(z<=d&&ZA(E,function(at){return at<h}))return P=$([O+q,k,z],3),p=P[0],y=P[1],O=P[2],{width:H,height:W,x:p,y,page:m,index:C,pageIndex:w++,row:S,col:E++};N=$([S+1,0,0,k+W+a],4),S=N[0],E=N[1],O=N[2],k=N[3];var Z=k+W;return Z<=g&&ZA(S,function(at){return at<u})?(L=$([O,k,H],3),p=L[0],y=L[1],O=L[2],{width:H,height:W,x:p,y,page:m,index:C,pageIndex:w++,row:S,col:E++}):(D=$([0,0,H,0,m+1,0,0,0],8),p=D[0],y=D[1],O=D[2],k=D[3],m=D[4],w=D[5],S=D[6],E=D[7],{width:H,height:W,x:p,y,page:m,index:C,pageIndex:w++,row:S,col:E++})})},Object.defineProperty(t.prototype,"itemsLayout",{get:function(){this.navigatorShape=[0,0];var e=this.attributes.layout==="grid"?this.getGridLayout:this.getFlexLayout,r=e.call(this);return r.slice(-1)[0].page>0?(this.navigatorShape=[55,0],e.call(this)):r},enumerable:!1,configurable:!0}),t.prototype.ifHorizontal=function(e,r){var i=this.attributes.orientation;return jb(i,e,r)},t.prototype.flattenPage=function(e){e.querySelectorAll(gs.item.class).forEach(function(r){e.appendChild(r)}),e.querySelectorAll(gs.page.class).forEach(function(r){var i=e.removeChild(r);i.destroy()})},t.prototype.renderItems=function(e){var r=this.attributes,i=r.click,a=r.mouseenter,s=r.mouseleave;this.flattenPage(e);var o=this.dispatchCustomEvent.bind(this);jt(e).selectAll(gs.item.class).data(this.renderData,function(l){return l.id}).join(function(l){return l.append(function(c){var u=c.style;return new AQ({style:u})}).attr("className",gs.item.name).on("click",function(){i==null||i(this),o("itemClick",{item:this})}).on("pointerenter",function(){a==null||a(this),o("itemMouseenter",{item:this})}).on("pointerleave",function(){s==null||s(this),o("itemMouseleave",{item:this})})},function(l){return l.each(function(c){var u=c.style;this.update(u)})},function(l){return l.remove()})},t.prototype.relayoutNavigator=function(){var e,r=this.attributes,i=r.layout,a=r.width,s=((e=this.pageViews.children[0])===null||e===void 0?void 0:e.getBBox().height)||0,o=$(this.navigatorShape,2),l=o[0],c=o[1];this.navigator.update(i==="grid"?{pageWidth:a-l,pageHeight:s-c}:{})},t.prototype.adjustLayout=function(){var e=this,r=Object.entries(YK(this.itemsLayout,"page")).map(function(a){var s=$(a,2),o=s[0],l=s[1];return{page:o,layouts:l}}),i=Rt([],$(this.navigator.getContainer().children),!1);r.forEach(function(a){var s=a.layouts,o=e.pageViews.appendChild(new Tn({className:gs.page.name}));s.forEach(function(l){var c=l.x,u=l.y,h=l.index,f=l.width,d=l.height,g=i[h];o.appendChild(g),Wl(g,"__layout__",l),g.update({x:c,y:u,width:f,height:d})})}),this.relayoutNavigator()},t.prototype.renderNavigator=function(e){var r=this.attributes.orientation,i=te(this.attributes,"nav"),a=Ln({orientation:r},i),s=this;return e.selectAll(gs.navigator.class).data(["nav"]).join(function(o){return o.append(function(){return new _Q({style:a})}).attr("className",gs.navigator.name).each(function(){s.navigator=this})},function(o){return o.each(function(){this.update(a)})},function(o){return o.remove()}),this.navigator},t.prototype.getBBox=function(){return this.navigator.getBBox()},t.prototype.render=function(e,r){var i=this.attributes.data;if(!(!i||i.length===0)){var a=this.renderNavigator(jt(r));this.renderItems(a.getContainer()),this.adjustLayout()}},t.prototype.dispatchCustomEvent=function(e,r){var i=new pn(e,{detail:r});this.dispatchEvent(i)},t}(sn),al=yi({markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label"},"handle"),mI={showLabel:!0,formatter:function(n){return n.toString()},markerSize:25,markerStroke:"#c5c5c5",markerFill:"#fff",markerLineWidth:1,labelFontSize:12,labelFill:"#c5c5c5",labelText:"",orientation:"vertical",spacing:0};(function(n){le(t,n);function t(e){return n.call(this,e,mI)||this}return t.prototype.render=function(e,r){var i=jt(r).maybeAppendByClassName(al.markerGroup,"g");this.renderMarker(i);var a=jt(r).maybeAppendByClassName(al.labelGroup,"g");this.renderLabel(a)},t.prototype.renderMarker=function(e){var r=this,i=this.attributes,a=i.orientation,s=i.markerSymbol,o=s===void 0?jb(a,"horizontalHandle","verticalHandle"):s;qr(!!o,e,function(l){var c=te(r.attributes,"marker"),u=pt({symbol:o},c);r.marker=l.maybeAppendByClassName(al.marker,function(){return new ke({style:u})}).update(u)})},t.prototype.renderLabel=function(e){var r=this,i=this.attributes,a=i.showLabel,s=i.orientation,o=i.spacing,l=o===void 0?0:o,c=i.formatter;qr(a,e,function(u){var h,f=te(r.attributes,"label"),d=f.text,g=an(f,["text"]),v=((h=u.select(al.marker.class))===null||h===void 0?void 0:h.node().getBBox())||{},p=v.width,y=p===void 0?0:p,m=v.height,w=m===void 0?0:m,E=$(jb(s,[0,w+l,"center","top"],[y+l,0,"start","middle"]),4),S=E[0],O=E[1],k=E[2],T=E[3];u.maybeAppendByClassName(al.label,"text").styles(pt(pt({},g),{x:S,y:O,text:c(d).toString(),textAlign:k,textBaseline:T}))})},t})(sn);var bI={showTitle:!0,padding:0,orientation:"horizontal",backgroundFill:"transparent",titleText:"",titleSpacing:4,titlePosition:"top-left",titleFill:"#2C3542",titleFontWeight:"bold",titleFontFamily:"sans-serif",titleFontSize:12},PQ=Ln({},bI,{});Ln({},bI,ho(mI,"handle"),{color:["#d0e3fa","#acc7f6","#8daaf2","#6d8eea","#4d73cd","#325bb1","#5a3e75","#8c3c79","#e23455","#e7655b"],indicatorBackgroundFill:"#262626",indicatorLabelFill:"white",indicatorLabelFontSize:12,indicatorVisibility:"hidden",labelAlign:"value",labelDirection:"positive",labelSpacing:5,showHandle:!0,showIndicator:!0,showLabel:!0,slidable:!0,titleText:"",type:"continuous"});var sl=yi({title:"title",titleGroup:"title-group",items:"items",itemsGroup:"items-group",contentGroup:"content-group",ribbonGroup:"ribbon-group",ribbon:"ribbon",handlesGroup:"handles-group",handle:"handle",startHandle:"start-handle",endHandle:"end-handle",labelGroup:"label-group",label:"label",indicator:"indicator"},"legend"),NQ=function(n){le(t,n);function t(e){return n.call(this,e,PQ)||this}return t.prototype.renderTitle=function(e,r,i){var a=this.attributes,s=a.showTitle,o=a.titleText,l=te(this.attributes,"title"),c=$(ha(l),2),u=c[0],h=c[1];this.titleGroup=e.maybeAppendByClassName(sl.titleGroup,"g").styles(h);var f=pt(pt({width:r,height:i},u),{text:s?o:""});this.title=this.titleGroup.maybeAppendByClassName(sl.title,function(){return new bQ({style:f})}).update(f)},t.prototype.renderItems=function(e,r){var i=r.x,a=r.y,s=r.width,o=r.height,l=te(this.attributes,"title",!0),c=$(ha(l),2),u=c[0],h=c[1],f=pt(pt({},u),{width:s,height:o,x:0,y:0});this.itemsGroup=e.maybeAppendByClassName(sl.itemsGroup,"g").styles(pt(pt({},h),{transform:"translate(".concat(i,", ").concat(a,")")}));var d=this;this.itemsGroup.selectAll(sl.items.class).data(["items"]).join(function(g){return g.append(function(){return new CQ({style:f})}).attr("className",sl.items.name).each(function(){d.items=jt(this)})},function(g){return g.update(f)},function(g){return g.remove()})},t.prototype.adjustLayout=function(){var e=this.attributes.showTitle;if(e){var r=this.title.node().getAvailableSpace(),i=r.x,a=r.y;this.itemsGroup.node().style.transform="translate(".concat(i,", ").concat(a,")")}},Object.defineProperty(t.prototype,"availableSpace",{get:function(){var e=this.attributes,r=e.showTitle,i=e.width,a=e.height;return r?this.title.node().getAvailableSpace():new cr(0,0,i,a)},enumerable:!1,configurable:!0}),t.prototype.getBBox=function(){var e,r,i=(e=this.title)===null||e===void 0?void 0:e.node(),a=(r=this.items)===null||r===void 0?void 0:r.node();return!i||!a?n.prototype.getBBox.call(this):vQ(i,a)},t.prototype.render=function(e,r){var i=this.attributes,a=i.width,s=i.height,o=i.x,l=o===void 0?0:o,c=i.y,u=c===void 0?0:c,h=jt(r);r.style.transform="translate(".concat(l,", ").concat(u,")"),this.renderTitle(h,a,s),this.renderItems(h,this.availableSpace),this.adjustLayout()},t}(sn),RQ={backgroundFill:"#262626",backgroundLineCap:"round",backgroundLineWidth:1,backgroundStroke:"#333",backgroundZIndex:-1,formatter:function(n){return n.toString()},labelFill:"#fff",labelFontSize:12,labelTextBaseline:"middle",padding:[2,4],position:"right",radius:0,zIndex:999},b1=yi({background:"background",labelGroup:"label-group",label:"label"},"indicator"),LQ=function(n){le(t,n);function t(e){var r=n.call(this,e,RQ)||this;return r.point=[0,0],r.group=r.appendChild(new Tn({})),r.isMutationObserved=!0,r}return t.prototype.renderBackground=function(){if(this.label){var e=this.attributes,r=e.position,i=e.padding,a=$($n(i),4),s=a[0],o=a[1],l=a[2],c=a[3],u=this.label.node().getLocalBounds(),h=u.min,f=u.max,d=new cr(h[0]-c,h[1]-s,f[0]+o-h[0]+c,f[1]+l-h[1]+s),g=this.getPath(r,d),v=te(this.attributes,"background");this.background=jt(this.group).maybeAppendByClassName(b1.background,"path").styles(pt(pt({},v),{d:g})),this.group.appendChild(this.label.node())}},t.prototype.renderLabel=function(){var e=this.attributes,r=e.formatter,i=e.labelText,a=te(this.attributes,"label"),s=$(ha(a),2),o=s[0],l=s[1];o.text;var c=an(o,["text"]);if(this.label=jt(this.group).maybeAppendByClassName(b1.labelGroup,"g").styles(l),!!i){var u=this.label.maybeAppendByClassName(b1.label,function(){return ua(r(i))}).style("text",r(i).toString());u.selectAll("text").styles(c)}},t.prototype.adjustLayout=function(){var e=$(this.point,2),r=e[0],i=e[1],a=this.attributes,s=a.x,o=a.y;this.group.attr("transform","translate(".concat(s-r,", ").concat(o-i,")"))},t.prototype.getPath=function(e,r){var i=this.attributes.radius,a=r.x,s=r.y,o=r.width,l=r.height,c=[["M",a+i,s],["L",a+o-i,s],["A",i,i,0,0,1,a+o,s+i],["L",a+o,s+l-i],["A",i,i,0,0,1,a+o-i,s+l],["L",a+i,s+l],["A",i,i,0,0,1,a,s+l-i],["L",a,s+i],["A",i,i,0,0,1,a+i,s],["Z"]],u={top:4,right:6,bottom:0,left:2},h=u[e],f=this.createCorner([c[h].slice(-2),c[h+1].slice(-2)]);return c.splice.apply(c,Rt([h+1,1],$(f),!1)),c[0][0]="M",c},t.prototype.createCorner=function(e,r){r===void 0&&(r=10);var i=.8,a=cZ.apply(void 0,Rt([],$(e),!1)),s=$(e,2),o=$(s[0],2),l=o[0],c=o[1],u=$(s[1],2),h=u[0],f=u[1],d=$(a?[h-l,[l,h]]:[f-c,[c,f]],2),g=d[0],v=$(d[1],2),p=v[0],y=v[1],m=g/2,w=g/Math.abs(g),E=r*w,S=E/2,O=E*Math.sqrt(3)/2*i,k=$([p,p+m-S,p+m,p+m+S,y],5),T=k[0],C=k[1],P=k[2],N=k[3],L=k[4];return a?(this.point=[P,c-O],[["L",T,c],["L",C,c],["L",P,c-O],["L",N,c],["L",L,c]]):(this.point=[l+O,P],[["L",l,T],["L",l,C],["L",l+O,P],["L",l,N],["L",l,L]])},t.prototype.applyVisibility=function(){var e=this.attributes.visibility;e==="hidden"?ui(this):Cc(this)},t.prototype.bindEvents=function(){this.label.on(ce.BOUNDS_CHANGED,this.renderBackground)},t.prototype.render=function(){this.renderLabel(),this.renderBackground(),this.adjustLayout(),this.applyVisibility()},t}(sn);function qb(n){return n===void 0&&(n=""),{CONTAINER:"".concat(n,"tooltip"),TITLE:"".concat(n,"tooltip-title"),LIST:"".concat(n,"tooltip-list"),LIST_ITEM:"".concat(n,"tooltip-list-item"),NAME:"".concat(n,"tooltip-list-item-name"),MARKER:"".concat(n,"tooltip-list-item-marker"),NAME_LABEL:"".concat(n,"tooltip-list-item-name-label"),VALUE:"".concat(n,"tooltip-list-item-value"),CROSSHAIR_X:"".concat(n,"tooltip-crosshair-x"),CROSSHAIR_Y:"".concat(n,"tooltip-crosshair-y")}}var JA={overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"};function IQ(n){var t;n===void 0&&(n="");var e=qb(n);return t={},t[".".concat(e.CONTAINER)]={position:"absolute",visibility:"visible","z-index":8,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)","background-color":"rgba(255, 255, 255, 0.96)","box-shadow":"0 6px 12px 0 rgba(0, 0, 0, 0.12)","border-radius":"4px",color:"rgba(0, 0, 0, 0.65)","font-size":"12px","line-height":"20px",padding:"12px","min-width":"120px","max-width":"360px","font-family":"Roboto-Regular"},t[".".concat(e.TITLE)]={color:"rgba(0, 0, 0, 0.45)"},t[".".concat(e.LIST)]={margin:"0px","list-style-type":"none",padding:"0px"},t[".".concat(e.LIST_ITEM)]={"list-style-type":"none",display:"flex","line-height":"2em","align-items":"center","justify-content":"space-between","white-space":"nowrap"},t[".".concat(e.MARKER)]={width:"8px",height:"8px","border-radius":"50%",display:"inline-block","margin-right":"4px"},t[".".concat(e.NAME)]={display:"flex","align-items":"center","max-width":"216px"},t[".".concat(e.NAME_LABEL)]=pt({flex:1},JA),t[".".concat(e.VALUE)]=pt({display:"inline-block",float:"right",flex:1,"text-align":"right","min-width":"28px","margin-left":"30px",color:"rgba(0, 0, 0, 0.85)"},JA),t[".".concat(e.CROSSHAIR_X)]={position:"absolute",width:"1px","background-color":"rgba(0, 0, 0, 0.25)"},t[".".concat(e.CROSSHAIR_Y)]={position:"absolute",height:"1px","background-color":"rgba(0, 0, 0, 0.25)"},t}var DQ=function(n){le(t,n);function t(e){var r=this,i,a,s=(a=(i=e.style)===null||i===void 0?void 0:i.template)===null||a===void 0?void 0:a.prefixCls,o=qb(s);return r=n.call(this,e,{data:[],x:0,y:0,visibility:"visible",title:"",position:"bottom-right",offset:[5,5],enterable:!1,container:{x:0,y:0},bounding:null,template:{prefixCls:"",container:'<div class="'.concat(o.CONTAINER,'"></div>'),title:'<div class="'.concat(o.TITLE,'"></div>'),item:'<li class="'.concat(o.LIST_ITEM,`" data-index={index}>
        <span class="`).concat(o.NAME,`">
          <span class="`).concat(o.MARKER,`" style="background:{color}"></span>
          <span class="`).concat(o.NAME_LABEL,`" title="{name}">{name}</span>
        </span>
        <span class="`).concat(o.VALUE,`" title="{value}">{value}</span>
      </li>`)},style:IQ(s)})||this,r.timestamp=-1,r.prevCustomContentKey=r.attributes.contentKey,r.initShape(),r.render(r.attributes,r),r}return Object.defineProperty(t.prototype,"HTMLTooltipElement",{get:function(){return this.element},enumerable:!1,configurable:!0}),t.prototype.getContainer=function(){return this.element},Object.defineProperty(t.prototype,"elementSize",{get:function(){var e=this.element.offsetWidth,r=this.element.offsetHeight;return{width:e,height:r}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"HTMLTooltipItemsElements",{get:function(){var e=this.attributes,r=e.data,i=e.template;return r.map(function(a,s){var o=a.name,l=o===void 0?"":o,c=a.color,u=c===void 0?"black":c,h=a.index,f=an(a,["name","color","index"]),d=pt({name:l,color:u,index:h??s},f);return Y1(vB(i.item,d))})},enumerable:!1,configurable:!0}),t.prototype.render=function(e,r){this.renderHTMLTooltipElement(),this.updatePosition()},t.prototype.destroy=function(){var e;(e=this.element)===null||e===void 0||e.remove(),n.prototype.destroy.call(this)},t.prototype.show=function(e,r){var i=this;if(e!==void 0&&r!==void 0){var a=this.element.style.visibility==="hidden",s=function(){i.attributes.x=e??i.attributes.x,i.attributes.y=r??i.attributes.y,i.updatePosition()};a?this.closeTransition(s):s()}this.element.style.visibility="visible"},t.prototype.hide=function(e,r){e===void 0&&(e=0),r===void 0&&(r=0);var i=this.attributes.enterable;i&&this.isCursorEntered(e,r)||(this.element.style.visibility="hidden")},t.prototype.initShape=function(){var e=this.attributes.template;this.element=Y1(e.container),this.id&&this.element.setAttribute("id",this.id)},t.prototype.renderCustomContent=function(){if(!(this.prevCustomContentKey!==void 0&&this.prevCustomContentKey===this.attributes.contentKey)){this.prevCustomContentKey=this.attributes.contentKey;var e=this.attributes.content;e&&(typeof e=="string"?this.element.innerHTML=e:EA(this.element,e))}},t.prototype.renderHTMLTooltipElement=function(){var e,r,i=this.attributes,a=i.template,s=i.title,o=i.enterable,l=i.style,c=i.content,u=qb(a.prefixCls),h=this.element;if(this.element.style.pointerEvents=o?"auto":"none",c)this.renderCustomContent();else{s?(h.innerHTML=a.title,h.getElementsByClassName(u.TITLE)[0].innerHTML=s):(r=(e=h.getElementsByClassName(u.TITLE))===null||e===void 0?void 0:e[0])===null||r===void 0||r.remove();var f=this.HTMLTooltipItemsElements,d=document.createElement("ul");d.className=u.LIST,EA(d,f);var g=this.element.querySelector(".".concat(u.LIST));g?g.replaceWith(d):h.appendChild(d)}dZ(h,l)},t.prototype.getRelativeOffsetFromCursor=function(e){var r=this.attributes,i=r.position,a=r.offset,s=e||i,o=s.split("-"),l={left:[-1,0],right:[1,0],top:[0,-1],bottom:[0,1]},c=this.elementSize,u=c.width,h=c.height,f=[-u/2,-h/2];return o.forEach(function(d){var g=$(f,2),v=g[0],p=g[1],y=$(l[d],2),m=y[0],w=y[1];f=[v+(u/2+a[0])*m,p+(h/2+a[1])*w]}),f},t.prototype.setOffsetPosition=function(e){var r=$(e,2),i=r[0],a=r[1],s=this.attributes,o=s.x,l=o===void 0?0:o,c=s.y,u=c===void 0?0:c,h=s.container,f=h.x,d=h.y;this.element.style.left="".concat(+l+f+i,"px"),this.element.style.top="".concat(+u+d+a,"px")},t.prototype.updatePosition=function(){var e=this.attributes.showDelay,r=e===void 0?60:e,i=Date.now();this.timestamp>0&&i-this.timestamp<r||(this.timestamp=i,this.setOffsetPosition(this.autoPosition(this.getRelativeOffsetFromCursor())))},t.prototype.autoPosition=function(e){var r=$(e,2),i=r[0],a=r[1],s=this.attributes,o=s.x,l=s.y,c=s.bounding,u=s.position;if(!c)return[i,a];var h=this.element,f=h.offsetWidth,d=h.offsetHeight,g=$([+o+i,+l+a],2),v=g[0],p=g[1],y={left:"right",right:"left",top:"bottom",bottom:"top"},m=c.x,w=c.y,E=c.width,S=c.height,O={left:v<m,right:v+f>m+E,top:p<w,bottom:p+d>w+S},k=[];u.split("-").forEach(function(C){O[C]?k.push(y[C]):k.push(C)});var T=k.join("-");return this.getRelativeOffsetFromCursor(T)},t.prototype.isCursorEntered=function(e,r){if(this.element){var i=this.element.getBoundingClientRect(),a=i.x,s=i.y,o=i.width,l=i.height;return new cr(a,s,o,l).isPointIn(e,r)}return!1},t.prototype.closeTransition=function(e){var r=this,i=this.element.style.transition;this.element.style.transition="none",e(),setTimeout(function(){r.element.style.transition=i},10)},t.tag="tooltip",t}(sn),FQ=function(n){le(t,n);function t(e){var r=n.call(this,Ln({},t.defaultOptions,e))||this;return r.hoverColor="#f5f5f5",r.selectedColor="#e6f7ff",r.background=r.appendChild(new Rn({})),r.label=r.background.appendChild(new Tn({})),r}return Object.defineProperty(t.prototype,"padding",{get:function(){return $n(this.style.padding)},enumerable:!1,configurable:!0}),t.prototype.renderLabel=function(){var e=this.style,r=e.label,i=e.value,a=te(this.attributes,"label");jt(this.label).maybeAppend(".label",function(){return ua(r)}).attr("className","label").styles(a),this.label.attr("__data__",i)},t.prototype.renderBackground=function(){var e=this.label.getBBox(),r=$(this.padding,4),i=r[0],a=r[1],s=r[2],o=r[3],l=e.width,c=e.height,u=l+o+a,h=c+i+s,f=te(this.attributes,"background"),d=this.style,g=d.width,v=g===void 0?0:g,p=d.height,y=p===void 0?0:p,m=d.selected;this.background.attr(pt(pt({},f),{width:Math.max(u,v),height:Math.max(h,y),fill:m?this.selectedColor:"#fff"})),this.label.attr({transform:"translate(".concat(o,", ").concat((h-c)/2,")")})},t.prototype.render=function(){this.renderLabel(),this.renderBackground()},t.prototype.bindEvents=function(){var e=this;this.addEventListener("pointerenter",function(){e.style.selected||e.background.attr("fill",e.hoverColor)}),this.addEventListener("pointerleave",function(){e.style.selected||e.background.attr("fill",e.style.backgroundFill)});var r=this;this.addEventListener("click",function(){var i=e.style,a=i.label,s=i.value,o=i.onClick;o==null||o(s,{label:a,value:s},r)})},t.defaultOptions={style:{value:"",label:"",cursor:"pointer"}},t}(sn),BQ=function(n){le(t,n);function t(e){var r,i,a=n.call(this,Ln({},t.defaultOptions,e))||this;a.currentValue=(r=t.defaultOptions.style)===null||r===void 0?void 0:r.defaultValue,a.isPointerInSelect=!1,a.select=a.appendChild(new Rn({className:"select",style:{cursor:"pointer",width:0,height:0}})),a.dropdown=a.appendChild(new Rn({className:"dropdown"}));var s=a.style.defaultValue;return s&&(!((i=a.style.options)===null||i===void 0)&&i.some(function(o){return o.value===s}))&&(a.currentValue=s),a}return t.prototype.setValue=function(e){this.currentValue=e,this.render()},t.prototype.getValue=function(){return this.currentValue},Object.defineProperty(t.prototype,"dropdownPadding",{get:function(){return $n(this.style.dropdownPadding)},enumerable:!1,configurable:!0}),t.prototype.renderSelect=function(){var e=this,r,i=this.style,a=i.x,s=i.y,o=i.width,l=i.height,c=i.bordered,u=i.showDropdownIcon,h=te(this.attributes,"select"),f=te(this.attributes,"placeholder");this.select.attr(pt(pt({x:a,y:s,width:o,height:l},h),{fill:"#fff",strokeWidth:c?1:0}));var d=this.dropdownPadding,g=10;u&&jt(this.select).maybeAppend(".dropdown-icon","path").style("d","M-5,-3.5 L0,3.5 L5,-3.5").style("transform","translate(".concat(a+o-g-d[1]-d[3],", ").concat(s+l/2,")")).style("lineWidth",1).style("stroke",this.select.style.stroke);var v=(r=this.style.options)===null||r===void 0?void 0:r.find(function(w){return w.value===e.currentValue}),p=pt({x:a+d[3]},f);jt(this.select).selectAll(".placeholder").data(v?[]:[1]).join(function(w){return w.append("text").attr("className","placeholder").styles(p).style("y",function(){var E=this.getBBox();return s+(l-E.height)/2})},function(w){return w.styles(p)},function(w){return w.remove()});var y=te(this.attributes,"optionLabel"),m=pt({x:a+d[3]},y);jt(this.select).selectAll(".value").data(v?[v]:[]).join(function(w){return w.append(function(E){return ua(E.label)}).attr("className","value").styles(m).style("y",function(){var E=this.getBBox();return s+(l-E.height)/2})},function(w){return w.styles(m)},function(w){return w.remove()})},t.prototype.renderDropdown=function(){var e=this,r,i,a=this.style,s=a.x,o=a.y,l=a.width,c=a.height,u=a.options,h=a.onSelect,f=a.open,d=te(this.attributes,"dropdown"),g=te(this.attributes,"option"),v=this.dropdownPadding;jt(this.dropdown).maybeAppend(".dropdown-container","g").attr("className","dropdown-container").selectAll(".dropdown-item").data(u,function(m){return m.value}).join(function(m){return m.append(function(w){return new FQ({className:"dropdown-item",style:pt(pt(pt({},w),g),{width:l-v[1]-v[3],selected:w.value===e.currentValue,onClick:function(E,S,O){e.setValue(E),h==null||h(E,S,O),e.dispatchEvent(new pn("change",{detail:{value:E,option:S,item:O}})),ui(e.dropdown)}})})}).each(function(w,E){var S,O=(S=this.parentNode)===null||S===void 0?void 0:S.children,k=O.reduce(function(T,C,P){return P<E&&(T+=C.getBBox().height),T},0);this.attr("transform","translate(".concat(v[3],", ").concat(v[0]+k,")"))})},function(m){return m.update(function(w){return{selected:w.value===e.currentValue}})},function(m){return m.remove()});var p=(i=(r=this.dropdown.getElementsByClassName("dropdown-container"))===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.getBBox(),y=d.spacing;this.dropdown.attr(pt({transform:"translate(".concat(s,", ").concat(o+c+y,")"),width:p.width+v[1]+v[3],height:p.height+v[0]+v[2]},d)),!f&&ui(this.dropdown)},t.prototype.render=function(){this.renderSelect(),this.renderDropdown()},t.prototype.bindEvents=function(){var e=this;this.addEventListener("click",function(r){r.stopPropagation()}),this.select.addEventListener("click",function(){e.dropdown.style.visibility==="visible"?ui(e.dropdown):Cc(e.dropdown)}),this.addEventListener("pointerenter",function(){e.isPointerInSelect=!0}),this.addEventListener("pointerleave",function(){e.isPointerInSelect=!1}),document==null||document.addEventListener("click",function(){e.isPointerInSelect||ui(e.dropdown)})},t.defaultOptions={style:{x:0,y:0,width:140,height:32,options:[],bordered:!0,defaultValue:"",selectRadius:8,selectStroke:"#d9d9d9",showDropdownIcon:!0,placeholderText:"",placeholderFontSize:12,placeholderTextBaseline:"top",placeholderFill:"#c2c2c2",dropdownFill:"#fff",dropdownStroke:"#d9d9d9",dropdownRadius:8,dropdownShadowBlur:4,dropdownShadowColor:"rgba(0, 0, 0, 0.08)",dropdownPadding:8,dropdownSpacing:10,optionPadding:[8,12],optionFontSize:12,optionTextBaseline:"top",optionBackgroundFill:"#fff",optionBackgroundRadius:4,optionLabelFontSize:12,optionLabelTextBaseline:"top"}},t}(sn),mi=function(n){le(t,n);function t(e){var r=n.call(this,Ln({},{style:{backgroundOpacity:t.backgroundOpacities.default}},t.defaultOptions,e))||this;return r.showBackground=!0,r.background=r.appendChild(new Rn({})),r.icon=r.appendChild(new Tn({})),r}return Object.defineProperty(t.prototype,"label",{get:function(){return"BaseIcon"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineWidth",{get:function(){return Math.log10(this.attributes.size)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return $n(this.attributes.size/5)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"iconSize",{get:function(){var e=this.attributes.size,r=$(this.padding,4),i=r[0],a=r[1],s=r[2],o=r[3];return Math.max(e-Math.max(o+a,i+s),this.lineWidth*2+1)},enumerable:!1,configurable:!0}),t.prototype.renderBackground=function(){var e=this.attributes,r=e.x,i=e.y,a=e.size,s=a/2,o=te(this.attributes,"background");this.background.attr(pt({x:r-s,y:i-s,width:a,height:a},o))},t.prototype.showIndicator=function(){if(this.label){var e=this.attributes.size,r=this.background.getBBox(),i=r.x,a=r.y;this.indicator.update({x:i+e/2,y:a-5,labelText:this.label,visibility:"visible"})}},t.prototype.hideIndicator=function(){this.indicator.update({visibility:"hidden"})},t.prototype.connectedCallback=function(){var e;n.prototype.connectedCallback.call(this);var r=this.attributes.size,i=this.background.getBBox(),a=i.x,s=i.y,o=(e=this.ownerDocument)===null||e===void 0?void 0:e.defaultView;o&&(this.indicator=o.appendChild(new LQ({style:{x:a+r/2,y:s-r/2,visibility:"hidden",position:"top",radius:3,zIndex:100}})))},t.prototype.disconnectedCallback=function(){this.indicator.destroy()},t.prototype.render=function(){this.renderIcon(),this.showBackground&&this.renderBackground()},t.prototype.bindEvents=function(){var e=this,r=this.attributes.onClick;if(this.addEventListener("click",function(){r==null||r(e)}),this.showBackground){var i=function(){return e.background.attr({opacity:t.backgroundOpacities.default})},a=function(){return e.background.attr({opacity:t.backgroundOpacities.hover})},s=function(){return e.background.attr({opacity:t.backgroundOpacities.active})};this.addEventListener("pointerenter",function(){a(),e.showIndicator()}),this.addEventListener("pointerleave",function(){i(),e.hideIndicator()}),this.addEventListener("pointerdown",function(){s()}),this.addEventListener("pointerup",function(){i()})}},t.tag="IconBase",t.defaultOptions={style:{x:0,y:0,size:10,color:"#565758",backgroundRadius:4,backgroundFill:"#e2e2e2"}},t.backgroundOpacities={default:0,hover:.8,active:1},t}(sn),ic=function(n,t){return t===void 0&&(t="#565758"),new Fr({style:{fill:t,d:"M ".concat(n,",").concat(n," L -").concat(n,",0 L ").concat(n,",-").concat(n," Z"),transformOrigin:"center"}})},zQ=function(n){le(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.arcPath=function(e,r,i){var a=$([i,i],2),s=a[0],o=a[1],l=function(v){return[e+i*Math.cos(v),r+i*Math.sin(v)]},c=$(l(-5/4*Math.PI),2),u=c[0],h=c[1],f=$(l(1/4*Math.PI),2),d=f[0],g=f[1];return"M".concat(u,",").concat(h,",A").concat(s,",").concat(o,",0,1,1,").concat(d,",").concat(g)},Object.defineProperty(t.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,r=e.x,i=e.y,a=e.color,s=this.iconSize,o=this.lineWidth,l=o+.5;jt(this.icon).maybeAppend(".reset","path").styles({stroke:a,lineWidth:o,d:this.arcPath(r,i,s/2-o),markerStart:ic(l,a)})},t}(mi),jQ=function(n){le(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,r=e.x,i=e.y,a=e.color,s=this.iconSize,o=s/2,l=s/2/Math.pow(3,.5),c=[[r,i],[r,i-l],[r-o,i],[r,i+l],[r,i],[r+o,i-l],[r+o,i+l],[r,i]];jt(this.icon).maybeAppend(".backward","polygon").styles({points:c,fill:a})},t}(mi),qQ=function(n){le(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,r=e.x,i=e.y,a=e.color,s=this.iconSize,o=s/2,l=s/2/Math.pow(3,.5),c=[[r,i],[r,i-l],[r+o,i],[r,i+l],[r,i],[r-o,i-l],[r-o,i+l],[r,i]];jt(this.icon).maybeAppend(".forward","polygon").styles({points:c,fill:a})},t}(mi),$Q=function(n){le(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,r=e.x,i=e.y,a=e.color,s=this.iconSize,o=s/3*Math.pow(3,.5)*.8,l=[[r+o,i],[r-o/2,i-s/2*.8],[r-o/2,i+s/2*.8],[r+o,i]];jt(this.icon).maybeAppend(".play","polygon").styles({points:l,fill:a})},t}(mi),GQ=function(n){le(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,r=e.x,i=e.y,a=e.color,s=this.iconSize,o=s/3,l=[[r-o,i-s/2],[r-o,i+s/2],[r-o/2,i+s/2],[r-o/2,i-s/2],[r-o,i-s/2],[r+o/2,i-s/2],[r+o/2,i+s/2],[r+o,i+s/2],[r+o,i-s/2]];jt(this.icon).maybeAppend(".pause","polygon").styles({points:l,fill:a})},t}(mi),WQ=function(n){le(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,r=e.x,i=e.y,a=e.color,s=this,o=s.iconSize,l=s.lineWidth,c=l;jt(this.icon).maybeAppend(".left-line","line").styles({x1:r-o/2,y1:i-o/2,x2:r-o/2,y2:i+o/2,stroke:a,lineWidth:l}),jt(this.icon).maybeAppend(".right-line","line").styles({x1:r+o/2,y1:i-o/2,x2:r+o/2,y2:i+o/2,stroke:a,lineWidth:l}),jt(this.icon).maybeAppend(".left-arrow","line").styles({x1:r,y1:i,x2:r-o/2+c*2,y2:i,stroke:a,lineWidth:l,markerEnd:ic(l*2,a)}),jt(this.icon).maybeAppend(".right-arrow","line").styles({x1:r,y1:i,x2:r+o/2-c*2,y2:i,stroke:a,lineWidth:l,markerEnd:ic(l*2,a)})},t}(mi),VQ=function(n){le(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,r=e.x,i=e.y,a=e.color,s=this,o=s.iconSize,l=s.lineWidth;jt(this.icon).maybeAppend(".line","line").styles({x1:r,y1:i-o/2,x2:r,y2:i+o/2,stroke:a,lineWidth:l});var c=l;jt(this.icon).maybeAppend(".left-arrow","line").styles({x1:r-o/2-c*2,y1:i,x2:r-c*2,y2:i,stroke:a,lineWidth:l,markerEnd:ic(l*2,a)}),jt(this.icon).maybeAppend(".right-arrow","line").styles({x1:r+o/2+c*2,y1:i,x2:r+c*2,y2:i,stroke:a,lineWidth:l,markerEnd:ic(l*2,a)})},t}(mi),wI=function(n){return[[-n/2,-n/2],[-n/2,n/2],[n/2,n/2]]},HQ=function(n){le(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,r=e.x,i=e.y,a=e.color,s=this,o=s.iconSize,l=s.lineWidth,c=l,u=(o-c*2-l)/4,h=(o-c*2-l)/2,f=$([r-o/2+c,i+o/2-c*2],2),d=f[0],g=f[1];jt(this.icon).maybeAppend(".coordinate","polyline").styles({points:wI(o).map(function(v){var p=$(v,2),y=p[0],m=p[1];return[y+r,m+i]}),stroke:a,lineWidth:l}),jt(this.icon).maybeAppend(".line","polyline").styles({points:[[d,g],[d+u,g-h],[d+u*2,g],[d+u*4,g-h*2]],stroke:a,lineWidth:l})},t}(mi),UQ=function(n){le(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return[1,4,2,4,3]},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.data,r=this.attributes,i=r.x,a=r.y,s=r.color,o=this,l=o.iconSize,c=o.lineWidth,u=c,h=(l-u)/e.length,f=(l-u*2)/4,d=$([i-l/2+u*2,a+l/2-u],2),g=d[0],v=d[1];jt(this.icon).maybeAppend(".coordinate","polyline").styles({points:wI(l).map(function(p){var y=$(p,2),m=y[0],w=y[1];return[m+i,w+a]}),stroke:s,lineWidth:c}),jt(this.icon).maybeAppend(".bars","g").selectAll(".column").data(this.data.map(function(p,y){return{value:p,index:y}})).join(function(p){return p.append("line").attr("className","column").style("x1",function(y){var m=y.index;return g+h*m}).style("y1",v).style("x2",function(y){var m=y.index;return g+h*m}).style("y2",function(y){var m=y.value;return v-f*m}).styles({y1:v,stroke:s,lineWidth:c})})},t}(mi),YQ=function(n){le(t,n);function t(e){var r=n.call(this,Ln({},{style:{color:"#d8d9d9"}},e))||this;return r.showBackground=!1,r}return t.prototype.renderIcon=function(){var e=this.attributes,r=e.x,i=e.y,a=e.color,s=this,o=s.iconSize,l=s.lineWidth;jt(this.icon).maybeAppend(".split","line").styles({x1:r,y1:i-o/2,x2:r,y2:i+o/2,stroke:a,lineWidth:l})},t}(mi),$b=function(n){le(t,n);function t(){var e=n.apply(this,Rt([],$(arguments),!1))||this;return e.showBackground=!1,e}return Object.defineProperty(t.prototype,"padding",{get:function(){return $n(0)},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.iconSize,r=this.attributes,i=r.x,a=r.y,s=r.speed,o=s===void 0?1:s,l=gw(this.attributes,["x","y","transform","transformOrigin","width","height","size","color","speed"]),c=tn(e,20,1/0),u=20,h=pt(pt({},l),{x:i-c/2,y:a-u/2,width:c,height:u,defaultValue:o,bordered:!1,showDropdownIcon:!1,selectRadius:2,dropdownPadding:this.padding,dropdownRadius:2,dropdownSpacing:e/5,placeholderFontSize:e/2,optionPadding:0,optionLabelFontSize:e/2,optionBackgroundRadius:1,options:[{label:"1x",value:1},{label:"1.5x",value:1.5},{label:"2x",value:2}]});jt(this.icon).maybeAppend(".speed",function(){return new BQ({style:h})}).attr("className","speed").each(function(){this.update(h)})},t.tag="SpeedSelect",t}(mi),Ax=function(n){le(t,n);function t(e){var r=n.call(this,e)||this;return r.icon=r.appendChild(new Tn({})),r.currentType=r.attributes.type,r}return t.prototype.getType=function(){return this.currentType},t.prototype.render=function(){var e=this,r=this.attributes;r.onChange;var i=an(r,["onChange"]);jt(this.icon).selectAll(".icon").data([this.currentType]).join(function(a){return a.append(function(s){var o,l=(o=e.toggles.find(function(c){var u=$(c,1),h=u[0];return h===s}))===null||o===void 0?void 0:o[1];if(!l)throw new Error("Invalid type: ".concat(s));return new l({})}).attr("className","icon").styles(i,!1).update({})},function(a){return a.styles({restStyles:i}).update({})},function(a){return a.remove()})},t.prototype.bindEvents=function(){var e=this,r=this.attributes.onChange;this.addEventListener("click",function(i){i.preventDefault(),i.stopPropagation();var a=(e.toggles.findIndex(function(o){var l=$(o,1),c=l[0];return c===e.currentType})+1)%e.toggles.length,s=e.toggles[a][0];r==null||r(e.currentType),e.currentType=s,e.render()})},t.tag="ToggleIcon",t}(sn),Gb=function(n){le(t,n);function t(e){var r=n.call(this,Ln({},{style:{type:"play"}},e))||this;return r.toggles=[["play",$Q],["pause",GQ]],r}return t}(Ax),Wb=function(n){le(t,n);function t(e){var r=n.call(this,Ln({},{style:{type:"range"}},e))||this;return r.toggles=[["range",WQ],["value",VQ]],r}return t}(Ax),Vb=function(n){le(t,n);function t(e){var r=n.call(this,Ln({},{style:{type:"column"}},e))||this;return r.toggles=[["line",HQ],["column",UQ]],r}return t}(Ax),XQ={reset:zQ,speed:$b,backward:jQ,playPause:Gb,forward:qQ,selectionType:Wb,chartType:Vb,split:YQ},KQ=function(n){le(t,n);function t(e){var r=n.call(this,Ln({},t.defaultOptions,e))||this;return r.background=r.appendChild(new Rn({})),r.functions=r.appendChild(new Tn({})),r}return Object.defineProperty(t.prototype,"padding",{get:function(){return $n(this.attributes.padding)},enumerable:!1,configurable:!0}),t.prototype.renderBackground=function(){var e=this.style,r=e.x,i=e.y,a=e.width,s=e.height,o=te(this.attributes,"background");this.background.attr(pt({x:r,y:i,width:a,height:s},o))},t.prototype.renderFunctions=function(){var e=this,r,i=this.attributes,a=i.functions,s=i.iconSize,o=i.iconSpacing,l=i.x,c=i.y,u=i.width,h=i.height,f=i.align,d=$(this.padding,4),g=d[1],v=d[3],p=a.reduce(function(w,E){return w.length&&E.length?w.concat.apply(w,Rt(["split"],$(E),!1)):w.concat.apply(w,Rt([],$(E),!1))},[]),y=p.length*(s+o)-o,m={left:v+s/2,center:(u-y)/2+s/2,right:u-y-v-g+s/2}[f]||0;(r=this.speedSelect)===null||r===void 0||r.destroy(),this.functions.removeChildren(),p.forEach(function(w,E){var S,O=XQ[w],k={x:l+E*(s+o)+m,y:c+h/2,size:s};if(O===$b?(k.speed=e.attributes.speed,k.onSelect=function(C){return e.handleFunctionChange(w,{value:C})}):[Gb,Wb,Vb].includes(O)?(k.onChange=function(C){return e.handleFunctionChange(w,{value:C})},O===Gb&&(k.type=e.attributes.state==="play"?"pause":"play"),O===Wb&&(k.type=e.attributes.selectionType==="range"?"value":"range"),O===Vb&&(k.type=e.attributes.chartType==="line"?"column":"line")):k.onClick=function(){return e.handleFunctionChange(w,{value:w})},O===$b){var T=(S=e.ownerDocument)===null||S===void 0?void 0:S.defaultView;T&&(e.speedSelect=new O({style:pt(pt({},k),{zIndex:100})}),T.appendChild(e.speedSelect))}else e.functions.appendChild(new O({style:k}))})},t.prototype.disconnectedCallback=function(){var e;n.prototype.disconnectedCallback.call(this),(e=this.speedSelect)===null||e===void 0||e.destroy()},t.prototype.render=function(){this.renderBackground(),this.renderFunctions()},t.prototype.handleFunctionChange=function(e,r){var i=this.attributes.onChange;i==null||i(e,r)},t.defaultOptions={style:{x:0,y:0,width:300,height:40,padding:0,align:"center",iconSize:25,iconSpacing:0,speed:1,state:"pause",chartType:"line",selectionType:"range",backgroundFill:"#fbfdff",backgroundStroke:"#ebedf0",functions:[["reset","speed"],["backward","playPause","forward"],["selectionType","chartType"]]}},t}(sn),ZQ=function(n){le(t,n);function t(e){var r=n.call(this,Ln({},t.defaultOptions,e))||this;return r.bindEvents(),r}return t.prototype.bindEvents=function(){var e=this;this.addEventListener("mouseenter",function(){e.attr("lineWidth",Math.ceil(+(e.style.r||0)/2))}),this.addEventListener("mouseleave",function(){e.attr("lineWidth",0)})},t.defaultOptions={style:{r:5,fill:"#3f7cf7",lineWidth:0,stroke:"#3f7cf7",strokeOpacity:.5,cursor:"pointer"}},t}(da),JQ=function(n){le(t,n);function t(e){return n.call(this,Ln({},t.defaultOptions,e))||this}return t.prototype.renderBackground=function(){var e=this.attributes,r=e.x,i=e.y,a=e.width,s=e.height,o=te(this.attributes,"background");jt(this).maybeAppend("background","rect").attr("className","background").styles(pt({x:r-a/2,y:i-s/2,width:a,height:s},o))},t.prototype.renderIcon=function(){var e=this.attributes,r=e.x,i=e.y,a=e.iconSize,s=te(this.attributes,"icon"),o=1,l=a/2;jt(this).maybeAppend("icon-left-line","line").attr("className","icon-left-line").styles(pt({x1:r-o,y1:i-l,x2:r-o,y2:i+l},s)),jt(this).maybeAppend("icon-right-line","line").attr("className","icon-right-line").styles(pt({x1:r+o,y1:i-l,x2:r+o,y2:i+l},s))},t.prototype.renderBorder=function(){var e=this.attributes,r=e.x,i=e.y,a=e.width,s=e.height,o=e.type,l=te(this.attributes,"border"),c=o==="start"?+a/2:-a/2;jt(this).maybeAppend("border","line").attr("className","border").styles(pt({x1:c+r,y1:i-s/2,x2:c+r,y2:i+s/2},l))},t.prototype.render=function(){this.renderBackground(),this.renderIcon(),this.renderBorder()},t.defaultOptions={style:{x:0,y:0,width:10,height:50,iconSize:10,type:"start",backgroundFill:"#fff",backgroundFillOpacity:.5,iconStroke:"#9a9a9a",iconLineWidth:1,borderStroke:"#e8e8e8",borderLineWidth:1}},t}(sn);function QQ(n,t){return typeof n=="number"?xI(n):ttt(n,t)}function ttt(n,t){var e=new Date(n);switch(t){case"half-hour":case"hour":case"four-hour":return[0,6,12,18].includes(e.getHours())&&e.getMinutes()===0?vr(e,`HH:mm
YYYY-MM-DD`):vr(e,"HH:mm");case"half-day":return e.getHours()<12?`AM
`.concat(vr(e,"YYYY-MM-DD")):"PM";case"day":return[1,10,20].includes(e.getDate())?vr(e,`DD
YYYY-MM`):vr(e,"DD");case"week":return e.getDate()<=7?vr(e,`DD
YYYY-MM`):vr(e,"DD");case"month":return[0,6].includes(e.getMonth())?vr(e,`MM
YYYY`):vr(e,"MM");case"season":return[0].includes(e.getMonth())?vr(e,`MM
YYYY`):vr(e,"MM");case"year":return vr(e,"YYYY");default:return vr(e,"YYYY-MM-DD HH:mm")}}function xI(n){var t=String(Math.floor(n/3600)).padStart(2,"0"),e=String(Math.floor(n%3600/60)).padStart(2,"0"),r=String(Math.floor(n%60)).padStart(2,"0");return n<3600?"".concat(e,":").concat(r):"".concat(t,":").concat(e,":").concat(r)}var ett=function(n){le(t,n);function t(e){var r=n.call(this,Ln({},t.defaultOptions,e))||this;r.axis=r.appendChild(new SQ({style:{type:"linear",startPos:[0,0],endPos:[0,0],data:[],showArrow:!1,animate:!1}})),r.timeline=r.appendChild(new xJ({style:{onChange:function(h){r.handleSliderChange(h)}}})),r.controller=r.appendChild(new KQ({})),r.states={},r.handleSliderChange=function(h){var f=function(){var d=r.states.values;return Array.isArray(d)?Rt([],$(d),!1):d}();r.setBySliderValues(h),r.dispatchOnChange(f)};var i=r.attributes,a=i.selectionType,s=i.chartType,o=i.speed,l=i.state,c=i.playMode,u=i.values;return r.states={chartType:s,playMode:c,selectionType:a,speed:o,state:l},r.setByTimebarValues(u),r}return Object.defineProperty(t.prototype,"data",{get:function(){var e=this.attributes.data,r=function(i,a){return i.time<a.time?-1:i.time>a.time?1:0};return e.sort(r)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"space",{get:function(){var e=this.attributes,r=e.x,i=e.y,a=e.width,s=e.height,o=e.type,l=e.controllerHeight,c=tn(+s-l,0,+s),u=new cr(r,i+ +s-l,+a,l),h,f=0;o==="chart"?(f=35,h=new cr(r,i+c-f,+a,f)):h=new cr;var d=o==="time"?10:c,g=new cr(r,i+(o==="time"?c:c-d),+a,d-f);return{axisBBox:h,controllerBBox:u,timelineBBox:g}},enumerable:!1,configurable:!0}),t.prototype.setBySliderValues=function(e){var r,i,a=this.data,s=$(Array.isArray(e)?e:[0,e],2),o=s[0],l=s[1],c=a.length,u=a[Math.floor(o*c)],h=a[Math.ceil(l*c)-(Array.isArray(e)?0:1)];this.states.values=[(r=u==null?void 0:u.time)!==null&&r!==void 0?r:a[0].time,(i=h==null?void 0:h.time)!==null&&i!==void 0?i:1/0]},t.prototype.setByTimebarValues=function(e){var r,i,a,s=this.data,o=$(Array.isArray(e)?e:[void 0,e],2),l=o[0],c=o[1],u=s.find(function(f){var d=f.time;return d===l}),h=s.find(function(f){var d=f.time;return d===c});this.states.values=[(r=u==null?void 0:u.time)!==null&&r!==void 0?r:(i=s[0])===null||i===void 0?void 0:i.time,(a=h==null?void 0:h.time)!==null&&a!==void 0?a:1/0]},t.prototype.setByIndex=function(e){var r,i,a,s,o=this.data,l=$(e,2),c=l[0],u=l[1];this.states.values=[(i=(r=o[c])===null||r===void 0?void 0:r.time)!==null&&i!==void 0?i:o[0].time,(s=(a=this.data[u])===null||a===void 0?void 0:a.time)!==null&&s!==void 0?s:1/0]},Object.defineProperty(t.prototype,"sliderValues",{get:function(){var e=this.states,r=e.values,i=e.selectionType,a=$(Array.isArray(r)?r:[void 0,r],2),s=a[0],o=a[1],l=this.data,c=l.length,u=i==="value",h=function(){var d=l.findIndex(function(g){var v=g.time;return v===s});return u?0:d>-1?d/c:0},f=function(){if(o===1/0)return 1;var d=l.findIndex(function(g){var v=g.time;return v===o});return d>-1?d/c:u?.5:1};return[h(),f()]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"values",{get:function(){var e=this.states,r=e.values,i=e.selectionType,a=$(Array.isArray(r)?r:[this.data[0].time,r],2),s=a[0],o=a[1];return i==="value"?o:[s,o]},enumerable:!1,configurable:!0}),t.prototype.getDatumByRatio=function(e){var r=this.data,i=r.length,a=Math.floor(e*(i-1));return r[a]},Object.defineProperty(t.prototype,"chartHandleIconShape",{get:function(){var e=this.states.selectionType,r=this.space.timelineBBox.height;return e==="range"?function(i){return new JQ({style:{type:i,height:r,iconSize:r/6}})}:function(){return new Is({style:{x1:0,y1:-r/2,x2:0,y2:r/2,lineWidth:2,stroke:"#c8c8c8"}})}},enumerable:!1,configurable:!0}),t.prototype.getChartStyle=function(e){var r=this,i=e.x,a=e.y,s=e.width,o=e.height,l=this.states,c=l.selectionType,u=l.chartType,h=this.data,f=this.attributes,d=f.type,g=f.labelFormatter,v=te(this.attributes,"chart");v.type;var p=an(v,["type"]),y=c==="range";if(d==="time")return pt({handleIconShape:function(){return new ZQ({})},selectionFill:"#2e7ff8",selectionFillOpacity:1,showLabelOnInteraction:!0,handleLabelDy:y?-15:0,autoFitLabel:y,handleSpacing:y?-15:0,trackFill:"#edeeef",trackLength:s,trackOpacity:.5,trackRadius:o/2,trackSize:o/2,type:c,values:this.sliderValues,formatter:function(E){if(g)return g(E);var S=r.getDatumByRatio(E).time;return typeof S=="number"?xI(S):vr(S,"YYYY-MM-DD HH:mm:ss")},transform:"translate(".concat(i,", ").concat(a,")"),zIndex:1},p);var m=c==="range"?5:0,w=h.map(function(E){var S=E.value;return S});return pt({handleIconOffset:m,handleIconShape:this.chartHandleIconShape,selectionFill:"#fff",selectionFillOpacity:.5,selectionType:"invert",sparklineSpacing:.1,sparklineColumnLineWidth:0,sparklineColor:"#d4e5fd",sparklineAreaOpacity:1,sparklineAreaLineWidth:0,sparklineData:w,sparklineType:u,sparklineScale:.8,trackLength:s,trackSize:o,type:c,values:this.sliderValues,transform:"translate(".concat(i,", ").concat(a,")"),zIndex:1},p)},t.prototype.renderChart=function(e){e===void 0&&(e=this.space.timelineBBox),this.timeline.update(this.getChartStyle(e))},t.prototype.updateSelection=function(){this.timeline.setValues(this.sliderValues,!0),this.handleSliderChange(this.sliderValues)},t.prototype.getAxisStyle=function(e){var r=this.data,i=this.attributes,a=i.interval,s=i.labelFormatter,o=te(this.attributes,"axis"),l=e.x,c=e.y,u=e.width,h=Rt(Rt([],$(r),!1),[{time:0}],!1).map(function(d,g,v){var p=d.time;return{label:"".concat(p),value:g/(v.length-1),time:p}}),f=pt({startPos:[l,c],endPos:[l+u,c],data:h,labelFilter:function(d,g){return g<h.length-1},labelFormatter:function(d){var g=d.time;return s?s(g):QQ(g,a)}},o);return f},t.prototype.renderAxis=function(e){e===void 0&&(e=this.space.axisBBox);var r=this.attributes.type;r==="chart"&&this.axis.update(this.getAxisStyle(e))},t.prototype.renderController=function(e){e===void 0&&(e=this.space.controllerBBox);var r=this.attributes.type,i=this.states,a=i.state,s=i.speed,o=i.selectionType,l=i.chartType,c=te(this.attributes,"controller"),u=this,h=pt(pt(pt({},e),{iconSize:20,speed:s,state:a,selectionType:o,chartType:l,onChange:function(f,d){var g=d.value;switch(f){case"reset":u.internalReset();break;case"speed":u.handleSpeedChange(g);break;case"backward":u.internalBackward();break;case"playPause":g==="play"?u.internalPlay():u.internalPause();break;case"forward":u.internalForward();break;case"selectionType":u.handleSelectionTypeChange(g);break;case"chartType":u.handleChartTypeChange(g);break}}}),c);r==="time"&&(h.functions=[["reset","speed"],["backward","playPause","forward"],["selectionType"]]),this.controller.update(h)},t.prototype.dispatchOnChange=function(e){var r=this.data,i=this.attributes.onChange,a=this.states,s=a.values,o=a.selectionType,l=$(s,2),c=l[0],u=l[1],h=u===1/0?r.at(-1).time:u,f=o==="range"?[c,h]:h,d=function(g,v){return Array.isArray(g)?Array.isArray(v)?g[0]===v[0]&&(g[1]===v[1]||g[1]===1/0||v[1]===1/0):!1:Array.isArray(v)?!1:g===v};(!e||!d(e,f))&&(i==null||i(o==="range"?[c,h]:h))},t.prototype.internalReset=function(e){var r,i,a=this.states.selectionType;this.internalPause(),this.setBySliderValues(a==="range"?[0,1]:[0,0]),this.renderController(),this.updateSelection(),e||((i=(r=this.attributes)===null||r===void 0?void 0:r.onReset)===null||i===void 0||i.call(r),this.dispatchOnChange())},t.prototype.reset=function(){this.internalReset()},t.prototype.moveSelection=function(e,r){var i=this.data,a=i.length,s=this.states,o=s.values,l=s.selectionType,c=s.playMode,u=$(o,2),h=u[0],f=u[1],d=i.findIndex(function(w){var E=w.time;return E===h}),g=i.findIndex(function(w){var E=w.time;return E===f});g===-1&&(g=a);var v=e==="backward"?-1:1,p;l==="range"?c==="acc"?(p=[d,g+v],v===-1&&d===g&&(p=[d,a])):p=[d+v,g+v]:p=[d,g+v];var y=function(w){var E=$(w.sort(function(T,C){return T-C}),2),S=E[0],O=E[1],k=function(T){return tn(T,0,a)};return O>a?l==="value"?[0,0]:c==="acc"?[k(S),k(S)]:[0,k(O-S)]:S<0?c==="acc"?[0,k(O)]:[k(S+a-O),a]:[k(S),k(O)]},m=y(p);return this.setByIndex(m),this.updateSelection(),m},t.prototype.internalBackward=function(e){var r,i,a=this.moveSelection("backward",e);return e||((i=(r=this.attributes)===null||r===void 0?void 0:r.onBackward)===null||i===void 0||i.call(r),this.dispatchOnChange()),a},t.prototype.backward=function(){this.internalBackward()},t.prototype.internalPlay=function(e){var r=this,i,a,s=this.data,o=this.attributes.loop,l=this.states.speed,c=l===void 0?1:l;this.playInterval=window.setInterval(function(){var u=r.internalForward();u[1]===s.length&&!o&&(r.internalPause(),r.renderController())},1e3/c),this.states.state="play",!e&&((a=(i=this.attributes)===null||i===void 0?void 0:i.onPlay)===null||a===void 0||a.call(i))},t.prototype.play=function(){this.internalPlay()},t.prototype.internalPause=function(e){var r,i;clearInterval(this.playInterval),this.states.state="pause",!e&&((i=(r=this.attributes)===null||r===void 0?void 0:r.onPause)===null||i===void 0||i.call(r))},t.prototype.pause=function(){this.internalPause()},t.prototype.internalForward=function(e){var r,i,a=this.moveSelection("forward",e);return e||((i=(r=this.attributes)===null||r===void 0?void 0:r.onForward)===null||i===void 0||i.call(r),this.dispatchOnChange()),a},t.prototype.forward=function(){this.internalForward()},t.prototype.handleSpeedChange=function(e){var r,i;this.states.speed=e;var a=this.states.state;a==="play"&&(this.internalPause(!0),this.internalPlay(!0)),(i=(r=this.attributes)===null||r===void 0?void 0:r.onSpeedChange)===null||i===void 0||i.call(r,e)},t.prototype.handleSelectionTypeChange=function(e){var r,i;this.states.selectionType=e,this.renderChart(),(i=(r=this.attributes)===null||r===void 0?void 0:r.onSelectionTypeChange)===null||i===void 0||i.call(r,e)},t.prototype.handleChartTypeChange=function(e){var r,i;this.states.chartType=e,this.renderChart(),(i=(r=this.attributes)===null||r===void 0?void 0:r.onChartTypeChange)===null||i===void 0||i.call(r,e)},t.prototype.render=function(){var e=this.space,r=e.axisBBox,i=e.controllerBBox,a=e.timelineBBox;this.renderController(i),this.renderAxis(r),this.renderChart(a),this.states.state==="play"&&this.internalPlay()},t.prototype.destroy=function(){n.prototype.destroy.call(this),this.internalPause(!0)},t.defaultOptions={style:{x:0,y:0,axisLabelFill:"#6e6e6e",axisLabelTextAlign:"left",axisLabelTextBaseline:"top",axisLabelTransform:"translate(5, -12)",axisLineLineWidth:1,axisLineStroke:"#cacdd1",axisTickLength:15,axisTickLineWidth:1,axisTickStroke:"#cacdd1",chartShowLabel:!1,chartType:"line",controllerAlign:"center",controllerHeight:40,data:[],interval:"day",loop:!1,playMode:"acc",selectionType:"range",type:"time"}},t}(sn);function Cx(n){const{width:t,height:e,renderer:r}=n,i=ntt(n),a=new ub({width:t,height:e,container:i,renderer:r||new Kl});return[i,a]}function ntt(n){var t;const{container:e,className:r,graphCanvas:i}=n;if(e)return typeof e=="string"?document.getElementById(e):e;const a=Vo(r,!1),{width:s,height:o,containerStyle:l}=n,[c,u]=rtt(n);return Object.assign(a.style,Object.assign({position:"absolute",left:c+"px",top:u+"px",width:s+"px",height:o+"px"},l)),(t=i.getContainer())===null||t===void 0||t.appendChild(a),a}function rtt(n){const{width:t,height:e,placement:r,graphCanvas:i}=n,[a,s]=i.getSize(),[o,l]=hR(r);return[o*(a-t),l*(s-e)]}var itt=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};class pd extends Wn{constructor(t,e){super(t,Object.assign({},pd.defaultOptions,e)),this.typePrefix="__data__",this.draw=!1,this.fieldMap={node:new Map,edge:new Map,combo:new Map},this.selectedItems=[],this.bindEvents=()=>{const{graph:r}=this.context;r.on(Mt.AFTER_DRAW,this.createElement)},this.changeState=(r,i)=>{const{graph:a}=this.context,{typePrefix:s}=this,o=sr(r,[s,"id"]),l=sr(r,[s,"style","labelText"]),[c]=o.split("__"),u=this.fieldMap[c].get(l)||[];a.setElementState(Object.fromEntries(u==null?void 0:u.map(h=>[h,i])))},this.click=r=>{if(this.options.trigger==="hover")return;const i=sr(r,[this.typePrefix,"id"]);this.selectedItems.includes(i)?(this.selectedItems=this.selectedItems.filter(a=>a!==i),this.changeState(r,[])):(this.selectedItems.push(i),this.changeState(r,"selected"))},this.mouseleave=r=>{this.options.trigger!=="click"&&(this.selectedItems=[],this.changeState(r,[]))},this.mouseenter=r=>{if(this.options.trigger==="click")return;const i=sr(r,[this.typePrefix,"id"]);this.selectedItems.includes(i)?this.selectedItems=this.selectedItems.filter(a=>a!==i):(this.selectedItems.push(i),this.changeState(r,"active"))},this.setFieldMap=(r,i,a)=>{if(!r)return;const s=this.fieldMap[a];if(s)if(!s.has(r))s.set(r,[i]);else{const o=s.get(r);o&&(o.push(i),s.set(r,o))}},this.getEvents=()=>({mouseenter:this.mouseenter,mouseleave:this.mouseleave,click:this.click}),this.getMarkerData=(r,i)=>{if(!r)return[];const{model:a,element:s}=this.context,{nodes:o,edges:l,combos:c}=a.getData(),u={},h=p=>zt(r)?r(p):r,f={node:"circle",edge:"line",combo:"rect"},d={circle:"circle",ellipse:"circle",image:"bowtie",rect:"square",star:"cross",triangle:"triangle",diamond:"diamond",cubic:"dot",line:"hyphen",polyline:"hyphen",quadratic:"hv","cubic-horizontal":"hyphen","cubic-vertical":"line"},g=(p,y)=>s==null?void 0:s.getElementComputedStyle(p,y),v=(p,y)=>{p.forEach(m=>{const{id:w}=m,E=sr(m,["data",h(m)]),S=(s==null?void 0:s.getElementType(y,m))||"circle",O=g(y,m),k=(y==="edge"?O==null?void 0:O.stroke:O==null?void 0:O.fill)||"#1783ff";w&&E&&E.replace(/\s+/g,"")&&(this.setFieldMap(E,w,y),u[E]||(u[E]={id:`${y}__${w}`,label:E,marker:d[S]||f[y],elementType:y,lineWidth:1,stroke:k,fill:k}))})};switch(i){case"node":v(o,"node");break;case"edge":v(l,"edge");break;case"combo":v(c,"combo");break;default:return[]}return Object.values(u)},this.createElement=()=>{if(this.draw){this.updateElement();return}const r=this.options,{width:i,height:a,nodeField:s,edgeField:o,comboField:l,trigger:c,position:u,container:h,containerStyle:f,className:d}=r,g=itt(r,["width","height","nodeField","edgeField","comboField","trigger","position","container","containerStyle","className"]),v=this.getMarkerData(s,"node"),p=this.getMarkerData(o,"edge"),y=this.getMarkerData(l,"combo"),m=[...v,...y,...p],w=Object.assign({width:i,height:a,data:m,itemMarkerLineWidth:({lineWidth:O})=>O,itemMarker:({marker:O})=>O,itemMarkerStroke:({stroke:O})=>O,itemMarkerFill:({fill:O})=>O,gridCol:v.length},g,this.getEvents()),E=new NQ({className:"legend",style:w});this.category=E,this.upsertCanvas().appendChild(E),this.draw=!0},this.bindEvents()}update(t){super.update(t),this.clear(),this.createElement()}clear(){var t,e;(t=this.canvas)===null||t===void 0||t.destroy(),(e=this.container)===null||e===void 0||e.remove(),this.canvas=void 0,this.container=void 0,this.draw=!1}updateElement(){this.category&&this.category.update({itemMarkerOpacity:({id:t})=>!this.selectedItems.length||this.selectedItems.includes(t)?1:.5,itemLabelOpacity:({id:t})=>!this.selectedItems.length||this.selectedItems.includes(t)?1:.5})}upsertCanvas(){if(this.canvas)return this.canvas;const t=this.context.canvas,[e,r]=t.getSize(),{width:i=e,height:a=r,position:s,container:o,containerStyle:l,className:c}=this.options,[u,h]=Cx({width:i,height:a,graphCanvas:t,container:o,containerStyle:l,placement:s,className:"legend"});return this.container=u,c&&u.classList.add(c),this.canvas=h,this.canvas}destroy(){this.clear(),this.context.graph.off(Mt.AFTER_DRAW,this.createElement),super.destroy()}}pd.defaultOptions={position:"bottom",trigger:"hover",orientation:"horizontal",layout:"flex",itemSpacing:4,rowPadding:10,colPadding:10,itemMarkerSize:16,itemLabelFontSize:16,width:240,height:160};class vd extends Wn{constructor(t,e){super(t,Object.assign({},vd.defaultOptions,e)),this.onDraw=r=>{var i;!((i=r==null?void 0:r.data)===null||i===void 0)&&i.render||this.onRender()},this.shapes=new Map,this.landmarkMap=new Map,this.mask=null,this.isMaskDragging=!1,this.onMaskDragStart=r=>{this.mask&&(this.isMaskDragging=!0,this.mask.setPointerCapture(r.pointerId),this.mask.addEventListener("pointermove",this.onMaskDrag),this.mask.addEventListener("pointerup",this.onMaskDragEnd),this.mask.addEventListener("pointercancel",this.onMaskDragEnd))},this.onMaskDrag=r=>{if(!this.mask||!this.isMaskDragging)return;const{size:[i,a]}=this.options,{movementX:s,movementY:o}=r,{left:l,top:c,width:u,height:h}=this.mask.style,[,,f,d]=this.maskBBox;let g=parseInt(l)+s,v=parseInt(c)+o,p=parseInt(u),y=parseInt(h);g<0&&(g=0),v<0&&(v=0),g+p>i&&(g=wa(i-p,0)),v+y>a&&(v=wa(a-y,0)),p<f&&(s>0?(g=wa(g-s,0),p=ba(p+s,i)):s<0&&(p=ba(p-s,i))),y<d&&(o>0?(v=wa(v-o,0),y=ba(y+o,a)):o<0&&(y=ba(y-o,a))),Object.assign(this.mask.style,{left:g+"px",top:v+"px",width:p+"px",height:y+"px"});const m=parseInt(l)-g,w=parseInt(c)-v;if(m===0&&w===0)return;const E=this.context.canvas.getCamera().getZoom(),S=this.canvas.getCamera().getZoom(),O=E/S;this.context.graph.translateBy([m*O,w*O],!1)},this.onMaskDragEnd=r=>{this.mask&&(this.isMaskDragging=!1,this.mask.releasePointerCapture(r.pointerId),this.mask.removeEventListener("pointermove",this.onMaskDrag),this.mask.removeEventListener("pointerup",this.onMaskDragEnd),this.mask.removeEventListener("pointercancel",this.onMaskDragEnd))},this.onTransform=YP(()=>{this.isMaskDragging||(this.updateMask(),this.setCamera())},32,{leading:!0}),this.setOnRender(),this.bindEvents()}update(t){this.unbindEvents(),super.update(t),"delay"in t&&this.setOnRender(),this.bindEvents()}setOnRender(){this.onRender=cc(()=>{this.renderMinimap(),this.renderMask()},this.options.delay,!0)}bindEvents(){const{graph:t}=this.context;t.on(Mt.AFTER_DRAW,this.onDraw),t.on(Mt.AFTER_RENDER,this.onRender),t.on(Mt.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){const{graph:t}=this.context;t.off(Mt.AFTER_DRAW,this.onDraw),t.off(Mt.AFTER_RENDER,this.onRender),t.off(Mt.AFTER_TRANSFORM,this.onTransform)}renderMinimap(){const t=this.getElements(),e=this.initCanvas();this.setShapes(e,t)}getElements(){const{filter:t}=this.options,{model:e}=this.context,r=e.getData();if(!t)return r;const{nodes:i,edges:a,combos:s}=r;return{nodes:i.filter(o=>t(tt(o),"node")),edges:a.filter(o=>t(tt(o),"edge")),combos:s.filter(o=>t(tt(o),"combo"))}}setShapes(t,e){const{nodes:r,edges:i,combos:a}=e,{shape:s}=this.options,{element:o}=this.context;if(s==="key"){const c=new Set,u=h=>{const f=tt(h);c.add(f);const d=o.getElement(f);if(!d)return;const g=d.getShape("key"),v=this.shapes.get(f)||g.cloneNode();v.setPosition(g.getPosition()),d.style.zIndex&&(v.style.zIndex=d.style.zIndex),v.id=d.id,this.shapes.has(f)?Object.entries(g.attributes).forEach(([p,y])=>{v.style[p]!==y&&(v.style[p]=y)}):(t.appendChild(v),this.shapes.set(f,v))};i.forEach(u),a.forEach(u),r.forEach(u),this.shapes.forEach((h,f)=>{c.has(f)||(t.removeChild(h),this.shapes.delete(f))});return}const l=(c,u)=>{const f=o.getElement(c).getPosition();return u.setPosition(f),u};t.removeChildren(),i.forEach(c=>t.appendChild(s(tt(c),"edge"))),a.forEach(c=>{t.appendChild(l(tt(c),s(tt(c),"combo")))}),r.forEach(c=>{t.appendChild(l(tt(c),s(tt(c),"node")))})}initCanvas(){const{renderer:t,size:[e,r]}=this.options;if(this.canvas){const{width:i,height:a}=this.canvas.getConfig();(e!==i||r!==a)&&this.canvas.resize(e,r),t&&this.canvas.setRenderer(t)}else{const{className:i,position:a,container:s,containerStyle:o}=this.options,[l,c]=Cx({renderer:t,width:e,height:r,placement:a,className:"minimap",container:s,containerStyle:o,graphCanvas:this.context.canvas});i&&l.classList.add(i),this.container=l,this.canvas=c}return this.setCamera(),this.canvas}createLandmark(t,e,r){const i=`${t.join(",")}-${e.join(",")}-${r}`;if(this.landmarkMap.has(i))return this.landmarkMap.get(i);const s=this.canvas.getCamera().createLandmark(i,{position:t,focalPoint:e,zoom:r});return this.landmarkMap.set(i,s),s}setCamera(){var t;const{canvas:e}=this.context,r=(t=this.canvas)===null||t===void 0?void 0:t.getCamera();if(!r)return;const{size:[i,a],padding:s}=this.options,[o,l,c,u]=qi(s),{min:h,max:f,center:d}=e.getBounds("elements"),g=f[0]-h[0],v=f[1]-h[1],p=i-u-l,y=a-o-c,m=p/g,w=y/v,E=Math.min(m,w),S=this.createLandmark(d,d,E);r.gotoLandmark(S,0)}get maskBBox(){const{canvas:t}=this.context,e=t.getSize(),r=t.getCanvasByViewport([0,0]),i=t.getCanvasByViewport(e),a=this.canvas.canvas2Viewport(ci(r)),s=this.canvas.canvas2Viewport(ci(i)),o=s.x-a.x,l=s.y-a.y;return[a.x,a.y,o,l]}calculateMaskBBox(){const{size:[t,e]}=this.options;let[r,i,a,s]=this.maskBBox;return r<0&&(a=ba(a+r,t),r=0),i<0&&(s=ba(s+i,e),i=0),r+a>t&&(a=wa(t-r,0)),i+s>e&&(s=wa(e-i,0)),[ba(r,t),ba(i,e),wa(a,0),wa(s,0)]}renderMask(){const{maskStyle:t}=this.options;this.mask||(this.mask=document.createElement("div"),this.mask.addEventListener("pointerdown",this.onMaskDragStart)),this.container.appendChild(this.mask),Object.assign(this.mask.style,Object.assign(Object.assign({},t),{cursor:"move",position:"absolute",pointerEvents:"auto"})),this.updateMask()}updateMask(){if(!this.mask)return;const[t,e,r,i]=this.calculateMaskBBox();Object.assign(this.mask.style,{top:e+"px",left:t+"px",width:r+"px",height:i+"px"})}destroy(){var t;this.unbindEvents(),this.canvas.destroy(),(t=this.mask)===null||t===void 0||t.remove(),super.destroy()}}vd.defaultOptions={size:[240,160],shape:"key",padding:10,position:"right-bottom",maskStyle:{border:"1px solid #ddd",background:"rgba(0, 0, 0, 0.1)"},containerStyle:{border:"1px solid #ddd",background:"#fff"},delay:128};const ba=(n,t)=>Math.min(n,t),wa=(n,t)=>Math.max(n,t);var w1=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(r.next(u))}catch(h){s(h)}}function l(u){try{c(r.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((r=r.apply(n,t||[])).next())})};const x1={x1:0,y1:0,x2:0,y2:0,visibility:"hidden"};class yd extends Wn{constructor(t,e){super(t,Object.assign({},yd.defaultOptions,e)),this.initSnapline=()=>{const r=this.context.canvas.getLayer("transient");this.horizontalLine||(this.horizontalLine=r.appendChild(new Is({style:Object.assign(Object.assign({},x1),this.options.horizontalLineStyle)}))),this.verticalLine||(this.verticalLine=r.appendChild(new Is({style:Object.assign(Object.assign({},x1),this.options.verticalLineStyle)})))},this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!0,this.autoSnapToLine=(r,i,a)=>w1(this,void 0,void 0,function*(){const{verticalX:s,horizontalY:o}=a,{tolerance:l}=this.options,{min:[c,u],max:[h,f],center:[d,g]}=i;let v=0,p=0;s!==null&&(Un(h,s)<l&&(v=s-h),Un(c,s)<l&&(v=s-c),Un(d,s)<l&&(v=s-d),v!==0&&(this.isVerticalSticking=!0)),o!==null&&(Un(f,o)<l&&(p=o-f),Un(u,o)<l&&(p=o-u),Un(g,o)<l&&(p=o-g),p!==0&&(this.isHorizontalSticking=!0)),(v!==0||p!==0)&&(yield this.context.graph.translateElementBy({[r]:[v,p]},!1))}),this.enableSnap=r=>{const{target:i}=r,a=.5;if(this.isHorizontalSticking||this.isVerticalSticking){const[s,o]=this.getDelta(r);if(this.isHorizontalSticking&&this.isVerticalSticking&&Math.abs(s)<=a&&Math.abs(o)<=a)return this.context.graph.translateElementBy({[i.id]:[-s,-o]},!1),!1;if(this.isHorizontalSticking&&Math.abs(o)<=a)return this.context.graph.translateElementBy({[i.id]:[0,-o]},!1),!1;if(this.isVerticalSticking&&Math.abs(s)<=a)return this.context.graph.translateElementBy({[i.id]:[-s,0]},!1),!1;this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!1,setTimeout(()=>{this.enableStick=!0},200)}return this.enableStick},this.calcSnaplineMetadata=(r,i)=>{const{tolerance:a,shape:s}=this.options,{min:[o,l],max:[c,u],center:[h,f]}=i;let d=null,g=null,v=null,p=null,y=null,m=null;return this.getNodes().some(w=>{if(en(r.id,w.id))return!1;const E=QA(w,s).getRenderBounds(),{min:[S,O],max:[k,T],center:[C,P]}=E;return d===null&&(Un(C,h)<a?d=C:Un(S,o)<a||Un(S,c)<a?d=S:(Un(k,c)<a||Un(k,o)<a)&&(d=k),d!==null&&(g=Math.min(O,l),v=Math.max(T,u))),p===null&&(Un(P,f)<a?p=P:Un(O,l)<a||Un(O,u)<a?p=O:(Un(T,u)<a||Un(T,l)<a)&&(p=T),p!==null&&(y=Math.min(S,o),m=Math.max(k,c))),d!==null&&p!==null}),{verticalX:d,verticalMinY:g,verticalMaxY:v,horizontalY:p,horizontalMinX:y,horizontalMaxX:m}},this.onDragStart=()=>{this.initSnapline()},this.onDrag=r=>w1(this,void 0,void 0,function*(){const{target:i}=r;if(this.options.autoSnap&&!this.enableSnap(r))return;const a=QA(i,this.options.shape).getRenderBounds(),s=this.calcSnaplineMetadata(i,a);this.hideSnapline(),(s.verticalX!==null||s.horizontalY!==null)&&this.updateSnapline(s),this.options.autoSnap&&(yield this.autoSnapToLine(i.id,a,s))}),this.onDragEnd=()=>{this.hideSnapline()},this.bindEvents()}getNodes(){var t;const{filter:e}=this.options,i=(((t=this.context.element)===null||t===void 0?void 0:t.getNodes())||[]).filter(a=>{var s;return z$(a)&&((s=this.context.viewport)===null||s===void 0?void 0:s.isInViewport(a.getRenderBounds()))});return e?i.filter(a=>e(a)):i}hideSnapline(){this.horizontalLine.style.visibility="hidden",this.verticalLine.style.visibility="hidden"}getLineWidth(t){const{lineWidth:e}=this.options[`${t}LineStyle`];return+(e||x1.lineWidth||1)/this.context.graph.getZoom()}updateSnapline(t){const{verticalX:e,verticalMinY:r,verticalMaxY:i,horizontalY:a,horizontalMinX:s,horizontalMaxX:o}=t,[l,c]=this.context.canvas.getSize(),{offset:u}=this.options;a!==null?Object.assign(this.horizontalLine.style,{x1:u===1/0?0:s-u,y1:a,x2:u===1/0?l:o+u,y2:a,visibility:"visible",lineWidth:this.getLineWidth("horizontal")}):this.horizontalLine.style.visibility="hidden",e!==null?Object.assign(this.verticalLine.style,{x1:e,y1:u===1/0?0:r-u,x2:e,y2:u===1/0?c:i+u,visibility:"visible",lineWidth:this.getLineWidth("vertical")}):this.verticalLine.style.visibility="hidden"}getDelta(t){const e=this.context.graph.getZoom();return gi([t.dx,t.dy],e)}bindEvents(){return w1(this,void 0,void 0,function*(){const{graph:t}=this.context;t.on(Kr.DRAG_START,this.onDragStart),t.on(Kr.DRAG,this.onDrag),t.on(Kr.DRAG_END,this.onDragEnd)})}unbindEvents(){const{graph:t}=this.context;t.off(Kr.DRAG_START,this.onDragStart),t.off(Kr.DRAG,this.onDrag),t.off(Kr.DRAG_END,this.onDragEnd)}destroyElements(){var t,e;(t=this.horizontalLine)===null||t===void 0||t.destroy(),(e=this.verticalLine)===null||e===void 0||e.destroy()}destroy(){this.destroyElements(),this.unbindEvents(),super.destroy()}}yd.defaultOptions={tolerance:5,offset:20,autoSnap:!0,shape:"key",verticalLineStyle:{stroke:"#1783FF"},horizontalLineStyle:{stroke:"#1783FF"},filter:()=>!0};const Un=(n,t)=>Math.abs(n-t),QA=(n,t)=>typeof t=="function"?t(n):n.getShape(t);var att=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(r.next(u))}catch(h){s(h)}}function l(u){try{c(r.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((r=r.apply(n,t||[])).next())})},stt=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};const ott=["timestamp","time","date","datetime"];class md extends Wn{get padding(){return qi(this.options.padding)}constructor(t,e){super(t,Object.assign({},md.defaultOptions,e)),this.backup(),this.upsertTimebar()}play(){var t;(t=this.timebar)===null||t===void 0||t.play()}pause(){var t;(t=this.timebar)===null||t===void 0||t.pause()}forward(){var t;(t=this.timebar)===null||t===void 0||t.forward()}backward(){var t;(t=this.timebar)===null||t===void 0||t.backward()}reset(){var t;(t=this.timebar)===null||t===void 0||t.reset()}update(t){super.update(t),this.backup(),this.upsertTimebar()}backup(){this.originalData=tC(this.context.graph.getData())}upsertTimebar(){const{canvas:t}=this.context,e=this.options,{onChange:r,timebarType:i,data:a,x:s,y:o,width:l,height:c,mode:u}=e,h=stt(e,["onChange","timebarType","data","x","y","width","height","mode"]),f=t.getSize(),[d]=this.padding;this.upsertCanvas().ready.then(()=>{var g;const v=Object.assign(Object.assign({x:f[0]/2-l/2,y:d,onChange:p=>{const y=($r(p)?p:[p,p]).map(m=>bB(m)?m.getTime():m);this.options.mode==="modify"?this.filterElements(y):this.hiddenElements(y),r==null||r(y)}},h),{data:a.map(p=>Lt(p)?{time:p,value:0}:p),width:l,height:c,type:i});this.timebar?this.timebar.update(v):(this.timebar=new ett({style:v}),(g=this.canvas)===null||g===void 0||g.appendChild(this.timebar))})}upsertCanvas(){if(this.canvas)return this.canvas;const{className:t,height:e,position:r}=this.options,i=this.context.canvas,[a]=i.getSize(),[s,,o]=this.padding,[l,c]=Cx({width:a,height:e+s+o,graphCanvas:i,className:"timebar",placement:r});return this.container=l,t&&l.classList.add(t),this.canvas=c,this.canvas}filterElements(t){return att(this,void 0,void 0,function*(){var e;if(!this.originalData)return;const{elementTypes:r,getTime:i}=this.options,{graph:a,element:s}=this.context,o=tC(this.originalData);r.forEach(c=>{const u=`${c}s`;o[u]=(this.originalData[u]||[]).filter(h=>{const f=i(h);return!!eC(f,t)})});const l=[...o.nodes,...o.combos].map(c=>tt(c));o.edges=o.edges.filter(c=>{const u=c.source,h=c.target;return l.includes(u)&&l.includes(h)}),a.setData(o),yield(e=s.draw({animation:!1,silence:!0}))===null||e===void 0?void 0:e.finished})}hiddenElements(t){const{graph:e}=this.context,{elementTypes:r,getTime:i}=this.options,a=[],s=[];r.forEach(o=>{var l;const c=`${o}s`;(((l=this.originalData)===null||l===void 0?void 0:l[c])||[]).forEach(h=>{const f=tt(h),d=i(h);eC(d,t)?s.push(f):a.push(f)})}),e.hideElement(a,!1),e.showElement(s,!1)}destroy(){var t,e,r;const{graph:i}=this.context;this.originalData&&i.setData(Object.assign({},this.originalData)),(t=this.timebar)===null||t===void 0||t.destroy(),(e=this.canvas)===null||e===void 0||e.destroy(),(r=this.container)===null||r===void 0||r.remove(),this.originalData=void 0,this.container=void 0,this.timebar=void 0,this.canvas=void 0,super.destroy()}}md.defaultOptions={position:"bottom",enable:!0,timebarType:"time",className:"g6-timebar",width:450,height:60,zIndex:3,elementTypes:["node"],padding:10,mode:"modify",getTime:n=>ltt(n,ott,void 0),loop:!1};const tC=n=>{const{nodes:t=[],edges:e=[],combos:r=[]}=n;return{nodes:[...t],edges:[...e],combos:[...r]}},eC=(n,t)=>{if(Lt(t))return n===t;const[e,r]=t;return n>=e&&n<=r},ltt=(n,t,e)=>{var r;for(let i=0;i<t.length;i++){const a=t[i],s=(r=n.data)===null||r===void 0?void 0:r[a];if(s)return s}return e};function ctt(n){const t={top:"unset",right:"unset",bottom:"unset",left:"unset"};return n.split("-").forEach(r=>{t[r]="8px"}),t.flexDirection=n.startsWith("top")||n.startsWith("bottom")?"row":"column",t}const utt=`
  .g6-toolbar {
    position: absolute;
    z-index: 100;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
    box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.1);
    opacity: 0.65;
  }
  .g6-toolbar .g6-toolbar-item {
    display: inline-block;
    width: 16px;
    height: 16px;
    padding: 4px;
    cursor: pointer;
    box-sizing: content-box;
  }

  .g6-toolbar .g6-toolbar-item:hover {
    background-color: #f0f0f0;
  }

  .g6-toolbar .g6-toolbar-item svg {
    display: inline-block;
    width: 100%;
    height: 100%;
    pointer-events: none;
  }
`,htt=`
  <svg>
    <symbol id="zoom-in" viewBox="64 64 896 896">
      <path d="M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="zoom-out" viewBox="64 64 896 896">
      <path d="M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="edit" viewBox="64 64 896 896">
      <path d="M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"></path>
    </symbol>
    <symbol id="delete" viewBox="64 64 896 896">
      <path d="M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"></path>
    </symbol>
    <symbol id="redo" viewBox="64 64 896 896">
      <path d="M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"></path>
    </symbol>
    <symbol id="undo" viewBox="64 64 896 896">
      <path d="M511.4 124C290.5 124.3 112 303 112 523.9c0 128 60.2 242 153.8 315.2l-37.5 48c-4.1 5.3-.3 13 6.3 12.9l167-.8c5.2 0 9-4.9 7.7-9.9L369.8 727a8 8 0 00-14.1-3L315 776.1c-10.2-8-20-16.7-29.3-26a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-7.5 7.5-15.3 14.5-23.4 21.2a7.93 7.93 0 00-1.2 11.1l39.4 50.5c2.8 3.5 7.9 4.1 11.4 1.3C854.5 760.8 912 649.1 912 523.9c0-221.1-179.4-400.2-400.6-399.9z"></path>
    </symbol>
    <symbol id="export" viewBox="64 64 896 896">
      <path d="M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"></path>
    </symbol>
    <symbol id="auto-fit" viewBox="64 64 896 896">
      <path d="M952 474H829.8C812.5 327.6 696.4 211.5 550 194.2V72c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v122.2C327.6 211.5 211.5 327.6 194.2 474H72c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h122.2C211.5 696.4 327.6 812.5 474 829.8V952c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V829.8C696.4 812.5 812.5 696.4 829.8 550H952c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM512 756c-134.8 0-244-109.2-244-244s109.2-244 244-244 244 109.2 244 244-109.2 244-244 244z"></path>
      <path d="M512 392c-32.1 0-62.1 12.4-84.8 35.2-22.7 22.7-35.2 52.7-35.2 84.8s12.5 62.1 35.2 84.8C449.9 619.4 480 632 512 632s62.1-12.5 84.8-35.2C619.4 574.1 632 544 632 512s-12.5-62.1-35.2-84.8A118.57 118.57 0 00512 392z"></path>
    </symbol>
    <symbol id="reset" viewBox="64 64 896 896">
      <path d="M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"></path>
    </symbol>
    <symbol id="exit-fullscreen" viewBox="0 0 1024 1024">
      <path d="M418.13333333 361.43786666c0 0.2048-0.13653333 0.4096-0.13653334 0.68266667C417.99679999 362.32533333 418.13333333 362.53013333 418.13333333 362.73493333 418.13333333 371.54133333 414.44693333 379.392 408.78079999 385.39946666 408.43946666 385.7408 408.30293333 386.21866666 408.02986666 386.49173333c-1.09226667 1.09226667-2.59413333 1.77493333-3.82293333 2.73066667C398.40426666 393.65973333 391.64586666 396.8 383.93173333 396.8 383.72693333 396.8 383.59039999 396.73173333 383.38559999 396.73173333S382.97599999 396.8 382.77119999 396.8L112.29866666 396.8C92.50133333 396.8 76.79999999 381.50826666 76.79999999 362.66666666 76.66346666 343.89333333 92.63786666 328.53333333 112.16213333 328.53333333l189.44 0L87.44959999 114.51733333C73.59146666 100.59093333 73.25013333 78.5408 86.63039999 65.29706666c13.17546667-13.44853333 35.36213333-12.97066667 49.152 0.88746667l214.08426667 214.08426667L349.86666666 90.89706666C349.79839999 71.23626666 365.22666666 55.46666666 383.99999999 55.46666666 402.77333333 55.33013333 418.13333333 71.30453333 418.13333333 90.8288L418.13333333 361.43786666zM928.90453333 328.53333333l-189.44 0 214.15253333-214.08426667c13.85813333-13.9264 14.19946667-35.90826667 0.88746667-49.22026666-13.17546667-13.44853333-35.36213333-12.97066667-49.152 0.88746666l-214.08426667 214.08426667L691.26826666 90.89706666C691.26826666 71.23626666 675.83999999 55.46666666 657.06666666 55.46666666 638.29333333 55.33013333 622.93333333 71.30453333 622.93333333 90.8288l0 270.60906666c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 362.32533333 622.93333333 362.53013333 622.93333333 362.73493333 622.93333333 371.54133333 626.61973333 379.392 632.28586666 385.39946666c0.34133333 0.34133333 0.47786667 0.8192 0.8192 1.09226667 1.09226667 1.09226667 2.59413333 1.77493333 3.8912 2.73066667C642.66239999 393.65973333 649.42079999 396.8 657.13493333 396.8c0.2048 0 0.34133333-0.06826667 0.54613333-0.06826667S658.09066666 396.8 658.29546666 396.8l270.5408 0C948.56533333 396.8 964.26666666 381.50826666 964.26666666 362.66666666 964.40319999 343.89333333 948.42879999 328.53333333 928.90453333 328.53333333zM418.13333333 635.73333333c0-8.8064-3.6864-16.5888-9.35253334-22.66453333C408.43946666 612.72746666 408.30293333 612.2496 408.02986666 611.90826666 406.86933333 610.88426666 405.43573333 610.2016 404.20693333 609.24586666 398.47253333 604.80853333 391.64586666 601.6 383.93173333 601.6 383.72693333 601.6 383.59039999 601.73653333 383.38559999 601.73653333S382.97599999 601.6 382.77119999 601.6L112.29866666 601.6C92.50133333 601.6 76.79999999 616.96 76.79999999 635.73333333 76.66346666 654.50666666 92.63786666 669.86666666 112.16213333 669.86666666l189.44 0-214.15253334 214.15253334c-13.85813333 13.85813333-14.19946667 35.84-0.88746666 49.22026666 13.17546667 13.44853333 35.36213333 12.9024 49.152-0.95573333l214.08426666-214.08426667 0 189.37173334c0 19.59253333 15.42826667 35.49866667 34.2016 35.36213333C402.77333333 943.2064 418.13333333 927.232 418.13333333 907.5712L418.13333333 637.09866666c0-0.27306667-0.13653333-0.47786667-0.13653334-0.68266666C417.99679999 636.14293333 418.13333333 635.93813333 418.13333333 635.73333333zM739.46453333 669.86666666l189.44 0c19.456 0 35.49866667-15.36 35.36213333-34.13333333C964.26666666 616.96 948.56533333 601.6 928.76799999 601.6L658.29546666 601.6C658.09066666 601.6 657.88586666 601.73653333 657.68106666 601.73653333S657.33973333 601.6 657.13493333 601.6C649.42079999 601.6 642.59413333 604.80853333 636.85973333 609.24586666 635.63093333 610.2016 634.19733333 610.88426666 633.03679999 611.90826666 632.76373333 612.2496 632.62719999 612.72746666 632.28586666 613.0688 626.61973333 619.14453333 622.93333333 626.92693333 622.93333333 635.73333333c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 636.6208 622.93333333 636.8256 622.93333333 637.09866666l0 270.5408C622.93333333 927.232 638.29333333 943.2064 657.06666666 942.93333333c18.77333333 0.13653333 34.2016-15.70133333 34.2016-35.36213333l0-189.37173334 214.08426667 214.08426667c13.78986667 13.85813333 35.90826667 14.40426667 49.152 0.95573333 13.312-13.312 12.97066667-35.36213333-0.88746667-49.22026666L739.46453333 669.86666666z"  ></path></symbol>
    <symbol id="request-fullscreen" viewBox="0 0 1024 1024">
      <path d="M69.818182 87.598545v273.128728a34.909091 34.909091 0 0 0 69.818182 0V163.653818l221.928727 222.021818a33.512727 33.512727 0 0 0 47.383273-47.383272L186.926545 116.363636h197.073455a34.909091 34.909091 0 0 0 0-69.818181H110.871273C85.364364 46.545455 69.818182 59.671273 69.818182 87.598545zM938.542545 46.545455H665.413818a34.909091 34.909091 0 0 0 0 69.818181h197.073455L640.465455 338.292364a33.512727 33.512727 0 0 0 47.383272 47.383272l221.928728-222.021818v197.073455a34.909091 34.909091 0 0 0 69.818181 0V87.598545c0-27.927273-15.453091-41.053091-40.96-41.05309z m-827.671272 907.636363h273.128727a34.909091 34.909091 0 0 0 0-69.818182H186.926545l222.021819-221.928727a33.512727 33.512727 0 0 0-47.383273-47.383273L139.636364 837.073455V640a34.909091 34.909091 0 0 0-69.818182 0v273.128727c0 27.927273 15.546182 41.053091 41.053091 41.053091z m868.724363-41.053091V640a34.909091 34.909091 0 0 0-69.818181 0v197.073455L687.941818 615.051636a33.512727 33.512727 0 0 0-47.383273 47.383273L862.487273 884.363636H665.413818a34.909091 34.909091 0 0 0 0 69.818182h273.128727c25.6 0 41.053091-13.125818 41.053091-41.053091z"  ></path></symbol>
  </svg>
`;var nC=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(r.next(u))}catch(h){s(h)}}function l(u){try{c(r.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((r=r.apply(n,t||[])).next())})};class bd extends Wn{constructor(t,e){super(t,Object.assign({},bd.defaultOptions,e)),this.$element=Vo("toolbar",!1),this.onToolbarItemClick=i=>{const{onClick:a}=this.options;if(i.target instanceof Element&&i.target.className.includes("g6-toolbar-item")){const s=i.target.getAttribute("value");a==null||a(s,i.target)}};const r=this.context.canvas.getContainer();this.$element.style.display="flex",r.appendChild(this.$element),Rb("g6-toolbar-css","style",{},utt,document.head),Rb("g6-toolbar-svgicon","div",{display:"none"},htt),this.$element.addEventListener("click",this.onToolbarItemClick),this.update(e)}update(t){const e=Object.create(null,{update:{get:()=>super.update}});return nC(this,void 0,void 0,function*(){e.update.call(this,t);const{className:r,position:i,style:a}=this.options;this.$element.className=`g6-toolbar ${r||""}`,Object.assign(this.$element.style,a,ctt(i)),this.$element.innerHTML=yield this.getDOMContent()})}destroy(){this.$element.removeEventListener("click",this.onToolbarItemClick),this.$element.remove(),super.destroy()}getDOMContent(){return nC(this,void 0,void 0,function*(){return(yield this.options.getItems()).map(e=>`
          <div class="g6-toolbar-item" value="${e.value}">
            <svg aria-hidden="true" focusable="false">
              <use xlink:href="#${e.id}"></use>
            </svg>
          </div>`).join("")})}}bd.defaultOptions={position:"top-left"};var rC=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(r.next(u))}catch(h){s(h)}}function l(u){try{c(r.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((r=r.apply(n,t||[])).next())})};class wd extends Wn{constructor(t,e){super(t,Object.assign({},wd.defaultOptions,e)),this.currentTarget=null,this.tooltipElement=null,this.container=null,this.isEnable=(r,i)=>{const{enable:a}=this.options;return typeof a=="function"?a(r,i):a},this.onClick=r=>{const{target:{id:i}}=r;this.currentTarget===i?this.hide(r):this.show(r)},this.onPointerMove=r=>{const{target:i}=r;!this.currentTarget||i.id===this.currentTarget||this.show(r)},this.onPointerLeave=r=>{this.hide(r)},this.onCanvasMove=r=>{this.hide(r)},this.onPointerEnter=r=>{this.show(r)},this.showById=r=>rC(this,void 0,void 0,function*(){const i={target:{id:r}};yield this.show(i)}),this.getElementData=(r,i)=>{const{model:a}=this.context;switch(i){case"node":return a.getNodeData([r]);case"edge":return a.getEdgeData([r]);case"combo":return a.getComboData([r]);default:return[]}},this.show=r=>rC(this,void 0,void 0,function*(){var i,a;const{client:s,target:{id:o}}=r;if(vf(r.target))return;const l=this.context.graph.getElementType(o),{getContent:c,title:u}=this.options,h=this.getElementData(o,l);if(!this.tooltipElement||!this.isEnable(r,h))return;let f={};if(c){if(f.content=yield c(r,h),!f.content)return}else{const v=this.context.graph.getElementRenderStyle(o),p=l==="node"?v.fill:v.stroke;f={title:u||l,data:h.map(y=>({name:"ID",value:y.id||`${y.source} -> ${y.target}`,color:p}))}}this.currentTarget=o;let d,g;if(s)d=s.x,g=s.y;else{const v=sr(h,"0.style",{x:0,y:0});d=v.x,g=v.y}(a=(i=this.options).onOpenChange)===null||a===void 0||a.call(i,!0),this.tooltipElement.update(Object.assign(Object.assign(Object.assign({},this.tooltipStyleProps),{x:d,y:g,style:{".tooltip":{visibility:"visible"}}}),f))}),this.hide=r=>{var i,a,s,o,l;if(!r){(a=(i=this.options).onOpenChange)===null||a===void 0||a.call(i,!1),(s=this.tooltipElement)===null||s===void 0||s.hide(),this.currentTarget=null;return}if(!this.tooltipElement||!this.currentTarget)return;const{client:{x:c,y:u}}=r;(l=(o=this.options).onOpenChange)===null||l===void 0||l.call(o,!1),this.tooltipElement.hide(c,u),this.currentTarget=null},this.initTooltip=()=>{var r;const i=new DQ({className:"tooltip",style:this.tooltipStyleProps});return(r=this.container)===null||r===void 0||r.appendChild(i.HTMLTooltipElement),i},this.render(),this.bindEvents()}getEvents(){return this.options.trigger==="click"?{"node:click":this.onClick,"edge:click":this.onClick,"combo:click":this.onClick,"canvas:click":this.onPointerLeave,contextmenu:this.onPointerLeave,drag:this.onPointerLeave}:{"node:pointerenter":this.onPointerEnter,"node:pointermove":this.onPointerMove,"canvas:pointermove":this.onCanvasMove,"edge:pointerenter":this.onPointerEnter,"edge:pointermove":this.onPointerMove,"combo:pointerenter":this.onPointerEnter,"combo:pointermove":this.onPointerMove,contextmenu:this.onPointerLeave,"node:drag":this.onPointerLeave}}update(t){var e;this.unbindEvents(),super.update(t),this.tooltipElement&&((e=this.container)===null||e===void 0||e.removeChild(this.tooltipElement.HTMLTooltipElement)),this.tooltipElement=this.initTooltip(),this.bindEvents()}render(){const{canvas:t}=this.context,e=t.getContainer();e&&(this.container=e,this.tooltipElement=this.initTooltip())}unbindEvents(){const{graph:t}=this.context,e=this.getEvents();Object.keys(e).forEach(r=>{t.off(r,e[r])})}bindEvents(){const{graph:t}=this.context,e=this.getEvents();Object.keys(e).forEach(r=>{t.on(r,e[r])})}get tooltipStyleProps(){const{canvas:t}=this.context,{center:e}=t.getBounds(),r=t.getContainer(),{top:i,left:a}=r.getBoundingClientRect(),{style:s,position:o,enterable:l,container:c={x:-a,y:-i},title:u,offset:h}=this.options,[f,d]=e,[g,v]=t.getSize();return{x:f,y:d,container:c,title:u,bounding:{x:0,y:0,width:g,height:v},position:o,enterable:l,offset:h,style:s}}destroy(){var t;this.unbindEvents(),this.tooltipElement&&((t=this.container)===null||t===void 0||t.removeChild(this.tooltipElement.HTMLTooltipElement)),super.destroy()}}wd.defaultOptions={trigger:"hover",position:"top-right",enterable:!1,enable:!0,offset:[10,10],style:{".tooltip":{visibility:"hidden"}}};var EI=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(r.next(u))}catch(h){s(h)}}function l(u){try{c(r.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((r=r.apply(n,t||[])).next())})};let ro;function SI(n,t){return ro||(ro=document.createElement("canvas")),ro.width=n,ro.height=t,ro.getContext("2d").clearRect(0,0,n,t),ro}function ftt(n,t,e,r){return EI(this,void 0,void 0,function*(){const i=SI(n,t),a=i.getContext("2d"),{rotate:s,opacity:o,textFill:l,textFontSize:c,textFontFamily:u,textFontVariant:h,textFontWeight:f,textAlign:d,textBaseline:g}=r;return a.textAlign=d,a.textBaseline=g,a.translate(n/2,t/2),a.font=`${c}px ${u} ${h} ${f}`,s&&a.rotate(s),o&&(a.globalAlpha=o),l&&(a.fillStyle=l,a.fillText(`${e}`,0,0)),i.toDataURL()})}function dtt(n,t,e,r){return EI(this,void 0,void 0,function*(){const i=SI(n,t),a=i.getContext("2d"),{rotate:s,opacity:o}=r;s&&a.rotate(s),o&&(a.globalAlpha=o);const l=new Image;return l.crossOrigin="anonymous",l.src=e,new Promise(c=>{l.onload=function(){const u=n>l.width?(n-l.width)/2:0,h=t>l.height?(t-l.height)/2:0;a.drawImage(l,0,0,l.width,l.height,u,h,n-u*2,t-h*2),c(i.toDataURL())}})})}var gtt=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(r.next(u))}catch(h){s(h)}}function l(u){try{c(r.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((r=r.apply(n,t||[])).next())})},ptt=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};class xd extends Wn{constructor(t,e){super(t,Object.assign({},xd.defaultOptions,e)),this.$element=Vo("watermark"),this.context.canvas.getContainer().appendChild(this.$element),this.update(e)}update(t){const e=Object.create(null,{update:{get:()=>super.update}});return gtt(this,void 0,void 0,function*(){e.update.call(this,t);const r=this.options,{width:i,height:a,text:s,imageURL:o}=r,l=ptt(r,["width","height","text","imageURL"]);Object.keys(l).forEach(u=>{u.startsWith("background")&&(this.$element.style[u]=t[u])});const c=o?yield dtt(i,a,o,l):yield ftt(i,a,s,l);this.$element.style.backgroundImage=`url(${c})`})}destroy(){super.destroy(),this.$element.remove()}}xd.defaultOptions={width:200,height:100,opacity:.2,rotate:Math.PI/12,text:"",textFill:"#000",textFontSize:16,textAlign:"center",textBaseline:"middle",backgroundRepeat:"repeat"};const vtt=["#7E92B5","#F4664A","#FFBE3A"],ytt={type:"group",color:["#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]},mtt={type:"group",color:["#99ADD1","#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]};function _I(n){const{bgColor:t,textColor:e,nodeColor:r,nodeColorDisabled:i,nodeStroke:a,nodeHaloStrokeOpacityActive:s=.15,nodeHaloStrokeOpacitySelected:o=.25,nodeOpacityDisabled:l=.06,nodeIconOpacityInactive:c=.85,nodeOpacityInactive:u=.25,nodeBadgePalette:h=vtt,nodePaletteOptions:f=ytt,edgeColor:d,edgeColorDisabled:g,edgePaletteOptions:v=mtt,comboColor:p,comboColorDisabled:y,comboStroke:m,comboStrokeDisabled:w,edgeColorInactive:E}=n;return{background:t,node:{palette:f,style:{donutOpacity:1,badgeBackgroundOpacity:1,badgeFill:"#fff",badgeFontSize:8,badgePadding:[0,4],badgePalette:h,fill:r,fillOpacity:1,halo:!1,iconFill:"#fff",iconOpacity:1,labelBackground:!1,labelBackgroundFill:t,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelFill:e,labelFillOpacity:.85,labelLineHeight:16,labelPadding:[0,2],labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelOffsetY:2,lineWidth:0,portFill:r,portLineWidth:1,portStroke:a,portStrokeOpacity:.65,size:32,stroke:a,strokeOpacity:1,zIndex:2},state:{selected:{halo:!0,haloLineWidth:24,haloStrokeOpacity:o,labelFontSize:12,labelFontWeight:"bold",lineWidth:4,stroke:a},active:{halo:!0,haloLineWidth:12,haloStrokeOpacity:s},highlight:{labelFontWeight:"bold",lineWidth:4,stroke:a,strokeOpacity:.85},inactive:{badgeBackgroundOpacity:u,donutOpacity:u,fillOpacity:u,iconOpacity:c,labelFill:e,labelFillOpacity:u,strokeOpacity:u},disabled:{badgeBackgroundOpacity:.25,donutOpacity:l,fill:i,fillOpacity:l,iconFill:i,iconOpacity:.25,labelFill:e,labelFillOpacity:.25,strokeOpacity:l}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"node-expand",collapse:"node-collapse",update:[{fields:["x","y","fill","stroke"]}],translate:[{fields:["x","y"]}]}},edge:{palette:v,style:{badgeBackgroundFill:d,badgeFill:"#fff",badgeFontSize:8,badgeOffsetX:10,fillOpacity:1,halo:!1,haloLineWidth:12,haloStrokeOpacity:1,increasedLineWidthForHitTesting:2,labelBackground:!1,labelBackgroundFill:t,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[4,4,4,4],labelFill:e,labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelPlacement:"center",labelTextBaseline:"middle",lineWidth:1,stroke:d,strokeOpacity:1,zIndex:1},state:{selected:{halo:!0,haloStrokeOpacity:.25,labelFontSize:14,labelFontWeight:"bold",lineWidth:3},active:{halo:!0,haloStrokeOpacity:.15},highlight:{labelFontWeight:"bold",lineWidth:3},inactive:{stroke:E,fillOpacity:.08,labelOpacity:.25,strokeOpacity:.08,badgeBackgroundOpacity:.25},disabled:{stroke:g,fillOpacity:.45,strokeOpacity:.45,labelOpacity:.25,badgeBackgroundOpacity:.45}},animation:{enter:"fade",exit:"fade",expand:"path-in",collapse:"path-out",show:"fade",hide:"fade",update:[{fields:["sourceNode","targetNode"]},{fields:["stroke"],shape:"key"}],translate:[{fields:["sourceNode","targetNode"]}]}},combo:{style:{collapsedMarkerFill:t,collapsedMarkerFontSize:12,collapsedMarkerFillOpacity:1,collapsedSize:32,collapsedFillOpacity:1,fill:p,halo:!1,haloLineWidth:12,haloStroke:m,haloStrokeOpacity:.25,labelBackground:!1,labelBackgroundFill:t,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[2,4,2,4],labelFill:e,labelFontSize:12,labelFontWeight:400,labelOpacity:1,lineDash:0,lineWidth:1,fillOpacity:.04,strokeOpacity:1,padding:10,stroke:m},state:{selected:{halo:!0,labelFontSize:14,labelFontWeight:700,lineWidth:4},active:{halo:!0},highlight:{labelFontWeight:700,lineWidth:4},inactive:{fillOpacity:.65,labelOpacity:.25,strokeOpacity:.65},disabled:{fill:y,fillOpacity:.25,labelOpacity:.25,stroke:w,strokeOpacity:.25}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"combo-expand",collapse:"combo-collapse",update:[{fields:["x","y"]},{fields:["fill","stroke","lineWidth"],shape:"key"}],translate:[{fields:["x","y"]}]}}}}const btt={type:"group",color:["#637088","#0F55A6","#008383","#9C5D38","#8B53A6","#4E40A6","#8F6608","#3E801D","#A65383","#175E75","#0F8248"]},wtt={bgColor:"#000000",comboColor:"#fdfdfd",comboColorDisabled:"#d0e4ff",comboStroke:"#99add1",comboStrokeDisabled:"#969696",edgeColor:"#637088",edgeColorDisabled:"#637088",edgeColorInactive:"#D0E4FF",edgePaletteOptions:btt,nodeColor:"#1783ff",nodeColorDisabled:"#D0E4FF",nodeHaloStrokeOpacityActive:.25,nodeHaloStrokeOpacitySelected:.45,nodeIconOpacityInactive:.45,nodeOpacityDisabled:.25,nodeOpacityInactive:.45,nodeStroke:"#d0e4ff",textColor:"#ffffff"},xtt=_I(wtt),Ett={bgColor:"#ffffff",comboColor:"#99ADD1",comboColorDisabled:"#f0f0f0",comboStroke:"#99add1",comboStrokeDisabled:"#d9d9d9",edgeColor:"#99add1",edgeColorDisabled:"#d9d9d9",edgeColorInactive:"#1B324F",nodeColor:"#1783ff",nodeColorDisabled:"#1B324F",nodeHaloStrokeOpacityActive:.15,nodeHaloStrokeOpacitySelected:.25,nodeIconOpacityInactive:.85,nodeOpacityDisabled:.06,nodeOpacityInactive:.25,nodeStroke:"#000000",textColor:"#000000"},Stt=_I(Ett);class ss extends Nw{beforeDraw(t,e){return t}afterLayout(t,e){}}class _tt extends ss{beforeDraw(t){const{model:e}=this.context,r=t.add.combos,i=a=>{const s=[];return a.forEach((o,l)=>{const u=e.getAncestorsData(l,"combo").map(h=>tt(h)).reverse();s.push([l,o,u.length])}),new Map(s.sort(([,,o],[,,l])=>l-o).map(([o,l])=>[o,l]))};return t.add.combos=i(r),t.update.combos=i(t.update.combos),t}}function zr(n,t,e,r,i){const a=tt(r),s=`${e}s`,o=i?r:n.add[s].get(a)||n.update[s].get(a)||n.remove[s].get(a)||r;Object.entries(n).forEach(([l,c])=>{t===l?c[s].set(a,o):c[s].delete(a)})}function Zu(n,t){return Object.keys(n).every(e=>n[e]===t[e])}class Mtt extends ss{beforeDraw(t,e){if(e.stage==="visibility"||!this.context.model.model.hasTreeStructure(Oe))return t;const{model:r}=this.context,{add:i,update:a}=t,s=[...t.update.combos.entries(),...t.add.combos.entries()];for(;s.length;){const[o,l]=s.pop();if(xr(l)){const c=r.getDescendantsData(o),u=c.map(tt),{internal:h,external:f}=bb(u,d=>r.getRelatedEdgesData(d));c.forEach(d=>{const g=tt(d),v=s.findIndex(([y])=>y===g);v!==-1&&s.splice(v,1);const p=r.getElementType(g);zr(t,"remove",p,d)}),h.forEach(d=>zr(t,"remove","edge",d)),f.forEach(d=>{var g;const v=tt(d);((g=this.context.element)===null||g===void 0?void 0:g.getElement(v))?a.edges.set(v,d):i.edges.set(v,d)})}else{const c=r.getChildrenData(o),u=c.map(tt),{edges:h}=bb(u,f=>r.getRelatedEdgesData(f));[...c,...h].forEach(f=>{var d;const g=tt(f),v=r.getElementType(g);((d=this.context.element)===null||d===void 0?void 0:d.getElement(g))?zr(t,"update",v,f):zr(t,"add",v,f),v==="combo"&&s.push([g,f])})}}return t}}const iC=(n,t,e,r)=>{const i=`${e}s`,a=tt(r);!n.add[i].has(a)&&!n.update[i].has(a)&&n[t][i].set(tt(r),r)};class Ott extends ss{getElement(t){return this.context.element.getElement(t)}handleExpand(t,e){if(iC(e,"add","node",t),xr(t))return;const r=tt(t);iC(e,"add","node",t),this.context.model.getRelatedEdgesData(r,"out").forEach(s=>{zr(e,"add","edge",s)}),this.context.model.getChildrenData(r).forEach(s=>{this.handleExpand(s,e)})}beforeDraw(t){const{graph:e,model:r}=this.context;if(!r.model.hasTreeStructure(Ir))return t;const{add:{nodes:i,edges:a},update:{nodes:s}}=t,o=new Map,l=new Map;i.forEach((u,h)=>{xr(u)&&o.set(h,u)}),a.forEach(u=>{if(e.getElementType(u.source)!=="node")return;const h=e.getNodeData(u.source);xr(h)&&o.set(u.source,h)}),s.forEach((u,h)=>{const f=this.getElement(h);if(!f)return;const d=f.attributes.collapsed;xr(u)?d||o.set(h,u):d&&l.set(h,u)});const c=new Set;return o.forEach((u,h)=>{r.getDescendantsData(h).forEach(d=>{const g=tt(d);if(c.has(g))return;zr(t,"remove","node",d),r.getRelatedEdgesData(g).forEach(p=>{zr(t,"remove","edge",p)}),c.add(g)})}),l.forEach((u,h)=>{if(r.getAncestorsData(h,Ir).some(xr)){zr(t,"remove","node",u);return}this.handleExpand(u,t)}),t}}function Ju(n,t,e,r=!1){const i=hb[n][t];!r&&i?i!==e&&ji.warn(`The extension ${t} of ${n} has been registered before.`):Object.assign(hb[n],{[t]:e})}/*!
 * @antv/g-plugin-dragndrop
 * @description A G plugin for Drag n Drop implemented with PointerEvents
 * @version 2.0.32
 * @date 1/23/2025, 8:33:12 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var MI=function(){function n(t){yt(this,n),this.dragndropPluginOptions=t}return mt(n,[{key:"apply",value:function(e){var r=this,i=e.renderingService,a=e.renderingContext,s=a.root.ownerDocument,o=s.defaultView,l=function(u){var h=u.target,f=h===s,d=f&&r.dragndropPluginOptions.isDocumentDraggable?s:h.closest&&h.closest("[draggable=true]");if(d){var g=!1,v=u.timeStamp,p=[u.clientX,u.clientY],y=null,m=[u.clientX,u.clientY],w=function(){var S=Ha(qn().mark(function O(k){var T,C,P,N,L,D;return qn().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(g){H.next=8;break}if(T=k.timeStamp-v,C=mr([k.clientX,k.clientY],p),!(T<=r.dragndropPluginOptions.dragstartTimeThreshold||C<=r.dragndropPluginOptions.dragstartDistanceThreshold)){H.next=5;break}return H.abrupt("return");case 5:k.type="dragstart",d.dispatchEvent(k),g=!0;case 8:if(k.type="drag",k.dx=k.clientX-m[0],k.dy=k.clientY-m[1],d.dispatchEvent(k),m=[k.clientX,k.clientY],f){H.next=21;break}return P=r.dragndropPluginOptions.overlap==="pointer"?[k.canvasX,k.canvasY]:h.getBounds().center,H.next=17,s.elementsFromPoint(P[0],P[1]);case 17:N=H.sent,L=N[N.indexOf(h)+1],D=(L==null?void 0:L.closest("[droppable=true]"))||(r.dragndropPluginOptions.isDocumentDroppable?s:null),y!==D&&(y&&(k.type="dragleave",k.target=y,y.dispatchEvent(k)),D&&(k.type="dragenter",k.target=D,D.dispatchEvent(k)),y=D,y&&(k.type="dragover",k.target=y,y.dispatchEvent(k)));case 21:case"end":return H.stop()}},O)}));return function(k){return S.apply(this,arguments)}}();o.addEventListener("pointermove",w);var E=function(O){if(g){O.detail={preventClick:!0};var k=O.clone();y&&(k.type="drop",k.target=y,y.dispatchEvent(k)),k.type="dragend",d.dispatchEvent(k),g=!1}o.removeEventListener("pointermove",w)};h.addEventListener("pointerup",E,{once:!0}),h.addEventListener("pointerupoutside",E,{once:!0})}};i.hooks.init.tap(n.tag,function(){o.addEventListener("pointerdown",l)}),i.hooks.destroy.tap(n.tag,function(){o.removeEventListener("pointerdown",l)})}}])}();MI.tag="Dragndrop";var Ttt=function(n){function t(){var e,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return yt(this,t),e=ae(this,t),e.name="dragndrop",e.options=r,e}return se(t,n),mt(t,[{key:"init",value:function(){this.addRenderingPlugin(new MI(ie({overlap:"pointer",isDocumentDraggable:!1,isDocumentDroppable:!1,dragstartDistanceThreshold:0,dragstartTimeThreshold:0},this.options)))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}},{key:"setOptions",value:function(r){Object.assign(this.plugins[0].dragndropPluginOptions,r)}}])}(Ja),aC=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(r.next(u))}catch(h){s(h)}}function l(u){try{c(r.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((r=r.apply(n,t||[])).next())})},sC=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};const oC=["main"],lC=["background","main","label","transient"];function ktt(n){return n.main}class cC{getConfig(){return this.config}getLayer(t="main"){return this.extends.layers[t]||ktt(this.getLayers())}getLayers(){return this.extends.layers}getRenderer(t){return this.extends.renderers[t]}getCamera(t="main"){return this.getLayer(t).getCamera()}getRoot(t="main"){return this.getLayer(t).getRoot()}getContextService(t="main"){return this.getLayer(t).getContextService()}setCursor(t){this.config.cursor=t,this.getLayer().setCursor(t)}get document(){return this.getLayer().document}get context(){return this.getLayer().context}constructor(t){this.config={enableMultiLayer:!0},Object.assign(this.config,t);const e=this.config,{renderer:r,background:i,cursor:a,enableMultiLayer:s}=e,o=sC(e,["renderer","background","cursor","enableMultiLayer"]),l=s?lC:oC,c=uC(r,l),u=Object.fromEntries(l.map(h=>{const f=new ub(Object.assign(Object.assign({},o),{supportsMutipleCanvasesInOneContainer:s,renderer:c[h],background:s?h==="background"?i:void 0:i}));return[h,f]}));hC(u),this.extends={config:this.config,renderer:r,renderers:c,layers:u}}get ready(){return Promise.all(Object.entries(this.getLayers()).map(([,t])=>t.ready))}resize(t,e){Object.assign(this.extends.config,{width:t,height:e}),Object.values(this.getLayers()).forEach(r=>{const i=r.getCamera(),a=i.getPosition(),s=i.getFocalPoint();r.resize(t,e),i.setPosition(a),i.setFocalPoint(s)})}getBounds(t){return vc(Object.values(this.getLayers()).map(e=>t?e.getRoot().childNodes.find(i=>i.classList.includes(t)):e.getRoot()).filter(e=>(e==null?void 0:e.childNodes.length)>0).map(e=>e.getBounds()))}getContainer(){const t=this.extends.config.container;return typeof t=="string"?document.getElementById(t):t}getSize(){return[this.extends.config.width||0,this.extends.config.height||0]}appendChild(t,e){var r;const i=((r=t.style)===null||r===void 0?void 0:r.$layer)||"main";return this.getLayer(i).appendChild(t,e)}setRenderer(t){if(t===this.extends.renderer)return;const e=uC(t,this.config.enableMultiLayer?lC:oC);this.extends.renderers=e,Object.entries(e).forEach(([r,i])=>this.getLayer(r).setRenderer(i)),hC(this.getLayers())}getCanvasByViewport(t){return jn(this.getLayer().viewport2Canvas(ci(t)))}getViewportByCanvas(t){return jn(this.getLayer().canvas2Viewport(ci(t)))}getViewportByClient(t){return jn(this.getLayer().client2Viewport(ci(t)))}getClientByViewport(t){return jn(this.getLayer().viewport2Client(ci(t)))}getClientByCanvas(t){return this.getClientByViewport(this.getViewportByCanvas(t))}getCanvasByClient(t){const e=this.getLayer(),r=e.client2Viewport(ci(t));return jn(e.viewport2Canvas(r))}toDataURL(){return aC(this,arguments,void 0,function*(t={}){const e=globalThis.devicePixelRatio||1,{mode:r="viewport"}=t,i=sC(t,["mode"]);let[a,s,o,l]=[0,0,0,0];if(r==="viewport")[o,l]=this.getSize();else if(r==="overall"){const y=this.getBounds(),m=ts(y);[a,s]=y.min,[o,l]=m}const c=Y1('<div id="virtual-image"></div>'),u=new ub({width:o,height:l,renderer:new Kl,devicePixelRatio:e,container:c,background:this.extends.config.background});yield u.ready,u.appendChild(this.getLayer("background").getRoot().cloneNode(!0)),u.appendChild(this.getRoot().cloneNode(!0));const h=this.getLayer("label").getRoot().cloneNode(!0),f=u.viewport2Canvas({x:0,y:0}),d=this.getCanvasByViewport([0,0]);h.translate([d[0]-f.x,d[1]-f.y]),h.scale(1/this.getCamera().getZoom()),u.appendChild(h),u.appendChild(this.getLayer("transient").getRoot().cloneNode(!0));const g=this.getCamera(),v=u.getCamera();if(r==="viewport")v.setZoom(g.getZoom()),v.setPosition(g.getPosition()),v.setFocalPoint(g.getFocalPoint());else if(r==="overall"){const[y,m,w]=v.getPosition(),[E,S,O]=v.getFocalPoint();v.setPosition([y+a,m+s,w]),v.setFocalPoint([E+a,S+s,O])}const p=u.getContextService();return new Promise(y=>{u.addEventListener(Lr.RERENDER,()=>aC(this,void 0,void 0,function*(){yield new Promise(w=>setTimeout(w,300));const m=yield p.toDataURL(i);y(m)}))})})}destroy(){Object.values(this.getLayers()).forEach(t=>{t.getCamera().cancelLandmarkAnimation(),t.destroy()})}}function uC(n,t){return Object.fromEntries(t.map(e=>{const r=(n==null?void 0:n(e))||new Kl;return r instanceof Kl&&r.setConfig({enableDirtyRectangleRendering:!1}),e==="main"?r.registerPlugin(new Ttt({isDocumentDraggable:!0,isDocumentDroppable:!0,dragstartDistanceThreshold:10,dragstartTimeThreshold:100})):r.unregisterPlugin(r.getPlugin("dom-interaction")),[e,r]}))}function hC(n){Object.entries(n).forEach(([t,e])=>{const r=e.getContextService().getDomElement();r!=null&&r.style&&(r.style.gridArea="1 / 1 / 2 / 2",r.style.outline="none",r.tabIndex=1,t!=="main"&&(r.style.pointerEvents="none")),r!=null&&r.parentElement&&(r.parentElement.style.display="grid")})}const io=n=>n?parseInt(n):0;function Att(n){const t=getComputedStyle(n),e=n.clientWidth||io(t.width),r=n.clientHeight||io(t.height),i=io(t.paddingLeft)+io(t.paddingRight),a=io(t.paddingTop)+io(t.paddingBottom);return[e-i,r-a]}function fC(n){if(!n)return[0,0];let t=640,e=480;const[r,i]=Att(n);t=r||t,e=i||e;const a=1,s=1;return[Math.max(Lt(t)?t:a,a),Math.max(Lt(e)?e:s,s)]}class Ed{constructor(t){this.type=t}}class vn extends Ed{constructor(t,e){super(t),this.data=e}}class Xr extends Ed{constructor(t,e,r,i){super(t),this.animationType=e,this.animation=r,this.data=i}}class ao extends Ed{constructor(t,e,r){super(t),this.elementType=e,this.data=r}}class Fu extends Ed{constructor(t,e){super(t),this.data=e}}function Mn(n,t){n.emit(t.type,t)}function Ctt(n){if(!n)return null;if(n instanceof FN)return{type:"canvas",element:n};let t=n;for(;t;){if(Ec(t))return{type:"node",element:t};if(WR(t))return{type:"edge",element:t};if($w(t))return{type:"combo",element:t};t=t.parentElement}return null}function dC(n){var t;return((t=n==null?void 0:n.style)===null||t===void 0?void 0:t.zIndex)||0}const Dl="cachedStyle",Px=n=>`__${n}__`;function Ptt(n,t){const e=Array.isArray(t)?t:[t];sr(n,Dl)||Wl(n,Dl,{}),e.forEach(r=>{Wl(sr(n,Dl),Px(r),n.attributes[r])})}function gC(n,t){return sr(n,[Dl,Px(t)])}function Ntt(n,t){return Px(t)in(sr(n,Dl)||{})}class Rtt{constructor(t){this.tasks=[],this.animations=new Set,this.context=t}getTasks(){const t=[...this.tasks];return this.tasks=[],t}add(t,e){this.tasks.push([t,e])}animate(t,e,r){var i,a,s;(i=e==null?void 0:e.before)===null||i===void 0||i.call(e);const o=this.getTasks().map(([c,u])=>{var h,f,d;const{element:g,elementType:v,stage:p}=c,y=q8(this.context.options,v,p,t);(h=u==null?void 0:u.before)===null||h===void 0||h.call(u);const m=y.length?G8(g,this.inferStyle(c,r),y):null;return m?((f=u==null?void 0:u.beforeAnimate)===null||f===void 0||f.call(u,m),m.finished.then(()=>{var w,E;(w=u==null?void 0:u.afterAnimate)===null||w===void 0||w.call(u,m),(E=u==null?void 0:u.after)===null||E===void 0||E.call(u),this.animations.delete(m)})):(d=u==null?void 0:u.after)===null||d===void 0||d.call(u),m}).filter(Boolean);o.forEach(c=>this.animations.add(c));const l=kw(o);return l?((a=e==null?void 0:e.beforeAnimate)===null||a===void 0||a.call(e,l),l.finished.then(()=>{var c,u;(c=e==null?void 0:e.afterAnimate)===null||c===void 0||c.call(e,l),(u=e==null?void 0:e.after)===null||u===void 0||u.call(e),this.release()})):(s=e==null?void 0:e.after)===null||s===void 0||s.call(e),l}inferStyle(t,e){var r,i;const{element:a,elementType:s,stage:o,originalStyle:l,updatedStyle:c={}}=t;t.modifiedStyle||(t.modifiedStyle=Object.assign(Object.assign({},l),c));const{modifiedStyle:u}=t,h={},f={};if(o==="enter")Object.assign(h,{opacity:0});else if(o==="exit")Object.assign(f,{opacity:0});else if(o==="show")Object.assign(h,{opacity:0}),Object.assign(f,{opacity:(r=gC(a,"opacity"))!==null&&r!==void 0?r:Yl("opacity")});else if(o==="hide")Object.assign(h,{opacity:(i=gC(a,"opacity"))!==null&&i!==void 0?i:Yl("opacity")}),Object.assign(f,{opacity:0});else if(o==="collapse"){const{collapse:d}=e||{},{target:g,descendants:v,position:p}=d;if(s==="node"){if(v.includes(a.id)){const[y,m,w]=p;Object.assign(f,{x:y,y:m,z:w})}}else if(s==="combo"){if(a.id===g||v.includes(a.id)){const[y,m]=p;Object.assign(f,{x:y,y:m,childrenNode:l.childrenNode})}}else s==="edge"&&Object.assign(f,{sourceNode:u.sourceNode,targetNode:u.targetNode})}else if(o==="expand"){const{expand:d}=e||{},{target:g,descendants:v,position:p}=d;if(s==="node"){if(a.id===g||v.includes(a.id)){const[y,m,w]=p;Object.assign(h,{x:y,y:m,z:w})}}else if(s==="combo"){if(a.id===g||v.includes(a.id)){const[y,m,w]=p;Object.assign(h,{x:y,y:m,z:w,childrenNode:u.childrenNode})}}else s==="edge"&&Object.assign(h,{sourceNode:u.sourceNode,targetNode:u.targetNode})}return[Object.keys(h).length>0?Object.assign({},l,h):l,Object.keys(f).length>0?Object.assign({},u,f):u]}stop(){this.animations.forEach(t=>t.cancel())}clear(){this.tasks=[]}release(){var t,e;const{canvas:r}=this.context,i=(e=(t=r.document)===null||t===void 0?void 0:t.timeline)===null||e===void 0?void 0:e.animationsWithPromises;i&&(r.document.timeline.animationsWithPromises=i.filter(a=>a.playState!=="finished"))}destroy(){this.stop(),this.animations.clear(),this.tasks=[]}}class Ltt{constructor(t){this.batchCount=0,this.context=t}emit(t){const{graph:e}=this.context;e.emit(t.type,t)}startBatch(t=!0){this.batchCount++,this.batchCount===1&&this.emit(new vn(Mt.BATCH_START,{initiate:t}))}endBatch(){this.batchCount--,this.batchCount===0&&this.emit(new vn(Mt.BATCH_END))}get isBatching(){return this.batchCount>0}destroy(){this.context=null}}class Itt extends Pw{constructor(t){super(t),this.currentTarget=null,this.currentTargetType=null,this.category="behavior",this.forwardCanvasEvents=e=>{const{target:r}=e,i=Ctt(r);if(!i)return;const{graph:a,canvas:s}=this.context,{type:o,element:l}=i;if("destroyed"in l&&(vf(l)||l.destroyed))return;const{type:c,detail:u,button:h}=e,f=Object.assign(Object.assign({},e),{target:l,targetType:o,originalTarget:r});c===st.POINTER_MOVE&&(this.currentTarget!==l&&(this.currentTarget&&a.emit(`${this.currentTargetType}:${st.POINTER_LEAVE}`,Object.assign(Object.assign({},f),{type:st.POINTER_LEAVE,target:this.currentTarget,targetType:this.currentTargetType})),l&&(Object.assign(f,{type:st.POINTER_ENTER}),a.emit(`${o}:${st.POINTER_ENTER}`,f))),this.currentTarget=l,this.currentTargetType=o),c===st.CLICK&&h===2||(a.emit(`${o}:${c}`,f),a.emit(c,f)),c===st.CLICK&&u===2&&(Object.assign(f,{type:st.DBLCLICK}),a.emit(`${o}:${st.DBLCLICK}`,f),a.emit(st.DBLCLICK,f)),c===st.POINTER_DOWN&&h===2&&(Object.assign(f,{type:st.CONTEXT_MENU,preventDefault:()=>{var d;(d=s.getContainer())===null||d===void 0||d.addEventListener(st.CONTEXT_MENU,g=>g.preventDefault(),{once:!0})}}),a.emit(`${o}:${st.CONTEXT_MENU}`,f),a.emit(st.CONTEXT_MENU,f))},this.forwardContainerEvents=e=>{this.context.graph.emit(e.type,e)},this.forwardEvents(),this.setBehaviors(this.context.options.behaviors||[])}setBehaviors(t){this.setExtensions(t)}forwardEvents(){const t=this.context.canvas.getContainer();t&&[fo.KEY_DOWN,fo.KEY_UP].forEach(r=>{t.addEventListener(r,this.forwardContainerEvents)});const e=this.context.canvas.document;e&&[st.CLICK,st.DBLCLICK,st.POINTER_OVER,st.POINTER_LEAVE,st.POINTER_ENTER,st.POINTER_MOVE,st.POINTER_OUT,st.POINTER_DOWN,st.POINTER_UP,st.CONTEXT_MENU,st.DRAG_START,st.DRAG,st.DRAG_END,st.DRAG_ENTER,st.DRAG_OVER,st.DRAG_LEAVE,st.DROP,st.WHEEL].forEach(r=>{e.addEventListener(r,this.forwardCanvasEvents)})}destroy(){const t=this.context.canvas.getContainer();t&&[fo.KEY_DOWN,fo.KEY_UP].forEach(e=>{t.removeEventListener(e,this.forwardContainerEvents)}),this.context.canvas.document.removeAllEventListeners(),super.destroy()}}var ac=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};function xa(n,t){const{data:e,style:r}=n,i=ac(n,["data","style"]),{data:a,style:s}=t,o=ac(t,["data","style"]),l=Object.assign(Object.assign({},i),o);return(e||a)&&Object.assign(l,{data:Object.assign(Object.assign({},e),a)}),(r||s)&&Object.assign(l,{style:Object.assign(Object.assign({},r),s)}),l}function E1(n){const{data:t,style:e}=n,i=ac(n,["data","style"]);return t&&(i.data=Object.assign({},t)),e&&(i.style=Object.assign({},e)),i}function so(n={},t={}){const{states:e=[],data:r={},style:i={},children:a=[]}=n,s=ac(n,["states","data","style","children"]),{states:o=[],data:l={},style:c={},children:u=[]}=t,h=ac(t,["states","data","style","children"]),f=(g,v)=>g.length!==v.length?!1:g.every((p,y)=>p===v[y]),d=(g,v)=>{const p=Object.keys(g),y=Object.keys(v);return p.length!==y.length?!1:p.every(m=>g[m]===v[m])};return!(!d(s,h)||!f(a,u)||!f(e,o)||!d(r,l)||!d(i,c))}var Dtt=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};function S1(n){const{id:t=tt(n),style:e,data:r}=n,i=Dtt(n,["id","style","data"]),a=Object.assign(Object.assign({},n),{style:Object.assign({},e),data:Object.assign({},r)});return X8(n)?Object.assign({id:t,data:a},i):{id:t,data:a}}function An(n){return n.data}function Ftt(n){if(n.hasTreeStructure(Ir))return;n.attachTreeStructure(Ir);const t=n.getAllEdges();for(const e of t){const{source:r,target:i}=e;n.setParent(i,r,Ir)}}class Btt{constructor(){this.latestRemovedComboIds=new Set,this.comboIds=new Set,this.changes=[],this.batchCount=0,this.isTraceless=!1,this.enableUpdateNodeLikeHierarchy=!0,this.model=new kn}pushChange(t){if(this.isTraceless)return;const{type:e}=t;if(e===We.NodeUpdated||e===We.EdgeUpdated||e===We.ComboUpdated){const{value:r,original:i}=t;this.changes.push({value:E1(r),original:E1(i),type:e})}else this.changes.push({value:E1(t.value),type:e})}getChanges(){return this.changes}clearChanges(){this.changes=[]}batch(t){this.batchCount++,this.model.batch(t),this.batchCount--}isBatching(){return this.batchCount>0}silence(t){this.isTraceless=!0,t(),this.isTraceless=!1}isCombo(t){return this.comboIds.has(t)||this.latestRemovedComboIds.has(t)}getData(){return{nodes:this.getNodeData(),edges:this.getEdgeData(),combos:this.getComboData()}}getNodeData(t){return this.model.getAllNodes().reduce((e,r)=>{const i=An(r);return this.isCombo(tt(i))||(t===void 0||t.includes(tt(i)))&&e.push(i),e},[])}getEdgeDatum(t){return An(this.model.getEdge(t))}getEdgeData(t){return this.model.getAllEdges().reduce((e,r)=>{const i=An(r);return(t===void 0||t.includes(tt(i)))&&e.push(i),e},[])}getComboData(t){return this.model.getAllNodes().reduce((e,r)=>{const i=An(r);return this.isCombo(tt(i))&&(t===void 0||t.includes(tt(i)))&&e.push(i),e},[])}getRootsData(t=Ir){return this.model.getRoots(t).map(An)}getAncestorsData(t,e){const{model:r}=this;return!r.hasNode(t)||!r.hasTreeStructure(e)?[]:r.getAncestors(t,e).map(An)}getDescendantsData(t){const e=this.getElementDataById(t),r=[];return As(e,i=>{i!==e&&r.push(i)},i=>this.getChildrenData(tt(i)),"TB"),r}getParentData(t,e){const{model:r}=this;if(!e){ji.warn("The hierarchy structure key is not specified");return}if(!r.hasNode(t)||!r.hasTreeStructure(e))return;const i=r.getParent(t,e);return i?An(i):void 0}getChildrenData(t){const e=this.getElementType(t)==="node"?Ir:Oe,{model:r}=this;return!r.hasNode(t)||!r.hasTreeStructure(e)?[]:r.getChildren(t,e).map(An)}getElementsDataByType(t){return t==="node"?this.getNodeData():t==="edge"?this.getEdgeData():t==="combo"?this.getComboData():[]}getElementDataById(t){return this.getElementType(t)==="edge"?this.getEdgeDatum(t):this.getNodeLikeDatum(t)}getNodeLikeDatum(t){const e=this.model.getNode(t);return An(e)}getNodeLikeData(t){return this.model.getAllNodes().reduce((e,r)=>{const i=An(r);return t?t.includes(tt(i))&&e.push(i):e.push(i),e},[])}getElementDataByState(t,e){return this.getElementsDataByType(t).filter(i=>{var a;return(a=i.states)===null||a===void 0?void 0:a.includes(e)})}getElementState(t){var e;return((e=this.getElementDataById(t))===null||e===void 0?void 0:e.states)||[]}hasNode(t){return this.model.hasNode(t)&&!this.isCombo(t)}hasEdge(t){return this.model.hasEdge(t)}hasCombo(t){return this.model.hasNode(t)&&this.isCombo(t)}getRelatedEdgesData(t,e="both"){return this.model.getRelatedEdges(t,e).map(An)}getNeighborNodesData(t){return this.model.getNeighbors(t).map(An)}setData(t){const{nodes:e=[],edges:r=[],combos:i=[]}=t,{nodes:a,edges:s,combos:o}=this.getData(),l=ja(a,e,h=>tt(h),so),c=ja(s,r,h=>tt(h),so),u=ja(o,i,h=>tt(h),so);this.batch(()=>{const h={nodes:l.enter,edges:c.enter,combos:u.enter};this.addData(h),this.computeZIndex(h,"add",!0);const f={nodes:l.update,edges:c.update,combos:u.update};this.updateData(f),this.computeZIndex(f,"update",!0);const d={nodes:l.exit.map(tt),edges:c.exit.map(tt),combos:u.exit.map(tt)};this.removeData(d)})}addData(t){const{nodes:e,edges:r,combos:i}=t;this.batch(()=>{this.addComboData(i),this.addNodeData(e),this.addEdgeData(r)}),this.computeZIndex(t,"add")}addNodeData(t=[]){t.length&&(this.model.addNodes(t.map(e=>(this.pushChange({value:e,type:We.NodeAdded}),S1(e)))),this.updateNodeLikeHierarchy(t),this.computeZIndex({nodes:t},"add"))}addEdgeData(t=[]){t.length&&(this.model.addEdges(t.map(e=>(this.pushChange({value:e,type:We.EdgeAdded}),S1(e)))),this.computeZIndex({edges:t},"add"))}addComboData(t=[]){if(!t.length)return;const{model:e}=this;e.hasTreeStructure(Oe)||e.attachTreeStructure(Oe),e.addNodes(t.map(r=>(this.comboIds.add(tt(r)),this.pushChange({value:r,type:We.ComboAdded}),S1(r)))),this.updateNodeLikeHierarchy(t),this.computeZIndex({combos:t},"add")}addChildrenData(t,e){const r=this.getNodeLikeDatum(t),i=e.map(tt);this.addNodeData(e),this.updateNodeData([{id:t,children:[...r.children||[],...i]}]),this.addEdgeData(i.map(a=>({source:t,target:a})))}computeZIndex(t,e,r=!1){!r&&this.isBatching()||this.batch(()=>{const{nodes:i=[],edges:a=[],combos:s=[]}=t;s.forEach(o=>{var l,c,u;const h=tt(o);if(e==="add"&&Lt((l=o.style)===null||l===void 0?void 0:l.zIndex)||e==="update"&&!("combo"in o))return;const f=this.getParentData(h,Oe),d=f?((u=(c=f.style)===null||c===void 0?void 0:c.zIndex)!==null&&u!==void 0?u:0)+1:0;this.preventUpdateNodeLikeHierarchy(()=>{this.updateComboData([{id:h,style:{zIndex:d}}])})}),i.forEach(o=>{var l,c,u;const h=tt(o);if(e==="add"&&Lt((l=o.style)===null||l===void 0?void 0:l.zIndex)||e==="update"&&!("combo"in o)&&!("children"in o))return;let f=0;const d=this.getParentData(h,Oe);if(d)f=(((c=d.style)===null||c===void 0?void 0:c.zIndex)||0)+1;else{const g=this.getParentData(h,Ir);g&&(f=((u=g==null?void 0:g.style)===null||u===void 0?void 0:u.zIndex)||0)}this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:h,style:{zIndex:f}}])})}),a.forEach(o=>{var l,c,u,h,f;if(Lt((l=o.style)===null||l===void 0?void 0:l.zIndex))return;let{id:d,source:g,target:v}=o;if(!d)d=tt(o);else{const m=this.getEdgeDatum(d);g=m.source,v=m.target}if(!g||!v)return;const p=((u=(c=this.getNodeLikeDatum(g))===null||c===void 0?void 0:c.style)===null||u===void 0?void 0:u.zIndex)||0,y=((f=(h=this.getNodeLikeDatum(v))===null||h===void 0?void 0:h.style)===null||f===void 0?void 0:f.zIndex)||0;this.updateEdgeData([{id:tt(o),style:{zIndex:Math.max(p,y)-1}}])})})}getFrontZIndex(t){var e;const r=this.getElementType(t),i=this.getElementDataById(t),a=this.getData();if(Object.assign(a,{[`${r}s`]:a[`${r}s`].filter(s=>tt(s)!==t)}),r==="combo"&&!xr(i)){const s=new Set(this.getAncestorsData(t,Oe).map(tt));a.nodes=a.nodes.filter(o=>!s.has(tt(o))),a.combos=a.combos.filter(o=>!s.has(tt(o))),a.edges=a.edges.filter(({source:o,target:l})=>!s.has(o)&&!s.has(l))}return Math.max(((e=i.style)===null||e===void 0?void 0:e.zIndex)||0,0,...Object.values(a).flat().map(s=>{var o;return(((o=s==null?void 0:s.style)===null||o===void 0?void 0:o.zIndex)||0)+1}))}updateNodeLikeHierarchy(t){if(!this.enableUpdateNodeLikeHierarchy)return;const{model:e}=this;t.forEach(r=>{const i=tt(r),a=pu(r);a!==void 0&&(e.hasTreeStructure(Oe)||e.attachTreeStructure(Oe),a===null&&this.refreshComboData(i),this.setParent(i,pu(r),Oe));const s=r.children||[];if(s.length){e.hasTreeStructure(Ir)||e.attachTreeStructure(Ir);const o=s.filter(l=>e.hasNode(l));o.forEach(l=>this.setParent(l,i,Ir)),o.length!==s.length&&this.updateNodeData([{id:i,children:o}])}})}preventUpdateNodeLikeHierarchy(t){this.enableUpdateNodeLikeHierarchy=!1,t(),this.enableUpdateNodeLikeHierarchy=!0}updateData(t){const{nodes:e,edges:r,combos:i}=t;this.batch(()=>{this.updateNodeData(e),this.updateComboData(i),this.updateEdgeData(r)}),this.computeZIndex(t,"update")}updateNodeData(t=[]){if(!t.length)return;const{model:e}=this;this.batch(()=>{const r=[];t.forEach(i=>{const a=tt(i),s=An(e.getNode(a));if(so(s,i))return;const o=xa(s,i);this.pushChange({value:o,original:s,type:We.NodeUpdated}),e.mergeNodeData(a,o),r.push(o)}),this.updateNodeLikeHierarchy(r)}),this.computeZIndex({nodes:t},"update")}refreshData(){const{nodes:t,edges:e,combos:r}=this.getData();t.forEach(i=>{this.pushChange({value:i,original:i,type:We.NodeUpdated})}),e.forEach(i=>{this.pushChange({value:i,original:i,type:We.EdgeUpdated})}),r.forEach(i=>{this.pushChange({value:i,original:i,type:We.ComboUpdated})})}syncNodeLikeDatum(t){const{model:e}=this,r=tt(t);if(!e.hasNode(r))return;const i=An(e.getNode(r)),a=xa(i,t);e.mergeNodeData(r,a)}syncEdgeDatum(t){const{model:e}=this,r=tt(t);if(!e.hasEdge(r))return;const i=An(e.getEdge(r)),a=xa(i,t);e.mergeEdgeData(r,a)}updateEdgeData(t=[]){if(!t.length)return;const{model:e}=this;this.batch(()=>{t.forEach(r=>{const i=tt(r),a=An(e.getEdge(i));if(so(a,r))return;r.source&&a.source!==r.source&&e.updateEdgeSource(i,r.source),r.target&&a.target!==r.target&&e.updateEdgeTarget(i,r.target);const s=xa(a,r);this.pushChange({value:s,original:a,type:We.EdgeUpdated}),e.mergeEdgeData(i,s)})}),this.computeZIndex({edges:t},"update")}updateComboData(t=[]){if(!t.length)return;const{model:e}=this;e.batch(()=>{const r=[];t.forEach(i=>{const a=tt(i),s=An(e.getNode(a));if(so(s,i))return;const o=xa(s,i);this.pushChange({value:o,original:s,type:We.ComboUpdated}),e.mergeNodeData(a,o),r.push(o)}),this.updateNodeLikeHierarchy(r)}),this.computeZIndex({combos:t},"update")}setParent(t,e,r,i=!0){if(t===e)return;const a=this.getNodeLikeDatum(t),s=pu(a);if(s!==e&&r===Oe){const o={id:t,combo:e};this.isCombo(t)?this.syncNodeLikeDatum(o):this.syncNodeLikeDatum(o)}this.model.setParent(t,e,r),i&&r===Oe&&uB([s,e]).forEach(o=>{o!==void 0&&this.refreshComboData(o)})}refreshComboData(t){const e=this.getComboData([t])[0],r=this.getAncestorsData(t,Oe);e&&this.pushChange({value:e,original:e,type:We.ComboUpdated}),r.forEach(i=>{this.pushChange({value:i,original:i,type:We.ComboUpdated})})}getElementPosition(t){const e=this.getElementDataById(t);return fn(e)}translateNodeLikeBy(t,e){this.isCombo(t)?this.translateComboBy(t,e):this.translateNodeBy(t,e)}translateNodeLikeTo(t,e){this.isCombo(t)?this.translateComboTo(t,e):this.translateNodeTo(t,e)}translateNodeBy(t,e){const r=this.getElementPosition(t),i=re(r,[...e,0].slice(0,3));this.translateNodeTo(t,i)}translateNodeTo(t,e){const[r=0,i=0,a=0]=e;this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:t,style:{x:r,y:i,z:a}}])})}translateComboBy(t,e){const[r=0,i=0,a=0]=e;if([r,i,a].some(isNaN)||[r,i,a].every(l=>l===0))return;const s=this.getComboData([t])[0];if(!s)return;const o=new Set;As(s,l=>{const c=tt(l);if(o.has(c))return;o.add(c);const[u,h,f]=fn(l),d=xa(l,{style:{x:u+r,y:h+i,z:f+a}});this.pushChange({value:d,original:l,type:this.isCombo(c)?We.ComboUpdated:We.NodeUpdated}),this.model.mergeNodeData(c,d)},l=>this.getChildrenData(tt(l)),"BT")}translateComboTo(t,e){var r;if(e.some(isNaN))return;const[i=0,a=0,s=0]=e,o=(r=this.getComboData([t]))===null||r===void 0?void 0:r[0];if(!o)return;const[l,c,u]=fn(o),h=i-l,f=a-c,d=s-u;As(o,g=>{const v=tt(g),[p,y,m]=fn(g),w=xa(g,{style:{x:p+h,y:y+f,z:m+d}});this.pushChange({value:w,original:g,type:this.isCombo(v)?We.ComboUpdated:We.NodeUpdated}),this.model.mergeNodeData(v,w)},g=>this.getChildrenData(tt(g)),"BT")}removeData(t){const{nodes:e,edges:r,combos:i}=t;this.batch(()=>{this.removeEdgeData(r),this.removeNodeData(e),this.removeComboData(i),this.latestRemovedComboIds=new Set(i)})}removeNodeData(t=[]){t.length&&this.batch(()=>{t.forEach(e=>{this.removeEdgeData(this.getRelatedEdgesData(e).map(tt)),this.pushChange({value:this.getNodeData([e])[0],type:We.NodeRemoved}),this.removeNodeLikeHierarchy(e)}),this.model.removeNodes(t)})}removeEdgeData(t=[]){t.length&&(t.forEach(e=>this.pushChange({value:this.getEdgeData([e])[0],type:We.EdgeRemoved})),this.model.removeEdges(t))}removeComboData(t=[]){t.length&&this.batch(()=>{t.forEach(e=>{this.pushChange({value:this.getComboData([e])[0],type:We.ComboRemoved}),this.removeNodeLikeHierarchy(e),this.comboIds.delete(e)}),this.model.removeNodes(t)})}removeNodeLikeHierarchy(t){if(this.model.hasTreeStructure(Oe)){const e=pu(this.getNodeLikeDatum(t));this.setParent(t,void 0,Oe,!1),this.model.getChildren(t,Oe).forEach(r=>{const i=An(r),a=tt(i);this.setParent(tt(i),e,Oe,!1);const s=xa(i,{id:tt(i),combo:e});this.pushChange({value:s,original:i,type:this.isCombo(a)?We.ComboUpdated:We.NodeUpdated}),this.model.mergeNodeData(tt(i),s)}),Ut(e)||this.refreshComboData(e)}}getElementType(t){if(this.model.hasNode(t))return this.isCombo(t)?"combo":"node";if(this.model.hasEdge(t))return"edge";throw new Error(ia(`Unknown element type of id: ${t}`))}destroy(){const{model:t}=this,e=t.getAllNodes(),r=t.getAllEdges();t.removeEdges(r.map(i=>i.id)),t.removeNodes(e.map(i=>i.id)),this.context={}}}var ol=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(r.next(u))}catch(h){s(h)}}function l(u){try{c(r.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((r=r.apply(n,t||[])).next())})};class ztt{constructor(t){this.elementMap={},this.shapeTypeMap={},this.paletteStyle={},this.defaultStyle={},this.stateStyle={},this.visibilityCache=new WeakMap,this.context=t}init(){this.initContainer()}initContainer(){if(!this.container||this.container.destroyed){const{canvas:t}=this.context;this.container=t.appendChild(new Tn({className:"elements"}))}}emit(t,e){e.silence||Mn(this.context.graph,t)}forEachElementData(t){Bs.forEach(e=>{const r=this.context.model.getElementsDataByType(e);t(e,r)})}getElementType(t,e){var r;const{options:i,graph:a}=this.context,s=((r=i[t])===null||r===void 0?void 0:r.type)||e.type;return s?typeof s=="string"?s:s.call(a,e):t==="edge"?"line":"circle"}getTheme(t){return XN(this.context.options)[t]||{}}getThemeStyle(t){return this.getTheme(t).style||{}}getThemeStateStyle(t,e){const{state:r={}}=this.getTheme(t);return Object.assign({},...e.map(i=>r[i]||{}))}computePaletteStyle(){const{options:t}=this.context;this.paletteStyle={},this.forEachElementData((e,r)=>{var i,a;const s=Object.assign({},y2((i=this.getTheme(e))===null||i===void 0?void 0:i.palette),y2((a=t[e])===null||a===void 0?void 0:a.palette));s!=null&&s.field&&Object.assign(this.paletteStyle,W9(r,s))})}getPaletteStyle(t,e){const r=this.paletteStyle[e];return r?t==="edge"?{stroke:r}:{fill:r}:{}}computeElementDefaultStyle(t,e){var r;const{options:i}=this.context,a=((r=i[t])===null||r===void 0?void 0:r.style)||{};"transform"in a&&Array.isArray(a.transform)&&(a.transform=[...a.transform]),this.defaultStyle[tt(e.datum)]=v2(a,e)}computeElementsDefaultStyle(t){const{graph:e}=this.context;this.forEachElementData((r,i)=>{const a=i.length;for(let s=0;s<a;s++){const o=i[s];(t===void 0||t.includes(tt(o)))&&this.computeElementDefaultStyle(r,{datum:o,graph:e})}})}getDefaultStyle(t){return this.defaultStyle[t]||{}}getElementState(t){try{const{model:e}=this.context;return e.getElementState(t)}catch{return[]}}getElementStateStyle(t,e,r){var i,a;const{options:s}=this.context,o=((a=(i=s[t])===null||i===void 0?void 0:i.state)===null||a===void 0?void 0:a[e])||{};return v2(o,r)}computeElementStatesStyle(t,e,r){this.stateStyle[tt(r.datum)]=Object.assign({},...e.map(i=>this.getElementStateStyle(t,i,r)))}computeElementsStatesStyle(t){const{graph:e}=this.context;this.forEachElementData((r,i)=>{const a=i.length;for(let s=0;s<a;s++){const o=i[s];if(t===void 0||t.includes(tt(o))){const l=this.getElementState(tt(o));this.computeElementStatesStyle(r,l,{datum:o,graph:e})}}})}getStateStyle(t){return this.stateStyle[t]||{}}computeStyle(t,e){t&&["translate","zIndex"].includes(t)||(this.computePaletteStyle(),this.computeElementsDefaultStyle(e),this.computeElementsStatesStyle(e))}getElement(t){return this.elementMap[t]}getNodes(){return this.context.model.getNodeData().map(({id:t})=>this.elementMap[t])}getEdges(){return this.context.model.getEdgeData().map(t=>this.elementMap[tt(t)])}getCombos(){return this.context.model.getComboData().map(({id:t})=>this.elementMap[t])}getElementComputedStyle(t,e){const r=tt(e),i=this.getThemeStyle(t),a=this.getPaletteStyle(t,r),s=e.style||{},o=this.getDefaultStyle(r),l=this.getThemeStateStyle(t,this.getElementState(r)),c=this.getStateStyle(r),u=Object.assign({},i,a,s,o,l,c);if(t==="combo"){const h=this.context.model.getChildrenData(r),d=!!u.collapsed?[]:h.map(tt).filter(g=>this.getElement(g));Object.assign(u,{childrenNode:d,childrenData:h})}return u}getDrawData(t){this.init();const e=this.computeChangesAndDrawData(t);if(!e)return null;const{type:r="draw",stage:i=r}=t;return this.markDestroyElement(e.drawData),this.computeStyle(i),{type:r,stage:i,data:e}}draw(t={animation:!0}){const e=this.getDrawData(t);if(!e)return;const{data:{drawData:{add:r,update:i,remove:a}}}=e;return this.destroyElements(a,t),this.createElements(r,t),this.updateElements(i,t),this.setAnimationTask(t,e)}preLayoutDraw(){return ol(this,arguments,void 0,function*(t={animation:!0}){var e,r;const i=this.getDrawData(t);if(!i)return;const{data:{drawData:a}}=i;yield(r=(e=this.context.layout)===null||e===void 0?void 0:e.preLayout)===null||r===void 0?void 0:r.call(e,a);const{add:s,update:o,remove:l}=a;return this.destroyElements(l,t),this.createElements(s,t),this.updateElements(o,t),this.setAnimationTask(t,i)})}setAnimationTask(t,e){const{animation:r,silence:i}=t,{data:{dataChanges:a,drawData:s},stage:o,type:l}=e;return this.context.animation.animate(r,i?{}:{before:()=>this.emit(new vn(Mt.BEFORE_DRAW,{dataChanges:a,animation:r,stage:o,render:l==="render"}),t),beforeAnimate:c=>this.emit(new Xr(Mt.BEFORE_ANIMATE,yr.DRAW,c,s),t),afterAnimate:c=>this.emit(new Xr(Mt.AFTER_ANIMATE,yr.DRAW,c,s),t),after:()=>this.emit(new vn(Mt.AFTER_DRAW,{dataChanges:a,animation:r,stage:o,render:l==="render",firstRender:this.context.graph.rendered===!1}),t)})}computeChangesAndDrawData(t){const{model:e}=this.context,r=e.getChanges(),i=yx(r);if(i.length===0)return null;const{NodeAdded:a=[],NodeUpdated:s=[],NodeRemoved:o=[],EdgeAdded:l=[],EdgeUpdated:c=[],EdgeRemoved:u=[],ComboAdded:h=[],ComboUpdated:f=[],ComboRemoved:d=[]}=Kh(i,y=>y.type),g=y=>new Map(y.map(m=>{const w=m.value;return[tt(w),w]})),v={add:{nodes:g(a),edges:g(l),combos:g(h)},update:{nodes:g(s),edges:g(c),combos:g(f)},remove:{nodes:g(o),edges:g(u),combos:g(d)}},p=this.transformData(v,t);return e.clearChanges(),{dataChanges:r,drawData:p}}transformData(t,e){const r=this.context.transform.getTransformInstance();return Object.values(r).reduce((i,a)=>a.beforeDraw(i,e),t)}createElement(t,e,r){var i;const a=tt(e);if(this.getElement(a))return;const o=this.getElementType(t,e),l=this.getElementComputedStyle(t,e),c=la(t,o);if(!c)return ji.warn(`The element ${o} of ${t} is not registered.`);this.emit(new ao(Mt.BEFORE_ELEMENT_CREATE,t,e),r);const u=this.container.appendChild(new c({id:a,context:this.context,style:l}));this.shapeTypeMap[a]=o,this.elementMap[a]=u;const{stage:h="enter"}=r;(i=this.context.animation)===null||i===void 0||i.add({element:u,elementType:t,stage:h,originalStyle:Object.assign({},u.attributes),updatedStyle:l},{after:()=>{var f;this.emit(new ao(Mt.AFTER_ELEMENT_CREATE,t,e),r),(f=u.onCreate)===null||f===void 0||f.call(u)}})}createElements(t,e){const{nodes:r,edges:i,combos:a}=t;[["node",r],["combo",a],["edge",i]].forEach(([o,l])=>{l.forEach(c=>this.createElement(o,c,e))})}getUpdateStageStyle(t,e,r){const{stage:i="update"}=r;if(i==="translate")if(t==="node"||t==="combo"){const{style:{x:a=0,y:s=0,z:o=0}={}}=e;return{x:a,y:s,z:o}}else return{};return this.getElementComputedStyle(t,e)}updateElement(t,e,r){var i;const a=tt(e),{stage:s="update"}=r,o=this.getElement(a);if(!o)return()=>null;this.emit(new ao(Mt.BEFORE_ELEMENT_UPDATE,t,e),r);const l=this.getElementType(t,e),c=this.getUpdateStageStyle(t,e,r);this.shapeTypeMap[a]!==l&&(o.destroy(),delete this.shapeTypeMap[a],delete this.elementMap[a],this.createElement(t,e,{animation:!1,silence:!0}));const u=s!=="visibility"?s:c.visibility==="hidden"?"hide":"show";u==="hide"&&delete c.visibility,(i=this.context.animation)===null||i===void 0||i.add({element:o,elementType:t,stage:u,originalStyle:Object.assign({},o.attributes),updatedStyle:c},{before:()=>{const h=this.elementMap[a];s!=="collapse"&&xb(h,c),s==="visibility"&&(Ntt(h,"opacity")||Ptt(h,"opacity"),this.visibilityCache.set(h,u==="show"?"visible":"hidden"),u==="show"&&Ds(h,"visible"))},after:()=>{var h;const f=this.elementMap[a];s==="collapse"&&xb(f,c),u==="hide"&&Ds(f,this.visibilityCache.get(f)),this.emit(new ao(Mt.AFTER_ELEMENT_UPDATE,t,e),r),(h=f.onUpdate)===null||h===void 0||h.call(f)}})}updateElements(t,e){const{nodes:r,edges:i,combos:a}=t;[["node",r],["combo",a],["edge",i]].forEach(([o,l])=>{l.forEach(c=>this.updateElement(o,c,e))})}markDestroyElement(t){Object.values(t.remove).forEach(e=>{e.forEach(r=>{const i=tt(r),a=this.getElement(i);a&&$$(a)})})}destroyElement(t,e,r){var i;const{stage:a="exit"}=r,s=tt(e),o=this.elementMap[s];if(!o)return()=>null;this.emit(new ao(Mt.BEFORE_ELEMENT_DESTROY,t,e),r),(i=this.context.animation)===null||i===void 0||i.add({element:o,elementType:t,stage:a,originalStyle:Object.assign({},o.attributes),updatedStyle:{}},{after:()=>{var l;this.clearElement(s),o.destroy(),(l=o.onDestroy)===null||l===void 0||l.call(o),this.emit(new ao(Mt.AFTER_ELEMENT_DESTROY,t,e),r)}})}destroyElements(t,e){const{nodes:r,edges:i,combos:a}=t;[["combo",a],["edge",i],["node",r]].forEach(([o,l])=>{l.forEach(c=>this.destroyElement(o,c,e))})}clearElement(t){delete this.paletteStyle[t],delete this.defaultStyle[t],delete this.stateStyle[t],delete this.elementMap[t],delete this.shapeTypeMap[t]}alignLayoutResultToElement(t,e){var r,i;const a=(r=t.nodes)===null||r===void 0?void 0:r.find(s=>tt(s)===e);if(a){const s=fn(this.context.model.getNodeLikeDatum(e)),o=fn(a),l=Me(s,o);(i=t.nodes)===null||i===void 0||i.forEach(c=>{var u,h,f;!((u=c.style)===null||u===void 0)&&u.x&&(c.style.x+=l[0]),!((h=c.style)===null||h===void 0)&&h.y&&(c.style.y+=l[1]),!((f=c.style)===null||f===void 0)&&f.z&&(c.style.z+=l[2]||0)})}}collapseNode(t,e){return ol(this,void 0,void 0,function*(){var r;const{animation:i,align:a}=e,{model:s,layout:o}=this.context,l=this.computeChangesAndDrawData({stage:"collapse",animation:i});if(!l)return;this.markDestroyElement(l.drawData);const c=yield o.simulate();a&&this.alignLayoutResultToElement(c,t),s.updateData(c);const u=this.computeChangesAndDrawData({stage:"collapse",animation:i});if(!u)return;const{drawData:h}=u,{add:f,remove:d,update:g}=h;this.markDestroyElement(h);const v={animation:i,stage:"collapse",data:h};this.destroyElements(d,v),this.createElements(f,v),this.updateElements(g,v),yield(r=this.context.animation.animate(i,{beforeAnimate:p=>this.emit(new Xr(Mt.BEFORE_ANIMATE,yr.COLLAPSE,p,h),v),afterAnimate:p=>this.emit(new Xr(Mt.AFTER_ANIMATE,yr.COLLAPSE,p,h),v)},{collapse:{target:t,descendants:Array.from(d.nodes).map(([,p])=>tt(p)),position:fn(g.nodes.get(t))}}))===null||r===void 0?void 0:r.finished})}expandNode(t,e){return ol(this,void 0,void 0,function*(){var r;const{model:i,layout:a}=this.context,{animation:s,align:o}=e,l=fn(i.getNodeData([t])[0]),c=this.computeChangesAndDrawData({stage:"expand",animation:s});if(!c)return;const{drawData:{add:u}}=c;this.createElements(u,{animation:!1,stage:"expand",target:t}),this.context.animation.clear();const h=yield a.simulate();o&&this.alignLayoutResultToElement(h,t),i.updateData(h),this.computeStyle("expand");const f=this.computeChangesAndDrawData({stage:"collapse",animation:s});if(!f)return;const{drawData:d}=f,{update:g}=d,v={animation:s,stage:"expand",data:d};u.edges.forEach(p=>g.edges.set(tt(p),p)),u.nodes.forEach(p=>g.nodes.set(tt(p),p)),this.updateElements(g,v),yield(r=this.context.animation.animate(s,{beforeAnimate:p=>this.emit(new Xr(Mt.BEFORE_ANIMATE,yr.EXPAND,p,d),v),afterAnimate:p=>this.emit(new Xr(Mt.AFTER_ANIMATE,yr.EXPAND,p,d),v)},{expand:{target:t,descendants:Array.from(u.nodes).map(([,p])=>tt(p)),position:l}}))===null||r===void 0?void 0:r.finished})}collapseCombo(t,e){return ol(this,void 0,void 0,function*(){var r;const{model:i,element:a}=this.context;if(i.getAncestorsData(t,Oe).some(v=>xr(v)))return;const s=a.getElement(t),o=s.getComboPosition(Object.assign(Object.assign({},s.attributes),{collapsed:!0})),l=this.computeChangesAndDrawData({stage:"collapse",animation:e});if(!l)return;const{dataChanges:c,drawData:u}=l;this.markDestroyElement(u);const{update:h,remove:f}=u,d={animation:e,stage:"collapse",data:u};this.destroyElements(f,d),this.updateElements(h,d);const g=v=>Array.from(v).map(([,p])=>tt(p));yield(r=this.context.animation.animate(e,{before:()=>this.emit(new vn(Mt.BEFORE_DRAW,{dataChanges:c,animation:e}),d),beforeAnimate:v=>this.emit(new Xr(Mt.BEFORE_ANIMATE,yr.COLLAPSE,v,u),d),afterAnimate:v=>this.emit(new Xr(Mt.AFTER_ANIMATE,yr.COLLAPSE,v,u),d),after:()=>this.emit(new vn(Mt.AFTER_DRAW,{dataChanges:c,animation:e}),d)},{collapse:{target:t,descendants:[...g(f.nodes),...g(f.combos)],position:o}}))===null||r===void 0?void 0:r.finished})}expandCombo(t,e){return ol(this,void 0,void 0,function*(){var r;const{model:i}=this.context,a=fn(i.getComboData([t])[0]);this.computeStyle("expand");const s=this.computeChangesAndDrawData({stage:"expand",animation:e});if(!s)return;const{dataChanges:o,drawData:l}=s,{add:c,update:u}=l,h={animation:e,stage:"expand",data:l,target:t};this.createElements(c,h),this.updateElements(u,h);const f=d=>Array.from(d).map(([,g])=>tt(g));yield(r=this.context.animation.animate(e,{before:()=>this.emit(new vn(Mt.BEFORE_DRAW,{dataChanges:o,animation:e}),h),beforeAnimate:d=>this.emit(new Xr(Mt.BEFORE_ANIMATE,yr.EXPAND,d,l),h),afterAnimate:d=>this.emit(new Xr(Mt.AFTER_ANIMATE,yr.EXPAND,d,l),h),after:()=>this.emit(new vn(Mt.AFTER_DRAW,{dataChanges:o,animation:e}),h)},{expand:{target:t,descendants:[...f(c.nodes),...f(c.combos)],position:a}}))===null||r===void 0?void 0:r.finished})}clear(){this.container.destroy(),this.initContainer(),this.elementMap={},this.shapeTypeMap={},this.defaultStyle={},this.stateStyle={},this.paletteStyle={}}destroy(){this.clear(),this.container.destroy(),this.context={}}}var oo=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(r.next(u))}catch(h){s(h)}}function l(u){try{c(r.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((r=r.apply(n,t||[])).next())})},jtt=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};class qtt{get presetOptions(){return{animation:!!KN(this.context.options,!0)}}get options(){const{options:t}=this.context;return t.layout}constructor(t){this.instances=[],this.context=t}getLayoutInstance(){return this.instances}preLayout(t){return oo(this,void 0,void 0,function*(){var e,r,i,a;const{graph:s,model:o}=this.context,{add:l}=t;Mn(s,new vn(Mt.BEFORE_LAYOUT,{type:"pre"}));const c=yield(e=this.context.layout)===null||e===void 0?void 0:e.simulate();(r=c==null?void 0:c.nodes)===null||r===void 0||r.forEach(u=>{const h=tt(u),f=l.nodes.get(h);o.syncNodeLikeDatum(u),f&&Object.assign(f.style,u.style)}),(i=c==null?void 0:c.edges)===null||i===void 0||i.forEach(u=>{const h=tt(u),f=l.edges.get(h);o.syncEdgeDatum(u),f&&Object.assign(f.style,u.style)}),(a=c==null?void 0:c.combos)===null||a===void 0||a.forEach(u=>{const h=tt(u),f=l.combos.get(h);o.syncNodeLikeDatum(u),f&&Object.assign(f.style,u.style)}),Mn(s,new vn(Mt.AFTER_LAYOUT,{type:"pre"})),this.transformDataAfterLayout("pre",t)})}postLayout(){return oo(this,arguments,void 0,function*(t=this.options){if(!t)return;const e=Array.isArray(t)?t:[t],{graph:r}=this.context;Mn(r,new vn(Mt.BEFORE_LAYOUT,{type:"post"}));for(const i of e){const a=e.indexOf(i),s=this.getLayoutData(i),o=Object.assign(Object.assign({},this.presetOptions),i);Mn(r,new vn(Mt.BEFORE_STAGE_LAYOUT,{options:o,index:a}));const l=yield this.stepLayout(s,o,a);Mn(r,new vn(Mt.AFTER_STAGE_LAYOUT,{options:o,index:a})),i.animation||this.updateElementPosition(l,!1)}Mn(r,new vn(Mt.AFTER_LAYOUT,{type:"post"})),this.transformDataAfterLayout("post")})}transformDataAfterLayout(t,e){const r=this.context.transform.getTransformInstance();Object.values(r).forEach(i=>i.afterLayout(t,e))}simulate(){return oo(this,void 0,void 0,function*(){if(!this.options)return{};const t=Array.isArray(this.options)?this.options:[this.options];let e={};for(const r of t){const i=t.indexOf(r),a=this.getLayoutData(r);e=yield this.stepLayout(a,Object.assign(Object.assign(Object.assign({},this.presetOptions),r),{animation:!1}),i)}return e})}stepLayout(t,e,r){return oo(this,void 0,void 0,function*(){return X$(e)?yield this.treeLayout(t,e,r):yield this.graphLayout(t,e,r)})}graphLayout(t,e,r){return oo(this,void 0,void 0,function*(){const{animation:i,enableWorker:a,iterations:s=300}=e,o=this.initGraphLayout(e);if(!o)return{};if(this.instances[r]=o,this.instance=o,a){const c=o;return this.supervisor=new FX(c.graphData2LayoutModel(t),c.instance,{iterations:s}),Hu(yield this.supervisor.execute())}if(kb(o))return i?yield o.execute(t,{onTick:c=>{this.updateElementPosition(c,!1)}}):(o.execute(t),o.stop(),o.tick(s));const l=yield o.execute(t);if(i){const c=this.updateElementPosition(l,i);yield c==null?void 0:c.finished}return l})}treeLayout(t,e,r){return oo(this,void 0,void 0,function*(){const{type:i,animation:a}=e,s=la("layout",i);if(!s)return{};const{nodes:o=[],edges:l=[]}=t,c=new kn({nodes:o.map(g=>({id:tt(g),data:g.data||{}})),edges:l.map(g=>({id:tt(g),source:g.source,target:g.target,data:g.data||{}}))});Ftt(c);const u={nodes:[],edges:[]},h={nodes:[],edges:[]};c.getRoots(Ir).forEach(g=>{As(g,w=>{w.children=c.getSuccessors(w.id)},w=>c.getSuccessors(w.id),"TB");const v=s(g,e),{x:p,y,z:m=0}=v;As(v,w=>{const{id:E,x:S,y:O,z:k=0}=w;u.nodes.push({id:E,style:{x:p,y,z:m}}),h.nodes.push({id:E,style:{x:S,y:O,z:k}})},w=>w.children,"TB")});const d=this.inferTreeLayoutOffset(h);if(pC(h,d),a){pC(u,d),this.updateElementPosition(u,!1);const g=this.updateElementPosition(h,a);yield g==null?void 0:g.finished}return h})}inferTreeLayoutOffset(t){var e;let[r,i]=[1/0,-1/0],[a,s]=[1/0,-1/0];(e=t.nodes)===null||e===void 0||e.forEach(v=>{const{x:p=0,y=0}=v.style||{};r=Math.min(r,p),i=Math.max(i,p),a=Math.min(a,y),s=Math.max(s,y)});const{canvas:o}=this.context,l=o.getSize(),[c,u]=o.getCanvasByViewport([0,0]),[h,f]=o.getCanvasByViewport(l);if(r>=c&&i<=h&&a>=u&&s<=f)return[0,0];const d=(c+h)/2,g=(u+f)/2;return[d-(r+i)/2,g-(a+s)/2]}stopLayout(){this.instance&&kb(this.instance)&&(this.instance.stop(),this.instance=void 0),this.supervisor&&(this.supervisor.stop(),this.supervisor=void 0),this.animationResult&&(this.animationResult.finish(),this.animationResult=void 0)}getLayoutData(t){const{nodeFilter:e=()=>!0,preLayout:r=!1,isLayoutInvisibleNodes:i=!1}=t,{nodes:a,edges:s,combos:o}=this.context.model.getData(),{element:l,model:c}=this.context,u=v=>l.getElement(v),h=r?v=>{var p;return!i&&(((p=v.style)===null||p===void 0?void 0:p.visibility)==="hidden"||c.getAncestorsData(v.id,Ir).some(xr)||c.getAncestorsData(v.id,Oe).some(xr))?!1:e(v)}:v=>{const p=tt(v),y=u(p);return!y||vf(y)?!1:e(v)},f=a.filter(h),d=new Map(f.map(v=>[tt(v),v]));o.forEach(v=>d.set(tt(v),v));const g=s.filter(({source:v,target:p})=>d.has(v)&&d.has(p));return{nodes:f,edges:g,combos:o}}initGraphLayout(t){var e;const{element:r,viewport:i}=this.context,{type:a,enableWorker:s,animation:o,iterations:l}=t,c=jtt(t,["type","enableWorker","animation","iterations"]),[u,h]=i.getCanvasSize(),f=[u/2,h/2],d=(e=t==null?void 0:t.nodeSize)!==null&&e!==void 0?e:m=>{const w=r==null?void 0:r.getElement(m.id);return w?w.attributes.size:r==null?void 0:r.getElementComputedStyle("node",m).size},g=la("layout",a);if(!g)return ji.warn(`The layout of ${a} is not registered.`);const v=Object.getPrototypeOf(g.prototype)===xf.prototype?g:Z$(g,this.context),p=new v(this.context),y={nodeSize:d,width:u,height:h,center:f};switch(p.id){case"d3-force":case"d3-force-3d":Object.assign(y,{center:{x:u/2,y:h/2,z:0}});break}return fr(p.options,y,c),p}updateElementPosition(t,e){const{model:r,element:i}=this.context;return i?(r.updateData(t),i.draw({animation:e,silence:!0})):null}destroy(){var t;this.stopLayout(),this.context={},(t=this.supervisor)===null||t===void 0||t.kill(),this.supervisor=void 0,this.instance=void 0,this.instances=[],this.animationResult=void 0}}const pC=(n,t)=>{var e;const[r,i]=t;(e=n.nodes)===null||e===void 0||e.forEach(a=>{if(a.style){const{x:s=0,y:o=0}=a.style;a.style.x=s+r,a.style.y=o+i}else a.style={x:r,y:i}})};function $tt(n){return[Gtt].reduce((e,r)=>r(e),n)}function Gtt(n){return!n.layout||Array.isArray(n.layout)||"preLayout"in n.layout||["antv-dagre","combo-combined","compact-box","circular","concentric","dagre","fishbone","grid","indented","mds","radial","random","snake","dendrogram","mindmap"].includes(n.layout.type)&&(n.layout.preLayout=!0),n}class Wtt extends Pw{constructor(t){super(t),this.category="plugin",this.setPlugins(this.context.options.plugins||[])}setPlugins(t){this.setExtensions(t)}getPluginInstance(t){const e=this.extensionMap[t];if(e)return e;ji.warn(`Cannot find the plugin ${t}, will try to find it by type.`);const r=this.extensions.find(i=>i.type===t);if(r)return this.extensionMap[r.key]}}const Bu=["update-related-edges","collapse-expand-node","collapse-expand-combo","get-edge-actual-ends","arrange-draw-order"];class Vtt extends Pw{constructor(t){super(t),this.category="transform",this.setTransforms(this.context.options.transforms||[])}getTransforms(){}setTransforms(t){this.setExtensions([...Bu.slice(0,Bu.length-1),...t,Bu[Bu.length-1]])}getTransformInstance(t){return t?this.extensionMap[t]:this.extensionMap}}var ll=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(r.next(u))}catch(h){s(h)}}function l(u){try{c(r.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((r=r.apply(n,t||[])).next())})};class Htt{get padding(){return qi(this.context.options.padding)}get paddingOffset(){const[t,e,r,i]=this.padding,[a,s,o]=[(i-e)/2,(t-r)/2,0];return[a,s,o]}constructor(t){this.landmarkCounter=0,this.context=t;const[e,r]=this.paddingOffset,{zoom:i,rotation:a,x:s=e,y:o=r}=t.options;this.transform({mode:"absolute",scale:i,translate:[s,o],rotate:a},!1)}get camera(){const{canvas:t}=this.context;return new Proxy(t.getCamera(),{get:(e,r)=>{const a=Object.entries(t.getLayers()).filter(([o])=>!["main"].includes(o)).map(([,o])=>o.getCamera()),s=e[r];if(typeof s=="function")return(...o)=>{const l=s.apply(e,o);return a.forEach(c=>{c[r].apply(c,o)}),l}}})}createLandmark(t){return this.camera.createLandmark(`landmark-${this.landmarkCounter++}`,t)}getAnimation(t){const e=KN(this.context.options,t);return e?Ns(Object.assign({},e),["easing","duration"]):!1}getCanvasSize(){const{canvas:t}=this.context,{width:e=0,height:r=0}=t.getConfig();return[e,r]}getCanvasCenter(){const{canvas:t}=this.context,{width:e=0,height:r=0}=t.getConfig();return[e/2,r/2,0]}getViewportCenter(){const[t,e]=this.camera.getPosition();return[t,e,0]}getGraphCenter(){return this.context.graph.getViewportByCanvas(this.getCanvasCenter())}getZoom(){return this.camera.getZoom()}getRotation(){return this.camera.getRoll()}getTranslateOptions(t){const{camera:e}=this,{mode:r,translate:i=[]}=t,a=this.getZoom(),s=e.getPosition(),o=e.getFocalPoint(),[l,c]=this.getCanvasCenter(),[u=0,h=0,f=0]=i,d=gi([-u,-h,-f],a);return r==="relative"?{position:re(s,d),focalPoint:re(o,d)}:{position:re([l,c,s[2]],d),focalPoint:re([l,c,o[2]],d)}}getRotateOptions(t){const{mode:e,rotate:r=0}=t;return{roll:e==="relative"?this.camera.getRoll()+r:r}}getZoomOptions(t){const{zoomRange:e}=this.context.options,r=this.camera.getZoom(),{mode:i,scale:a=1}=t;return tn(i==="relative"?r*a:a,...e)}transform(t,e){return ll(this,void 0,void 0,function*(){const{graph:r}=this.context,{translate:i,rotate:a,scale:s,origin:o}=t;this.cancelAnimation();const l=this.getAnimation(e);if(Mn(r,new Fu(Mt.BEFORE_TRANSFORM,t)),!a&&s&&!i&&o&&!l){this.camera.setZoomByViewportPoint(this.getZoomOptions(t),o),Mn(r,new Fu(Mt.AFTER_TRANSFORM,t));return}const c={};if(i&&Object.assign(c,this.getTranslateOptions(t)),Lt(a)&&Object.assign(c,this.getRotateOptions(t)),Lt(s)&&Object.assign(c,{zoom:this.getZoomOptions(t)}),l)return Mn(r,new Xr(Mt.BEFORE_ANIMATE,yr.TRANSFORM,null,t)),new Promise(u=>{this.transformResolver=u,this.camera.gotoLandmark(this.createLandmark(c),Object.assign(Object.assign({},l),{onfinish:()=>{Mn(r,new Xr(Mt.AFTER_ANIMATE,yr.TRANSFORM,null,t)),Mn(r,new Fu(Mt.AFTER_TRANSFORM,t)),this.transformResolver=void 0,u()}}))});this.camera.gotoLandmark(this.createLandmark(c),{duration:0}),Mn(r,new Fu(Mt.AFTER_TRANSFORM,t))})}fitView(t,e){return ll(this,void 0,void 0,function*(){const[r,i,a,s]=this.padding,{when:o="always",direction:l="both"}=t||{},[c,u]=this.context.canvas.getSize(),h=c-s-i,f=u-r-a,d=this.context.canvas.getBounds(),g=this.getBBoxInViewport(d),[v,p]=ts(g),y=l==="x"&&v>=h||l==="y"&&p>=f||l==="both"&&v>=h&&p>=f;if(o==="overflow"&&!y)return yield this.fitCenter({animation:e});const m=h/v,w=f/p,E=l==="x"?m:l==="y"?w:Math.min(m,w),S=this.getAnimation(e);yield this.transform({mode:"relative",scale:E,translate:re(Me(this.getCanvasCenter(),this.getBBoxInViewport(d).center),gi(this.paddingOffset,E))},S)})}fitCenter(t){return ll(this,void 0,void 0,function*(){const e=this.context.canvas.getBounds();yield this.focus(e,t)})}focusElements(t){return ll(this,arguments,void 0,function*(e,r={}){const{element:i}=this.context;if(!i)return;const a=o=>r.shapes?o.getShape(r.shapes).getRenderBounds():o.getRenderBounds(),s=vc(e.map(o=>a(i.getElement(o))));yield this.focus(s,r)})}focus(t,e){return ll(this,void 0,void 0,function*(){const r=this.context.graph.getViewportByCanvas(t.center),i=e.position||this.getCanvasCenter(),a=Me(i,r);yield this.transform({mode:"relative",translate:re(a,this.paddingOffset)},e.animation)})}getBBoxInViewport(t){const{min:e,max:r}=t,{graph:i}=this.context,[a,s]=i.getViewportByCanvas(e),[o,l]=i.getViewportByCanvas(r),c=new Re;return c.setMinMax([a,s,0],[o,l,0]),c}isInViewport(t,e=!1,r=0){const{graph:i}=this.context,a=this.getCanvasSize(),[s,o]=i.getCanvasByViewport([0,0]),[l,c]=i.getCanvasByViewport(a);let u=new Re;return u.setMinMax([s,o,0],[l,c,0]),r&&(u=es(u,r)),No(t)?di(t,u):e?J8(t,u):u.intersects(t)}cancelAnimation(){var t,e;!((t=this.camera.landmarks)===null||t===void 0)&&t.length&&this.camera.cancelLandmarkAnimation(),(e=this.transformResolver)===null||e===void 0||e.call(this)}}var Pe=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(u){try{c(r.next(u))}catch(h){s(h)}}function l(u){try{c(r.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((r=r.apply(n,t||[])).next())})};class Sd extends wf{constructor(t){var e;super(),this.options={},this.rendered=!1,this.destroyed=!1,this.context={model:new Btt},this.isCollapsingExpanding=!1,this.onResize=cc(()=>{this.resize()},300),this._setOptions(Object.assign({},Sd.defaultOptions,t),!0),this.context.graph=this,this.options.autoResize&&((e=globalThis.addEventListener)===null||e===void 0||e.call(globalThis,"resize",this.onResize))}getOptions(){return this.options}setOptions(t){this._setOptions(t,!1)}_setOptions(t,e){if(this.updateCanvas(t),Object.assign(this.options,$tt(t)),e){const{data:f}=t;f&&this.addData(f);return}const{behaviors:r,combo:i,data:a,edge:s,layout:o,node:l,plugins:c,theme:u,transforms:h}=t;r&&this.setBehaviors(r),a&&this.setData(a),l&&this.setNode(l),s&&this.setEdge(s),i&&this.setCombo(i),o&&this.setLayout(o),u&&this.setTheme(u),c&&this.setPlugins(c),h&&this.setTransforms(h)}getSize(){return this.context.canvas?this.context.canvas.getSize():[this.options.width||0,this.options.height||0]}setSize(t,e){t&&(this.options.width=t),e&&(this.options.height=e),this.resize(t,e)}setZoomRange(t){this.options.zoomRange=t}getZoomRange(){return this.options.zoomRange}setNode(t){this.options.node=t,this.context.model.refreshData()}setEdge(t){this.options.edge=t,this.context.model.refreshData()}setCombo(t){this.options.combo=t,this.context.model.refreshData()}getTheme(){return this.options.theme}setTheme(t){this.options.theme=zt(t)?t(this.getTheme()):t}setLayout(t){this.options.layout=zt(t)?t(this.getLayout()):t}getLayout(){return this.options.layout}setBehaviors(t){var e;this.options.behaviors=zt(t)?t(this.getBehaviors()):t,(e=this.context.behavior)===null||e===void 0||e.setBehaviors(this.options.behaviors)}updateBehavior(t){this.setBehaviors(e=>e.map(r=>typeof r=="object"&&r.key===t.key?Object.assign(Object.assign({},r),t):r))}getBehaviors(){return this.options.behaviors||[]}setPlugins(t){var e;this.options.plugins=zt(t)?t(this.getPlugins()):t,(e=this.context.plugin)===null||e===void 0||e.setPlugins(this.options.plugins)}updatePlugin(t){this.setPlugins(e=>e.map(r=>typeof r=="object"&&r.key===t.key?Object.assign(Object.assign({},r),t):r))}getPlugins(){return this.options.plugins||[]}getPluginInstance(t){return this.context.plugin.getPluginInstance(t)}setTransforms(t){var e;this.options.transforms=zt(t)?t(this.getTransforms()):t,(e=this.context.transform)===null||e===void 0||e.setTransforms(this.options.transforms)}updateTransform(t){this.setTransforms(e=>e.map(r=>typeof r=="object"&&r.key===t.key?Object.assign(Object.assign({},r),t):r)),this.context.model.refreshData()}getTransforms(){return this.options.transforms||[]}getData(){return this.context.model.getData()}getElementData(t){return Array.isArray(t)?t.map(e=>this.context.model.getElementDataById(e)):this.context.model.getElementDataById(t)}getNodeData(t){return t===void 0?this.context.model.getNodeData():Array.isArray(t)?this.context.model.getNodeData(t):this.context.model.getNodeLikeDatum(t)}getEdgeData(t){return t===void 0?this.context.model.getEdgeData():Array.isArray(t)?this.context.model.getEdgeData(t):this.context.model.getEdgeDatum(t)}getComboData(t){return t===void 0?this.context.model.getComboData():Array.isArray(t)?this.context.model.getComboData(t):this.context.model.getNodeLikeDatum(t)}setData(t){this.context.model.setData(zt(t)?t(this.getData()):t)}addData(t){this.context.model.addData(zt(t)?t(this.getData()):t)}addNodeData(t){this.context.model.addNodeData(zt(t)?t(this.getNodeData()):t)}addEdgeData(t){this.context.model.addEdgeData(zt(t)?t(this.getEdgeData()):t)}addComboData(t){this.context.model.addComboData(zt(t)?t(this.getComboData()):t)}addChildrenData(t,e){this.context.model.addChildrenData(t,e)}updateData(t){this.context.model.updateData(zt(t)?t(this.getData()):t)}updateNodeData(t){this.context.model.updateNodeData(zt(t)?t(this.getNodeData()):t)}updateEdgeData(t){this.context.model.updateEdgeData(zt(t)?t(this.getEdgeData()):t)}updateComboData(t){this.context.model.updateComboData(zt(t)?t(this.getComboData()):t)}removeData(t){this.context.model.removeData(zt(t)?t(this.getData()):t)}removeNodeData(t){this.context.model.removeNodeData(zt(t)?t(this.getNodeData()):t)}removeEdgeData(t){this.context.model.removeEdgeData(zt(t)?t(this.getEdgeData()):t)}removeComboData(t){this.context.model.removeComboData(zt(t)?t(this.getComboData()):t)}getElementType(t){return this.context.model.getElementType(t)}getRelatedEdgesData(t,e="both"){return this.context.model.getRelatedEdgesData(t,e)}getNeighborNodesData(t){return this.context.model.getNeighborNodesData(t)}getAncestorsData(t,e){return this.context.model.getAncestorsData(t,e)}getParentData(t,e){return this.context.model.getParentData(t,e)}getChildrenData(t){return this.context.model.getChildrenData(t)}getDescendantsData(t){return this.context.model.getDescendantsData(t)}getElementDataByState(t,e){return this.context.model.getElementDataByState(t,e)}initCanvas(){return Pe(this,void 0,void 0,function*(){var t;if(this.context.canvas)return yield this.context.canvas.ready;const{container:e="container",width:r,height:i,renderer:a,cursor:s,background:o,canvas:l,devicePixelRatio:c=(t=globalThis.devicePixelRatio)!==null&&t!==void 0?t:1}=this.options;if(e instanceof cC)this.context.canvas=e,s&&e.setCursor(s),a&&e.setRenderer(a),yield e.ready;else{const u=me(e)?document.getElementById(e):e,h=fC(u);this.emit(Mt.BEFORE_CANVAS_INIT,{container:u,width:r,height:i});const f=Object.assign(Object.assign({},l),{container:u,width:r||h[0],height:i||h[1],background:o,renderer:a,cursor:s,devicePixelRatio:c}),d=new cC(f);this.context.canvas=d,yield d.ready,this.emit(Mt.AFTER_CANVAS_INIT,{canvas:d})}})}updateCanvas(t){var e,r;const{renderer:i,cursor:a,height:s,width:o}=t,l=this.context.canvas;l&&(i&&(this.emit(Mt.BEFORE_RENDERER_CHANGE,{renderer:this.options.renderer}),l.setRenderer(i),this.emit(Mt.AFTER_RENDERER_CHANGE,{renderer:i})),a&&l.setCursor(a),(Lt(o)||Lt(s))&&this.setSize((e=o??this.options.width)!==null&&e!==void 0?e:0,(r=s??this.options.height)!==null&&r!==void 0?r:0))}initRuntime(){this.context.options=this.options,this.context.batch||(this.context.batch=new Ltt(this.context)),this.context.plugin||(this.context.plugin=new Wtt(this.context)),this.context.viewport||(this.context.viewport=new Htt(this.context)),this.context.transform||(this.context.transform=new Vtt(this.context)),this.context.element||(this.context.element=new ztt(this.context)),this.context.animation||(this.context.animation=new Rtt(this.context)),this.context.layout||(this.context.layout=new qtt(this.context)),this.context.behavior||(this.context.behavior=new Itt(this.context))}prepare(){return Pe(this,void 0,void 0,function*(){if(yield Promise.resolve(),this.destroyed)throw new Error(ia("The graph instance has been destroyed"));yield this.initCanvas(),this.initRuntime()})}render(){return Pe(this,void 0,void 0,function*(){if(yield this.prepare(),Mn(this,new vn(Mt.BEFORE_RENDER)),this.options.layout)if(!this.rendered&&K$(this.options.layout)){const t=yield this.context.element.preLayoutDraw({type:"render"});yield Promise.all([t==null?void 0:t.finished,this.autoFit()])}else{const t=this.context.element.draw({type:"render"});yield Promise.all([t==null?void 0:t.finished,this.context.layout.postLayout()]),yield this.autoFit()}else{const t=this.context.element.draw({type:"render"});yield Promise.all([t==null?void 0:t.finished,this.autoFit()])}this.rendered=!0,Mn(this,new vn(Mt.AFTER_RENDER))})}draw(){return Pe(this,void 0,void 0,function*(){var t;yield this.prepare(),yield(t=this.context.element.draw())===null||t===void 0?void 0:t.finished})}layout(t){return Pe(this,void 0,void 0,function*(){yield this.context.layout.postLayout(t)})}stopLayout(){this.context.layout.stopLayout()}clear(){return Pe(this,void 0,void 0,function*(){const{model:t,element:e}=this.context;t.setData({}),t.clearChanges(),e==null||e.clear()})}destroy(){var t;Mn(this,new vn(Mt.BEFORE_DESTROY));const{layout:e,animation:r,element:i,model:a,canvas:s,behavior:o,plugin:l}=this.context;l==null||l.destroy(),o==null||o.destroy(),e==null||e.destroy(),r==null||r.destroy(),i==null||i.destroy(),a.destroy(),s==null||s.destroy(),this.options={},this.context={},this.off(),(t=globalThis.removeEventListener)===null||t===void 0||t.call(globalThis,"resize",this.onResize),this.destroyed=!0,Mn(this,new vn(Mt.AFTER_DESTROY))}getCanvas(){return this.context.canvas}resize(t,e){var r;const i=fC((r=this.context.canvas)===null||r===void 0?void 0:r.getContainer()),a=[t||i[0],e||i[1]];if(!this.context.canvas)return;const s=this.context.canvas.getSize();en(a,s)||(Mn(this,new vn(Mt.BEFORE_SIZE_CHANGE,{size:a})),this.context.canvas.resize(...a),Mn(this,new vn(Mt.AFTER_SIZE_CHANGE,{size:a})))}fitView(t,e){return Pe(this,void 0,void 0,function*(){var r;yield(r=this.context.viewport)===null||r===void 0?void 0:r.fitView(t,e)})}fitCenter(t){return Pe(this,void 0,void 0,function*(){var e;yield(e=this.context.viewport)===null||e===void 0?void 0:e.fitCenter({animation:t})})}autoFit(){return Pe(this,void 0,void 0,function*(){const{autoFit:t}=this.context.options;if(t)if(me(t))t==="view"?yield this.fitView():t==="center"&&(yield this.fitCenter());else{const{type:e,animation:r}=t;e==="view"?yield this.fitView(t.options,r):e==="center"&&(yield this.fitCenter(r))}})}focusElement(t,e){return Pe(this,void 0,void 0,function*(){var r;yield(r=this.context.viewport)===null||r===void 0?void 0:r.focusElements(Array.isArray(t)?t:[t],{animation:e})})}zoomBy(t,e,r){return Pe(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",scale:t,origin:r},e)})}zoomTo(t,e,r){return Pe(this,void 0,void 0,function*(){this.context.viewport.transform({mode:"absolute",scale:t,origin:r},e)})}getZoom(){return this.context.viewport.getZoom()}rotateBy(t,e,r){return Pe(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",rotate:t,origin:r},e)})}rotateTo(t,e,r){return Pe(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"absolute",rotate:t,origin:r},e)})}getRotation(){return this.context.viewport.getRotation()}translateBy(t,e){return Pe(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",translate:t},e)})}translateTo(t,e){return Pe(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"absolute",translate:t},e)})}getPosition(){return Me([0,0],this.getCanvasByViewport([0,0]))}translateElementBy(t,e){return Pe(this,arguments,void 0,function*(r,i,a=!0){var s,o;const[l,c]=hn(r)?[r,(s=i)!==null&&s!==void 0?s:!0]:[{[r]:i},a];Object.entries(l).forEach(([u,h])=>this.context.model.translateNodeLikeBy(u,h)),yield(o=this.context.element.draw({animation:c,stage:"translate"}))===null||o===void 0?void 0:o.finished})}translateElementTo(t,e){return Pe(this,arguments,void 0,function*(r,i,a=!0){var s,o;const[l,c]=hn(r)?[r,(s=i)!==null&&s!==void 0?s:!0]:[{[r]:i},a];Object.entries(l).forEach(([u,h])=>this.context.model.translateNodeLikeTo(u,h)),yield(o=this.context.element.draw({animation:c,stage:"translate"}))===null||o===void 0?void 0:o.finished})}getElementPosition(t){return this.context.model.getElementPosition(t)}getElementRenderStyle(t){return gw(this.context.element.getElement(t).attributes,["context"])}setElementVisibility(t,e){return Pe(this,arguments,void 0,function*(r,i,a=!0){var s,o;const[l,c]=hn(r)?[r,(s=i)!==null&&s!==void 0?s:!0]:[{[r]:i},a],u={nodes:[],edges:[],combos:[]};Object.entries(l).forEach(([d,g])=>{const v=this.getElementType(d);u[`${v}s`].push({id:d,style:{visibility:g}})});const{model:h,element:f}=this.context;h.preventUpdateNodeLikeHierarchy(()=>{h.updateData(u)}),yield(o=f.draw({animation:c,stage:"visibility"}))===null||o===void 0?void 0:o.finished})}showElement(t,e){return Pe(this,void 0,void 0,function*(){const r=Array.isArray(t)?t:[t];yield this.setElementVisibility(Object.fromEntries(r.map(i=>[i,"visible"])),e)})}hideElement(t,e){return Pe(this,void 0,void 0,function*(){const r=Array.isArray(t)?t:[t];yield this.setElementVisibility(Object.fromEntries(r.map(i=>[i,"hidden"])),e)})}getElementVisibility(t){var e,r;const i=this.context.element.getElement(t);return(r=(e=i==null?void 0:i.style)===null||e===void 0?void 0:e.visibility)!==null&&r!==void 0?r:"visible"}setElementZIndex(t,e){return Pe(this,void 0,void 0,function*(){var r;const i={nodes:[],edges:[],combos:[]},a=hn(t)?t:{[t]:e};Object.entries(a).forEach(([l,c])=>{const u=this.getElementType(l);i[`${u}s`].push({id:l,style:{zIndex:c}})});const{model:s,element:o}=this.context;s.preventUpdateNodeLikeHierarchy(()=>s.updateData(i)),yield(r=o.draw({animation:!1,stage:"zIndex"}))===null||r===void 0?void 0:r.finished})}frontElement(t){return Pe(this,void 0,void 0,function*(){const e=Array.isArray(t)?t:[t],{model:r}=this.context,i={};e.map(a=>{const s=r.getFrontZIndex(a);if(r.getElementType(a)==="combo"){const l=r.getAncestorsData(a,Oe).at(-1)||this.getComboData(a),c=[l,...r.getDescendantsData(tt(l))],u=s-dC(l);c.forEach(f=>{i[tt(f)]=this.getElementZIndex(tt(f))+u});const{internal:h}=bb(c.map(tt),f=>r.getRelatedEdgesData(f));h.forEach(f=>{const d=tt(f);i[d]=this.getElementZIndex(d)+u})}else i[a]=s}),yield this.setElementZIndex(i)})}getElementZIndex(t){return dC(this.context.model.getElementDataById(t))}setElementState(t,e){return Pe(this,arguments,void 0,function*(r,i,a=!0){var s,o;const[l,c]=hn(r)?[r,(s=i)!==null&&s!==void 0?s:!0]:[{[r]:i},a],u=f=>f?Array.isArray(f)?f:[f]:[],h={nodes:[],edges:[],combos:[]};Object.entries(l).forEach(([f,d])=>{const g=this.getElementType(f);h[`${g}s`].push({id:f,states:u(d)})}),this.updateData(h),yield(o=this.context.element.draw({animation:c,stage:"state"}))===null||o===void 0?void 0:o.finished})}getElementState(t){return this.context.model.getElementState(t)}getElementRenderBounds(t){return this.context.element.getElement(t).getRenderBounds()}collapseElement(t){return Pe(this,arguments,void 0,function*(e,r=!0){const{model:i,element:a}=this.context;if(xr(i.getNodeLikeData([e])[0])||this.isCollapsingExpanding)return;typeof r=="boolean"&&(r={animation:r,align:!0});const s=i.getElementType(e);yield this.frontElement(e),this.isCollapsingExpanding=!0,this.setElementCollapsibility(e,!0),s==="node"?yield a.collapseNode(e,r):s==="combo"&&(yield a.collapseCombo(e,!!r.animation)),this.isCollapsingExpanding=!1})}expandElement(t){return Pe(this,arguments,void 0,function*(e,r=!0){const{model:i,element:a}=this.context;if(!xr(i.getNodeLikeData([e])[0])||this.isCollapsingExpanding)return;typeof r=="boolean"&&(r={animation:r,align:!0});const s=i.getElementType(e);this.isCollapsingExpanding=!0,this.setElementCollapsibility(e,!1),s==="node"?yield a.expandNode(e,r):s==="combo"&&(yield a.expandCombo(e,!!r.animation)),this.isCollapsingExpanding=!1})}setElementCollapsibility(t,e){const r=this.getElementType(t);r==="node"?this.updateNodeData([{id:t,style:{collapsed:e}}]):r==="combo"&&this.updateComboData([{id:t,style:{collapsed:e}}])}toDataURL(){return Pe(this,arguments,void 0,function*(t={}){return this.context.canvas.toDataURL(t)})}getCanvasByViewport(t){return this.context.canvas.getCanvasByViewport(t)}getViewportByCanvas(t){return this.context.canvas.getViewportByCanvas(t)}getClientByCanvas(t){return this.context.canvas.getClientByCanvas(t)}getCanvasByClient(t){return this.context.canvas.getCanvasByClient(t)}getViewportCenter(){return this.context.viewport.getViewportCenter()}getCanvasCenter(){return this.context.viewport.getCanvasCenter()}on(t,e,r){return super.on(t,e,r)}once(t,e){return super.once(t,e)}off(t,e){return super.off(t,e)}}Sd.defaultOptions={autoResize:!1,theme:"light",rotation:0,zoom:1,zoomRange:[.01,10]};var Utt=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};function Ytt(n,t){const{getNodeData:e=(o,l)=>{if(o.depth=l,!o.children)return o;const{children:c}=o,u=Utt(o,["children"]);return Object.assign(Object.assign({},u),{children:c.map(h=>h.id)})},getEdgeData:r=(o,l)=>({source:o.id,target:l.id}),getChildren:i=o=>o.children||[]}={},a=[],s=[];return As(n,(o,l)=>{a.push(e(o,l));const c=i(o);for(const u of c)s.push(r(o,u))},o=>i(o),"TB"),{nodes:a,edges:s}}class Xtt extends ss{beforeDraw(t){const{add:e,update:r}=t,{model:i}=this.context;return[...e.edges.entries(),...r.edges.entries()].forEach(([,a])=>{OI(i,a)}),t}}const OI=(n,t)=>{const{source:e,target:r}=t,i=n.getElementDataById(e),a=n.getElementDataById(r),s=A2(i,h=>n.getParentData(h,Oe)),o=A2(a,h=>n.getParentData(h,Oe)),l=tt(s),c=tt(o),u={sourceNode:l,targetNode:c};return t.style?Object.assign(t.style,u):t.style=u,t},Ktt=(n,t,e)=>{const[r,i]=t,[a,s]=e;if(i===r)return a;const o=(n-r)/(i-r);return a+o*(s-a)},Ztt=(n,t,e)=>{const[r,i]=t,[a,s]=e,o=Math.log(n-r+1)/Math.log(i-r+1);return a+o*(s-a)},Jtt=(n,t,e,r=2)=>{const[i,a]=t,[s,o]=e,l=Math.pow((n-i)/(a-i),r);return s+l*(o-s)},Qtt=(n,t,e)=>{const[r,i]=t,[a,s]=e,o=Math.sqrt((n-r)/(i-r));return a+o*(s-a)};class _d extends ss{constructor(t,e){super(t,fr({},_d.defaultOptions,e)),this.assignSizeByCentrality=(r,i,a,s,o,l)=>{const c=[i,a],u=[s[0],o[0]],h=[s[1],o[1]],f=[s[2],o[2]],d=(g,v)=>{if(typeof l=="function")return l(g,c,v);switch(l){case"linear":return Ktt(g,c,v);case"log":return Ztt(g,c,v);case"pow":return Jtt(g,c,v,2);case"sqrt":return Qtt(g,c,v);default:return v[0]}};return[d(r,u),d(r,h),d(r,f)]}}beforeDraw(t){const{model:e}=this.context,r=e.getNodeData(),i=jr(this.options.maxSize),a=jr(this.options.minSize),s=this.getCentralities(this.options.centrality),o=s.size>0?Math.max(...s.values()):0,l=s.size>0?Math.min(...s.values()):0;return r.forEach(c=>{var u;const h=this.assignSizeByCentrality(s.get(tt(c))||0,l,o,a,i,this.options.scale),f=(u=this.context.element)===null||u===void 0?void 0:u.getElement(tt(c)),d={size:h};this.assignLabelStyle(d,h,c,f),(!f||!Zu(d,f.attributes))&&zr(t,f?"update":"add","node",fr(c,{style:d}),!0)}),t}assignLabelStyle(t,e,r,i){var a;const s=i?i.config.style:(a=this.context.element)===null||a===void 0?void 0:a.getElementComputedStyle("node",r);if(Object.assign(t,Ns(s,["labelFontSize","labelLineHeight"])),this.options.mapLabelSize){const o=this.getLabelSizeByNodeSize(e,1/0,Number(t.labelFontSize));Object.assign(t,{labelFontSize:o,labelLineHeight:o+Z8(t.labelPadding)})}return t}getLabelSizeByNodeSize(t,e,r){const i=Math.min(...t)/2,[a,s]=Array.isArray(this.options.mapLabelSize)?this.options.mapLabelSize:[r,e];return Math.min(s,Math.max(i,a))}getCentralities(t){const{model:e}=this.context,r=e.getData();if(typeof t=="function")return t(r);const i=e.getRelatedEdgesData.bind(e);return oR(r,i,t)}}_d.defaultOptions={centrality:{type:"degree"},maxSize:80,minSize:20,scale:"linear",mapLabelSize:!1};class Md extends ss{constructor(t,e){super(t,Object.assign({},Md.defaultOptions,e))}get ref(){return this.context.model.getRootsData()[0]}afterLayout(){var t;const e=fn(this.ref),{graph:r,model:i}=this.context;(t=i.getData().nodes)===null||t===void 0||t.forEach(s=>{var o;if(tt(s)===tt(this.ref))return;const l=cR(Me(fn(s),e)),c=Math.abs(l)>Math.PI/2,u=!s.children||s.children.length===0,h=tt(s),f=(o=this.context.element)===null||o===void 0?void 0:o.getElement(h);if(!f||!f.isVisible())return;const d=jr(r.getElementRenderStyle(h).size)[0]/2,g=(u?1:-1)*(d+this.options.offset),v=[["translate",g*Math.cos(l),g*Math.sin(l)],["rotate",c?br(l)+180:br(l)]];i.updateNodeData([{id:tt(s),style:{labelTextAlign:c===u?"right":"left",labelTextBaseline:"middle",labelTransform:v}}])}),r.draw()}}Md.defaultOptions={offset:5};const tet="quadratic",vC=["top","top-right","right","right-bottom","bottom","bottom-left","left","left-top"];class Od extends ss{constructor(t,e){super(t,Object.assign({},Od.defaultOptions,e)),this.cacheMergeStyle=new Map,this.getAffectedParallelEdges=r=>{const{add:{edges:i},update:{nodes:a,edges:s,combos:o},remove:{edges:l}}=r,{model:c}=this.context,u=new Map,h=(g,v)=>{c.getRelatedEdgesData(v).forEach(y=>!u.has(tt(y))&&u.set(tt(y),y))};a.forEach(h),o.forEach(h);const f=g=>{const v=c.getEdgeData().map(y=>OI(c,y));eet(g,v).forEach(y=>!u.has(tt(y))&&u.set(tt(y),y))};if(l.size&&l.forEach(f),i.size&&i.forEach(f),s.size){const g=z3(yx(c.getChanges())).update.edges;s.forEach(v=>{var p;f(v);const y=(p=g.find(m=>tt(m.value)===tt(v)))===null||p===void 0?void 0:p.original;y&&!Nx(v,y)&&f(y)})}Ti(this.options.edges)||u.forEach((g,v)=>!this.options.edges.includes(v)&&u.delete(v));const d=c.getEdgeData().map(tt);return new Map([...u].sort((g,v)=>d.indexOf(g[0])-d.indexOf(v[0])))},this.applyBundlingStyle=(r,i,a)=>{const{edgeMap:s,reverses:o}=yC(i);s.forEach(l=>{l.forEach((c,u,h)=>{var f;const d=h.length,g=c.style||{};if(c.source===c.target){const y=vC.length;g.loopPlacement=vC[u%y],g.loopDist=Math.floor(u/y)*a+50}else if(d===1)g.curveOffset=0;else{const y=(u%2===0?1:-1)*(o[`${c.source}|${c.target}|${u}`]?-1:1);g.curveOffset=d%2===1?y*Math.ceil(u/2)*a*2:y*(Math.floor(u/2)*a*2+a)}const v=Object.assign(c,{type:tet,style:g}),p=(f=this.context.element)===null||f===void 0?void 0:f.getElement(tt(c));(!p||!Zu(v.style,p.attributes))&&zr(r,p?"update":"add","edge",v,!0)})})},this.resetEdgeStyle=r=>{const i=r.style||{},a=this.cacheMergeStyle.get(tt(r))||{};return Object.keys(a).forEach(s=>{en(i[s],a[s])&&(r[s]?i[s]=r[s]:delete i[s])}),Object.assign(r,{style:i})},this.applyMergingStyle=(r,i)=>{const{edgeMap:a,reverses:s}=yC(i);a.forEach(o=>{var l;if(o.length===1){const u=o[0],h=(l=this.context.element)===null||l===void 0?void 0:l.getElement(tt(u)),f=this.resetEdgeStyle(u);(!h||!Zu(f,h.attributes))&&zr(r,h?"update":"add","edge",f);return}const c=o.map(({source:u,target:h,style:f={}},d)=>{const{startArrow:g,endArrow:v}=f,p={},[y,m]=s[`${u}|${h}|${d}`]?["endArrow","startArrow"]:["startArrow","endArrow"];return fh(g)&&(p[y]=g),fh(v)&&(p[m]=v),p}).reduce((u,h)=>Object.assign(Object.assign({},u),h),{});o.forEach((u,h,f)=>{var d;if(h!==0){zr(r,"remove","edge",u);return}const g=Object.assign({},zt(this.options.style)?this.options.style(f):this.options.style,{childrenData:f});this.cacheMergeStyle.set(tt(u),g);const v=Object.assign(Object.assign({},u),{type:"line",style:Object.assign(Object.assign(Object.assign({},u.style),c),g)}),p=(d=this.context.element)===null||d===void 0?void 0:d.getElement(tt(u));(!p||!Zu(v.style,p.attributes))&&zr(r,p?"update":"add","edge",v,!0)})})}}beforeDraw(t){const e=this.getAffectedParallelEdges(t);return e.size===0||(this.options.mode==="bundle"?this.applyBundlingStyle(t,e,this.options.distance):this.applyMergingStyle(t,e)),t}}Od.defaultOptions={mode:"bundle",distance:15};const yC=n=>{const t=new Map,e=new Set,r={};for(const[i,a]of n){if(e.has(i))continue;const{source:s,target:o}=a,l=`${s}-${o}`;t.has(l)||t.set(l,[]),t.get(l).push(a),e.add(i);for(const[c,u]of n)e.has(c)||Nx(a,u)&&(t.get(l).push(u),e.add(c),s===u.target&&o===u.source&&(r[`${u.source}|${u.target}|${t.get(l).length-1}`]=!0))}return{edgeMap:t,reverses:r}},eet=(n,t,e)=>t.filter(r=>Nx(r,n)),Nx=(n,t)=>{const{sourceNode:e,targetNode:r}=n.style||{},{sourceNode:i,targetNode:a}=t.style||{};return e===i&&r===a||e===a&&r===i};class net extends ss{beforeDraw(t,e){const{stage:r}=e;if(r==="visibility")return t;const{model:i}=this.context,{update:{nodes:a,edges:s,combos:o}}=t,l=(c,u)=>{i.getRelatedEdgesData(u).forEach(f=>!s.has(tt(f))&&s.set(tt(f),f))};return a.forEach(l),o.forEach(l),t}}const ret={animation:{"combo-collapse":tR,"combo-expand":Y8,"node-collapse":JN,"node-expand":H8,"path-in":QN,"path-out":U8,fade:W8,translate:V8},behavior:{"brush-select":yc,"click-select":sf,"collapse-expand":yf,"create-edge":mf,"drag-canvas":bf,"drag-element-force":Q$,"drag-element":Sc,"fix-element-size":Ef,"focus-element":Sf,"hover-activate":_f,"lasso-select":eG,"auto-adapt-label":nf,"optimize-viewport-transform":Mf,"scroll-canvas":Of,"zoom-canvas":Tf},combo:{circle:Jq,rect:Qq},edge:{cubic:Ws,line:qR,polyline:gf,quadratic:pf,"cubic-horizontal":xc,"cubic-radial":ff,"cubic-vertical":df},layout:{"antv-dagre":rV,"combo-combined":g7,"compact-box":Ou.compactBox,"d3-force":j7,"force-atlas2":iX,circular:sV,concentric:Ob,dagre:Xf,dendrogram:Ou.dendrogram,fishbone:Kf,force:pL,fruchterman:oX,grid:cX,indented:Ou.indented,mds:yL,mindmap:Ou.mindmap,radial:mX,random:MX,snake:Zf},node:{circle:wc,diamond:eq,ellipse:cf,hexagon:sq,html:uf,image:LR,rect:Kq,star:Zq,donut:lf,triangle:hf},palette:{spectral:qX,tableau:$X,oranges:GX,greens:WX,blues:VX},theme:{dark:xtt,light:Stt},plugin:{"bubble-sets":td,"edge-bundling":nd,"edge-filter-lens":rd,"grid-line":sd,background:Jf,contextmenu:ed,fisheye:id,fullscreen:ad,history:od,hull:ld,legend:pd,minimap:vd,snapline:yd,timebar:md,toolbar:bd,tooltip:wd,watermark:xd},transform:{"arrange-draw-order":_tt,"collapse-expand-combo":Mtt,"collapse-expand-node":Ott,"get-edge-actual-ends":Xtt,"map-node-size":_d,"place-radial-labels":Md,"process-parallel-edges":Od,"update-related-edges":net},shape:{circle:da,ellipse:dc,group:Tn,html:gc,image:Dw,line:Is,path:Fr,polygon:Gs,polyline:tf,rect:Rn,text:Qa,label:ns,badge:Ua}};function iet(){Object.entries(ret).forEach(([n,t])=>{Object.entries(t).forEach(([e,r])=>{Ju(n,e,r)})})}iet();const aet={css:"//at.alicdn.com/t/a/font_470089_8hnbbf8n4u8.css"},set={id:"container"},oet={__name:"App",setup(n){const t=["#1783FF","#F08F56","#D580FF","#00C9C9","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"],e=["#F08F56","#D580FF","#00C9C9","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F","#1783FF"];return UC(()=>{const r=document.createElement("style");r.innerHTML=`@import url('${aet.css}');`,document.head.appendChild(r);const i={fill:"#020409",labelFill:"#FFFFFF",labelFontSize:24,labelFontWeight:600,labelOffsetY:8,labelPlacement:"center",ports:[{placement:"right"}],radius:8},a={labelOffsetY:0,labelFill:"#262626",labelFontWeight:600,labelOffsetY:4,labelPlacement:"center",ports:[{placement:"right"}],radius:8,labelFontSize:16,ports:[{placement:"right"},{placement:"left"}]},s={COLLAPSE_EXPAND:"collapse-expand"};let o;const l=p=>(o||(o=new Qa({style:p})),o.attr(p),o.getBBox().width),c=(p,y)=>{const m=y?40:30;return l({text:p,fontSize:(y?i:a).labelFontSize,fontFamily:"Gill Sans"})+m},u=(p,y)=>[c(p,y),y?48:32],v=class v extends Qr{constructor(y){Object.assign(y.style,v.defaultStyleProps),super(y)}get childrenData(){return this.context.model.getChildrenData(this.id)}get rootId(){return tt(this.context.model.getRootsData()[0])}isShowCollapse(y){var w;const{collapsed:m}=y;return this.id===this.rootId?!1:!m&&((w=this.childrenData)==null?void 0:w.length)>0}getCollapseStyle(y){const{showIcon:m,color:w,direction:E}=y;if(!this.isShowCollapse(y))return!1;const[S,O]=this.getSize(y);return{backgroundFill:w,backgroundHeight:12,backgroundWidth:12,cursor:"pointer",fill:"#fff",fontFamily:"iconfont",fontSize:8,text:"",textAlign:"center",transform:[["rotate",-90]],visibility:m?"visible":"hidden",x:S+6,y:O-14}}drawCollapseShape(y,m){if(!y.collapsed){const w=this.getCollapseStyle(y),E=this.upsert("collapse-expand",Ua,w,m);this.forwardEvent(E,st.CLICK,S=>{S.stopPropagation(),this.context.graph.emit(s.COLLAPSE_EXPAND,{id:this.id,collapsed:!y.collapsed})})}}getCountStyle(y){const{collapsed:m,color:w,direction:E}=y,S=this.context.model.getDescendantsData(this.id).length;if(!m||S===0)return!1;const[O,k]=this.getSize(y);return{backgroundFill:w,backgroundHeight:12,backgroundWidth:12,cursor:"pointer",fill:"#fff",fontSize:8,text:S.toString(),textAlign:"center",x:O+6,y:k-14,transform:[["rotate",0]]}}drawCountShape(y,m){if(y.collapsed){const w=this.getCountStyle(y),E=this.upsert("collapse-expand",Ua,w,m);this.forwardEvent(E,st.CLICK,S=>{S.stopPropagation(),this.context.graph.emit(s.COLLAPSE_EXPAND,{id:this.id,collapsed:!1})})}}forwardEvent(y,m,w){y&&!Reflect.has(y,"__bind__")&&(Reflect.set(y,"__bind__",!0),y.addEventListener(m,w))}getKeyStyle(y){const[m,w]=this.getSize(y),E=super.getKeyStyle(y);return{width:m,height:w,...E}}drawKeyShape(y,m){const w=this.getKeyStyle(y);return this.upsert("key",Rn,w,m)}render(y=this.parsedAttributes,m=this){console.log("badge render ",this.id),super.render(y,m),this.drawCollapseShape(y,m),this.drawCountShape(y,m),console.log("badge render ",this.id)}};Ce(v,"defaultStyleProps",{showIcon:!0});let h=v;class f extends xc{get rootId(){return tt(this.context.model.getRootsData()[0])}getKeyPath(y){const m=super.getKeyPath(y),w=this.targetNode.id===this.rootId,E=c(this.targetNode.id,w),[,S]=this.getEndpoints(y),O=this.sourceNode.getCenter()[0]<this.targetNode.getCenter()[0]?1:-1;return[...m,["L",S[0]+E*O,S[1]]]}}class d extends _r{constructor(m,w){super(m,w);Ce(this,"onCollapseExpand",async m=>{console.log("",m);const{id:w,collapsed:E}=m,{graph:S}=this.context;await S.frontElement(w),E?await S.collapseElement(w):await S.expandElement(w),console.log("",m)});this.bindEvents()}update(m){this.unbindEvents(),super.update(m),this.bindEvents()}bindEvents(){this.context.graph.on(s.COLLAPSE_EXPAND,this.onCollapseExpand)}unbindEvents(){this.context.graph.off(s.COLLAPSE_EXPAND,this.onCollapseExpand)}}Ju(za.NODE,"mindmap",h),Ju(za.EDGE,"mindmap",f),Ju(za.BEHAVIOR,"collapse-expand-tree",d);const g=(p,y)=>{if(!y)return"center";const m=fn(p)[0];return fn(y)[0]>m?"left":"right"};fetch("./data.json").then(p=>p.json()).then(p=>{let y=Ytt(p),m=0;y.nodes.forEach(S=>{S.depth===0&&(S.style={color:i.fill}),S.depth===1?(S.style={color:t[m%t.length]},S.children.forEach(O=>{const k=y.nodes.find(T=>T.id===O);k.style={color:e[m%e.length]}}),m++):S.style={color:t[m%t.length]}});const w=p.id,E=new Sd({data:y,node:{type:"mindmap",style:function(S){const O=g(S,this.getParentData(tt(S),"tree")),k=tt(S)===w;return console.log(S),{direction:O,labelText:tt(S),size:u(tt(S),k),labelFontFamily:"Gill Sans",labelBackground:!0,labelBackgroundFill:"transparent",labelPadding:[2,40,10,0],...k?i:a,fill:S.style.color}}},edge:{type:"mindmap",style:{lineWidth:3,stroke:function(S){return this.getNodeData(S.target).style.color||"#99ADD1"}}},layout:{type:"mindmap",direction:"LR",getHeight:()=>30,getWidth:S=>c(S.id,S.id===w),getVGap:()=>6,getHGap:()=>60,animation:!1},behaviors:["drag-canvas","zoom-canvas","collapse-expand-tree"],animation:!1});E.once(Mt.AFTER_RENDER,()=>{E.fitView()}),E.render()})}),(r,i)=>(E6(),M6("div",set))}};lF(oet).mount("#app");
